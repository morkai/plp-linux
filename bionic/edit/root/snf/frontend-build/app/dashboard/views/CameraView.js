// Part of <https://miracle.systems/p/walkner-snf> licensed under <CC BY-NC-SA 4.0>

define(["underscore","jquery","app/viewport","app/i18n","app/user","app/controller","app/data/programs","app/core/View","app/dashboard/templates/camera"],function(e,i,t,a,r,n,o,s,d){"use strict";navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var c;return s.extend({template:d,initialize:function(){this.idPrefix=e.uniqueId("camera")},destroy:function(){this.context=null},serialize:function(){return{idPrefix:this.idPrefix}},afterRender:function(){this.setUpCamera()},setUpCamera:function(){navigator.getUserMedia&&(void 0===c?navigator.getUserMedia({video:!0,audio:!1},this.onCameraSuccess.bind(this),this.onCameraError.bind(this)):null!==c&&this.setUpVideo())},onCameraSuccess:function(e){c=e,this.$id("video").prop("src",window.URL.createObjectURL(c))},onCameraError:function(e){c=null},setUpVideo:function(){this.$id("video").prop("src",window.URL.createObjectURL(c))}})});