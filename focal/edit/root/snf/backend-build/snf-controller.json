{"paths":{".":{"./helpers":"backend/helpers.js","moment":"node_modules/moment/moment.js","h5.main":"node_modules/h5.main/lib/index.js"},"node_modules/h5.main/lib/index.js":{"h5.step":"node_modules/h5.step/lib/index.js","h5.pubsub":"node_modules/h5.pubsub/lib/index.js","./utils/app":"node_modules/h5.main/lib/utils/app.js","./utils/log":"node_modules/h5.main/lib/utils/log.js","backend/node_modules/updater":"backend/node_modules/updater/index.js","backend/node_modules/h5-mongoose":"backend/node_modules/h5-mongoose/index.js","backend/node_modules/events":"backend/node_modules/events/index.js","backend/node_modules/modbus":"backend/node_modules/modbus/index.js","backend/node_modules/messenger/server":"backend/node_modules/messenger/server.js","backend/node_modules/messenger/client":"backend/node_modules/messenger/client.js","backend/node_modules/program":"backend/node_modules/program/index.js"},"node_modules/h5.pubsub/lib/index.js":{"./MessageBroker":"node_modules/h5.pubsub/lib/MessageBroker.js"},"node_modules/h5.pubsub/lib/MessageBroker.js":{"./Subscriptions":"node_modules/h5.pubsub/lib/Subscriptions.js","./Subscription":"node_modules/h5.pubsub/lib/Subscription.js","./Sandbox":"node_modules/h5.pubsub/lib/Sandbox.js"},"node_modules/h5.main/lib/utils/app.js":{},"node_modules/h5.main/lib/utils/log.js":{},"node_modules/moment/moment.js":{"./locale/pl":"node_modules/moment/locale/pl.js"},"node_modules/moment/locale/pl.js":{"../moment":"node_modules/moment/moment.js"},"backend/node_modules/updater/index.js":{"lodash":"node_modules/lodash/lodash.js","./expressMiddleware":"backend/node_modules/updater/expressMiddleware.js","./routes":"backend/node_modules/updater/routes.js","./commands":"backend/node_modules/updater/commands.js","package.json":"package.json"},"node_modules/lodash/lodash.js":{},"backend/node_modules/updater/commands.js":{},"backend/node_modules/h5-mongoose/index.js":{"mongoose":"node_modules/mongoose/index.js","./expressMiddleware":"backend/node_modules/h5-mongoose/expressMiddleware.js"},"node_modules/mongoose/index.js":{"./lib/":"node_modules/mongoose/lib/index.js"},"node_modules/mongoose/lib/index.js":{"./driver":"node_modules/mongoose/lib/driver.js","./drivers/node-mongodb-native":"node_modules/mongoose/lib/drivers/node-mongodb-native/index.js","./schema":"node_modules/mongoose/lib/schema.js","./schematype":"node_modules/mongoose/lib/schematype.js","./schema/index":"node_modules/mongoose/lib/schema/index.js","./virtualtype":"node_modules/mongoose/lib/virtualtype.js","./connectionstate":"node_modules/mongoose/lib/connectionstate.js","./types":"node_modules/mongoose/lib/types/index.js","./query":"node_modules/mongoose/lib/query.js","./model":"node_modules/mongoose/lib/model.js","./document":"node_modules/mongoose/lib/document.js","./helpers/schema/applyPlugins":"node_modules/mongoose/lib/helpers/schema/applyPlugins.js","./helpers/get":"node_modules/mongoose/lib/helpers/get.js","mongoose-legacy-pluralize":"node_modules/mongoose-legacy-pluralize/index.js","./utils":"node_modules/mongoose/lib/utils.js","../package.json":"node_modules/mongoose/package.json","./cast":"node_modules/mongoose/lib/cast.js","./plugins/removeSubdocs":"node_modules/mongoose/lib/plugins/removeSubdocs.js","./plugins/saveSubdocs":"node_modules/mongoose/lib/plugins/saveSubdocs.js","./plugins/validateBeforeSave":"node_modules/mongoose/lib/plugins/validateBeforeSave.js","./aggregate":"node_modules/mongoose/lib/aggregate.js","./promise_provider":"node_modules/mongoose/lib/promise_provider.js","./plugins/sharding":"node_modules/mongoose/lib/plugins/sharding.js","./helpers/printJestWarning":"node_modules/mongoose/lib/helpers/printJestWarning.js","./drivers/node-mongodb-native/connection":"node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js","./drivers/node-mongodb-native/collection":"node_modules/mongoose/lib/drivers/node-mongodb-native/collection.js","./document_provider":"node_modules/mongoose/lib/document_provider.js","./error/index":"node_modules/mongoose/lib/error/index.js","./error/cast":"node_modules/mongoose/lib/error/cast.js","./options/SchemaTypeOptions":"node_modules/mongoose/lib/options/SchemaTypeOptions.js","mongodb":"node_modules/mongodb/index.js","mquery":"node_modules/mquery/lib/mquery.js"},"node_modules/mongoose/lib/drivers/node-mongodb-native/index.js":{"./binary":"node_modules/mongoose/lib/drivers/node-mongodb-native/binary.js","./collection":"node_modules/mongoose/lib/drivers/node-mongodb-native/collection.js","./decimal128":"node_modules/mongoose/lib/drivers/node-mongodb-native/decimal128.js","./objectid":"node_modules/mongoose/lib/drivers/node-mongodb-native/objectid.js","./ReadPreference":"node_modules/mongoose/lib/drivers/node-mongodb-native/ReadPreference.js"},"node_modules/mongoose/lib/drivers/node-mongodb-native/binary.js":{"mongodb":"node_modules/mongodb/index.js"},"node_modules/mongodb/index.js":{"./lib/core":"node_modules/mongodb/lib/core/index.js","./lib/apm":"node_modules/mongodb/lib/apm.js","./lib/mongo_client":"node_modules/mongodb/lib/mongo_client.js","./lib/bulk/common":"node_modules/mongodb/lib/bulk/common.js","./lib/admin":"node_modules/mongodb/lib/admin.js","./lib/db":"node_modules/mongodb/lib/db.js","./lib/collection":"node_modules/mongodb/lib/collection.js","./lib/topologies/server":"node_modules/mongodb/lib/topologies/server.js","./lib/topologies/replset":"node_modules/mongodb/lib/topologies/replset.js","./lib/topologies/mongos":"node_modules/mongodb/lib/topologies/mongos.js","./lib/gridfs/grid_store":"node_modules/mongodb/lib/gridfs/grid_store.js","./lib/gridfs/chunk":"node_modules/mongodb/lib/gridfs/chunk.js","./lib/aggregation_cursor":"node_modules/mongodb/lib/aggregation_cursor.js","./lib/command_cursor":"node_modules/mongodb/lib/command_cursor.js","./lib/cursor":"node_modules/mongodb/lib/cursor.js","./lib/gridfs-stream":"node_modules/mongodb/lib/gridfs-stream/index.js"},"node_modules/mongodb/lib/core/index.js":{"bson":"node_modules/bson/index.js","require_optional":"node_modules/require_optional/index.js","./utils":"node_modules/mongodb/lib/core/utils.js","./error":"node_modules/mongodb/lib/core/error.js","./connection/connection":"node_modules/mongodb/lib/core/connection/connection.js","./topologies/server":"node_modules/mongodb/lib/core/topologies/server.js","./topologies/replset":"node_modules/mongodb/lib/core/topologies/replset.js","./topologies/mongos":"node_modules/mongodb/lib/core/topologies/mongos.js","./connection/logger":"node_modules/mongodb/lib/core/connection/logger.js","./cursor":"node_modules/mongodb/lib/core/cursor.js","./topologies/read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","./sessions":"node_modules/mongodb/lib/core/sessions.js","./sdam/topology":"node_modules/mongodb/lib/core/sdam/topology.js","./connection/commands":"node_modules/mongodb/lib/core/connection/commands.js","./auth/mongo_credentials":"node_modules/mongodb/lib/core/auth/mongo_credentials.js","./auth/defaultAuthProviders":"node_modules/mongodb/lib/core/auth/defaultAuthProviders.js","./auth/mongocr":"node_modules/mongodb/lib/core/auth/mongocr.js","./auth/x509":"node_modules/mongodb/lib/core/auth/x509.js","./auth/plain":"node_modules/mongodb/lib/core/auth/plain.js","./auth/gssapi":"node_modules/mongodb/lib/core/auth/gssapi.js","./auth/scram":"node_modules/mongodb/lib/core/auth/scram.js","./uri_parser":"node_modules/mongodb/lib/core/uri_parser.js"},"node_modules/bson/index.js":{"./lib/bson/bson":"node_modules/bson/lib/bson/bson.js","./lib/bson/binary":"node_modules/bson/lib/bson/binary.js","./lib/bson/code":"node_modules/bson/lib/bson/code.js","./lib/bson/db_ref":"node_modules/bson/lib/bson/db_ref.js","./lib/bson/decimal128":"node_modules/bson/lib/bson/decimal128.js","./lib/bson/double":"node_modules/bson/lib/bson/double.js","./lib/bson/int_32":"node_modules/bson/lib/bson/int_32.js","./lib/bson/long":"node_modules/bson/lib/bson/long.js","./lib/bson/map":"node_modules/bson/lib/bson/map.js","./lib/bson/max_key":"node_modules/bson/lib/bson/max_key.js","./lib/bson/min_key":"node_modules/bson/lib/bson/min_key.js","./lib/bson/objectid":"node_modules/bson/lib/bson/objectid.js","./lib/bson/regexp":"node_modules/bson/lib/bson/regexp.js","./lib/bson/symbol":"node_modules/bson/lib/bson/symbol.js","./lib/bson/timestamp":"node_modules/bson/lib/bson/timestamp.js"},"node_modules/bson/lib/bson/bson.js":{"./map":"node_modules/bson/lib/bson/map.js","./long":"node_modules/bson/lib/bson/long.js","./double":"node_modules/bson/lib/bson/double.js","./timestamp":"node_modules/bson/lib/bson/timestamp.js","./objectid":"node_modules/bson/lib/bson/objectid.js","./regexp":"node_modules/bson/lib/bson/regexp.js","./symbol":"node_modules/bson/lib/bson/symbol.js","./int_32":"node_modules/bson/lib/bson/int_32.js","./code":"node_modules/bson/lib/bson/code.js","./decimal128":"node_modules/bson/lib/bson/decimal128.js","./min_key":"node_modules/bson/lib/bson/min_key.js","./max_key":"node_modules/bson/lib/bson/max_key.js","./db_ref":"node_modules/bson/lib/bson/db_ref.js","./binary":"node_modules/bson/lib/bson/binary.js","./parser/deserializer":"node_modules/bson/lib/bson/parser/deserializer.js","./parser/serializer":"node_modules/bson/lib/bson/parser/serializer.js","./parser/calculate_size":"node_modules/bson/lib/bson/parser/calculate_size.js","./parser/utils":"node_modules/bson/lib/bson/parser/utils.js"},"node_modules/bson/lib/bson/objectid.js":{"./parser/utils":"node_modules/bson/lib/bson/parser/utils.js"},"node_modules/bson/lib/bson/symbol.js":{},"node_modules/bson/lib/bson/decimal128.js":{"./long":"node_modules/bson/lib/bson/long.js","./parser/utils":"node_modules/bson/lib/bson/parser/utils.js"},"node_modules/bson/lib/bson/binary.js":{"./parser/utils":"node_modules/bson/lib/bson/parser/utils.js"},"node_modules/bson/lib/bson/parser/deserializer.js":{"../long":"node_modules/bson/lib/bson/long.js","../double":"node_modules/bson/lib/bson/double.js","../timestamp":"node_modules/bson/lib/bson/timestamp.js","../objectid":"node_modules/bson/lib/bson/objectid.js","../symbol":"node_modules/bson/lib/bson/symbol.js","../code":"node_modules/bson/lib/bson/code.js","../min_key":"node_modules/bson/lib/bson/min_key.js","../max_key":"node_modules/bson/lib/bson/max_key.js","../decimal128":"node_modules/bson/lib/bson/decimal128.js","../int_32":"node_modules/bson/lib/bson/int_32.js","../db_ref":"node_modules/bson/lib/bson/db_ref.js","../regexp":"node_modules/bson/lib/bson/regexp.js","../binary":"node_modules/bson/lib/bson/binary.js","./utils":"node_modules/bson/lib/bson/parser/utils.js"},"node_modules/bson/lib/bson/parser/serializer.js":{"../float_parser":"node_modules/bson/lib/bson/float_parser.js","../long":"node_modules/bson/lib/bson/long.js","../map":"node_modules/bson/lib/bson/map.js","../binary":"node_modules/bson/lib/bson/binary.js","./utils":"node_modules/bson/lib/bson/parser/utils.js"},"node_modules/bson/lib/bson/parser/calculate_size.js":{"../long":"node_modules/bson/lib/bson/long.js","../double":"node_modules/bson/lib/bson/double.js","../timestamp":"node_modules/bson/lib/bson/timestamp.js","../objectid":"node_modules/bson/lib/bson/objectid.js","../symbol":"node_modules/bson/lib/bson/symbol.js","../regexp":"node_modules/bson/lib/bson/regexp.js","../code":"node_modules/bson/lib/bson/code.js","../decimal128":"node_modules/bson/lib/bson/decimal128.js","../min_key":"node_modules/bson/lib/bson/min_key.js","../max_key":"node_modules/bson/lib/bson/max_key.js","../db_ref":"node_modules/bson/lib/bson/db_ref.js","../binary":"node_modules/bson/lib/bson/binary.js","./utils":"node_modules/bson/lib/bson/parser/utils.js"},"node_modules/require_optional/index.js":{"resolve-from":"node_modules/resolve-from/index.js","semver":"node_modules/semver/semver.js"},"node_modules/resolve-from/index.js":{},"node_modules/mongodb/lib/core/utils.js":{"require_optional":"node_modules/require_optional/index.js"},"node_modules/mongodb/lib/core/error.js":{"./utils":"node_modules/mongodb/lib/core/utils.js"},"node_modules/mongodb/lib/core/connection/connection.js":{"./utils":"node_modules/mongodb/lib/core/connection/utils.js","../wireprotocol/shared":"node_modules/mongodb/lib/core/wireprotocol/shared.js","../wireprotocol/compression":"node_modules/mongodb/lib/core/wireprotocol/compression.js","./commands":"node_modules/mongodb/lib/core/connection/commands.js","./msg":"node_modules/mongodb/lib/core/connection/msg.js","../error":"node_modules/mongodb/lib/core/error.js","./logger":"node_modules/mongodb/lib/core/connection/logger.js","safe-buffer":"node_modules/safe-buffer/index.js"},"node_modules/mongodb/lib/core/connection/utils.js":{"require_optional":"node_modules/require_optional/index.js","bson":"node_modules/bson/index.js"},"node_modules/mongodb/lib/core/wireprotocol/shared.js":{"../topologies/read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","../error":"node_modules/mongodb/lib/core/error.js","../sdam/common":"node_modules/mongodb/lib/core/sdam/common.js","../sdam/topology_description":"node_modules/mongodb/lib/core/sdam/topology_description.js"},"node_modules/mongodb/lib/core/sdam/topology_description.js":{"./common":"node_modules/mongodb/lib/core/sdam/common.js","./server_description":"node_modules/mongodb/lib/core/sdam/server_description.js","../wireprotocol/constants":"node_modules/mongodb/lib/core/wireprotocol/constants.js"},"node_modules/mongodb/lib/core/sdam/server_description.js":{"../utils":"node_modules/mongodb/lib/core/utils.js","./common":"node_modules/mongodb/lib/core/sdam/common.js"},"node_modules/mongodb/lib/core/wireprotocol/compression.js":{"../connection/utils":"node_modules/mongodb/lib/core/connection/utils.js"},"node_modules/mongodb/lib/core/connection/commands.js":{"./utils":"node_modules/mongodb/lib/core/connection/utils.js","safe-buffer":"node_modules/safe-buffer/index.js","../wireprotocol/shared":"node_modules/mongodb/lib/core/wireprotocol/shared.js"},"node_modules/safe-buffer/index.js":{},"node_modules/mongodb/lib/core/connection/msg.js":{"safe-buffer":"node_modules/safe-buffer/index.js","../wireprotocol/shared":"node_modules/mongodb/lib/core/wireprotocol/shared.js","../topologies/read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js"},"node_modules/mongodb/lib/core/connection/logger.js":{"../error":"node_modules/mongodb/lib/core/error.js"},"node_modules/mongodb/lib/core/topologies/server.js":{"./read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","../connection/logger":"node_modules/mongodb/lib/core/connection/logger.js","../connection/utils":"node_modules/mongodb/lib/core/connection/utils.js","../connection/pool":"node_modules/mongodb/lib/core/connection/pool.js","../error":"node_modules/mongodb/lib/core/error.js","../wireprotocol":"node_modules/mongodb/lib/core/wireprotocol/index.js","../cursor":"node_modules/mongodb/lib/core/cursor.js","./shared":"node_modules/mongodb/lib/core/topologies/shared.js","../utils":"node_modules/mongodb/lib/core/utils.js"},"node_modules/mongodb/lib/core/connection/pool.js":{"../error":"node_modules/mongodb/lib/core/error.js","./logger":"node_modules/mongodb/lib/core/connection/logger.js","./msg":"node_modules/mongodb/lib/core/connection/msg.js","./command_result":"node_modules/mongodb/lib/core/connection/command_result.js","../wireprotocol/shared":"node_modules/mongodb/lib/core/wireprotocol/shared.js","../wireprotocol/compression":"node_modules/mongodb/lib/core/wireprotocol/compression.js","./apm":"node_modules/mongodb/lib/core/connection/apm.js","safe-buffer":"node_modules/safe-buffer/index.js","./connect":"node_modules/mongodb/lib/core/connection/connect.js","../sessions":"node_modules/mongodb/lib/core/sessions.js","../utils":"node_modules/mongodb/lib/core/utils.js"},"node_modules/mongodb/lib/core/connection/apm.js":{"../connection/msg":"node_modules/mongodb/lib/core/connection/msg.js","../connection/commands":"node_modules/mongodb/lib/core/connection/commands.js","../utils":"node_modules/mongodb/lib/core/utils.js"},"node_modules/mongodb/lib/core/connection/connect.js":{"./connection":"node_modules/mongodb/lib/core/connection/connection.js","./commands":"node_modules/mongodb/lib/core/connection/commands.js","../topologies/shared":"node_modules/mongodb/lib/core/topologies/shared.js","../error":"node_modules/mongodb/lib/core/error.js","../auth/defaultAuthProviders":"node_modules/mongodb/lib/core/auth/defaultAuthProviders.js","../wireprotocol/constants":"node_modules/mongodb/lib/core/wireprotocol/constants.js"},"node_modules/mongodb/lib/core/topologies/shared.js":{"./read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","safe-buffer":"node_modules/safe-buffer/index.js","../sdam/common":"node_modules/mongodb/lib/core/sdam/common.js","../error":"node_modules/mongodb/lib/core/error.js","../../../package.json":"node_modules/mongodb/package.json"},"node_modules/mongodb/lib/core/auth/defaultAuthProviders.js":{"./mongocr":"node_modules/mongodb/lib/core/auth/mongocr.js","./x509":"node_modules/mongodb/lib/core/auth/x509.js","./plain":"node_modules/mongodb/lib/core/auth/plain.js","./gssapi":"node_modules/mongodb/lib/core/auth/gssapi.js","./sspi":"node_modules/mongodb/lib/core/auth/sspi.js","./scram":"node_modules/mongodb/lib/core/auth/scram.js"},"node_modules/mongodb/lib/core/auth/mongocr.js":{"./auth_provider":"node_modules/mongodb/lib/core/auth/auth_provider.js"},"node_modules/mongodb/lib/core/auth/auth_provider.js":{"../error":"node_modules/mongodb/lib/core/error.js"},"node_modules/mongodb/lib/core/auth/x509.js":{"./auth_provider":"node_modules/mongodb/lib/core/auth/auth_provider.js"},"node_modules/mongodb/lib/core/auth/plain.js":{"../connection/utils":"node_modules/mongodb/lib/core/connection/utils.js","./auth_provider":"node_modules/mongodb/lib/core/auth/auth_provider.js"},"node_modules/mongodb/lib/core/auth/gssapi.js":{"./auth_provider":"node_modules/mongodb/lib/core/auth/auth_provider.js","../utils":"node_modules/mongodb/lib/core/utils.js"},"node_modules/mongodb/lib/core/auth/sspi.js":{"./auth_provider":"node_modules/mongodb/lib/core/auth/auth_provider.js","../utils":"node_modules/mongodb/lib/core/utils.js"},"node_modules/mongodb/lib/core/auth/scram.js":{"safe-buffer":"node_modules/safe-buffer/index.js","../connection/utils":"node_modules/mongodb/lib/core/connection/utils.js","../error":"node_modules/mongodb/lib/core/error.js","./auth_provider":"node_modules/mongodb/lib/core/auth/auth_provider.js","saslprep":"node_modules/saslprep/index.js"},"node_modules/saslprep/index.js":{"./lib/memory-code-points":"node_modules/saslprep/lib/memory-code-points.js"},"node_modules/saslprep/lib/memory-code-points.js":{"sparse-bitfield":"node_modules/sparse-bitfield/index.js"},"node_modules/sparse-bitfield/index.js":{"memory-pager":"node_modules/memory-pager/index.js"},"node_modules/mongodb/lib/core/sessions.js":{"./connection/utils":"node_modules/mongodb/lib/core/connection/utils.js","./utils":"node_modules/mongodb/lib/core/utils.js","./error":"node_modules/mongodb/lib/core/error.js","././error":"node_modules/mongodb/lib/core/error.js","./transactions":"node_modules/mongodb/lib/core/transactions.js","./topologies/read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","./topologies/shared":"node_modules/mongodb/lib/core/topologies/shared.js","./wireprotocol/shared":"node_modules/mongodb/lib/core/wireprotocol/shared.js"},"node_modules/mongodb/lib/core/transactions.js":{"./error":"node_modules/mongodb/lib/core/error.js"},"node_modules/mongodb/lib/core/wireprotocol/index.js":{"./write_command":"node_modules/mongodb/lib/core/wireprotocol/write_command.js","./kill_cursors":"node_modules/mongodb/lib/core/wireprotocol/kill_cursors.js","./get_more":"node_modules/mongodb/lib/core/wireprotocol/get_more.js","./query":"node_modules/mongodb/lib/core/wireprotocol/query.js","./command":"node_modules/mongodb/lib/core/wireprotocol/command.js"},"node_modules/mongodb/lib/core/wireprotocol/write_command.js":{"../error":"node_modules/mongodb/lib/core/error.js","./shared":"node_modules/mongodb/lib/core/wireprotocol/shared.js","./command":"node_modules/mongodb/lib/core/wireprotocol/command.js"},"node_modules/mongodb/lib/core/wireprotocol/command.js":{"../connection/commands":"node_modules/mongodb/lib/core/connection/commands.js","../connection/msg":"node_modules/mongodb/lib/core/connection/msg.js","../error":"node_modules/mongodb/lib/core/error.js","./shared":"node_modules/mongodb/lib/core/wireprotocol/shared.js","../transactions":"node_modules/mongodb/lib/core/transactions.js","../sessions":"node_modules/mongodb/lib/core/sessions.js"},"node_modules/mongodb/lib/core/wireprotocol/kill_cursors.js":{"../connection/commands":"node_modules/mongodb/lib/core/connection/commands.js","../error":"node_modules/mongodb/lib/core/error.js","./shared":"node_modules/mongodb/lib/core/wireprotocol/shared.js","../utils":"node_modules/mongodb/lib/core/utils.js","./command":"node_modules/mongodb/lib/core/wireprotocol/command.js"},"node_modules/mongodb/lib/core/wireprotocol/get_more.js":{"../connection/commands":"node_modules/mongodb/lib/core/connection/commands.js","../connection/utils":"node_modules/mongodb/lib/core/connection/utils.js","../error":"node_modules/mongodb/lib/core/error.js","./shared":"node_modules/mongodb/lib/core/wireprotocol/shared.js","../utils":"node_modules/mongodb/lib/core/utils.js","./command":"node_modules/mongodb/lib/core/wireprotocol/command.js"},"node_modules/mongodb/lib/core/wireprotocol/query.js":{"../connection/commands":"node_modules/mongodb/lib/core/connection/commands.js","../error":"node_modules/mongodb/lib/core/error.js","./shared":"node_modules/mongodb/lib/core/wireprotocol/shared.js","../utils":"node_modules/mongodb/lib/core/utils.js","./command":"node_modules/mongodb/lib/core/wireprotocol/command.js"},"node_modules/mongodb/lib/core/cursor.js":{"./connection/logger":"node_modules/mongodb/lib/core/connection/logger.js","./connection/utils":"node_modules/mongodb/lib/core/connection/utils.js","./error":"node_modules/mongodb/lib/core/error.js","./utils":"node_modules/mongodb/lib/core/utils.js","./topologies/read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","../operations/execute_operation":"node_modules/mongodb/lib/operations/execute_operation.js","../utils":"node_modules/mongodb/lib/utils.js","../operations/operation":"node_modules/mongodb/lib/operations/operation.js","../async/async_iterator":"node_modules/mongodb/lib/async/async_iterator.js"},"node_modules/mongodb/lib/operations/execute_operation.js":{"../core/error":"node_modules/mongodb/lib/core/error.js","./operation":"node_modules/mongodb/lib/operations/operation.js","../core/topologies/read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","../core/utils":"node_modules/mongodb/lib/core/utils.js"},"node_modules/mongodb/lib/utils.js":{"./core/error":"node_modules/mongodb/lib/core/error.js","./core/topologies/read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","./write_concern":"node_modules/mongodb/lib/write_concern.js","./async/async_iterator":"node_modules/mongodb/lib/async/async_iterator.js"},"node_modules/mongodb/lib/core/topologies/replset.js":{"./read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","../cursor":"node_modules/mongodb/lib/core/cursor.js","../connection/utils":"node_modules/mongodb/lib/core/connection/utils.js","../connection/logger":"node_modules/mongodb/lib/core/connection/logger.js","../error":"node_modules/mongodb/lib/core/error.js","./server":"node_modules/mongodb/lib/core/topologies/server.js","./replset_state":"node_modules/mongodb/lib/core/topologies/replset_state.js","./shared":"node_modules/mongodb/lib/core/topologies/shared.js","../utils":"node_modules/mongodb/lib/core/utils.js"},"node_modules/mongodb/lib/core/topologies/replset_state.js":{"./shared":"node_modules/mongodb/lib/core/topologies/shared.js","../connection/logger":"node_modules/mongodb/lib/core/connection/logger.js","./read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","../error":"node_modules/mongodb/lib/core/error.js","safe-buffer":"node_modules/safe-buffer/index.js"},"node_modules/mongodb/lib/core/topologies/mongos.js":{"../cursor":"node_modules/mongodb/lib/core/cursor.js","../connection/logger":"node_modules/mongodb/lib/core/connection/logger.js","../connection/utils":"node_modules/mongodb/lib/core/connection/utils.js","../error":"node_modules/mongodb/lib/core/error.js","./server":"node_modules/mongodb/lib/core/topologies/server.js","./shared":"node_modules/mongodb/lib/core/topologies/shared.js","../utils":"node_modules/mongodb/lib/core/utils.js"},"node_modules/mongodb/lib/core/sdam/topology.js":{"./server_description":"node_modules/mongodb/lib/core/sdam/server_description.js","./common":"node_modules/mongodb/lib/core/sdam/common.js","./topology_description":"node_modules/mongodb/lib/core/sdam/topology_description.js","./monitoring":"node_modules/mongodb/lib/core/sdam/monitoring.js","./server":"node_modules/mongodb/lib/core/sdam/server.js","../utils":"node_modules/mongodb/lib/core/utils.js","../topologies/read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","../topologies/shared":"node_modules/mongodb/lib/core/topologies/shared.js","../cursor":"node_modules/mongodb/lib/core/cursor.js","../connection/utils":"node_modules/mongodb/lib/core/connection/utils.js","../error":"node_modules/mongodb/lib/core/error.js","../sessions":"node_modules/mongodb/lib/core/sessions.js","./srv_polling":"node_modules/mongodb/lib/core/sdam/srv_polling.js","../../utils":"node_modules/mongodb/lib/utils.js","./server_selection":"node_modules/mongodb/lib/core/sdam/server_selection.js"},"node_modules/mongodb/lib/core/sdam/monitoring.js":{"./server_description":"node_modules/mongodb/lib/core/sdam/server_description.js","../utils":"node_modules/mongodb/lib/core/utils.js"},"node_modules/mongodb/lib/core/sdam/server.js":{"../error":"node_modules/mongodb/lib/core/error.js","../connection/pool":"node_modules/mongodb/lib/core/connection/pool.js","../utils":"node_modules/mongodb/lib/core/utils.js","../wireprotocol":"node_modules/mongodb/lib/core/wireprotocol/index.js","../connection/utils":"node_modules/mongodb/lib/core/connection/utils.js","../topologies/shared":"node_modules/mongodb/lib/core/topologies/shared.js","../connection/logger":"node_modules/mongodb/lib/core/connection/logger.js","./server_description":"node_modules/mongodb/lib/core/sdam/server_description.js","../topologies/read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","./monitoring":"node_modules/mongodb/lib/core/sdam/monitoring.js","./common":"node_modules/mongodb/lib/core/sdam/common.js"},"node_modules/mongodb/lib/core/sdam/srv_polling.js":{"../connection/logger":"node_modules/mongodb/lib/core/connection/logger.js"},"node_modules/mongodb/lib/core/sdam/server_selection.js":{"./common":"node_modules/mongodb/lib/core/sdam/common.js","../topologies/read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","../error":"node_modules/mongodb/lib/core/error.js","../utils":"node_modules/mongodb/lib/core/utils.js"},"node_modules/mongodb/lib/core/uri_parser.js":{"./error":"node_modules/mongodb/lib/core/error.js","./topologies/read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js"},"node_modules/mongodb/lib/apm.js":{},"node_modules/mongodb/lib/mongo_client.js":{"./change_stream":"node_modules/mongodb/lib/change_stream.js","./db":"node_modules/mongodb/lib/db.js","./operations/execute_operation":"node_modules/mongodb/lib/operations/execute_operation.js","./core":"node_modules/mongodb/lib/core/index.js","./write_concern":"node_modules/mongodb/lib/write_concern.js","./utils":"node_modules/mongodb/lib/utils.js","./core/topologies/read_preference":"node_modules/mongodb/lib/core/topologies/read_preference.js","./operations/connect":"node_modules/mongodb/lib/operations/connect.js","./operations/close":"node_modules/mongodb/lib/operations/close.js"},"node_modules/mongodb/lib/change_stream.js":{"./error":"node_modules/mongodb/lib/error.js","./core":"node_modules/mongodb/lib/core/index.js","./cursor":"node_modules/mongodb/lib/cursor.js","./core/utils":"node_modules/mongodb/lib/core/utils.js","./operations/aggregate":"node_modules/mongodb/lib/operations/aggregate.js"},"node_modules/mongodb/lib/error.js":{"./core":"node_modules/mongodb/lib/core/index.js"},"node_modules/mongodb/lib/cursor.js":{"./utils":"node_modules/mongodb/lib/utils.js","./core":"node_modules/mongodb/lib/core/index.js","./core/cursor":"node_modules/mongodb/lib/core/cursor.js","./operations/cursor_ops":"node_modules/mongodb/lib/operations/cursor_ops.js","./operations/count":"node_modules/mongodb/lib/operations/count.js","./operations/explain":"node_modules/mongodb/lib/operations/explain.js","./operations/has_next":"node_modules/mongodb/lib/operations/has_next.js","./operations/next":"node_modules/mongodb/lib/operations/next.js","./operations/to_array":"node_modules/mongodb/lib/operations/to_array.js","./operations/execute_operation":"node_modules/mongodb/lib/operations/execute_operation.js"},"node_modules/mongodb/lib/operations/cursor_ops.js":{"./collection_ops":"node_modules/mongodb/lib/operations/collection_ops.js","../utils":"node_modules/mongodb/lib/utils.js","../core":"node_modules/mongodb/lib/core/index.js","../core/cursor":"node_modules/mongodb/lib/core/cursor.js"},"node_modules/mongodb/lib/operations/collection_ops.js":{"../utils":"node_modules/mongodb/lib/utils.js","../core":"node_modules/mongodb/lib/core/index.js","./db_ops":"node_modules/mongodb/lib/operations/db_ops.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/db_ops.js":{"../utils":"node_modules/mongodb/lib/utils.js","../core":"node_modules/mongodb/lib/core/index.js","../constants":"node_modules/mongodb/lib/constants.js","./collection_ops":"node_modules/mongodb/lib/operations/collection_ops.js"},"node_modules/mongodb/lib/operations/common_functions.js":{"../utils":"node_modules/mongodb/lib/utils.js","./db_ops":"node_modules/mongodb/lib/operations/db_ops.js","../core":"node_modules/mongodb/lib/core/index.js","../core/cursor":"node_modules/mongodb/lib/core/cursor.js"},"node_modules/mongodb/lib/operations/count.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/explain.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../core/cursor":"node_modules/mongodb/lib/core/cursor.js"},"node_modules/mongodb/lib/operations/has_next.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../dynamic_loaders":"node_modules/mongodb/lib/dynamic_loaders.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/next.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/to_array.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../utils":"node_modules/mongodb/lib/utils.js","../core/cursor":"node_modules/mongodb/lib/core/cursor.js"},"node_modules/mongodb/lib/operations/aggregate.js":{"./command_v2":"node_modules/mongodb/lib/operations/command_v2.js","../core":"node_modules/mongodb/lib/core/index.js","../core/utils":"node_modules/mongodb/lib/core/utils.js","./operation":"node_modules/mongodb/lib/operations/operation.js"},"node_modules/mongodb/lib/operations/command_v2.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../utils":"node_modules/mongodb/lib/utils.js","../read_concern":"node_modules/mongodb/lib/read_concern.js","../write_concern":"node_modules/mongodb/lib/write_concern.js","../core/utils":"node_modules/mongodb/lib/core/utils.js","../core/sessions":"node_modules/mongodb/lib/core/sessions.js","../error":"node_modules/mongodb/lib/error.js"},"node_modules/mongodb/lib/db.js":{"./utils":"node_modules/mongodb/lib/utils.js","./command_cursor":"node_modules/mongodb/lib/command_cursor.js","./core":"node_modules/mongodb/lib/core/index.js","./collection":"node_modules/mongodb/lib/collection.js","./change_stream":"node_modules/mongodb/lib/change_stream.js","./constants":"node_modules/mongodb/lib/constants.js","./write_concern":"node_modules/mongodb/lib/write_concern.js","./read_concern":"node_modules/mongodb/lib/read_concern.js","./aggregation_cursor":"node_modules/mongodb/lib/aggregation_cursor.js","./operations/db_ops":"node_modules/mongodb/lib/operations/db_ops.js","./operations/aggregate":"node_modules/mongodb/lib/operations/aggregate.js","./operations/add_user":"node_modules/mongodb/lib/operations/add_user.js","./operations/collections":"node_modules/mongodb/lib/operations/collections.js","./operations/command":"node_modules/mongodb/lib/operations/command.js","./operations/create_collection":"node_modules/mongodb/lib/operations/create_collection.js","./operations/create_index":"node_modules/mongodb/lib/operations/create_index.js","./operations/drop":"node_modules/mongodb/lib/operations/drop.js","./operations/execute_db_admin_command":"node_modules/mongodb/lib/operations/execute_db_admin_command.js","./operations/index_information":"node_modules/mongodb/lib/operations/index_information.js","./operations/list_collections":"node_modules/mongodb/lib/operations/list_collections.js","./operations/profiling_level":"node_modules/mongodb/lib/operations/profiling_level.js","./operations/remove_user":"node_modules/mongodb/lib/operations/remove_user.js","./operations/rename":"node_modules/mongodb/lib/operations/rename.js","./operations/set_profiling_level":"node_modules/mongodb/lib/operations/set_profiling_level.js","./operations/execute_operation":"node_modules/mongodb/lib/operations/execute_operation.js"},"node_modules/mongodb/lib/command_cursor.js":{"./core":"node_modules/mongodb/lib/core/index.js","./cursor":"node_modules/mongodb/lib/cursor.js","./core/cursor":"node_modules/mongodb/lib/core/cursor.js"},"node_modules/mongodb/lib/collection.js":{"./utils":"node_modules/mongodb/lib/utils.js","./core":"node_modules/mongodb/lib/core/index.js","./bulk/unordered":"node_modules/mongodb/lib/bulk/unordered.js","./bulk/ordered":"node_modules/mongodb/lib/bulk/ordered.js","./change_stream":"node_modules/mongodb/lib/change_stream.js","./write_concern":"node_modules/mongodb/lib/write_concern.js","./read_concern":"node_modules/mongodb/lib/read_concern.js","./aggregation_cursor":"node_modules/mongodb/lib/aggregation_cursor.js","./command_cursor":"node_modules/mongodb/lib/command_cursor.js","./operations/collection_ops":"node_modules/mongodb/lib/operations/collection_ops.js","./operations/common_functions":"node_modules/mongodb/lib/operations/common_functions.js","./operations/aggregate":"node_modules/mongodb/lib/operations/aggregate.js","./operations/bulk_write":"node_modules/mongodb/lib/operations/bulk_write.js","./operations/count_documents":"node_modules/mongodb/lib/operations/count_documents.js","./operations/create_index":"node_modules/mongodb/lib/operations/create_index.js","./operations/create_indexes":"node_modules/mongodb/lib/operations/create_indexes.js","./operations/delete_many":"node_modules/mongodb/lib/operations/delete_many.js","./operations/delete_one":"node_modules/mongodb/lib/operations/delete_one.js","./operations/distinct":"node_modules/mongodb/lib/operations/distinct.js","./operations/drop":"node_modules/mongodb/lib/operations/drop.js","./operations/drop_index":"node_modules/mongodb/lib/operations/drop_index.js","./operations/drop_indexes":"node_modules/mongodb/lib/operations/drop_indexes.js","./operations/estimated_document_count":"node_modules/mongodb/lib/operations/estimated_document_count.js","./operations/find":"node_modules/mongodb/lib/operations/find.js","./operations/find_one":"node_modules/mongodb/lib/operations/find_one.js","./operations/find_and_modify":"node_modules/mongodb/lib/operations/find_and_modify.js","./operations/find_one_and_delete":"node_modules/mongodb/lib/operations/find_one_and_delete.js","./operations/find_one_and_replace":"node_modules/mongodb/lib/operations/find_one_and_replace.js","./operations/find_one_and_update":"node_modules/mongodb/lib/operations/find_one_and_update.js","./operations/geo_haystack_search":"node_modules/mongodb/lib/operations/geo_haystack_search.js","./operations/indexes":"node_modules/mongodb/lib/operations/indexes.js","./operations/index_exists":"node_modules/mongodb/lib/operations/index_exists.js","./operations/index_information":"node_modules/mongodb/lib/operations/index_information.js","./operations/insert_many":"node_modules/mongodb/lib/operations/insert_many.js","./operations/insert_one":"node_modules/mongodb/lib/operations/insert_one.js","./operations/is_capped":"node_modules/mongodb/lib/operations/is_capped.js","./operations/list_indexes":"node_modules/mongodb/lib/operations/list_indexes.js","./operations/map_reduce":"node_modules/mongodb/lib/operations/map_reduce.js","./operations/options_operation":"node_modules/mongodb/lib/operations/options_operation.js","./operations/rename":"node_modules/mongodb/lib/operations/rename.js","./operations/re_index":"node_modules/mongodb/lib/operations/re_index.js","./operations/replace_one":"node_modules/mongodb/lib/operations/replace_one.js","./operations/stats":"node_modules/mongodb/lib/operations/stats.js","./operations/update_many":"node_modules/mongodb/lib/operations/update_many.js","./operations/update_one":"node_modules/mongodb/lib/operations/update_one.js","./operations/execute_operation":"node_modules/mongodb/lib/operations/execute_operation.js"},"node_modules/mongodb/lib/bulk/unordered.js":{"./common":"node_modules/mongodb/lib/bulk/common.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/bulk/common.js":{"../core":"node_modules/mongodb/lib/core/index.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/bulk/ordered.js":{"./common":"node_modules/mongodb/lib/bulk/common.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/aggregation_cursor.js":{"./core":"node_modules/mongodb/lib/core/index.js","./cursor":"node_modules/mongodb/lib/cursor.js","./core/cursor":"node_modules/mongodb/lib/core/cursor.js"},"node_modules/mongodb/lib/operations/bulk_write.js":{"../utils":"node_modules/mongodb/lib/utils.js","../core":"node_modules/mongodb/lib/core/index.js","./operation":"node_modules/mongodb/lib/operations/operation.js"},"node_modules/mongodb/lib/operations/count_documents.js":{"./aggregate":"node_modules/mongodb/lib/operations/aggregate.js"},"node_modules/mongodb/lib/operations/create_index.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./command":"node_modules/mongodb/lib/operations/command.js","../utils":"node_modules/mongodb/lib/utils.js","../core":"node_modules/mongodb/lib/core/index.js"},"node_modules/mongodb/lib/operations/command.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../utils":"node_modules/mongodb/lib/utils.js","../core":"node_modules/mongodb/lib/core/index.js"},"node_modules/mongodb/lib/operations/create_indexes.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./db_ops":"node_modules/mongodb/lib/operations/db_ops.js","../core":"node_modules/mongodb/lib/core/index.js"},"node_modules/mongodb/lib/operations/delete_many.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/delete_one.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/distinct.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./command_v2":"node_modules/mongodb/lib/operations/command_v2.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/operations/drop.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./command":"node_modules/mongodb/lib/operations/command.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/operations/drop_index.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./command":"node_modules/mongodb/lib/operations/command.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/operations/drop_indexes.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./drop_index":"node_modules/mongodb/lib/operations/drop_index.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/operations/estimated_document_count.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./command_v2":"node_modules/mongodb/lib/operations/command_v2.js"},"node_modules/mongodb/lib/operations/find.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/operations/find_one.js":{"../utils":"node_modules/mongodb/lib/utils.js","./operation":"node_modules/mongodb/lib/operations/operation.js"},"node_modules/mongodb/lib/operations/find_and_modify.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../utils":"node_modules/mongodb/lib/utils.js","./db_ops":"node_modules/mongodb/lib/operations/db_ops.js","../core":"node_modules/mongodb/lib/core/index.js"},"node_modules/mongodb/lib/operations/find_one_and_delete.js":{"./find_and_modify":"node_modules/mongodb/lib/operations/find_and_modify.js"},"node_modules/mongodb/lib/operations/find_one_and_replace.js":{"./find_and_modify":"node_modules/mongodb/lib/operations/find_and_modify.js"},"node_modules/mongodb/lib/operations/find_one_and_update.js":{"./find_and_modify":"node_modules/mongodb/lib/operations/find_and_modify.js"},"node_modules/mongodb/lib/operations/geo_haystack_search.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../utils":"node_modules/mongodb/lib/utils.js","./db_ops":"node_modules/mongodb/lib/operations/db_ops.js"},"node_modules/mongodb/lib/operations/indexes.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/index_exists.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../utils":"node_modules/mongodb/lib/utils.js","./db_ops":"node_modules/mongodb/lib/operations/db_ops.js"},"node_modules/mongodb/lib/operations/index_information.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/insert_many.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./bulk_write":"node_modules/mongodb/lib/operations/bulk_write.js","../core":"node_modules/mongodb/lib/core/index.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/insert_one.js":{"../core":"node_modules/mongodb/lib/core/index.js","./operation":"node_modules/mongodb/lib/operations/operation.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/is_capped.js":{"./options_operation":"node_modules/mongodb/lib/operations/options_operation.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/operations/options_operation.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../utils":"node_modules/mongodb/lib/utils.js","../core":"node_modules/mongodb/lib/core/index.js"},"node_modules/mongodb/lib/operations/list_indexes.js":{"./command_v2":"node_modules/mongodb/lib/operations/command_v2.js","./operation":"node_modules/mongodb/lib/operations/operation.js","../core/utils":"node_modules/mongodb/lib/core/utils.js"},"node_modules/mongodb/lib/operations/map_reduce.js":{"../utils":"node_modules/mongodb/lib/utils.js","../core":"node_modules/mongodb/lib/core/index.js","./db_ops":"node_modules/mongodb/lib/operations/db_ops.js","../dynamic_loaders":"node_modules/mongodb/lib/dynamic_loaders.js","./operation":"node_modules/mongodb/lib/operations/operation.js"},"node_modules/mongodb/lib/operations/rename.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../utils":"node_modules/mongodb/lib/utils.js","./db_ops":"node_modules/mongodb/lib/operations/db_ops.js","../dynamic_loaders":"node_modules/mongodb/lib/dynamic_loaders.js"},"node_modules/mongodb/lib/operations/re_index.js":{"./command":"node_modules/mongodb/lib/operations/command.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/operations/replace_one.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/stats.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./command":"node_modules/mongodb/lib/operations/command.js"},"node_modules/mongodb/lib/operations/update_many.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/update_one.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./common_functions":"node_modules/mongodb/lib/operations/common_functions.js"},"node_modules/mongodb/lib/operations/add_user.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./command":"node_modules/mongodb/lib/operations/command.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/operations/collections.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/operations/create_collection.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./command":"node_modules/mongodb/lib/operations/command.js","../utils":"node_modules/mongodb/lib/utils.js","../dynamic_loaders":"node_modules/mongodb/lib/dynamic_loaders.js","../core":"node_modules/mongodb/lib/core/index.js"},"node_modules/mongodb/lib/operations/execute_db_admin_command.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../utils":"node_modules/mongodb/lib/utils.js","../core":"node_modules/mongodb/lib/core/index.js"},"node_modules/mongodb/lib/operations/list_collections.js":{"./command_v2":"node_modules/mongodb/lib/operations/command_v2.js","./operation":"node_modules/mongodb/lib/operations/operation.js","../core/utils":"node_modules/mongodb/lib/core/utils.js","../constants":"node_modules/mongodb/lib/constants.js"},"node_modules/mongodb/lib/operations/profiling_level.js":{"./command":"node_modules/mongodb/lib/operations/command.js"},"node_modules/mongodb/lib/operations/remove_user.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","./command":"node_modules/mongodb/lib/operations/command.js","../utils":"node_modules/mongodb/lib/utils.js","../write_concern":"node_modules/mongodb/lib/write_concern.js"},"node_modules/mongodb/lib/operations/set_profiling_level.js":{"./command":"node_modules/mongodb/lib/operations/command.js"},"node_modules/mongodb/lib/operations/connect.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../core":"node_modules/mongodb/lib/core/index.js","../topologies/mongos":"node_modules/mongodb/lib/topologies/mongos.js","../topologies/native_topology":"node_modules/mongodb/lib/topologies/native_topology.js","../read_concern":"node_modules/mongodb/lib/read_concern.js","../topologies/replset":"node_modules/mongodb/lib/topologies/replset.js","../topologies/server":"node_modules/mongodb/lib/topologies/server.js","../utils":"node_modules/mongodb/lib/utils.js","../url_parser":"node_modules/mongodb/lib/url_parser.js"},"node_modules/mongodb/lib/topologies/mongos.js":{"./topology_base":"node_modules/mongodb/lib/topologies/topology_base.js","../core":"node_modules/mongodb/lib/core/index.js","../cursor":"node_modules/mongodb/lib/cursor.js","./server":"node_modules/mongodb/lib/topologies/server.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/topologies/topology_base.js":{"../core":"node_modules/mongodb/lib/core/index.js","../utils":"node_modules/mongodb/lib/utils.js","../../package.json":"node_modules/mongodb/package.json"},"node_modules/mongodb/lib/topologies/server.js":{"../core":"node_modules/mongodb/lib/core/index.js","../cursor":"node_modules/mongodb/lib/cursor.js","./topology_base":"node_modules/mongodb/lib/topologies/topology_base.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/topologies/native_topology.js":{"../core":"node_modules/mongodb/lib/core/index.js","./topology_base":"node_modules/mongodb/lib/topologies/topology_base.js","../cursor":"node_modules/mongodb/lib/cursor.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/topologies/replset.js":{"./server":"node_modules/mongodb/lib/topologies/server.js","../cursor":"node_modules/mongodb/lib/cursor.js","../core":"node_modules/mongodb/lib/core/index.js","./topology_base":"node_modules/mongodb/lib/topologies/topology_base.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/url_parser.js":{"./core":"node_modules/mongodb/lib/core/index.js","./read_concern":"node_modules/mongodb/lib/read_concern.js"},"node_modules/mongodb/lib/operations/close.js":{"./operation":"node_modules/mongodb/lib/operations/operation.js","../topologies/native_topology":"node_modules/mongodb/lib/topologies/native_topology.js"},"node_modules/mongodb/lib/admin.js":{"./utils":"node_modules/mongodb/lib/utils.js","./operations/add_user":"node_modules/mongodb/lib/operations/add_user.js","./operations/execute_db_admin_command":"node_modules/mongodb/lib/operations/execute_db_admin_command.js","./operations/remove_user":"node_modules/mongodb/lib/operations/remove_user.js","./operations/validate_collection":"node_modules/mongodb/lib/operations/validate_collection.js","./operations/list_databases":"node_modules/mongodb/lib/operations/list_databases.js","./operations/execute_operation":"node_modules/mongodb/lib/operations/execute_operation.js"},"node_modules/mongodb/lib/operations/validate_collection.js":{"./command":"node_modules/mongodb/lib/operations/command.js"},"node_modules/mongodb/lib/operations/list_databases.js":{"./command_v2":"node_modules/mongodb/lib/operations/command_v2.js","./operation":"node_modules/mongodb/lib/operations/operation.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/gridfs/grid_store.js":{"./chunk":"node_modules/mongodb/lib/gridfs/chunk.js","../core":"node_modules/mongodb/lib/core/index.js","safe-buffer":"node_modules/safe-buffer/index.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/gridfs/chunk.js":{"../core":"node_modules/mongodb/lib/core/index.js","safe-buffer":"node_modules/safe-buffer/index.js"},"node_modules/mongodb/lib/gridfs-stream/index.js":{"./download":"node_modules/mongodb/lib/gridfs-stream/download.js","./upload":"node_modules/mongodb/lib/gridfs-stream/upload.js","../utils":"node_modules/mongodb/lib/utils.js"},"node_modules/mongodb/lib/gridfs-stream/download.js":{},"node_modules/mongodb/lib/gridfs-stream/upload.js":{"../core":"node_modules/mongodb/lib/core/index.js","safe-buffer":"node_modules/safe-buffer/index.js"},"node_modules/mongoose/lib/drivers/node-mongodb-native/collection.js":{"../../collection":"node_modules/mongoose/lib/collection.js","../../error/mongooseError":"node_modules/mongoose/lib/error/mongooseError.js","mongodb":"node_modules/mongodb/index.js","../../helpers/get":"node_modules/mongoose/lib/helpers/get.js","sliced":"node_modules/sliced/index.js"},"node_modules/mongoose/lib/collection.js":{"./connectionstate":"node_modules/mongoose/lib/connectionstate.js","./helpers/immediate":"node_modules/mongoose/lib/helpers/immediate.js"},"node_modules/mongoose/lib/drivers/node-mongodb-native/decimal128.js":{"mongodb":"node_modules/mongodb/index.js"},"node_modules/mongoose/lib/drivers/node-mongodb-native/objectid.js":{"mongodb":"node_modules/mongodb/index.js"},"node_modules/mongoose/lib/drivers/node-mongodb-native/ReadPreference.js":{"mongodb":"node_modules/mongodb/index.js"},"node_modules/mongoose/lib/schema.js":{"kareem":"node_modules/kareem/index.js","./schematype":"node_modules/mongoose/lib/schematype.js","./options/SchemaTypeOptions":"node_modules/mongoose/lib/options/SchemaTypeOptions.js","./virtualtype":"node_modules/mongoose/lib/virtualtype.js","./helpers/update/applyTimestampsToChildren":"node_modules/mongoose/lib/helpers/update/applyTimestampsToChildren.js","./helpers/update/applyTimestampsToUpdate":"node_modules/mongoose/lib/helpers/update/applyTimestampsToUpdate.js","./helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js","./helpers/get":"node_modules/mongoose/lib/helpers/get.js","./helpers/schema/getIndexes":"node_modules/mongoose/lib/helpers/schema/getIndexes.js","./helpers/schema/handleTimestampOption":"node_modules/mongoose/lib/helpers/schema/handleTimestampOption.js","./helpers/schema/merge":"node_modules/mongoose/lib/helpers/schema/merge.js","mpath":"node_modules/mpath/index.js","./driver":"node_modules/mongoose/lib/driver.js","./schema/symbols":"node_modules/mongoose/lib/schema/symbols.js","./utils":"node_modules/mongoose/lib/utils.js","./helpers/populate/validateRef":"node_modules/mongoose/lib/helpers/populate/validateRef.js","./helpers/query/applyQueryMiddleware":"node_modules/mongoose/lib/helpers/query/applyQueryMiddleware.js","./helpers/model/applyHooks":"node_modules/mongoose/lib/helpers/model/applyHooks.js","./schema/index":"node_modules/mongoose/lib/schema/index.js"},"node_modules/mongoose/lib/schematype.js":{"./error/index":"node_modules/mongoose/lib/error/index.js","./options/SchemaTypeOptions":"node_modules/mongoose/lib/options/SchemaTypeOptions.js","./schema/operators/exists":"node_modules/mongoose/lib/schema/operators/exists.js","./schema/operators/type":"node_modules/mongoose/lib/schema/operators/type.js","./helpers/get":"node_modules/mongoose/lib/helpers/get.js","./helpers/schematype/handleImmutable":"node_modules/mongoose/lib/helpers/schematype/handleImmutable.js","./helpers/immediate":"node_modules/mongoose/lib/helpers/immediate.js","./helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js","./utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/error/index.js":{"./mongooseError":"node_modules/mongoose/lib/error/mongooseError.js","./messages":"node_modules/mongoose/lib/error/messages.js","./notFound":"node_modules/mongoose/lib/error/notFound.js","./cast":"node_modules/mongoose/lib/error/cast.js","./validation":"node_modules/mongoose/lib/error/validation.js","./validator":"node_modules/mongoose/lib/error/validator.js","./version":"node_modules/mongoose/lib/error/version.js","./parallelSave":"node_modules/mongoose/lib/error/parallelSave.js","./overwriteModel":"node_modules/mongoose/lib/error/overwriteModel.js","./missingSchema":"node_modules/mongoose/lib/error/missingSchema.js","./divergentArray":"node_modules/mongoose/lib/error/divergentArray.js","./strict":"node_modules/mongoose/lib/error/strict.js"},"node_modules/mongoose/lib/error/notFound.js":{"./":"node_modules/mongoose/lib/error/index.js"},"node_modules/mongoose/lib/error/cast.js":{"./mongooseError":"node_modules/mongoose/lib/error/mongooseError.js"},"node_modules/mongoose/lib/error/validation.js":{"./":"node_modules/mongoose/lib/error/index.js"},"node_modules/mongoose/lib/error/validator.js":{"./":"node_modules/mongoose/lib/error/index.js"},"node_modules/mongoose/lib/error/version.js":{"./":"node_modules/mongoose/lib/error/index.js"},"node_modules/mongoose/lib/error/parallelSave.js":{"./":"node_modules/mongoose/lib/error/index.js"},"node_modules/mongoose/lib/error/overwriteModel.js":{"./":"node_modules/mongoose/lib/error/index.js"},"node_modules/mongoose/lib/error/missingSchema.js":{"./":"node_modules/mongoose/lib/error/index.js"},"node_modules/mongoose/lib/error/divergentArray.js":{"./":"node_modules/mongoose/lib/error/index.js"},"node_modules/mongoose/lib/error/strict.js":{"./":"node_modules/mongoose/lib/error/index.js"},"node_modules/mongoose/lib/options/SchemaTypeOptions.js":{"../utils":"node_modules/mongoose/lib/utils.js","./propertyOptions":"node_modules/mongoose/lib/options/propertyOptions.js"},"node_modules/mongoose/lib/utils.js":{"./types/decimal128":"node_modules/mongoose/lib/types/decimal128.js","./types/objectid":"node_modules/mongoose/lib/types/objectid.js","./options/PopulateOptions":"node_modules/mongoose/lib/options/PopulateOptions.js","./promise_provider":"node_modules/mongoose/lib/promise_provider.js","regexp-clone":"node_modules/regexp-clone/index.js","./helpers/get":"node_modules/mongoose/lib/helpers/get.js","sliced":"node_modules/sliced/index.js","mpath":"node_modules/mpath/index.js","ms":"node_modules/ms/index.js","./helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js","safe-buffer":"node_modules/safe-buffer/index.js","./document":"node_modules/mongoose/lib/document.js","./types":"node_modules/mongoose/lib/types/index.js"},"node_modules/mongoose/lib/types/decimal128.js":{"../driver":"node_modules/mongoose/lib/driver.js"},"node_modules/mongoose/lib/types/objectid.js":{"../driver":"node_modules/mongoose/lib/driver.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/options/PopulateOptions.js":{"../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/promise_provider.js":{"mquery":"node_modules/mquery/lib/mquery.js"},"node_modules/mquery/lib/mquery.js":{"sliced":"node_modules/sliced/index.js","./utils":"node_modules/mquery/lib/utils.js","debug":"node_modules/debug/src/index.js","./permissions":"node_modules/mquery/lib/permissions.js","./env":"node_modules/mquery/lib/env.js","./collection":"node_modules/mquery/lib/collection/index.js","./collection/collection":"node_modules/mquery/lib/collection/collection.js","bluebird":"node_modules/bluebird/js/release/bluebird.js"},"node_modules/mquery/lib/utils.js":{"safe-buffer":"node_modules/safe-buffer/index.js","regexp-clone":"node_modules/regexp-clone/index.js"},"node_modules/debug/src/index.js":{"./node.js":"node_modules/debug/src/node.js"},"node_modules/debug/src/node.js":{"supports-color":"C:/Workspace/walkner/node_modules/supports-color/index.js","./common":"node_modules/debug/src/common.js"},"node_modules/debug/src/common.js":{"ms":"node_modules/ms/index.js"},"node_modules/mquery/lib/collection/index.js":{"../env":"node_modules/mquery/lib/env.js","./node":"node_modules/mquery/lib/collection/node.js"},"node_modules/mquery/lib/collection/node.js":{"./collection":"node_modules/mquery/lib/collection/collection.js","../utils":"node_modules/mquery/lib/utils.js"},"node_modules/bluebird/js/release/bluebird.js":{"./promise":"node_modules/bluebird/js/release/promise.js"},"node_modules/bluebird/js/release/promise.js":{"./util":"node_modules/bluebird/js/release/util.js","./es5":"node_modules/bluebird/js/release/es5.js","./async":"node_modules/bluebird/js/release/async.js","./errors":"node_modules/bluebird/js/release/errors.js","./thenables":"node_modules/bluebird/js/release/thenables.js","./promise_array":"node_modules/bluebird/js/release/promise_array.js","./context":"node_modules/bluebird/js/release/context.js","./debuggability":"node_modules/bluebird/js/release/debuggability.js","./finally":"node_modules/bluebird/js/release/finally.js","./catch_filter":"node_modules/bluebird/js/release/catch_filter.js","./nodeback":"node_modules/bluebird/js/release/nodeback.js","./method":"node_modules/bluebird/js/release/method.js","./bind":"node_modules/bluebird/js/release/bind.js","./cancel":"node_modules/bluebird/js/release/cancel.js","./direct_resolve":"node_modules/bluebird/js/release/direct_resolve.js","./synchronous_inspection":"node_modules/bluebird/js/release/synchronous_inspection.js","./join":"node_modules/bluebird/js/release/join.js","./map.js":"node_modules/bluebird/js/release/map.js","./call_get.js":"node_modules/bluebird/js/release/call_get.js","./using.js":"node_modules/bluebird/js/release/using.js","./timers.js":"node_modules/bluebird/js/release/timers.js","./generators.js":"node_modules/bluebird/js/release/generators.js","./nodeify.js":"node_modules/bluebird/js/release/nodeify.js","./promisify.js":"node_modules/bluebird/js/release/promisify.js","./props.js":"node_modules/bluebird/js/release/props.js","./race.js":"node_modules/bluebird/js/release/race.js","./reduce.js":"node_modules/bluebird/js/release/reduce.js","./settle.js":"node_modules/bluebird/js/release/settle.js","./some.js":"node_modules/bluebird/js/release/some.js","./filter.js":"node_modules/bluebird/js/release/filter.js","./each.js":"node_modules/bluebird/js/release/each.js","./any.js":"node_modules/bluebird/js/release/any.js"},"node_modules/bluebird/js/release/util.js":{"./es5":"node_modules/bluebird/js/release/es5.js"},"node_modules/bluebird/js/release/async.js":{"./schedule":"node_modules/bluebird/js/release/schedule.js","./queue":"node_modules/bluebird/js/release/queue.js","./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/schedule.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/errors.js":{"./es5":"node_modules/bluebird/js/release/es5.js","./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/thenables.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/promise_array.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/debuggability.js":{"./errors":"node_modules/bluebird/js/release/errors.js","./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/finally.js":{"./util":"node_modules/bluebird/js/release/util.js","./catch_filter":"node_modules/bluebird/js/release/catch_filter.js"},"node_modules/bluebird/js/release/catch_filter.js":{"./util":"node_modules/bluebird/js/release/util.js","./es5":"node_modules/bluebird/js/release/es5.js"},"node_modules/bluebird/js/release/nodeback.js":{"./util":"node_modules/bluebird/js/release/util.js","./errors":"node_modules/bluebird/js/release/errors.js","./es5":"node_modules/bluebird/js/release/es5.js"},"node_modules/bluebird/js/release/method.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/cancel.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/join.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/map.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/call_get.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/using.js":{"./util":"node_modules/bluebird/js/release/util.js","./errors":"node_modules/bluebird/js/release/errors.js"},"node_modules/bluebird/js/release/timers.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/generators.js":{"./errors":"node_modules/bluebird/js/release/errors.js","./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/nodeify.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/promisify.js":{"./util":"node_modules/bluebird/js/release/util.js","./nodeback":"node_modules/bluebird/js/release/nodeback.js","./errors":"node_modules/bluebird/js/release/errors.js"},"node_modules/bluebird/js/release/props.js":{"./util":"node_modules/bluebird/js/release/util.js","./es5":"node_modules/bluebird/js/release/es5.js"},"node_modules/bluebird/js/release/race.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/reduce.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/settle.js":{"./util":"node_modules/bluebird/js/release/util.js"},"node_modules/bluebird/js/release/some.js":{"./util":"node_modules/bluebird/js/release/util.js","./errors":"node_modules/bluebird/js/release/errors.js"},"node_modules/mpath/index.js":{"./lib":"node_modules/mpath/lib/index.js"},"node_modules/mongoose/lib/schema/operators/exists.js":{"../../cast/boolean":"node_modules/mongoose/lib/cast/boolean.js"},"node_modules/mongoose/lib/cast/boolean.js":{"../error/cast":"node_modules/mongoose/lib/error/cast.js"},"node_modules/mongoose/lib/helpers/schematype/handleImmutable.js":{"../../error/strict":"node_modules/mongoose/lib/error/strict.js"},"node_modules/mongoose/lib/helpers/update/applyTimestampsToChildren.js":{"../schema/cleanPositionalOperators":"node_modules/mongoose/lib/helpers/schema/cleanPositionalOperators.js","../schema/handleTimestampOption":"node_modules/mongoose/lib/helpers/schema/handleTimestampOption.js"},"node_modules/mongoose/lib/helpers/update/applyTimestampsToUpdate.js":{"../get":"node_modules/mongoose/lib/helpers/get.js"},"node_modules/mongoose/lib/helpers/schema/getIndexes.js":{"../get":"node_modules/mongoose/lib/helpers/get.js","../../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/helpers/populate/validateRef.js":{"../../error/mongooseError":"node_modules/mongoose/lib/error/mongooseError.js"},"node_modules/mongoose/lib/helpers/model/applyHooks.js":{"../../schema/symbols":"node_modules/mongoose/lib/schema/symbols.js","../../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/schema/index.js":{"./string":"node_modules/mongoose/lib/schema/string.js","./number":"node_modules/mongoose/lib/schema/number.js","./boolean":"node_modules/mongoose/lib/schema/boolean.js","./documentarray":"node_modules/mongoose/lib/schema/documentarray.js","./SingleNestedPath":"node_modules/mongoose/lib/schema/SingleNestedPath.js","./array":"node_modules/mongoose/lib/schema/array.js","./buffer":"node_modules/mongoose/lib/schema/buffer.js","./date":"node_modules/mongoose/lib/schema/date.js","./objectid":"node_modules/mongoose/lib/schema/objectid.js","./mixed":"node_modules/mongoose/lib/schema/mixed.js","./decimal128":"node_modules/mongoose/lib/schema/decimal128.js","./map":"node_modules/mongoose/lib/schema/map.js"},"node_modules/mongoose/lib/schema/string.js":{"../schematype":"node_modules/mongoose/lib/schematype.js","../error/index":"node_modules/mongoose/lib/error/index.js","../options/SchemaStringOptions":"node_modules/mongoose/lib/options/SchemaStringOptions.js","../cast/string":"node_modules/mongoose/lib/cast/string.js","../utils":"node_modules/mongoose/lib/utils.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/options/SchemaStringOptions.js":{"./SchemaTypeOptions":"node_modules/mongoose/lib/options/SchemaTypeOptions.js","./propertyOptions":"node_modules/mongoose/lib/options/propertyOptions.js"},"node_modules/mongoose/lib/cast/string.js":{"../error/cast":"node_modules/mongoose/lib/error/cast.js"},"node_modules/mongoose/lib/schema/number.js":{"../error/index":"node_modules/mongoose/lib/error/index.js","../options/SchemaNumberOptions":"node_modules/mongoose/lib/options/SchemaNumberOptions.js","../schematype":"node_modules/mongoose/lib/schematype.js","../cast/number":"node_modules/mongoose/lib/cast/number.js","./operators/bitwise":"node_modules/mongoose/lib/schema/operators/bitwise.js","../utils":"node_modules/mongoose/lib/utils.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/options/SchemaNumberOptions.js":{"./SchemaTypeOptions":"node_modules/mongoose/lib/options/SchemaTypeOptions.js","./propertyOptions":"node_modules/mongoose/lib/options/propertyOptions.js"},"node_modules/mongoose/lib/cast/number.js":{},"node_modules/mongoose/lib/schema/operators/bitwise.js":{"../../error/cast":"node_modules/mongoose/lib/error/cast.js"},"node_modules/mongoose/lib/schema/boolean.js":{"../error/cast":"node_modules/mongoose/lib/error/cast.js","../schematype":"node_modules/mongoose/lib/schematype.js","../cast/boolean":"node_modules/mongoose/lib/cast/boolean.js","../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/schema/documentarray.js":{"./array":"node_modules/mongoose/lib/schema/array.js","../error/cast":"node_modules/mongoose/lib/error/cast.js","../options/SchemaDocumentArrayOptions":"node_modules/mongoose/lib/options/SchemaDocumentArrayOptions.js","../schematype":"node_modules/mongoose/lib/schematype.js","../helpers/model/discriminator":"node_modules/mongoose/lib/helpers/model/discriminator.js","../helpers/get":"node_modules/mongoose/lib/helpers/get.js","../utils":"node_modules/mongoose/lib/utils.js","../helpers/discriminator/getConstructor":"node_modules/mongoose/lib/helpers/discriminator/getConstructor.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js","../types/embedded":"node_modules/mongoose/lib/types/embedded.js"},"node_modules/mongoose/lib/schema/array.js":{"./operators/exists":"node_modules/mongoose/lib/schema/operators/exists.js","./operators/type":"node_modules/mongoose/lib/schema/operators/type.js","../error/mongooseError":"node_modules/mongoose/lib/error/mongooseError.js","../options/SchemaArrayOptions":"node_modules/mongoose/lib/options/SchemaArrayOptions.js","../schematype":"node_modules/mongoose/lib/schematype.js","./mixed":"node_modules/mongoose/lib/schema/mixed.js","../cast":"node_modules/mongoose/lib/cast.js","../helpers/get":"node_modules/mongoose/lib/helpers/get.js","../utils":"node_modules/mongoose/lib/utils.js","./operators/helpers":"node_modules/mongoose/lib/schema/operators/helpers.js","./operators/geospatial":"node_modules/mongoose/lib/schema/operators/geospatial.js","../helpers/discriminator/getDiscriminatorByValue":"node_modules/mongoose/lib/helpers/discriminator/getDiscriminatorByValue.js","../types":"node_modules/mongoose/lib/types/index.js","./index.js":"node_modules/mongoose/lib/schema/index.js"},"node_modules/mongoose/lib/options/SchemaArrayOptions.js":{"./SchemaTypeOptions":"node_modules/mongoose/lib/options/SchemaTypeOptions.js","./propertyOptions":"node_modules/mongoose/lib/options/propertyOptions.js"},"node_modules/mongoose/lib/schema/mixed.js":{"../schematype":"node_modules/mongoose/lib/schematype.js","./symbols":"node_modules/mongoose/lib/schema/symbols.js","../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/cast.js":{"./error/strict":"node_modules/mongoose/lib/error/strict.js","./schema/index":"node_modules/mongoose/lib/schema/index.js","./schema/operators/text":"node_modules/mongoose/lib/schema/operators/text.js","./helpers/get":"node_modules/mongoose/lib/helpers/get.js","./utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/schema/operators/text.js":{"../../error/cast":"node_modules/mongoose/lib/error/cast.js","../../cast/boolean":"node_modules/mongoose/lib/cast/boolean.js","../../cast/string":"node_modules/mongoose/lib/cast/string.js"},"node_modules/mongoose/lib/schema/operators/helpers.js":{"../number":"node_modules/mongoose/lib/schema/number.js"},"node_modules/mongoose/lib/schema/operators/geospatial.js":{"./helpers":"node_modules/mongoose/lib/schema/operators/helpers.js"},"node_modules/mongoose/lib/options/SchemaDocumentArrayOptions.js":{"./SchemaTypeOptions":"node_modules/mongoose/lib/options/SchemaTypeOptions.js","./propertyOptions":"node_modules/mongoose/lib/options/propertyOptions.js"},"node_modules/mongoose/lib/helpers/model/discriminator.js":{"../document/compile":"node_modules/mongoose/lib/helpers/document/compile.js","../get":"node_modules/mongoose/lib/helpers/get.js","../../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/helpers/document/compile.js":{"../../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js","../../helpers/get":"node_modules/mongoose/lib/helpers/get.js","../../utils":"node_modules/mongoose/lib/utils.js","../../document":"node_modules/mongoose/lib/document.js"},"node_modules/mongoose/lib/helpers/discriminator/getConstructor.js":{"./getDiscriminatorByValue":"node_modules/mongoose/lib/helpers/discriminator/getDiscriminatorByValue.js"},"node_modules/mongoose/lib/schema/SingleNestedPath.js":{"../error/cast":"node_modules/mongoose/lib/error/cast.js","../error/objectExpected":"node_modules/mongoose/lib/error/objectExpected.js","../schematype":"node_modules/mongoose/lib/schematype.js","./operators/exists":"node_modules/mongoose/lib/schema/operators/exists.js","./operators/helpers":"node_modules/mongoose/lib/schema/operators/helpers.js","../helpers/model/discriminator":"node_modules/mongoose/lib/helpers/model/discriminator.js","./operators/geospatial":"node_modules/mongoose/lib/schema/operators/geospatial.js","../helpers/get":"node_modules/mongoose/lib/helpers/get.js","../helpers/discriminator/getConstructor":"node_modules/mongoose/lib/helpers/discriminator/getConstructor.js","../options":"node_modules/mongoose/lib/options.js"},"node_modules/mongoose/lib/error/objectExpected.js":{"./":"node_modules/mongoose/lib/error/index.js"},"node_modules/mongoose/lib/schema/buffer.js":{"../types/buffer":"node_modules/mongoose/lib/types/buffer.js","../options/SchemaBufferOptions":"node_modules/mongoose/lib/options/SchemaBufferOptions.js","../schematype":"node_modules/mongoose/lib/schematype.js","./operators/bitwise":"node_modules/mongoose/lib/schema/operators/bitwise.js","../utils":"node_modules/mongoose/lib/utils.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/types/buffer.js":{"../driver":"node_modules/mongoose/lib/driver.js","../utils":"node_modules/mongoose/lib/utils.js","safe-buffer":"node_modules/safe-buffer/index.js"},"node_modules/mongoose/lib/options/SchemaBufferOptions.js":{"./SchemaTypeOptions":"node_modules/mongoose/lib/options/SchemaTypeOptions.js","./propertyOptions":"node_modules/mongoose/lib/options/propertyOptions.js"},"node_modules/mongoose/lib/schema/date.js":{"../error/index":"node_modules/mongoose/lib/error/index.js","../options/SchemaDateOptions":"node_modules/mongoose/lib/options/SchemaDateOptions.js","../schematype":"node_modules/mongoose/lib/schematype.js","../cast/date":"node_modules/mongoose/lib/cast/date.js","../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/options/SchemaDateOptions.js":{"./SchemaTypeOptions":"node_modules/mongoose/lib/options/SchemaTypeOptions.js","./propertyOptions":"node_modules/mongoose/lib/options/propertyOptions.js"},"node_modules/mongoose/lib/cast/date.js":{},"node_modules/mongoose/lib/schema/objectid.js":{"../options/SchemaObjectIdOptions":"node_modules/mongoose/lib/options/SchemaObjectIdOptions.js","../schematype":"node_modules/mongoose/lib/schematype.js","../cast/objectid":"node_modules/mongoose/lib/cast/objectid.js","../types/objectid":"node_modules/mongoose/lib/types/objectid.js","../utils":"node_modules/mongoose/lib/utils.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/options/SchemaObjectIdOptions.js":{"./SchemaTypeOptions":"node_modules/mongoose/lib/options/SchemaTypeOptions.js","./propertyOptions":"node_modules/mongoose/lib/options/propertyOptions.js"},"node_modules/mongoose/lib/cast/objectid.js":{"../driver":"node_modules/mongoose/lib/driver.js"},"node_modules/mongoose/lib/schema/decimal128.js":{"../schematype":"node_modules/mongoose/lib/schematype.js","../types/decimal128":"node_modules/mongoose/lib/types/decimal128.js","../cast/decimal128":"node_modules/mongoose/lib/cast/decimal128.js","../utils":"node_modules/mongoose/lib/utils.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/cast/decimal128.js":{"../types/decimal128":"node_modules/mongoose/lib/types/decimal128.js"},"node_modules/mongoose/lib/schema/map.js":{"../types/map":"node_modules/mongoose/lib/types/map.js","../options/SchemaMapOptions":"node_modules/mongoose/lib/options/SchemaMapOptions.js","../schematype":"node_modules/mongoose/lib/schematype.js"},"node_modules/mongoose/lib/types/map.js":{"../schema/mixed":"node_modules/mongoose/lib/schema/mixed.js","../helpers/get":"node_modules/mongoose/lib/helpers/get.js","../utils":"node_modules/mongoose/lib/utils.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/options/SchemaMapOptions.js":{"./SchemaTypeOptions":"node_modules/mongoose/lib/options/SchemaTypeOptions.js","./propertyOptions":"node_modules/mongoose/lib/options/propertyOptions.js"},"node_modules/mongoose/lib/types/index.js":{"./array":"node_modules/mongoose/lib/types/array.js","./buffer":"node_modules/mongoose/lib/types/buffer.js","./embedded":"node_modules/mongoose/lib/types/embedded.js","./documentarray":"node_modules/mongoose/lib/types/documentarray.js","./decimal128":"node_modules/mongoose/lib/types/decimal128.js","./objectid":"node_modules/mongoose/lib/types/objectid.js","./map":"node_modules/mongoose/lib/types/map.js","./subdocument":"node_modules/mongoose/lib/types/subdocument.js"},"node_modules/mongoose/lib/types/array.js":{"./core_array":"node_modules/mongoose/lib/types/core_array.js","../document":"node_modules/mongoose/lib/document.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/types/core_array.js":{"../document":"node_modules/mongoose/lib/document.js","./embedded":"node_modules/mongoose/lib/types/embedded.js","./objectid":"node_modules/mongoose/lib/types/objectid.js","../helpers/document/cleanModifiedSubpaths":"node_modules/mongoose/lib/helpers/document/cleanModifiedSubpaths.js","../helpers/get":"node_modules/mongoose/lib/helpers/get.js","../options":"node_modules/mongoose/lib/options.js","../utils":"node_modules/mongoose/lib/utils.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/document.js":{"./internal":"node_modules/mongoose/lib/internal.js","./error/index":"node_modules/mongoose/lib/error/index.js","./schema/mixed":"node_modules/mongoose/lib/schema/mixed.js","./error/objectExpected":"node_modules/mongoose/lib/error/objectExpected.js","./error/objectParameter":"node_modules/mongoose/lib/error/objectParameter.js","./schema":"node_modules/mongoose/lib/schema.js","./error/strict":"node_modules/mongoose/lib/error/strict.js","./schematype":"node_modules/mongoose/lib/schematype.js","./virtualtype":"node_modules/mongoose/lib/virtualtype.js","./helpers/document/cleanModifiedSubpaths":"node_modules/mongoose/lib/helpers/document/cleanModifiedSubpaths.js","./helpers/document/compile":"node_modules/mongoose/lib/helpers/document/compile.js","./helpers/common":"node_modules/mongoose/lib/helpers/common.js","./helpers/get":"node_modules/mongoose/lib/helpers/get.js","./helpers/document/getEmbeddedDiscriminatorPath":"node_modules/mongoose/lib/helpers/document/getEmbeddedDiscriminatorPath.js","./plugins/idGetter":"node_modules/mongoose/lib/plugins/idGetter.js","./helpers/projection/isDefiningProjection":"node_modules/mongoose/lib/helpers/projection/isDefiningProjection.js","./helpers/projection/isExclusive":"node_modules/mongoose/lib/helpers/projection/isExclusive.js","./options":"node_modules/mongoose/lib/options.js","mpath":"node_modules/mpath/index.js","./utils":"node_modules/mongoose/lib/utils.js","./helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/internal.js":{"./statemachine":"node_modules/mongoose/lib/statemachine.js"},"node_modules/mongoose/lib/statemachine.js":{"./utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/error/objectParameter.js":{"./":"node_modules/mongoose/lib/error/index.js"},"node_modules/mongoose/lib/helpers/common.js":{"../types/decimal128":"node_modules/mongoose/lib/types/decimal128.js","../types/objectid":"node_modules/mongoose/lib/types/objectid.js","../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/helpers/document/getEmbeddedDiscriminatorPath.js":{"../get":"node_modules/mongoose/lib/helpers/get.js"},"node_modules/mongoose/lib/helpers/projection/isExclusive.js":{"./isDefiningProjection":"node_modules/mongoose/lib/helpers/projection/isDefiningProjection.js"},"node_modules/mongoose/lib/types/embedded.js":{"../document_provider":"node_modules/mongoose/lib/document_provider.js","../helpers/immediate":"node_modules/mongoose/lib/helpers/immediate.js","../options":"node_modules/mongoose/lib/options.js","../helpers/get":"node_modules/mongoose/lib/helpers/get.js","../utils":"node_modules/mongoose/lib/utils.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/document_provider.js":{"./document.js":"node_modules/mongoose/lib/document.js","./browserDocument.js":"node_modules/mongoose/lib/browserDocument.js"},"node_modules/mongoose/lib/browserDocument.js":{"./document":"node_modules/mongoose/lib/document.js","./error/index":"node_modules/mongoose/lib/error/index.js","./schema":"node_modules/mongoose/lib/schema.js","./types/objectid":"node_modules/mongoose/lib/types/objectid.js","./helpers/model/applyHooks":"node_modules/mongoose/lib/helpers/model/applyHooks.js","./utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/types/documentarray.js":{"./core_array":"node_modules/mongoose/lib/types/core_array.js","../document":"node_modules/mongoose/lib/document.js","./objectid":"node_modules/mongoose/lib/types/objectid.js","../cast/objectid":"node_modules/mongoose/lib/cast/objectid.js","../helpers/discriminator/getDiscriminatorByValue":"node_modules/mongoose/lib/helpers/discriminator/getDiscriminatorByValue.js","../options":"node_modules/mongoose/lib/options.js","../utils":"node_modules/mongoose/lib/utils.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/types/subdocument.js":{"../document":"node_modules/mongoose/lib/document.js","../helpers/immediate":"node_modules/mongoose/lib/helpers/immediate.js","../options":"node_modules/mongoose/lib/options.js","../utils":"node_modules/mongoose/lib/utils.js","../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/query.js":{"./error/cast":"node_modules/mongoose/lib/error/cast.js","./error/notFound":"node_modules/mongoose/lib/error/notFound.js","kareem":"node_modules/kareem/index.js","./error/mongooseError":"node_modules/mongoose/lib/error/mongooseError.js","./error/objectParameter":"node_modules/mongoose/lib/error/objectParameter.js","./cursor/QueryCursor":"node_modules/mongoose/lib/cursor/QueryCursor.js","./driver":"node_modules/mongoose/lib/driver.js","./helpers/query/applyGlobalMaxTimeMS":"node_modules/mongoose/lib/helpers/query/applyGlobalMaxTimeMS.js","./helpers/schema/applyWriteConcern":"node_modules/mongoose/lib/helpers/schema/applyWriteConcern.js","./cast":"node_modules/mongoose/lib/cast.js","./helpers/update/castArrayFilters":"node_modules/mongoose/lib/helpers/update/castArrayFilters.js","./helpers/query/castUpdate":"node_modules/mongoose/lib/helpers/query/castUpdate.js","./helpers/query/completeMany":"node_modules/mongoose/lib/helpers/query/completeMany.js","./helpers/get":"node_modules/mongoose/lib/helpers/get.js","./helpers/discriminator/getDiscriminatorByValue":"node_modules/mongoose/lib/helpers/discriminator/getDiscriminatorByValue.js","./helpers/query/hasDollarKeys":"node_modules/mongoose/lib/helpers/query/hasDollarKeys.js","./queryhelpers":"node_modules/mongoose/lib/queryhelpers.js","./helpers/projection/isInclusive":"node_modules/mongoose/lib/helpers/projection/isInclusive.js","mquery":"node_modules/mquery/lib/mquery.js","./helpers/query/selectPopulatedFields":"node_modules/mongoose/lib/helpers/query/selectPopulatedFields.js","./helpers/setDefaultsOnInsert":"node_modules/mongoose/lib/helpers/setDefaultsOnInsert.js","sliced":"node_modules/sliced/index.js","./helpers/updateValidators":"node_modules/mongoose/lib/helpers/updateValidators.js","./utils":"node_modules/mongoose/lib/utils.js","./helpers/query/wrapThunk":"node_modules/mongoose/lib/helpers/query/wrapThunk.js"},"node_modules/mongoose/lib/cursor/QueryCursor.js":{"../helpers/cursor/eachAsync":"node_modules/mongoose/lib/helpers/cursor/eachAsync.js","../queryhelpers":"node_modules/mongoose/lib/queryhelpers.js","../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/helpers/cursor/eachAsync.js":{"../../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/queryhelpers.js":{"./helpers/discriminator/checkEmbeddedDiscriminatorKeyProjection":"node_modules/mongoose/lib/helpers/discriminator/checkEmbeddedDiscriminatorKeyProjection.js","./helpers/get":"node_modules/mongoose/lib/helpers/get.js","./helpers/discriminator/getDiscriminatorByValue":"node_modules/mongoose/lib/helpers/discriminator/getDiscriminatorByValue.js","./helpers/projection/isDefiningProjection":"node_modules/mongoose/lib/helpers/projection/isDefiningProjection.js","./utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/helpers/query/applyGlobalMaxTimeMS.js":{"../../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/helpers/schema/applyWriteConcern.js":{"../get":"node_modules/mongoose/lib/helpers/get.js"},"node_modules/mongoose/lib/helpers/update/castArrayFilters.js":{"../query/castFilterPath":"node_modules/mongoose/lib/helpers/query/castFilterPath.js","../schema/cleanPositionalOperators":"node_modules/mongoose/lib/helpers/schema/cleanPositionalOperators.js","../schema/getPath":"node_modules/mongoose/lib/helpers/schema/getPath.js","./modifiedPaths":"node_modules/mongoose/lib/helpers/update/modifiedPaths.js"},"node_modules/mongoose/lib/helpers/update/modifiedPaths.js":{"../common":"node_modules/mongoose/lib/helpers/common.js"},"node_modules/mongoose/lib/helpers/query/castUpdate.js":{"../../error/cast":"node_modules/mongoose/lib/error/cast.js","../../error/strict":"node_modules/mongoose/lib/error/strict.js","../../error/validation":"node_modules/mongoose/lib/error/validation.js","../../cast/number":"node_modules/mongoose/lib/cast/number.js","../../cast":"node_modules/mongoose/lib/cast.js","./getEmbeddedDiscriminatorPath":"node_modules/mongoose/lib/helpers/query/getEmbeddedDiscriminatorPath.js","./handleImmutable":"node_modules/mongoose/lib/helpers/query/handleImmutable.js","../../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/helpers/query/getEmbeddedDiscriminatorPath.js":{"../schema/cleanPositionalOperators":"node_modules/mongoose/lib/helpers/schema/cleanPositionalOperators.js","../get":"node_modules/mongoose/lib/helpers/get.js"},"node_modules/mongoose/lib/helpers/query/handleImmutable.js":{"../../error/strict":"node_modules/mongoose/lib/error/strict.js"},"node_modules/mongoose/lib/helpers/query/completeMany.js":{"../../queryhelpers":"node_modules/mongoose/lib/queryhelpers.js"},"node_modules/mongoose/lib/helpers/projection/isInclusive.js":{"./isDefiningProjection":"node_modules/mongoose/lib/helpers/projection/isDefiningProjection.js"},"node_modules/mongoose/lib/helpers/setDefaultsOnInsert.js":{"./common":"node_modules/mongoose/lib/helpers/common.js"},"node_modules/mongoose/lib/helpers/updateValidators.js":{"../error/validation":"node_modules/mongoose/lib/error/validation.js","./schema/cleanPositionalOperators":"node_modules/mongoose/lib/helpers/schema/cleanPositionalOperators.js","./common":"node_modules/mongoose/lib/helpers/common.js"},"node_modules/mongoose/lib/model.js":{"./aggregate":"node_modules/mongoose/lib/aggregate.js","./cursor/ChangeStream":"node_modules/mongoose/lib/cursor/ChangeStream.js","./document":"node_modules/mongoose/lib/document.js","./error/notFound":"node_modules/mongoose/lib/error/notFound.js","./error/divergentArray":"node_modules/mongoose/lib/error/divergentArray.js","./types/buffer":"node_modules/mongoose/lib/types/buffer.js","./error/index":"node_modules/mongoose/lib/error/index.js","./error/overwriteModel":"node_modules/mongoose/lib/error/overwriteModel.js","./promise_provider":"node_modules/mongoose/lib/promise_provider.js","./query":"node_modules/mongoose/lib/query.js","./options/removeOptions":"node_modules/mongoose/lib/options/removeOptions.js","./options/saveOptions":"node_modules/mongoose/lib/options/saveOptions.js","./schema":"node_modules/mongoose/lib/schema.js","./error/version":"node_modules/mongoose/lib/error/version.js","./error/parallelSave":"node_modules/mongoose/lib/error/parallelSave.js","./helpers/query/applyQueryMiddleware":"node_modules/mongoose/lib/helpers/query/applyQueryMiddleware.js","./helpers/model/applyHooks":"node_modules/mongoose/lib/helpers/model/applyHooks.js","./helpers/model/applyMethods":"node_modules/mongoose/lib/helpers/model/applyMethods.js","./helpers/model/applyStaticHooks":"node_modules/mongoose/lib/helpers/model/applyStaticHooks.js","./helpers/model/applyStatics":"node_modules/mongoose/lib/helpers/model/applyStatics.js","./helpers/schema/applyWriteConcern":"node_modules/mongoose/lib/helpers/schema/applyWriteConcern.js","./helpers/populate/assignVals":"node_modules/mongoose/lib/helpers/populate/assignVals.js","./helpers/model/castBulkWrite":"node_modules/mongoose/lib/helpers/model/castBulkWrite.js","./helpers/model/discriminator":"node_modules/mongoose/lib/helpers/model/discriminator.js","./helpers/each":"node_modules/mongoose/lib/helpers/each.js","./helpers/discriminator/getDiscriminatorByValue":"node_modules/mongoose/lib/helpers/discriminator/getDiscriminatorByValue.js","./helpers/populate/getModelsMapForPopulate":"node_modules/mongoose/lib/helpers/populate/getModelsMapForPopulate.js","./helpers/immediate":"node_modules/mongoose/lib/helpers/immediate.js","./options":"node_modules/mongoose/lib/options.js","./helpers/projection/isPathSelectedInclusive":"node_modules/mongoose/lib/helpers/projection/isPathSelectedInclusive.js","./helpers/get":"node_modules/mongoose/lib/helpers/get.js","./helpers/populate/leanPopulateMap":"node_modules/mongoose/lib/helpers/populate/leanPopulateMap.js","./helpers/update/modifiedPaths":"node_modules/mongoose/lib/helpers/update/modifiedPaths.js","./helpers/parallelLimit":"node_modules/mongoose/lib/helpers/parallelLimit.js","./utils":"node_modules/mongoose/lib/utils.js","./helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/aggregate.js":{"./cursor/AggregationCursor":"node_modules/mongoose/lib/cursor/AggregationCursor.js","./query":"node_modules/mongoose/lib/query.js","./helpers/query/applyGlobalMaxTimeMS":"node_modules/mongoose/lib/helpers/query/applyGlobalMaxTimeMS.js","./utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/cursor/AggregationCursor.js":{"../error/mongooseError":"node_modules/mongoose/lib/error/mongooseError.js","../helpers/cursor/eachAsync":"node_modules/mongoose/lib/helpers/cursor/eachAsync.js","../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/cursor/ChangeStream.js":{},"node_modules/mongoose/lib/options/removeOptions.js":{"../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/options/saveOptions.js":{"../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/helpers/model/applyMethods.js":{"../get":"node_modules/mongoose/lib/helpers/get.js"},"node_modules/mongoose/lib/helpers/model/applyStaticHooks.js":{"../query/applyQueryMiddleware":"node_modules/mongoose/lib/helpers/query/applyQueryMiddleware.js","../../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/helpers/populate/assignVals.js":{"./assignRawDocsToIdStructure":"node_modules/mongoose/lib/helpers/populate/assignRawDocsToIdStructure.js","../get":"node_modules/mongoose/lib/helpers/get.js","./getVirtual":"node_modules/mongoose/lib/helpers/populate/getVirtual.js","./leanPopulateMap":"node_modules/mongoose/lib/helpers/populate/leanPopulateMap.js","mpath":"node_modules/mpath/index.js","sift":"node_modules/sift/lib/index.js","../../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/helpers/populate/assignRawDocsToIdStructure.js":{"../symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/helpers/model/castBulkWrite.js":{"../update/applyTimestampsToChildren":"node_modules/mongoose/lib/helpers/update/applyTimestampsToChildren.js","../update/applyTimestampsToUpdate":"node_modules/mongoose/lib/helpers/update/applyTimestampsToUpdate.js","../../cast":"node_modules/mongoose/lib/cast.js","../query/castUpdate":"node_modules/mongoose/lib/helpers/query/castUpdate.js","../setDefaultsOnInsert":"node_modules/mongoose/lib/helpers/setDefaultsOnInsert.js"},"node_modules/mongoose/lib/helpers/populate/getModelsMapForPopulate.js":{"../../error/index":"node_modules/mongoose/lib/error/index.js","../get":"node_modules/mongoose/lib/helpers/get.js","../discriminator/getDiscriminatorByValue":"node_modules/mongoose/lib/helpers/discriminator/getDiscriminatorByValue.js","../projection/isPathExcluded":"node_modules/mongoose/lib/helpers/projection/isPathExcluded.js","./getSchemaTypes":"node_modules/mongoose/lib/helpers/populate/getSchemaTypes.js","./getVirtual":"node_modules/mongoose/lib/helpers/populate/getVirtual.js","./normalizeRefPath":"node_modules/mongoose/lib/helpers/populate/normalizeRefPath.js","../../utils":"node_modules/mongoose/lib/utils.js","../symbols":"node_modules/mongoose/lib/helpers/symbols.js","../../schema/symbols":"node_modules/mongoose/lib/schema/symbols.js"},"node_modules/mongoose/lib/helpers/projection/isPathExcluded.js":{"./isDefiningProjection":"node_modules/mongoose/lib/helpers/projection/isDefiningProjection.js"},"node_modules/mongoose/lib/helpers/populate/getSchemaTypes.js":{"../../schema/mixed":"node_modules/mongoose/lib/schema/mixed.js","../get":"node_modules/mongoose/lib/helpers/get.js","./leanPopulateMap":"node_modules/mongoose/lib/helpers/populate/leanPopulateMap.js","mpath":"node_modules/mpath/index.js","../symbols":"node_modules/mongoose/lib/helpers/symbols.js"},"node_modules/mongoose/lib/plugins/removeSubdocs.js":{"../helpers/each":"node_modules/mongoose/lib/helpers/each.js"},"node_modules/mongoose/lib/plugins/saveSubdocs.js":{"../helpers/each":"node_modules/mongoose/lib/helpers/each.js"},"node_modules/mongoose/lib/plugins/sharding.js":{"../helpers/symbols":"node_modules/mongoose/lib/helpers/symbols.js","../utils":"node_modules/mongoose/lib/utils.js"},"node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js":{"../../connection":"node_modules/mongoose/lib/connection.js","../../connectionstate":"node_modules/mongoose/lib/connectionstate.js"},"node_modules/mongoose/lib/connection.js":{"./schema":"node_modules/mongoose/lib/schema.js","./driver":"node_modules/mongoose/lib/driver.js","./connectionstate":"node_modules/mongoose/lib/connectionstate.js","./error/index":"node_modules/mongoose/lib/error/index.js","./promise_provider":"node_modules/mongoose/lib/promise_provider.js","./helpers/schema/applyPlugins":"node_modules/mongoose/lib/helpers/schema/applyPlugins.js","./helpers/get":"node_modules/mongoose/lib/helpers/get.js","mongodb":"node_modules/mongodb/index.js","./utils":"node_modules/mongoose/lib/utils.js","mongodb/lib/core":"node_modules/mongodb/lib/core/index.js"},"backend/node_modules/h5-mongoose/expressMiddleware.js":{"mongoose":"node_modules/mongoose/index.js"},"backend/node_modules/events/index.js":{"lodash":"node_modules/lodash/lodash.js","./models/event":"backend/node_modules/events/models/event.js","./routes":"backend/node_modules/events/routes.js"},"backend/node_modules/modbus/index.js":{"lodash":"node_modules/lodash/lodash.js","csv":"node_modules/csv/lib/index.js","deep-equal":"node_modules/deep-equal/index.js","h5.modbus":"node_modules/h5.modbus/lib/index.js","./Tag":"backend/node_modules/modbus/Tag.js","./virtuals":"backend/node_modules/modbus/virtuals.js","./safeGuards":"backend/node_modules/modbus/safeGuards.js"},"node_modules/csv/lib/index.js":{"csv-generate":"node_modules/csv-generate/lib/index.js","csv-parse":"node_modules/csv-parse/lib/index.js","stream-transform":"node_modules/stream-transform/lib/index.js","csv-stringify":"node_modules/csv-stringify/lib/index.js"},"node_modules/csv-generate/lib/index.js":{},"node_modules/csv-parse/lib/index.js":{},"node_modules/stream-transform/lib/index.js":{},"node_modules/csv-stringify/lib/index.js":{"lodash.get":"node_modules/lodash.get/index.js"},"node_modules/deep-equal/index.js":{"object-keys":"node_modules/object-keys/index.js","is-arguments":"node_modules/is-arguments/index.js","object-is":"node_modules/object-is/index.js","is-regex":"node_modules/is-regex/index.js","regexp.prototype.flags":"node_modules/regexp.prototype.flags/index.js","is-date-object":"node_modules/is-date-object/index.js"},"node_modules/object-keys/index.js":{"./isArguments":"node_modules/object-keys/isArguments.js"},"node_modules/is-regex/index.js":{"has":"node_modules/has/src/index.js"},"node_modules/has/src/index.js":{"function-bind":"node_modules/function-bind/index.js"},"node_modules/function-bind/index.js":{"./implementation":"node_modules/function-bind/implementation.js"},"node_modules/regexp.prototype.flags/index.js":{"define-properties":"node_modules/define-properties/index.js","./implementation":"node_modules/regexp.prototype.flags/implementation.js","./polyfill":"node_modules/regexp.prototype.flags/polyfill.js","./shim":"node_modules/regexp.prototype.flags/shim.js"},"node_modules/define-properties/index.js":{"object-keys":"node_modules/object-keys/index.js"},"node_modules/regexp.prototype.flags/polyfill.js":{"./implementation":"node_modules/regexp.prototype.flags/implementation.js","define-properties":"node_modules/define-properties/index.js"},"node_modules/regexp.prototype.flags/shim.js":{"define-properties":"node_modules/define-properties/index.js","./polyfill":"node_modules/regexp.prototype.flags/polyfill.js"},"node_modules/h5.modbus/lib/index.js":{"./Master":"node_modules/h5.modbus/lib/Master.js","./Slave":"node_modules/h5.modbus/lib/Slave.js","./ExceptionCode":"node_modules/h5.modbus/lib/ExceptionCode.js","./FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","./helpers":"node_modules/h5.modbus/lib/helpers.js","./ApplicationDataUnit":"node_modules/h5.modbus/lib/ApplicationDataUnit.js","./RemoteClient":"node_modules/h5.modbus/lib/RemoteClient.js","./Transaction":"node_modules/h5.modbus/lib/Transaction.js","./InvalidFrameError":"node_modules/h5.modbus/lib/InvalidFrameError.js","./ResponseTimeoutError":"node_modules/h5.modbus/lib/ResponseTimeoutError.js","./Transport":"node_modules/h5.modbus/lib/Transport.js","./transports/IpTransport":"node_modules/h5.modbus/lib/transports/IpTransport.js","./transports/AsciiTransport":"node_modules/h5.modbus/lib/transports/AsciiTransport.js","./transports/RtuTransport":"node_modules/h5.modbus/lib/transports/RtuTransport.js","./Connection":"node_modules/h5.modbus/lib/Connection.js","./connections/TcpConnection":"node_modules/h5.modbus/lib/connections/TcpConnection.js","./connections/UdpConnection":"node_modules/h5.modbus/lib/connections/UdpConnection.js","./connections/SerialConnection":"node_modules/h5.modbus/lib/connections/SerialConnection.js","./connections/WebSocketConnection":"node_modules/h5.modbus/lib/connections/WebSocketConnection.js","./Listener":"node_modules/h5.modbus/lib/Listener.js","./listeners/TcpListener":"node_modules/h5.modbus/lib/listeners/TcpListener.js","./listeners/UdpListener":"node_modules/h5.modbus/lib/listeners/UdpListener.js","./listeners/SerialListener":"node_modules/h5.modbus/lib/listeners/SerialListener.js","./listeners/WebSocketListener":"node_modules/h5.modbus/lib/listeners/WebSocketListener.js","./messages":"node_modules/h5.modbus/lib/messages/index.js","./Message":"node_modules/h5.modbus/lib/Message.js","./Request":"node_modules/h5.modbus/lib/Request.js","./Response":"node_modules/h5.modbus/lib/Response.js"},"node_modules/h5.modbus/lib/Master.js":{"./InvalidFrameError":"node_modules/h5.modbus/lib/InvalidFrameError.js","./ResponseTimeoutError":"node_modules/h5.modbus/lib/ResponseTimeoutError.js","./Transaction":"node_modules/h5.modbus/lib/Transaction.js","./messages":"node_modules/h5.modbus/lib/messages/index.js"},"node_modules/h5.modbus/lib/Transaction.js":{"./messages":"node_modules/h5.modbus/lib/messages/index.js"},"node_modules/h5.modbus/lib/messages/index.js":{"../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","./ReadDiscreteInputsRequest":"node_modules/h5.modbus/lib/messages/ReadDiscreteInputsRequest.js","./ReadDiscreteInputsResponse":"node_modules/h5.modbus/lib/messages/ReadDiscreteInputsResponse.js","./ReadCoilsRequest":"node_modules/h5.modbus/lib/messages/ReadCoilsRequest.js","./ReadCoilsResponse":"node_modules/h5.modbus/lib/messages/ReadCoilsResponse.js","./WriteSingleCoilRequest":"node_modules/h5.modbus/lib/messages/WriteSingleCoilRequest.js","./WriteSingleCoilResponse":"node_modules/h5.modbus/lib/messages/WriteSingleCoilResponse.js","./WriteMultipleCoilsRequest":"node_modules/h5.modbus/lib/messages/WriteMultipleCoilsRequest.js","./WriteMultipleCoilsResponse":"node_modules/h5.modbus/lib/messages/WriteMultipleCoilsResponse.js","./ReadInputRegistersRequest":"node_modules/h5.modbus/lib/messages/ReadInputRegistersRequest.js","./ReadInputRegistersResponse":"node_modules/h5.modbus/lib/messages/ReadInputRegistersResponse.js","./ReadHoldingRegistersRequest":"node_modules/h5.modbus/lib/messages/ReadHoldingRegistersRequest.js","./ReadHoldingRegistersResponse":"node_modules/h5.modbus/lib/messages/ReadHoldingRegistersResponse.js","./WriteSingleRegisterRequest":"node_modules/h5.modbus/lib/messages/WriteSingleRegisterRequest.js","./WriteSingleRegisterResponse":"node_modules/h5.modbus/lib/messages/WriteSingleRegisterResponse.js","./WriteMultipleRegistersRequest":"node_modules/h5.modbus/lib/messages/WriteMultipleRegistersRequest.js","./WriteMultipleRegistersResponse":"node_modules/h5.modbus/lib/messages/WriteMultipleRegistersResponse.js","./ExceptionResponse":"node_modules/h5.modbus/lib/messages/ExceptionResponse.js"},"node_modules/h5.modbus/lib/messages/ReadDiscreteInputsRequest.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Request":"node_modules/h5.modbus/lib/Request.js"},"node_modules/h5.modbus/lib/helpers.js":{},"node_modules/h5.modbus/lib/Request.js":{"./Message":"node_modules/h5.modbus/lib/Message.js"},"node_modules/h5.modbus/lib/messages/ReadDiscreteInputsResponse.js":{"h5.buffers":"node_modules/h5.buffers/lib/index.js","../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Response":"node_modules/h5.modbus/lib/Response.js"},"node_modules/h5.buffers/lib/index.js":{"./BufferQueueReader":"node_modules/h5.buffers/lib/BufferQueueReader.js","./BufferReader":"node_modules/h5.buffers/lib/BufferReader.js","./BufferBuilder":"node_modules/h5.buffers/lib/BufferBuilder.js"},"node_modules/h5.buffers/lib/BufferQueueReader.js":{"./helpers":"node_modules/h5.buffers/lib/helpers.js"},"node_modules/h5.buffers/lib/BufferReader.js":{"./helpers":"node_modules/h5.buffers/lib/helpers.js"},"node_modules/h5.modbus/lib/Response.js":{"./Message":"node_modules/h5.modbus/lib/Message.js"},"node_modules/h5.modbus/lib/messages/ReadCoilsRequest.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Request":"node_modules/h5.modbus/lib/Request.js"},"node_modules/h5.modbus/lib/messages/ReadCoilsResponse.js":{"h5.buffers":"node_modules/h5.buffers/lib/index.js","../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Response":"node_modules/h5.modbus/lib/Response.js"},"node_modules/h5.modbus/lib/messages/WriteSingleCoilRequest.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Request":"node_modules/h5.modbus/lib/Request.js"},"node_modules/h5.modbus/lib/messages/WriteSingleCoilResponse.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Response":"node_modules/h5.modbus/lib/Response.js"},"node_modules/h5.modbus/lib/messages/WriteMultipleCoilsRequest.js":{"h5.buffers":"node_modules/h5.buffers/lib/index.js","../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Request":"node_modules/h5.modbus/lib/Request.js"},"node_modules/h5.modbus/lib/messages/WriteMultipleCoilsResponse.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Response":"node_modules/h5.modbus/lib/Response.js"},"node_modules/h5.modbus/lib/messages/ReadInputRegistersRequest.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Request":"node_modules/h5.modbus/lib/Request.js"},"node_modules/h5.modbus/lib/messages/ReadInputRegistersResponse.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Response":"node_modules/h5.modbus/lib/Response.js"},"node_modules/h5.modbus/lib/messages/ReadHoldingRegistersRequest.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Request":"node_modules/h5.modbus/lib/Request.js"},"node_modules/h5.modbus/lib/messages/ReadHoldingRegistersResponse.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Response":"node_modules/h5.modbus/lib/Response.js"},"node_modules/h5.modbus/lib/messages/WriteSingleRegisterRequest.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Request":"node_modules/h5.modbus/lib/Request.js"},"node_modules/h5.modbus/lib/messages/WriteSingleRegisterResponse.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Response":"node_modules/h5.modbus/lib/Response.js"},"node_modules/h5.modbus/lib/messages/WriteMultipleRegistersRequest.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Request":"node_modules/h5.modbus/lib/Request.js"},"node_modules/h5.modbus/lib/messages/WriteMultipleRegistersResponse.js":{"../helpers":"node_modules/h5.modbus/lib/helpers.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Response":"node_modules/h5.modbus/lib/Response.js"},"node_modules/h5.modbus/lib/messages/ExceptionResponse.js":{"../ExceptionCode":"node_modules/h5.modbus/lib/ExceptionCode.js","../FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","../Response":"node_modules/h5.modbus/lib/Response.js","../helpers":"node_modules/h5.modbus/lib/helpers.js"},"node_modules/h5.modbus/lib/Slave.js":{"./ExceptionCode":"node_modules/h5.modbus/lib/ExceptionCode.js","./FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","./Response":"node_modules/h5.modbus/lib/Response.js","./messages/ExceptionResponse":"node_modules/h5.modbus/lib/messages/ExceptionResponse.js","./messages":"node_modules/h5.modbus/lib/messages/index.js"},"node_modules/h5.modbus/lib/ApplicationDataUnit.js":{"./InvalidFrameError":"node_modules/h5.modbus/lib/InvalidFrameError.js","./FunctionCode":"node_modules/h5.modbus/lib/FunctionCode.js","./messages":"node_modules/h5.modbus/lib/messages/index.js"},"node_modules/h5.modbus/lib/RemoteClient.js":{},"node_modules/h5.modbus/lib/transports/IpTransport.js":{"h5.buffers":"node_modules/h5.buffers/lib/index.js","../InvalidFrameError":"node_modules/h5.modbus/lib/InvalidFrameError.js","../ApplicationDataUnit":"node_modules/h5.modbus/lib/ApplicationDataUnit.js","../Transport":"node_modules/h5.modbus/lib/Transport.js"},"node_modules/h5.modbus/lib/transports/AsciiTransport.js":{"h5.buffers":"node_modules/h5.buffers/lib/index.js","../InvalidFrameError":"node_modules/h5.modbus/lib/InvalidFrameError.js","../ApplicationDataUnit":"node_modules/h5.modbus/lib/ApplicationDataUnit.js","../Transport":"node_modules/h5.modbus/lib/Transport.js"},"node_modules/h5.modbus/lib/transports/RtuTransport.js":{"h5.buffers":"node_modules/h5.buffers/lib/index.js","../InvalidFrameError":"node_modules/h5.modbus/lib/InvalidFrameError.js","../ApplicationDataUnit":"node_modules/h5.modbus/lib/ApplicationDataUnit.js","../Transport":"node_modules/h5.modbus/lib/Transport.js"},"node_modules/h5.modbus/lib/Connection.js":{},"node_modules/h5.modbus/lib/connections/TcpConnection.js":{"../Connection":"node_modules/h5.modbus/lib/Connection.js"},"node_modules/h5.modbus/lib/connections/UdpConnection.js":{"../Connection":"node_modules/h5.modbus/lib/Connection.js"},"node_modules/h5.modbus/lib/connections/SerialConnection.js":{"../Connection":"node_modules/h5.modbus/lib/Connection.js"},"node_modules/h5.modbus/lib/connections/WebSocketConnection.js":{"../Connection":"node_modules/h5.modbus/lib/Connection.js"},"node_modules/h5.modbus/lib/Listener.js":{},"node_modules/h5.modbus/lib/listeners/TcpListener.js":{"../Listener":"node_modules/h5.modbus/lib/Listener.js","../RemoteClient":"node_modules/h5.modbus/lib/RemoteClient.js","./monkeyPatch":"node_modules/h5.modbus/lib/listeners/monkeyPatch.js"},"node_modules/h5.modbus/lib/listeners/monkeyPatch.js":{},"node_modules/h5.modbus/lib/listeners/UdpListener.js":{"../Listener":"node_modules/h5.modbus/lib/Listener.js","../RemoteClient":"node_modules/h5.modbus/lib/RemoteClient.js"},"node_modules/h5.modbus/lib/listeners/SerialListener.js":{"../Listener":"node_modules/h5.modbus/lib/Listener.js","../RemoteClient":"node_modules/h5.modbus/lib/RemoteClient.js"},"node_modules/h5.modbus/lib/listeners/WebSocketListener.js":{"../Listener":"node_modules/h5.modbus/lib/Listener.js","../RemoteClient":"node_modules/h5.modbus/lib/RemoteClient.js","./monkeyPatch":"node_modules/h5.modbus/lib/listeners/monkeyPatch.js"},"backend/node_modules/modbus/Tag.js":{"lodash":"node_modules/lodash/lodash.js","deep-equal":"node_modules/deep-equal/index.js","./deltaUtils":"backend/node_modules/modbus/deltaUtils.js","./scaleFunctions":"backend/node_modules/modbus/scaleFunctions.js"},"backend/node_modules/modbus/scaleFunctions.js":{"lodash":"node_modules/lodash/lodash.js"},"backend/node_modules/messenger/server.js":{"lodash":"node_modules/lodash/lodash.js","axon":"node_modules/axon/index.js","amp-message":"node_modules/amp-message/index.js"},"node_modules/axon/index.js":{"./lib":"node_modules/axon/lib/index.js"},"node_modules/axon/lib/index.js":{"./sockets/pub-emitter":"node_modules/axon/lib/sockets/pub-emitter.js","./sockets/sub-emitter":"node_modules/axon/lib/sockets/sub-emitter.js","./sockets/push":"node_modules/axon/lib/sockets/push.js","./sockets/pull":"node_modules/axon/lib/sockets/pull.js","./sockets/pub":"node_modules/axon/lib/sockets/pub.js","./sockets/sub":"node_modules/axon/lib/sockets/sub.js","./sockets/req":"node_modules/axon/lib/sockets/req.js","./sockets/rep":"node_modules/axon/lib/sockets/rep.js","./sockets/sock":"node_modules/axon/lib/sockets/sock.js"},"node_modules/axon/lib/sockets/pub-emitter.js":{"./pub":"node_modules/axon/lib/sockets/pub.js"},"node_modules/axon/lib/sockets/pub.js":{"./sock":"node_modules/axon/lib/sockets/sock.js","../utils":"node_modules/axon/lib/utils.js"},"node_modules/axon/lib/sockets/sock.js":{"configurable":"node_modules/configurable/index.js","debug":"node_modules/debug/src/index.js","amp-message":"node_modules/amp-message/index.js","amp":"node_modules/amp/index.js"},"node_modules/configurable/index.js":{"./lib/configurable":"node_modules/configurable/lib/configurable.js"},"node_modules/amp-message/index.js":{"amp":"node_modules/amp/index.js"},"node_modules/amp/index.js":{"./lib/stream":"node_modules/amp/lib/stream.js","./lib/encode":"node_modules/amp/lib/encode.js","./lib/decode":"node_modules/amp/lib/decode.js"},"node_modules/amp/lib/stream.js":{"./encode":"node_modules/amp/lib/encode.js"},"node_modules/axon/lib/sockets/sub-emitter.js":{"amp-message":"node_modules/amp-message/index.js","./sub":"node_modules/axon/lib/sockets/sub.js"},"node_modules/axon/lib/sockets/sub.js":{"debug":"node_modules/debug/src/index.js","escape-regexp":"node_modules/escape-regexp/index.js","amp-message":"node_modules/amp-message/index.js","./sock":"node_modules/axon/lib/sockets/sock.js"},"node_modules/axon/lib/sockets/push.js":{"../plugins/round-robin":"node_modules/axon/lib/plugins/round-robin.js","../plugins/queue":"node_modules/axon/lib/plugins/queue.js","./sock":"node_modules/axon/lib/sockets/sock.js"},"node_modules/axon/lib/plugins/round-robin.js":{"../utils":"node_modules/axon/lib/utils.js"},"node_modules/axon/lib/plugins/queue.js":{"debug":"node_modules/debug/src/index.js"},"node_modules/axon/lib/sockets/pull.js":{"./sock":"node_modules/axon/lib/sockets/sock.js"},"node_modules/axon/lib/sockets/req.js":{"debug":"node_modules/debug/src/index.js","../plugins/queue":"node_modules/axon/lib/plugins/queue.js","../utils":"node_modules/axon/lib/utils.js","amp-message":"node_modules/amp-message/index.js","./sock":"node_modules/axon/lib/sockets/sock.js"},"node_modules/axon/lib/sockets/rep.js":{"../utils":"node_modules/axon/lib/utils.js","debug":"node_modules/debug/src/index.js","amp-message":"node_modules/amp-message/index.js","./sock":"node_modules/axon/lib/sockets/sock.js"},"backend/node_modules/messenger/client.js":{"lodash":"node_modules/lodash/lodash.js","axon":"node_modules/axon/index.js","amp-message":"node_modules/amp-message/index.js"},"backend/node_modules/program/index.js":{"lodash":"node_modules/lodash/lodash.js","./Watchdog":"backend/node_modules/program/Watchdog.js","./ProgramManager":"backend/node_modules/program/ProgramManager.js","./TestManager":"backend/node_modules/program/TestManager.js","snf-programs/models/snfProgram":"backend/node_modules/snf-programs/models/snfProgram.js","snf-tests/models/snfTest":"backend/node_modules/snf-tests/models/snfTest.js"},"backend/node_modules/program/Watchdog.js":{"h5.step":"node_modules/h5.step/lib/index.js","./ControlUnit":"backend/node_modules/program/ControlUnit.js"},"backend/node_modules/program/ControlUnit.js":{"lodash":"node_modules/lodash/lodash.js","./Lock":"backend/node_modules/program/Lock.js"},"backend/node_modules/program/ProgramManager.js":{"h5.step":"node_modules/h5.step/lib/index.js","./ControlUnit":"backend/node_modules/program/ControlUnit.js"},"backend/node_modules/program/TestManager.js":{"h5.step":"node_modules/h5.step/lib/index.js","./ControlUnit":"backend/node_modules/program/ControlUnit.js"},"backend/node_modules/modbus/virtuals.js":{"lodash":"node_modules/lodash/lodash.js"}},"sources":{"backend/helpers.js":"\"use strict\";","node_modules/moment/moment.js":"!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){\"use strict\";var e,t;function n(){return e.apply(null,arguments)}function s(e){return e instanceof Array||\"[object Array]\"===Object.prototype.toString.call(e)}function i(e){return null!=e&&\"[object Object]\"===Object.prototype.toString.call(e)}function r(e){return void 0===e}function a(e){return\"number\"==typeof e||\"[object Number]\"===Object.prototype.toString.call(e)}function o(e){return e instanceof Date||\"[object Date]\"===Object.prototype.toString.call(e)}function u(e,t){var n,s=[];for(n=0;n<e.length;++n)s.push(t(e[n],n));return s}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function h(e,t){for(var n in t)l(t,n)&&(e[n]=t[n]);return l(t,\"toString\")&&(e.toString=t.toString),l(t,\"valueOf\")&&(e.valueOf=t.valueOf),e}function d(e,t,n,s){return bt(e,t,n,s,!0).utc()}function c(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function f(e){if(null==e._isValid){var n=c(e),s=t.call(n.parsedDateParts,function(e){return null!=e}),i=!isNaN(e._d.getTime())&&n.overflow<0&&!n.empty&&!n.invalidMonth&&!n.invalidWeekday&&!n.weekdayMismatch&&!n.nullInput&&!n.invalidFormat&&!n.userInvalidated&&(!n.meridiem||n.meridiem&&s);if(e._strict&&(i=i&&0===n.charsLeftOver&&0===n.unusedTokens.length&&void 0===n.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function m(e){var t=d(NaN);return null!=e?h(c(t),e):c(t).userInvalidated=!0,t}t=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,s=0;s<n;s++)if(s in t&&e.call(this,t[s],s,t))return!0;return!1};var _=n.momentProperties=[];function y(e,t){var n,s,i;if(r(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),r(t._i)||(e._i=t._i),r(t._f)||(e._f=t._f),r(t._l)||(e._l=t._l),r(t._strict)||(e._strict=t._strict),r(t._tzm)||(e._tzm=t._tzm),r(t._isUTC)||(e._isUTC=t._isUTC),r(t._offset)||(e._offset=t._offset),r(t._pf)||(e._pf=c(t)),r(t._locale)||(e._locale=t._locale),_.length>0)for(n=0;n<_.length;n++)r(i=t[s=_[n]])||(e[s]=i);return e}var g=!1;function v(e){y(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===g&&(g=!0,n.updateOffset(this),g=!1)}function p(e){return e instanceof v||null!=e&&null!=e._isAMomentObject}function w(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function M(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=w(t)),n}function k(e,t,n){var s,i=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0;for(s=0;s<i;s++)(n&&e[s]!==t[s]||!n&&M(e[s])!==M(t[s]))&&a++;return a+r}function S(e){!1===n.suppressDeprecationWarnings&&\"undefined\"!=typeof console&&console.warn&&console.warn(\"Deprecation warning: \"+e)}function D(e,t){var s=!0;return h(function(){if(null!=n.deprecationHandler&&n.deprecationHandler(null,e),s){for(var i,r=[],a=0;a<arguments.length;a++){if(i=\"\",\"object\"==typeof arguments[a]){for(var o in i+=\"\\n[\"+a+\"] \",arguments[0])i+=o+\": \"+arguments[0][o]+\", \";i=i.slice(0,-2)}else i=arguments[a];r.push(i)}S(e+\"\\nArguments: \"+Array.prototype.slice.call(r).join(\"\")+\"\\n\"+(new Error).stack),s=!1}return t.apply(this,arguments)},t)}var Y,O={};function T(e,t){null!=n.deprecationHandler&&n.deprecationHandler(e,t),O[e]||(S(t),O[e]=!0)}function b(e){return e instanceof Function||\"[object Function]\"===Object.prototype.toString.call(e)}function x(e,t){var n,s=h({},e);for(n in t)l(t,n)&&(i(e[n])&&i(t[n])?(s[n]={},h(s[n],e[n]),h(s[n],t[n])):null!=t[n]?s[n]=t[n]:delete s[n]);for(n in e)l(e,n)&&!l(t,n)&&i(e[n])&&(s[n]=h({},s[n]));return s}function P(e){null!=e&&this.set(e)}n.suppressDeprecationWarnings=!1,n.deprecationHandler=null,Y=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)l(e,t)&&n.push(t);return n};var W={};function C(e,t){var n=e.toLowerCase();W[n]=W[n+\"s\"]=W[t]=e}function H(e){return\"string\"==typeof e?W[e]||W[e.toLowerCase()]:void 0}function R(e){var t,n,s={};for(n in e)l(e,n)&&(t=H(n))&&(s[t]=e[n]);return s}var U={};function F(e,t){U[e]=t}function L(e,t,n){var s=\"\"+Math.abs(e),i=t-s.length;return(e>=0?n?\"+\":\"\":\"-\")+Math.pow(10,Math.max(0,i)).toString().substr(1)+s}var N=/(\\[[^\\[]*\\])|(\\\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,G=/(\\[[^\\[]*\\])|(\\\\)?(LTS|LT|LL?L?L?|l{1,4})/g,V={},E={};function I(e,t,n,s){var i=s;\"string\"==typeof s&&(i=function(){return this[s]()}),e&&(E[e]=i),t&&(E[t[0]]=function(){return L(i.apply(this,arguments),t[1],t[2])}),n&&(E[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function A(e,t){return e.isValid()?(t=j(t,e.localeData()),V[t]=V[t]||function(e){var t,n,s,i=e.match(N);for(t=0,n=i.length;t<n;t++)E[i[t]]?i[t]=E[i[t]]:i[t]=(s=i[t]).match(/\\[[\\s\\S]/)?s.replace(/^\\[|\\]$/g,\"\"):s.replace(/\\\\/g,\"\");return function(t){var s,r=\"\";for(s=0;s<n;s++)r+=b(i[s])?i[s].call(t,e):i[s];return r}}(t),V[t](e)):e.localeData().invalidDate()}function j(e,t){var n=5;function s(e){return t.longDateFormat(e)||e}for(G.lastIndex=0;n>=0&&G.test(e);)e=e.replace(G,s),G.lastIndex=0,n-=1;return e}var Z=/\\d/,z=/\\d\\d/,$=/\\d{3}/,q=/\\d{4}/,J=/[+-]?\\d{6}/,B=/\\d\\d?/,Q=/\\d\\d\\d\\d?/,X=/\\d\\d\\d\\d\\d\\d?/,K=/\\d{1,3}/,ee=/\\d{1,4}/,te=/[+-]?\\d{1,6}/,ne=/\\d+/,se=/[+-]?\\d+/,ie=/Z|[+-]\\d\\d:?\\d\\d/gi,re=/Z|[+-]\\d\\d(?::?\\d\\d)?/gi,ae=/[0-9]{0,256}['a-z\\u00A0-\\u05FF\\u0700-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFF07\\uFF10-\\uFFEF]{1,256}|[\\u0600-\\u06FF\\/]{1,256}(\\s*?[\\u0600-\\u06FF]{1,256}){1,2}/i,oe={};function ue(e,t,n){oe[e]=b(t)?t:function(e,s){return e&&n?n:t}}function le(e,t){return l(oe,e)?oe[e](t._strict,t._locale):new RegExp(he(e.replace(\"\\\\\",\"\").replace(/\\\\(\\[)|\\\\(\\])|\\[([^\\]\\[]*)\\]|\\\\(.)/g,function(e,t,n,s,i){return t||n||s||i})))}function he(e){return e.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g,\"\\\\$&\")}var de={};function ce(e,t){var n,s=t;for(\"string\"==typeof e&&(e=[e]),a(t)&&(s=function(e,n){n[t]=M(e)}),n=0;n<e.length;n++)de[e[n]]=s}function fe(e,t){ce(e,function(e,n,s,i){s._w=s._w||{},t(e,s._w,s,i)})}function me(e,t,n){null!=t&&l(de,e)&&de[e](t,n._a,n,e)}var _e=0,ye=1,ge=2,ve=3,pe=4,we=5,Me=6,ke=7,Se=8;function De(e){return Ye(e)?366:365}function Ye(e){return e%4==0&&e%100!=0||e%400==0}I(\"Y\",0,0,function(){var e=this.year();return e<=9999?\"\"+e:\"+\"+e}),I(0,[\"YY\",2],0,function(){return this.year()%100}),I(0,[\"YYYY\",4],0,\"year\"),I(0,[\"YYYYY\",5],0,\"year\"),I(0,[\"YYYYYY\",6,!0],0,\"year\"),C(\"year\",\"y\"),F(\"year\",1),ue(\"Y\",se),ue(\"YY\",B,z),ue(\"YYYY\",ee,q),ue(\"YYYYY\",te,J),ue(\"YYYYYY\",te,J),ce([\"YYYYY\",\"YYYYYY\"],_e),ce(\"YYYY\",function(e,t){t[_e]=2===e.length?n.parseTwoDigitYear(e):M(e)}),ce(\"YY\",function(e,t){t[_e]=n.parseTwoDigitYear(e)}),ce(\"Y\",function(e,t){t[_e]=parseInt(e,10)}),n.parseTwoDigitYear=function(e){return M(e)+(M(e)>68?1900:2e3)};var Oe,Te=be(\"FullYear\",!0);function be(e,t){return function(s){return null!=s?(Pe(this,e,s),n.updateOffset(this,t),this):xe(this,e)}}function xe(e,t){return e.isValid()?e._d[\"get\"+(e._isUTC?\"UTC\":\"\")+t]():NaN}function Pe(e,t,n){e.isValid()&&!isNaN(n)&&(\"FullYear\"===t&&Ye(e.year())&&1===e.month()&&29===e.date()?e._d[\"set\"+(e._isUTC?\"UTC\":\"\")+t](n,e.month(),We(n,e.month())):e._d[\"set\"+(e._isUTC?\"UTC\":\"\")+t](n))}function We(e,t){if(isNaN(e)||isNaN(t))return NaN;var n,s=(t%(n=12)+n)%n;return e+=(t-s)/12,1===s?Ye(e)?29:28:31-s%7%2}Oe=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},I(\"M\",[\"MM\",2],\"Mo\",function(){return this.month()+1}),I(\"MMM\",0,0,function(e){return this.localeData().monthsShort(this,e)}),I(\"MMMM\",0,0,function(e){return this.localeData().months(this,e)}),C(\"month\",\"M\"),F(\"month\",8),ue(\"M\",B),ue(\"MM\",B,z),ue(\"MMM\",function(e,t){return t.monthsShortRegex(e)}),ue(\"MMMM\",function(e,t){return t.monthsRegex(e)}),ce([\"M\",\"MM\"],function(e,t){t[ye]=M(e)-1}),ce([\"MMM\",\"MMMM\"],function(e,t,n,s){var i=n._locale.monthsParse(e,s,n._strict);null!=i?t[ye]=i:c(n).invalidMonth=e});var Ce=/D[oD]?(\\[[^\\[\\]]*\\]|\\s)+MMMM?/,He=\"January_February_March_April_May_June_July_August_September_October_November_December\".split(\"_\");var Re=\"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec\".split(\"_\");function Ue(e,t){var n;if(!e.isValid())return e;if(\"string\"==typeof t)if(/^\\d+$/.test(t))t=M(t);else if(!a(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),We(e.year(),t)),e._d[\"set\"+(e._isUTC?\"UTC\":\"\")+\"Month\"](t,n),e}function Fe(e){return null!=e?(Ue(this,e),n.updateOffset(this,!0),this):xe(this,\"Month\")}var Le=ae;var Ne=ae;function Ge(){function e(e,t){return t.length-e.length}var t,n,s=[],i=[],r=[];for(t=0;t<12;t++)n=d([2e3,t]),s.push(this.monthsShort(n,\"\")),i.push(this.months(n,\"\")),r.push(this.months(n,\"\")),r.push(this.monthsShort(n,\"\"));for(s.sort(e),i.sort(e),r.sort(e),t=0;t<12;t++)s[t]=he(s[t]),i[t]=he(i[t]);for(t=0;t<24;t++)r[t]=he(r[t]);this._monthsRegex=new RegExp(\"^(\"+r.join(\"|\")+\")\",\"i\"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp(\"^(\"+i.join(\"|\")+\")\",\"i\"),this._monthsShortStrictRegex=new RegExp(\"^(\"+s.join(\"|\")+\")\",\"i\")}function Ve(e){var t;if(e<100&&e>=0){var n=Array.prototype.slice.call(arguments);n[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function Ee(e,t,n){var s=7+t-n;return-((7+Ve(e,0,s).getUTCDay()-t)%7)+s-1}function Ie(e,t,n,s,i){var r,a,o=1+7*(t-1)+(7+n-s)%7+Ee(e,s,i);return o<=0?a=De(r=e-1)+o:o>De(e)?(r=e+1,a=o-De(e)):(r=e,a=o),{year:r,dayOfYear:a}}function Ae(e,t,n){var s,i,r=Ee(e.year(),t,n),a=Math.floor((e.dayOfYear()-r-1)/7)+1;return a<1?s=a+je(i=e.year()-1,t,n):a>je(e.year(),t,n)?(s=a-je(e.year(),t,n),i=e.year()+1):(i=e.year(),s=a),{week:s,year:i}}function je(e,t,n){var s=Ee(e,t,n),i=Ee(e+1,t,n);return(De(e)-s+i)/7}I(\"w\",[\"ww\",2],\"wo\",\"week\"),I(\"W\",[\"WW\",2],\"Wo\",\"isoWeek\"),C(\"week\",\"w\"),C(\"isoWeek\",\"W\"),F(\"week\",5),F(\"isoWeek\",5),ue(\"w\",B),ue(\"ww\",B,z),ue(\"W\",B),ue(\"WW\",B,z),fe([\"w\",\"ww\",\"W\",\"WW\"],function(e,t,n,s){t[s.substr(0,1)]=M(e)});function Ze(e,t){return e.slice(t,7).concat(e.slice(0,t))}I(\"d\",0,\"do\",\"day\"),I(\"dd\",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),I(\"ddd\",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),I(\"dddd\",0,0,function(e){return this.localeData().weekdays(this,e)}),I(\"e\",0,0,\"weekday\"),I(\"E\",0,0,\"isoWeekday\"),C(\"day\",\"d\"),C(\"weekday\",\"e\"),C(\"isoWeekday\",\"E\"),F(\"day\",11),F(\"weekday\",11),F(\"isoWeekday\",11),ue(\"d\",B),ue(\"e\",B),ue(\"E\",B),ue(\"dd\",function(e,t){return t.weekdaysMinRegex(e)}),ue(\"ddd\",function(e,t){return t.weekdaysShortRegex(e)}),ue(\"dddd\",function(e,t){return t.weekdaysRegex(e)}),fe([\"dd\",\"ddd\",\"dddd\"],function(e,t,n,s){var i=n._locale.weekdaysParse(e,s,n._strict);null!=i?t.d=i:c(n).invalidWeekday=e}),fe([\"d\",\"e\",\"E\"],function(e,t,n,s){t[s]=M(e)});var ze=\"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday\".split(\"_\");var $e=\"Sun_Mon_Tue_Wed_Thu_Fri_Sat\".split(\"_\");var qe=\"Su_Mo_Tu_We_Th_Fr_Sa\".split(\"_\");var Je=ae;var Be=ae;var Qe=ae;function Xe(){function e(e,t){return t.length-e.length}var t,n,s,i,r,a=[],o=[],u=[],l=[];for(t=0;t<7;t++)n=d([2e3,1]).day(t),s=this.weekdaysMin(n,\"\"),i=this.weekdaysShort(n,\"\"),r=this.weekdays(n,\"\"),a.push(s),o.push(i),u.push(r),l.push(s),l.push(i),l.push(r);for(a.sort(e),o.sort(e),u.sort(e),l.sort(e),t=0;t<7;t++)o[t]=he(o[t]),u[t]=he(u[t]),l[t]=he(l[t]);this._weekdaysRegex=new RegExp(\"^(\"+l.join(\"|\")+\")\",\"i\"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp(\"^(\"+u.join(\"|\")+\")\",\"i\"),this._weekdaysShortStrictRegex=new RegExp(\"^(\"+o.join(\"|\")+\")\",\"i\"),this._weekdaysMinStrictRegex=new RegExp(\"^(\"+a.join(\"|\")+\")\",\"i\")}function Ke(){return this.hours()%12||12}function et(e,t){I(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function tt(e,t){return t._meridiemParse}I(\"H\",[\"HH\",2],0,\"hour\"),I(\"h\",[\"hh\",2],0,Ke),I(\"k\",[\"kk\",2],0,function(){return this.hours()||24}),I(\"hmm\",0,0,function(){return\"\"+Ke.apply(this)+L(this.minutes(),2)}),I(\"hmmss\",0,0,function(){return\"\"+Ke.apply(this)+L(this.minutes(),2)+L(this.seconds(),2)}),I(\"Hmm\",0,0,function(){return\"\"+this.hours()+L(this.minutes(),2)}),I(\"Hmmss\",0,0,function(){return\"\"+this.hours()+L(this.minutes(),2)+L(this.seconds(),2)}),et(\"a\",!0),et(\"A\",!1),C(\"hour\",\"h\"),F(\"hour\",13),ue(\"a\",tt),ue(\"A\",tt),ue(\"H\",B),ue(\"h\",B),ue(\"k\",B),ue(\"HH\",B,z),ue(\"hh\",B,z),ue(\"kk\",B,z),ue(\"hmm\",Q),ue(\"hmmss\",X),ue(\"Hmm\",Q),ue(\"Hmmss\",X),ce([\"H\",\"HH\"],ve),ce([\"k\",\"kk\"],function(e,t,n){var s=M(e);t[ve]=24===s?0:s}),ce([\"a\",\"A\"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),ce([\"h\",\"hh\"],function(e,t,n){t[ve]=M(e),c(n).bigHour=!0}),ce(\"hmm\",function(e,t,n){var s=e.length-2;t[ve]=M(e.substr(0,s)),t[pe]=M(e.substr(s)),c(n).bigHour=!0}),ce(\"hmmss\",function(e,t,n){var s=e.length-4,i=e.length-2;t[ve]=M(e.substr(0,s)),t[pe]=M(e.substr(s,2)),t[we]=M(e.substr(i)),c(n).bigHour=!0}),ce(\"Hmm\",function(e,t,n){var s=e.length-2;t[ve]=M(e.substr(0,s)),t[pe]=M(e.substr(s))}),ce(\"Hmmss\",function(e,t,n){var s=e.length-4,i=e.length-2;t[ve]=M(e.substr(0,s)),t[pe]=M(e.substr(s,2)),t[we]=M(e.substr(i))});var nt,st=be(\"Hours\",!0),it={calendar:{sameDay:\"[Today at] LT\",nextDay:\"[Tomorrow at] LT\",nextWeek:\"dddd [at] LT\",lastDay:\"[Yesterday at] LT\",lastWeek:\"[Last] dddd [at] LT\",sameElse:\"L\"},longDateFormat:{LTS:\"h:mm:ss A\",LT:\"h:mm A\",L:\"MM/DD/YYYY\",LL:\"MMMM D, YYYY\",LLL:\"MMMM D, YYYY h:mm A\",LLLL:\"dddd, MMMM D, YYYY h:mm A\"},invalidDate:\"Invalid date\",ordinal:\"%d\",dayOfMonthOrdinalParse:/\\d{1,2}/,relativeTime:{future:\"in %s\",past:\"%s ago\",s:\"a few seconds\",ss:\"%d seconds\",m:\"a minute\",mm:\"%d minutes\",h:\"an hour\",hh:\"%d hours\",d:\"a day\",dd:\"%d days\",M:\"a month\",MM:\"%d months\",y:\"a year\",yy:\"%d years\"},months:He,monthsShort:Re,week:{dow:0,doy:6},weekdays:ze,weekdaysMin:qe,weekdaysShort:$e,meridiemParse:/[ap]\\.?m?\\.?/i},rt={},at={};function ot(e){return e?e.toLowerCase().replace(\"_\",\"-\"):e}function ut(e){var t=null;if(!rt[e]&&\"undefined\"!=typeof module&&module&&module.exports)try{t=nt._abbr,require(\"./locale/\"+e),lt(t)}catch(e){}return rt[e]}function lt(e,t){var n;return e&&((n=r(t)?dt(e):ht(e,t))?nt=n:\"undefined\"!=typeof console&&console.warn&&console.warn(\"Locale \"+e+\" not found. Did you forget to load it?\")),nt._abbr}function ht(e,t){if(null!==t){var n,s=it;if(t.abbr=e,null!=rt[e])T(\"defineLocaleOverride\",\"use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info.\"),s=rt[e]._config;else if(null!=t.parentLocale)if(null!=rt[t.parentLocale])s=rt[t.parentLocale]._config;else{if(null==(n=ut(t.parentLocale)))return at[t.parentLocale]||(at[t.parentLocale]=[]),at[t.parentLocale].push({name:e,config:t}),null;s=n._config}return rt[e]=new P(x(s,t)),at[e]&&at[e].forEach(function(e){ht(e.name,e.config)}),lt(e),rt[e]}return delete rt[e],null}function dt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return nt;if(!s(e)){if(t=ut(e))return t;e=[e]}return function(e){for(var t,n,s,i,r=0;r<e.length;){for(t=(i=ot(e[r]).split(\"-\")).length,n=(n=ot(e[r+1]))?n.split(\"-\"):null;t>0;){if(s=ut(i.slice(0,t).join(\"-\")))return s;if(n&&n.length>=t&&k(i,n,!0)>=t-1)break;t--}r++}return nt}(e)}function ct(e){var t,n=e._a;return n&&-2===c(e).overflow&&(t=n[ye]<0||n[ye]>11?ye:n[ge]<1||n[ge]>We(n[_e],n[ye])?ge:n[ve]<0||n[ve]>24||24===n[ve]&&(0!==n[pe]||0!==n[we]||0!==n[Me])?ve:n[pe]<0||n[pe]>59?pe:n[we]<0||n[we]>59?we:n[Me]<0||n[Me]>999?Me:-1,c(e)._overflowDayOfYear&&(t<_e||t>ge)&&(t=ge),c(e)._overflowWeeks&&-1===t&&(t=ke),c(e)._overflowWeekday&&-1===t&&(t=Se),c(e).overflow=t),e}function ft(e,t,n){return null!=e?e:null!=t?t:n}function mt(e){var t,s,i,r,a,o=[];if(!e._d){for(i=function(e){var t=new Date(n.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[ge]&&null==e._a[ye]&&function(e){var t,n,s,i,r,a,o,u;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)r=1,a=4,n=ft(t.GG,e._a[_e],Ae(xt(),1,4).year),s=ft(t.W,1),((i=ft(t.E,1))<1||i>7)&&(u=!0);else{r=e._locale._week.dow,a=e._locale._week.doy;var l=Ae(xt(),r,a);n=ft(t.gg,e._a[_e],l.year),s=ft(t.w,l.week),null!=t.d?((i=t.d)<0||i>6)&&(u=!0):null!=t.e?(i=t.e+r,(t.e<0||t.e>6)&&(u=!0)):i=r}s<1||s>je(n,r,a)?c(e)._overflowWeeks=!0:null!=u?c(e)._overflowWeekday=!0:(o=Ie(n,s,i,r,a),e._a[_e]=o.year,e._dayOfYear=o.dayOfYear)}(e),null!=e._dayOfYear&&(a=ft(e._a[_e],i[_e]),(e._dayOfYear>De(a)||0===e._dayOfYear)&&(c(e)._overflowDayOfYear=!0),s=Ve(a,0,e._dayOfYear),e._a[ye]=s.getUTCMonth(),e._a[ge]=s.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=o[t]=i[t];for(;t<7;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ve]&&0===e._a[pe]&&0===e._a[we]&&0===e._a[Me]&&(e._nextDay=!0,e._a[ve]=0),e._d=(e._useUTC?Ve:function(e,t,n,s,i,r,a){var o;return e<100&&e>=0?(o=new Date(e+400,t,n,s,i,r,a),isFinite(o.getFullYear())&&o.setFullYear(e)):o=new Date(e,t,n,s,i,r,a),o}).apply(null,o),r=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ve]=24),e._w&&void 0!==e._w.d&&e._w.d!==r&&(c(e).weekdayMismatch=!0)}}var _t=/^\\s*((?:[+-]\\d{6}|\\d{4})-(?:\\d\\d-\\d\\d|W\\d\\d-\\d|W\\d\\d|\\d\\d\\d|\\d\\d))(?:(T| )(\\d\\d(?::\\d\\d(?::\\d\\d(?:[.,]\\d+)?)?)?)([\\+\\-]\\d\\d(?::?\\d\\d)?|\\s*Z)?)?$/,yt=/^\\s*((?:[+-]\\d{6}|\\d{4})(?:\\d\\d\\d\\d|W\\d\\d\\d|W\\d\\d|\\d\\d\\d|\\d\\d))(?:(T| )(\\d\\d(?:\\d\\d(?:\\d\\d(?:[.,]\\d+)?)?)?)([\\+\\-]\\d\\d(?::?\\d\\d)?|\\s*Z)?)?$/,gt=/Z|[+-]\\d\\d(?::?\\d\\d)?/,vt=[[\"YYYYYY-MM-DD\",/[+-]\\d{6}-\\d\\d-\\d\\d/],[\"YYYY-MM-DD\",/\\d{4}-\\d\\d-\\d\\d/],[\"GGGG-[W]WW-E\",/\\d{4}-W\\d\\d-\\d/],[\"GGGG-[W]WW\",/\\d{4}-W\\d\\d/,!1],[\"YYYY-DDD\",/\\d{4}-\\d{3}/],[\"YYYY-MM\",/\\d{4}-\\d\\d/,!1],[\"YYYYYYMMDD\",/[+-]\\d{10}/],[\"YYYYMMDD\",/\\d{8}/],[\"GGGG[W]WWE\",/\\d{4}W\\d{3}/],[\"GGGG[W]WW\",/\\d{4}W\\d{2}/,!1],[\"YYYYDDD\",/\\d{7}/]],pt=[[\"HH:mm:ss.SSSS\",/\\d\\d:\\d\\d:\\d\\d\\.\\d+/],[\"HH:mm:ss,SSSS\",/\\d\\d:\\d\\d:\\d\\d,\\d+/],[\"HH:mm:ss\",/\\d\\d:\\d\\d:\\d\\d/],[\"HH:mm\",/\\d\\d:\\d\\d/],[\"HHmmss.SSSS\",/\\d\\d\\d\\d\\d\\d\\.\\d+/],[\"HHmmss,SSSS\",/\\d\\d\\d\\d\\d\\d,\\d+/],[\"HHmmss\",/\\d\\d\\d\\d\\d\\d/],[\"HHmm\",/\\d\\d\\d\\d/],[\"HH\",/\\d\\d/]],wt=/^\\/?Date\\((\\-?\\d+)/i;function Mt(e){var t,n,s,i,r,a,o=e._i,u=_t.exec(o)||yt.exec(o);if(u){for(c(e).iso=!0,t=0,n=vt.length;t<n;t++)if(vt[t][1].exec(u[1])){i=vt[t][0],s=!1!==vt[t][2];break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,n=pt.length;t<n;t++)if(pt[t][1].exec(u[3])){r=(u[2]||\" \")+pt[t][0];break}if(null==r)return void(e._isValid=!1)}if(!s&&null!=r)return void(e._isValid=!1);if(u[4]){if(!gt.exec(u[4]))return void(e._isValid=!1);a=\"Z\"}e._f=i+(r||\"\")+(a||\"\"),Ot(e)}else e._isValid=!1}var kt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\\s)?(\\d{1,2})\\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\\s(\\d{2,4})\\s(\\d\\d):(\\d\\d)(?::(\\d\\d))?\\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\\d{4}))$/;function St(e,t,n,s,i,r){var a=[function(e){var t=parseInt(e,10);if(t<=49)return 2e3+t;if(t<=999)return 1900+t;return t}(e),Re.indexOf(t),parseInt(n,10),parseInt(s,10),parseInt(i,10)];return r&&a.push(parseInt(r,10)),a}var Dt={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Yt(e){var t=kt.exec(e._i.replace(/\\([^)]*\\)|[\\n\\t]/g,\" \").replace(/(\\s\\s+)/g,\" \").replace(/^\\s\\s*/,\"\").replace(/\\s\\s*$/,\"\"));if(t){var n=St(t[4],t[3],t[2],t[5],t[6],t[7]);if(!function(e,t,n){return!e||$e.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(c(n).weekdayMismatch=!0,n._isValid=!1,!1)}(t[1],n,e))return;e._a=n,e._tzm=function(e,t,n){if(e)return Dt[e];if(t)return 0;var s=parseInt(n,10),i=s%100;return(s-i)/100*60+i}(t[8],t[9],t[10]),e._d=Ve.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),c(e).rfc2822=!0}else e._isValid=!1}function Ot(e){if(e._f!==n.ISO_8601)if(e._f!==n.RFC_2822){e._a=[],c(e).empty=!0;var t,s,i,r,a,o=\"\"+e._i,u=o.length,l=0;for(i=j(e._f,e._locale).match(N)||[],t=0;t<i.length;t++)r=i[t],(s=(o.match(le(r,e))||[])[0])&&((a=o.substr(0,o.indexOf(s))).length>0&&c(e).unusedInput.push(a),o=o.slice(o.indexOf(s)+s.length),l+=s.length),E[r]?(s?c(e).empty=!1:c(e).unusedTokens.push(r),me(r,s,e)):e._strict&&!s&&c(e).unusedTokens.push(r);c(e).charsLeftOver=u-l,o.length>0&&c(e).unusedInput.push(o),e._a[ve]<=12&&!0===c(e).bigHour&&e._a[ve]>0&&(c(e).bigHour=void 0),c(e).parsedDateParts=e._a.slice(0),c(e).meridiem=e._meridiem,e._a[ve]=function(e,t,n){var s;if(null==n)return t;return null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((s=e.isPM(n))&&t<12&&(t+=12),s||12!==t||(t=0),t):t}(e._locale,e._a[ve],e._meridiem),mt(e),ct(e)}else Yt(e);else Mt(e)}function Tt(e){var t=e._i,l=e._f;return e._locale=e._locale||dt(e._l),null===t||void 0===l&&\"\"===t?m({nullInput:!0}):(\"string\"==typeof t&&(e._i=t=e._locale.preparse(t)),p(t)?new v(ct(t)):(o(t)?e._d=t:s(l)?function(e){var t,n,s,i,r;if(0===e._f.length)return c(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)r=0,t=y({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Ot(t),f(t)&&(r+=c(t).charsLeftOver,r+=10*c(t).unusedTokens.length,c(t).score=r,(null==s||r<s)&&(s=r,n=t));h(e,n||t)}(e):l?Ot(e):function(e){var t=e._i;r(t)?e._d=new Date(n.now()):o(t)?e._d=new Date(t.valueOf()):\"string\"==typeof t?function(e){var t=wt.exec(e._i);null===t?(Mt(e),!1===e._isValid&&(delete e._isValid,Yt(e),!1===e._isValid&&(delete e._isValid,n.createFromInputFallback(e)))):e._d=new Date(+t[1])}(e):s(t)?(e._a=u(t.slice(0),function(e){return parseInt(e,10)}),mt(e)):i(t)?function(e){if(!e._d){var t=R(e._i);e._a=u([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),mt(e)}}(e):a(t)?e._d=new Date(t):n.createFromInputFallback(e)}(e),f(e)||(e._d=null),e))}function bt(e,t,n,r,a){var o,u={};return!0!==n&&!1!==n||(r=n,n=void 0),(i(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||s(e)&&0===e.length)&&(e=void 0),u._isAMomentObject=!0,u._useUTC=u._isUTC=a,u._l=n,u._i=e,u._f=t,u._strict=r,(o=new v(ct(Tt(u))))._nextDay&&(o.add(1,\"d\"),o._nextDay=void 0),o}function xt(e,t,n,s){return bt(e,t,n,s,!1)}n.createFromInputFallback=D(\"value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.\",function(e){e._d=new Date(e._i+(e._useUTC?\" UTC\":\"\"))}),n.ISO_8601=function(){},n.RFC_2822=function(){};var Pt=D(\"moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/\",function(){var e=xt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:m()}),Wt=D(\"moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/\",function(){var e=xt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:m()});function Ct(e,t){var n,i;if(1===t.length&&s(t[0])&&(t=t[0]),!t.length)return xt();for(n=t[0],i=1;i<t.length;++i)t[i].isValid()&&!t[i][e](n)||(n=t[i]);return n}var Ht=[\"year\",\"quarter\",\"month\",\"week\",\"day\",\"hour\",\"minute\",\"second\",\"millisecond\"];function Rt(e){var t=R(e),n=t.year||0,s=t.quarter||0,i=t.month||0,r=t.week||t.isoWeek||0,a=t.day||0,o=t.hour||0,u=t.minute||0,l=t.second||0,h=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===Oe.call(Ht,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,s=0;s<Ht.length;++s)if(e[Ht[s]]){if(n)return!1;parseFloat(e[Ht[s]])!==M(e[Ht[s]])&&(n=!0)}return!0}(t),this._milliseconds=+h+1e3*l+6e4*u+1e3*o*60*60,this._days=+a+7*r,this._months=+i+3*s+12*n,this._data={},this._locale=dt(),this._bubble()}function Ut(e){return e instanceof Rt}function Ft(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Lt(e,t){I(e,0,0,function(){var e=this.utcOffset(),n=\"+\";return e<0&&(e=-e,n=\"-\"),n+L(~~(e/60),2)+t+L(~~e%60,2)})}Lt(\"Z\",\":\"),Lt(\"ZZ\",\"\"),ue(\"Z\",re),ue(\"ZZ\",re),ce([\"Z\",\"ZZ\"],function(e,t,n){n._useUTC=!0,n._tzm=Gt(re,e)});var Nt=/([\\+\\-]|\\d\\d)/gi;function Gt(e,t){var n=(t||\"\").match(e);if(null===n)return null;var s=((n[n.length-1]||[])+\"\").match(Nt)||[\"-\",0,0],i=60*s[1]+M(s[2]);return 0===i?0:\"+\"===s[0]?i:-i}function Vt(e,t){var s,i;return t._isUTC?(s=t.clone(),i=(p(e)||o(e)?e.valueOf():xt(e).valueOf())-s.valueOf(),s._d.setTime(s._d.valueOf()+i),n.updateOffset(s,!1),s):xt(e).local()}function Et(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function It(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}n.updateOffset=function(){};var At=/^(\\-|\\+)?(?:(\\d*)[. ])?(\\d+)\\:(\\d+)(?:\\:(\\d+)(\\.\\d*)?)?$/,jt=/^(-|\\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Zt(e,t){var n,s,i,r=e,o=null;return Ut(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:a(e)?(r={},t?r[t]=e:r.milliseconds=e):(o=At.exec(e))?(n=\"-\"===o[1]?-1:1,r={y:0,d:M(o[ge])*n,h:M(o[ve])*n,m:M(o[pe])*n,s:M(o[we])*n,ms:M(Ft(1e3*o[Me]))*n}):(o=jt.exec(e))?(n=\"-\"===o[1]?-1:1,r={y:zt(o[2],n),M:zt(o[3],n),w:zt(o[4],n),d:zt(o[5],n),h:zt(o[6],n),m:zt(o[7],n),s:zt(o[8],n)}):null==r?r={}:\"object\"==typeof r&&(\"from\"in r||\"to\"in r)&&(i=function(e,t){var n;if(!e.isValid()||!t.isValid())return{milliseconds:0,months:0};t=Vt(t,e),e.isBefore(t)?n=$t(e,t):((n=$t(t,e)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(xt(r.from),xt(r.to)),(r={}).ms=i.milliseconds,r.M=i.months),s=new Rt(r),Ut(e)&&l(e,\"_locale\")&&(s._locale=e._locale),s}function zt(e,t){var n=e&&parseFloat(e.replace(\",\",\".\"));return(isNaN(n)?0:n)*t}function $t(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,\"M\").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,\"M\"),n}function qt(e,t){return function(n,s){var i;return null===s||isNaN(+s)||(T(t,\"moment().\"+t+\"(period, number) is deprecated. Please use moment().\"+t+\"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.\"),i=n,n=s,s=i),Jt(this,Zt(n=\"string\"==typeof n?+n:n,s),e),this}}function Jt(e,t,s,i){var r=t._milliseconds,a=Ft(t._days),o=Ft(t._months);e.isValid()&&(i=null==i||i,o&&Ue(e,xe(e,\"Month\")+o*s),a&&Pe(e,\"Date\",xe(e,\"Date\")+a*s),r&&e._d.setTime(e._d.valueOf()+r*s),i&&n.updateOffset(e,a||o))}Zt.fn=Rt.prototype,Zt.invalid=function(){return Zt(NaN)};var Bt=qt(1,\"add\"),Qt=qt(-1,\"subtract\");function Xt(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(n,\"months\");return-(n+(t-s<0?(t-s)/(s-e.clone().add(n-1,\"months\")):(t-s)/(e.clone().add(n+1,\"months\")-s)))||0}function Kt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=dt(e))&&(this._locale=t),this)}n.defaultFormat=\"YYYY-MM-DDTHH:mm:ssZ\",n.defaultFormatUtc=\"YYYY-MM-DDTHH:mm:ss[Z]\";var en=D(\"moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.\",function(e){return void 0===e?this.localeData():this.locale(e)});function tn(){return this._locale}var nn=1e3,sn=60*nn,rn=60*sn,an=3506328*rn;function on(e,t){return(e%t+t)%t}function un(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-an:new Date(e,t,n).valueOf()}function ln(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-an:Date.UTC(e,t,n)}function hn(e,t){I(0,[e,e.length],0,t)}function dn(e,t,n,s,i){var r;return null==e?Ae(this,s,i).year:(t>(r=je(e,s,i))&&(t=r),function(e,t,n,s,i){var r=Ie(e,t,n,s,i),a=Ve(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}.call(this,e,t,n,s,i))}I(0,[\"gg\",2],0,function(){return this.weekYear()%100}),I(0,[\"GG\",2],0,function(){return this.isoWeekYear()%100}),hn(\"gggg\",\"weekYear\"),hn(\"ggggg\",\"weekYear\"),hn(\"GGGG\",\"isoWeekYear\"),hn(\"GGGGG\",\"isoWeekYear\"),C(\"weekYear\",\"gg\"),C(\"isoWeekYear\",\"GG\"),F(\"weekYear\",1),F(\"isoWeekYear\",1),ue(\"G\",se),ue(\"g\",se),ue(\"GG\",B,z),ue(\"gg\",B,z),ue(\"GGGG\",ee,q),ue(\"gggg\",ee,q),ue(\"GGGGG\",te,J),ue(\"ggggg\",te,J),fe([\"gggg\",\"ggggg\",\"GGGG\",\"GGGGG\"],function(e,t,n,s){t[s.substr(0,2)]=M(e)}),fe([\"gg\",\"GG\"],function(e,t,s,i){t[i]=n.parseTwoDigitYear(e)}),I(\"Q\",0,\"Qo\",\"quarter\"),C(\"quarter\",\"Q\"),F(\"quarter\",7),ue(\"Q\",Z),ce(\"Q\",function(e,t){t[ye]=3*(M(e)-1)}),I(\"D\",[\"DD\",2],\"Do\",\"date\"),C(\"date\",\"D\"),F(\"date\",9),ue(\"D\",B),ue(\"DD\",B,z),ue(\"Do\",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),ce([\"D\",\"DD\"],ge),ce(\"Do\",function(e,t){t[ge]=M(e.match(B)[0])});var cn=be(\"Date\",!0);I(\"DDD\",[\"DDDD\",3],\"DDDo\",\"dayOfYear\"),C(\"dayOfYear\",\"DDD\"),F(\"dayOfYear\",4),ue(\"DDD\",K),ue(\"DDDD\",$),ce([\"DDD\",\"DDDD\"],function(e,t,n){n._dayOfYear=M(e)}),I(\"m\",[\"mm\",2],0,\"minute\"),C(\"minute\",\"m\"),F(\"minute\",14),ue(\"m\",B),ue(\"mm\",B,z),ce([\"m\",\"mm\"],pe);var fn=be(\"Minutes\",!1);I(\"s\",[\"ss\",2],0,\"second\"),C(\"second\",\"s\"),F(\"second\",15),ue(\"s\",B),ue(\"ss\",B,z),ce([\"s\",\"ss\"],we);var mn,_n=be(\"Seconds\",!1);for(I(\"S\",0,0,function(){return~~(this.millisecond()/100)}),I(0,[\"SS\",2],0,function(){return~~(this.millisecond()/10)}),I(0,[\"SSS\",3],0,\"millisecond\"),I(0,[\"SSSS\",4],0,function(){return 10*this.millisecond()}),I(0,[\"SSSSS\",5],0,function(){return 100*this.millisecond()}),I(0,[\"SSSSSS\",6],0,function(){return 1e3*this.millisecond()}),I(0,[\"SSSSSSS\",7],0,function(){return 1e4*this.millisecond()}),I(0,[\"SSSSSSSS\",8],0,function(){return 1e5*this.millisecond()}),I(0,[\"SSSSSSSSS\",9],0,function(){return 1e6*this.millisecond()}),C(\"millisecond\",\"ms\"),F(\"millisecond\",16),ue(\"S\",K,Z),ue(\"SS\",K,z),ue(\"SSS\",K,$),mn=\"SSSS\";mn.length<=9;mn+=\"S\")ue(mn,ne);function yn(e,t){t[Me]=M(1e3*(\"0.\"+e))}for(mn=\"S\";mn.length<=9;mn+=\"S\")ce(mn,yn);var gn=be(\"Milliseconds\",!1);I(\"z\",0,0,\"zoneAbbr\"),I(\"zz\",0,0,\"zoneName\");var vn=v.prototype;function pn(e){return e}vn.add=Bt,vn.calendar=function(e,t){var s=e||xt(),i=Vt(s,this).startOf(\"day\"),r=n.calendarFormat(this,i)||\"sameElse\",a=t&&(b(t[r])?t[r].call(this,s):t[r]);return this.format(a||this.localeData().calendar(r,this,xt(s)))},vn.clone=function(){return new v(this)},vn.diff=function(e,t,n){var s,i,r;if(!this.isValid())return NaN;if(!(s=Vt(e,this)).isValid())return NaN;switch(i=6e4*(s.utcOffset()-this.utcOffset()),t=H(t)){case\"year\":r=Xt(this,s)/12;break;case\"month\":r=Xt(this,s);break;case\"quarter\":r=Xt(this,s)/3;break;case\"second\":r=(this-s)/1e3;break;case\"minute\":r=(this-s)/6e4;break;case\"hour\":r=(this-s)/36e5;break;case\"day\":r=(this-s-i)/864e5;break;case\"week\":r=(this-s-i)/6048e5;break;default:r=this-s}return n?r:w(r)},vn.endOf=function(e){var t;if(void 0===(e=H(e))||\"millisecond\"===e||!this.isValid())return this;var s=this._isUTC?ln:un;switch(e){case\"year\":t=s(this.year()+1,0,1)-1;break;case\"quarter\":t=s(this.year(),this.month()-this.month()%3+3,1)-1;break;case\"month\":t=s(this.year(),this.month()+1,1)-1;break;case\"week\":t=s(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case\"isoWeek\":t=s(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case\"day\":case\"date\":t=s(this.year(),this.month(),this.date()+1)-1;break;case\"hour\":t=this._d.valueOf(),t+=rn-on(t+(this._isUTC?0:this.utcOffset()*sn),rn)-1;break;case\"minute\":t=this._d.valueOf(),t+=sn-on(t,sn)-1;break;case\"second\":t=this._d.valueOf(),t+=nn-on(t,nn)-1}return this._d.setTime(t),n.updateOffset(this,!0),this},vn.format=function(e){e||(e=this.isUtc()?n.defaultFormatUtc:n.defaultFormat);var t=A(this,e);return this.localeData().postformat(t)},vn.from=function(e,t){return this.isValid()&&(p(e)&&e.isValid()||xt(e).isValid())?Zt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},vn.fromNow=function(e){return this.from(xt(),e)},vn.to=function(e,t){return this.isValid()&&(p(e)&&e.isValid()||xt(e).isValid())?Zt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},vn.toNow=function(e){return this.to(xt(),e)},vn.get=function(e){return b(this[e=H(e)])?this[e]():this},vn.invalidAt=function(){return c(this).overflow},vn.isAfter=function(e,t){var n=p(e)?e:xt(e);return!(!this.isValid()||!n.isValid())&&(\"millisecond\"===(t=H(t)||\"millisecond\")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},vn.isBefore=function(e,t){var n=p(e)?e:xt(e);return!(!this.isValid()||!n.isValid())&&(\"millisecond\"===(t=H(t)||\"millisecond\")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},vn.isBetween=function(e,t,n,s){var i=p(e)?e:xt(e),r=p(t)?t:xt(t);return!!(this.isValid()&&i.isValid()&&r.isValid())&&(\"(\"===(s=s||\"()\")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(\")\"===s[1]?this.isBefore(r,n):!this.isAfter(r,n))},vn.isSame=function(e,t){var n,s=p(e)?e:xt(e);return!(!this.isValid()||!s.isValid())&&(\"millisecond\"===(t=H(t)||\"millisecond\")?this.valueOf()===s.valueOf():(n=s.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},vn.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},vn.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},vn.isValid=function(){return f(this)},vn.lang=en,vn.locale=Kt,vn.localeData=tn,vn.max=Wt,vn.min=Pt,vn.parsingFlags=function(){return h({},c(this))},vn.set=function(e,t){if(\"object\"==typeof e)for(var n=function(e){var t=[];for(var n in e)t.push({unit:n,priority:U[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}(e=R(e)),s=0;s<n.length;s++)this[n[s].unit](e[n[s].unit]);else if(b(this[e=H(e)]))return this[e](t);return this},vn.startOf=function(e){var t;if(void 0===(e=H(e))||\"millisecond\"===e||!this.isValid())return this;var s=this._isUTC?ln:un;switch(e){case\"year\":t=s(this.year(),0,1);break;case\"quarter\":t=s(this.year(),this.month()-this.month()%3,1);break;case\"month\":t=s(this.year(),this.month(),1);break;case\"week\":t=s(this.year(),this.month(),this.date()-this.weekday());break;case\"isoWeek\":t=s(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case\"day\":case\"date\":t=s(this.year(),this.month(),this.date());break;case\"hour\":t=this._d.valueOf(),t-=on(t+(this._isUTC?0:this.utcOffset()*sn),rn);break;case\"minute\":t=this._d.valueOf(),t-=on(t,sn);break;case\"second\":t=this._d.valueOf(),t-=on(t,nn)}return this._d.setTime(t),n.updateOffset(this,!0),this},vn.subtract=Qt,vn.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},vn.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},vn.toDate=function(){return new Date(this.valueOf())},vn.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?A(n,t?\"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]\":\"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ\"):b(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace(\"Z\",A(n,\"Z\")):A(n,t?\"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]\":\"YYYY-MM-DD[T]HH:mm:ss.SSSZ\")},vn.inspect=function(){if(!this.isValid())return\"moment.invalid(/* \"+this._i+\" */)\";var e=\"moment\",t=\"\";this.isLocal()||(e=0===this.utcOffset()?\"moment.utc\":\"moment.parseZone\",t=\"Z\");var n=\"[\"+e+'(\"]',s=0<=this.year()&&this.year()<=9999?\"YYYY\":\"YYYYYY\",i=t+'[\")]';return this.format(n+s+\"-MM-DD[T]HH:mm:ss.SSS\"+i)},vn.toJSON=function(){return this.isValid()?this.toISOString():null},vn.toString=function(){return this.clone().locale(\"en\").format(\"ddd MMM DD YYYY HH:mm:ss [GMT]ZZ\")},vn.unix=function(){return Math.floor(this.valueOf()/1e3)},vn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},vn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},vn.year=Te,vn.isLeapYear=function(){return Ye(this.year())},vn.weekYear=function(e){return dn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},vn.isoWeekYear=function(e){return dn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},vn.quarter=vn.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},vn.month=Fe,vn.daysInMonth=function(){return We(this.year(),this.month())},vn.week=vn.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),\"d\")},vn.isoWeek=vn.isoWeeks=function(e){var t=Ae(this,1,4).week;return null==e?t:this.add(7*(e-t),\"d\")},vn.weeksInYear=function(){var e=this.localeData()._week;return je(this.year(),e.dow,e.doy)},vn.isoWeeksInYear=function(){return je(this.year(),1,4)},vn.date=cn,vn.day=vn.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){return\"string\"!=typeof e?e:isNaN(e)?\"number\"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,\"d\")):t},vn.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,\"d\")},vn.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=function(e,t){return\"string\"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},vn.dayOfYear=function(e){var t=Math.round((this.clone().startOf(\"day\")-this.clone().startOf(\"year\"))/864e5)+1;return null==e?t:this.add(e-t,\"d\")},vn.hour=vn.hours=st,vn.minute=vn.minutes=fn,vn.second=vn.seconds=_n,vn.millisecond=vn.milliseconds=gn,vn.utcOffset=function(e,t,s){var i,r=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if(\"string\"==typeof e){if(null===(e=Gt(re,e)))return this}else Math.abs(e)<16&&!s&&(e*=60);return!this._isUTC&&t&&(i=Et(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,\"m\"),r!==e&&(!t||this._changeInProgress?Jt(this,Zt(e-r,\"m\"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:Et(this)},vn.utc=function(e){return this.utcOffset(0,e)},vn.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Et(this),\"m\")),this},vn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if(\"string\"==typeof this._i){var e=Gt(ie,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},vn.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?xt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},vn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},vn.isLocal=function(){return!!this.isValid()&&!this._isUTC},vn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},vn.isUtc=It,vn.isUTC=It,vn.zoneAbbr=function(){return this._isUTC?\"UTC\":\"\"},vn.zoneName=function(){return this._isUTC?\"Coordinated Universal Time\":\"\"},vn.dates=D(\"dates accessor is deprecated. Use date instead.\",cn),vn.months=D(\"months accessor is deprecated. Use month instead\",Fe),vn.years=D(\"years accessor is deprecated. Use year instead\",Te),vn.zone=D(\"moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/\",function(e,t){return null!=e?(\"string\"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),vn.isDSTShifted=D(\"isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information\",function(){if(!r(this._isDSTShifted))return this._isDSTShifted;var e={};if(y(e,this),(e=Tt(e))._a){var t=e._isUTC?d(e._a):xt(e._a);this._isDSTShifted=this.isValid()&&k(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted});var wn=P.prototype;function Mn(e,t,n,s){var i=dt(),r=d().set(s,t);return i[n](r,e)}function kn(e,t,n){if(a(e)&&(t=e,e=void 0),e=e||\"\",null!=t)return Mn(e,t,n,\"month\");var s,i=[];for(s=0;s<12;s++)i[s]=Mn(e,s,n,\"month\");return i}function Sn(e,t,n,s){\"boolean\"==typeof e?(a(t)&&(n=t,t=void 0),t=t||\"\"):(n=t=e,e=!1,a(t)&&(n=t,t=void 0),t=t||\"\");var i,r=dt(),o=e?r._week.dow:0;if(null!=n)return Mn(t,(n+o)%7,s,\"day\");var u=[];for(i=0;i<7;i++)u[i]=Mn(t,(i+o)%7,s,\"day\");return u}wn.calendar=function(e,t,n){var s=this._calendar[e]||this._calendar.sameElse;return b(s)?s.call(t,n):s},wn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},wn.invalidDate=function(){return this._invalidDate},wn.ordinal=function(e){return this._ordinal.replace(\"%d\",e)},wn.preparse=pn,wn.postformat=pn,wn.relativeTime=function(e,t,n,s){var i=this._relativeTime[n];return b(i)?i(e,t,n,s):i.replace(/%d/i,e)},wn.pastFuture=function(e,t){var n=this._relativeTime[e>0?\"future\":\"past\"];return b(n)?n(t):n.replace(/%s/i,t)},wn.set=function(e){var t,n;for(n in e)b(t=e[n])?this[n]=t:this[\"_\"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+\"|\"+/\\d{1,2}/.source)},wn.months=function(e,t){return e?s(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Ce).test(t)?\"format\":\"standalone\"][e.month()]:s(this._months)?this._months:this._months.standalone},wn.monthsShort=function(e,t){return e?s(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Ce.test(t)?\"format\":\"standalone\"][e.month()]:s(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},wn.monthsParse=function(e,t,n){var s,i,r;if(this._monthsParseExact)return function(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)r=d([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(r,\"\").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(r,\"\").toLocaleLowerCase();return n?\"MMM\"===t?-1!==(i=Oe.call(this._shortMonthsParse,a))?i:null:-1!==(i=Oe.call(this._longMonthsParse,a))?i:null:\"MMM\"===t?-1!==(i=Oe.call(this._shortMonthsParse,a))?i:-1!==(i=Oe.call(this._longMonthsParse,a))?i:null:-1!==(i=Oe.call(this._longMonthsParse,a))?i:-1!==(i=Oe.call(this._shortMonthsParse,a))?i:null}.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(i=d([2e3,s]),n&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp(\"^\"+this.months(i,\"\").replace(\".\",\"\")+\"$\",\"i\"),this._shortMonthsParse[s]=new RegExp(\"^\"+this.monthsShort(i,\"\").replace(\".\",\"\")+\"$\",\"i\")),n||this._monthsParse[s]||(r=\"^\"+this.months(i,\"\")+\"|^\"+this.monthsShort(i,\"\"),this._monthsParse[s]=new RegExp(r.replace(\".\",\"\"),\"i\")),n&&\"MMMM\"===t&&this._longMonthsParse[s].test(e))return s;if(n&&\"MMM\"===t&&this._shortMonthsParse[s].test(e))return s;if(!n&&this._monthsParse[s].test(e))return s}},wn.monthsRegex=function(e){return this._monthsParseExact?(l(this,\"_monthsRegex\")||Ge.call(this),e?this._monthsStrictRegex:this._monthsRegex):(l(this,\"_monthsRegex\")||(this._monthsRegex=Ne),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},wn.monthsShortRegex=function(e){return this._monthsParseExact?(l(this,\"_monthsRegex\")||Ge.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(l(this,\"_monthsShortRegex\")||(this._monthsShortRegex=Le),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},wn.week=function(e){return Ae(e,this._week.dow,this._week.doy).week},wn.firstDayOfYear=function(){return this._week.doy},wn.firstDayOfWeek=function(){return this._week.dow},wn.weekdays=function(e,t){var n=s(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?\"format\":\"standalone\"];return!0===e?Ze(n,this._week.dow):e?n[e.day()]:n},wn.weekdaysMin=function(e){return!0===e?Ze(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},wn.weekdaysShort=function(e){return!0===e?Ze(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},wn.weekdaysParse=function(e,t,n){var s,i,r;if(this._weekdaysParseExact)return function(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)r=d([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(r,\"\").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(r,\"\").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(r,\"\").toLocaleLowerCase();return n?\"dddd\"===t?-1!==(i=Oe.call(this._weekdaysParse,a))?i:null:\"ddd\"===t?-1!==(i=Oe.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=Oe.call(this._minWeekdaysParse,a))?i:null:\"dddd\"===t?-1!==(i=Oe.call(this._weekdaysParse,a))?i:-1!==(i=Oe.call(this._shortWeekdaysParse,a))?i:-1!==(i=Oe.call(this._minWeekdaysParse,a))?i:null:\"ddd\"===t?-1!==(i=Oe.call(this._shortWeekdaysParse,a))?i:-1!==(i=Oe.call(this._weekdaysParse,a))?i:-1!==(i=Oe.call(this._minWeekdaysParse,a))?i:null:-1!==(i=Oe.call(this._minWeekdaysParse,a))?i:-1!==(i=Oe.call(this._weekdaysParse,a))?i:-1!==(i=Oe.call(this._shortWeekdaysParse,a))?i:null}.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(i=d([2e3,1]).day(s),n&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp(\"^\"+this.weekdays(i,\"\").replace(\".\",\"\\\\.?\")+\"$\",\"i\"),this._shortWeekdaysParse[s]=new RegExp(\"^\"+this.weekdaysShort(i,\"\").replace(\".\",\"\\\\.?\")+\"$\",\"i\"),this._minWeekdaysParse[s]=new RegExp(\"^\"+this.weekdaysMin(i,\"\").replace(\".\",\"\\\\.?\")+\"$\",\"i\")),this._weekdaysParse[s]||(r=\"^\"+this.weekdays(i,\"\")+\"|^\"+this.weekdaysShort(i,\"\")+\"|^\"+this.weekdaysMin(i,\"\"),this._weekdaysParse[s]=new RegExp(r.replace(\".\",\"\"),\"i\")),n&&\"dddd\"===t&&this._fullWeekdaysParse[s].test(e))return s;if(n&&\"ddd\"===t&&this._shortWeekdaysParse[s].test(e))return s;if(n&&\"dd\"===t&&this._minWeekdaysParse[s].test(e))return s;if(!n&&this._weekdaysParse[s].test(e))return s}},wn.weekdaysRegex=function(e){return this._weekdaysParseExact?(l(this,\"_weekdaysRegex\")||Xe.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(l(this,\"_weekdaysRegex\")||(this._weekdaysRegex=Je),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},wn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(l(this,\"_weekdaysRegex\")||Xe.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(l(this,\"_weekdaysShortRegex\")||(this._weekdaysShortRegex=Be),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},wn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(l(this,\"_weekdaysRegex\")||Xe.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(l(this,\"_weekdaysMinRegex\")||(this._weekdaysMinRegex=Qe),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},wn.isPM=function(e){return\"p\"===(e+\"\").toLowerCase().charAt(0)},wn.meridiem=function(e,t,n){return e>11?n?\"pm\":\"PM\":n?\"am\":\"AM\"},lt(\"en\",{dayOfMonthOrdinalParse:/\\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===M(e%100/10)?\"th\":1===t?\"st\":2===t?\"nd\":3===t?\"rd\":\"th\")}}),n.lang=D(\"moment.lang is deprecated. Use moment.locale instead.\",lt),n.langData=D(\"moment.langData is deprecated. Use moment.localeData instead.\",dt);var Dn=Math.abs;function Yn(e,t,n,s){var i=Zt(t,n);return e._milliseconds+=s*i._milliseconds,e._days+=s*i._days,e._months+=s*i._months,e._bubble()}function On(e){return e<0?Math.floor(e):Math.ceil(e)}function Tn(e){return 4800*e/146097}function bn(e){return 146097*e/4800}function xn(e){return function(){return this.as(e)}}var Pn=xn(\"ms\"),Wn=xn(\"s\"),Cn=xn(\"m\"),Hn=xn(\"h\"),Rn=xn(\"d\"),Un=xn(\"w\"),Fn=xn(\"M\"),Ln=xn(\"Q\"),Nn=xn(\"y\");function Gn(e){return function(){return this.isValid()?this._data[e]:NaN}}var Vn=Gn(\"milliseconds\"),En=Gn(\"seconds\"),In=Gn(\"minutes\"),An=Gn(\"hours\"),jn=Gn(\"days\"),Zn=Gn(\"months\"),zn=Gn(\"years\");var $n=Math.round,qn={ss:44,s:45,m:45,h:22,d:26,M:11};var Jn=Math.abs;function Bn(e){return(e>0)-(e<0)||+e}function Qn(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=Jn(this._milliseconds)/1e3,s=Jn(this._days),i=Jn(this._months);t=w((e=w(n/60))/60),n%=60,e%=60;var r=w(i/12),a=i%=12,o=s,u=t,l=e,h=n?n.toFixed(3).replace(/\\.?0+$/,\"\"):\"\",d=this.asSeconds();if(!d)return\"P0D\";var c=d<0?\"-\":\"\",f=Bn(this._months)!==Bn(d)?\"-\":\"\",m=Bn(this._days)!==Bn(d)?\"-\":\"\",_=Bn(this._milliseconds)!==Bn(d)?\"-\":\"\";return c+\"P\"+(r?f+r+\"Y\":\"\")+(a?f+a+\"M\":\"\")+(o?m+o+\"D\":\"\")+(u||l||h?\"T\":\"\")+(u?_+u+\"H\":\"\")+(l?_+l+\"M\":\"\")+(h?_+h+\"S\":\"\")}var Xn=Rt.prototype;return Xn.isValid=function(){return this._isValid},Xn.abs=function(){var e=this._data;return this._milliseconds=Dn(this._milliseconds),this._days=Dn(this._days),this._months=Dn(this._months),e.milliseconds=Dn(e.milliseconds),e.seconds=Dn(e.seconds),e.minutes=Dn(e.minutes),e.hours=Dn(e.hours),e.months=Dn(e.months),e.years=Dn(e.years),this},Xn.add=function(e,t){return Yn(this,e,t,1)},Xn.subtract=function(e,t){return Yn(this,e,t,-1)},Xn.as=function(e){if(!this.isValid())return NaN;var t,n,s=this._milliseconds;if(\"month\"===(e=H(e))||\"quarter\"===e||\"year\"===e)switch(t=this._days+s/864e5,n=this._months+Tn(t),e){case\"month\":return n;case\"quarter\":return n/3;case\"year\":return n/12}else switch(t=this._days+Math.round(bn(this._months)),e){case\"week\":return t/7+s/6048e5;case\"day\":return t+s/864e5;case\"hour\":return 24*t+s/36e5;case\"minute\":return 1440*t+s/6e4;case\"second\":return 86400*t+s/1e3;case\"millisecond\":return Math.floor(864e5*t)+s;default:throw new Error(\"Unknown unit \"+e)}},Xn.asMilliseconds=Pn,Xn.asSeconds=Wn,Xn.asMinutes=Cn,Xn.asHours=Hn,Xn.asDays=Rn,Xn.asWeeks=Un,Xn.asMonths=Fn,Xn.asQuarters=Ln,Xn.asYears=Nn,Xn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*M(this._months/12):NaN},Xn._bubble=function(){var e,t,n,s,i,r=this._milliseconds,a=this._days,o=this._months,u=this._data;return r>=0&&a>=0&&o>=0||r<=0&&a<=0&&o<=0||(r+=864e5*On(bn(o)+a),a=0,o=0),u.milliseconds=r%1e3,e=w(r/1e3),u.seconds=e%60,t=w(e/60),u.minutes=t%60,n=w(t/60),u.hours=n%24,o+=i=w(Tn(a+=w(n/24))),a-=On(bn(i)),s=w(o/12),o%=12,u.days=a,u.months=o,u.years=s,this},Xn.clone=function(){return Zt(this)},Xn.get=function(e){return e=H(e),this.isValid()?this[e+\"s\"]():NaN},Xn.milliseconds=Vn,Xn.seconds=En,Xn.minutes=In,Xn.hours=An,Xn.days=jn,Xn.weeks=function(){return w(this.days()/7)},Xn.months=Zn,Xn.years=zn,Xn.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=function(e,t,n){var s=Zt(e).abs(),i=$n(s.as(\"s\")),r=$n(s.as(\"m\")),a=$n(s.as(\"h\")),o=$n(s.as(\"d\")),u=$n(s.as(\"M\")),l=$n(s.as(\"y\")),h=i<=qn.ss&&[\"s\",i]||i<qn.s&&[\"ss\",i]||r<=1&&[\"m\"]||r<qn.m&&[\"mm\",r]||a<=1&&[\"h\"]||a<qn.h&&[\"hh\",a]||o<=1&&[\"d\"]||o<qn.d&&[\"dd\",o]||u<=1&&[\"M\"]||u<qn.M&&[\"MM\",u]||l<=1&&[\"y\"]||[\"yy\",l];return h[2]=t,h[3]=+e>0,h[4]=n,function(e,t,n,s,i){return i.relativeTime(t||1,!!n,e,s)}.apply(null,h)}(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)},Xn.toISOString=Qn,Xn.toString=Qn,Xn.toJSON=Qn,Xn.locale=Kt,Xn.localeData=tn,Xn.toIsoString=D(\"toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)\",Qn),Xn.lang=en,I(\"X\",0,0,\"unix\"),I(\"x\",0,0,\"valueOf\"),ue(\"x\",se),ue(\"X\",/[+-]?\\d+(\\.\\d{1,3})?/),ce(\"X\",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),ce(\"x\",function(e,t,n){n._d=new Date(M(e))}),n.version=\"2.24.0\",e=xt,n.fn=vn,n.min=function(){return Ct(\"isBefore\",[].slice.call(arguments,0))},n.max=function(){return Ct(\"isAfter\",[].slice.call(arguments,0))},n.now=function(){return Date.now?Date.now():+new Date},n.utc=d,n.unix=function(e){return xt(1e3*e)},n.months=function(e,t){return kn(e,t,\"months\")},n.isDate=o,n.locale=lt,n.invalid=m,n.duration=Zt,n.isMoment=p,n.weekdays=function(e,t,n){return Sn(e,t,n,\"weekdays\")},n.parseZone=function(){return xt.apply(null,arguments).parseZone()},n.localeData=dt,n.isDuration=Ut,n.monthsShort=function(e,t){return kn(e,t,\"monthsShort\")},n.weekdaysMin=function(e,t,n){return Sn(e,t,n,\"weekdaysMin\")},n.defineLocale=ht,n.updateLocale=function(e,t){if(null!=t){var n,s,i=it;null!=(s=ut(e))&&(i=s._config),(n=new P(t=x(i,t))).parentLocale=rt[e],rt[e]=n,lt(e)}else null!=rt[e]&&(null!=rt[e].parentLocale?rt[e]=rt[e].parentLocale:null!=rt[e]&&delete rt[e]);return rt[e]},n.locales=function(){return Y(rt)},n.weekdaysShort=function(e,t,n){return Sn(e,t,n,\"weekdaysShort\")},n.normalizeUnits=H,n.relativeTimeRounding=function(e){return void 0===e?$n:\"function\"==typeof e&&($n=e,!0)},n.relativeTimeThreshold=function(e,t){return void 0!==qn[e]&&(void 0===t?qn[e]:(qn[e]=t,\"s\"===e&&(qn.ss=t-1),!0))},n.calendarFormat=function(e,t){var n=e.diff(t,\"days\",!0);return n<-6?\"sameElse\":n<-1?\"lastWeek\":n<0?\"lastDay\":n<1?\"sameDay\":n<2?\"nextDay\":n<7?\"nextWeek\":\"sameElse\"},n.prototype=vn,n.HTML5_FMT={DATETIME_LOCAL:\"YYYY-MM-DDTHH:mm\",DATETIME_LOCAL_SECONDS:\"YYYY-MM-DDTHH:mm:ss\",DATETIME_LOCAL_MS:\"YYYY-MM-DDTHH:mm:ss.SSS\",DATE:\"YYYY-MM-DD\",TIME:\"HH:mm\",TIME_SECONDS:\"HH:mm:ss\",TIME_MS:\"HH:mm:ss.SSS\",WEEK:\"GGGG-[W]WW\",MONTH:\"YYYY-MM\"},n});","node_modules/h5.main/lib/index.js":"\"use strict\";const DEFAULT_OPTIONS={moduleStartTimeout:2e3,rootPath:process.cwd(),env:process.env.NODE_ENV||\"development\",startTime:Date.now(),id:\"nonameapp\"},step=require(\"h5.step\"),{MessageBroker:MessageBroker}=require(\"h5.pubsub\"),appUtils=require(\"./utils/app\"),logUtils=require(\"./utils/log\");module.exports=((e,o)=>{function t(o,t){const s=\"string\"==typeof t.requiredModules?t.requiredModules.split(\" \"):t.requiredModules;Array.isArray(s)&&s.forEach(t=>{const s=o.config[`${t}Id`],p=e[s];if(!p)throw new Error(`[${o.name}] module requires the [${t}] module!`);o[t]=p})}function s(o,t){Object.keys(t.optionalModules||{}).forEach(s=>{const p=t.optionalModules[s],n=new Map;s.split(\" \").forEach(e=>{n.set(e,o.config[`${e}Id`])}),e.onModuleReady(Array.from(n.values()),()=>{n.forEach((t,s)=>{o[s]=e[t]}),Array.isArray(p)?p.forEach(t=>t(e,o)):\"function\"==typeof p&&p(e,o)})})}function p(o,p,n){return function(){p.info(\"Starting...\"),e.main.startedModules.push(p.name),e[p.name]=p,e.broker.publish(\"app.modules.starting\",{module:p,appModule:n}),n.start&&3===n.start.length?function(o,p,n){const u=setTimeout(()=>{throw new Error(`[${o.name}] module failed to start in the allowed time!`)},e.options.moduleStartTimeout);t(o,p),s(o,p),p.start(e,o,t=>{if(clearTimeout(u),t)throw t;e.broker.publish(\"app.modules.started\",{module:o,appModule:p}),setImmediate(n)})}(p,n,this.next()):function(o,p,n){t(o,p),s(o,p),p.start&&p.start(e,o),e.broker.publish(\"app.modules.started\",{module:o,appModule:p}),setImmediate(n)}(p,n,this.next())}}null!==e&&\"object\"==typeof e||(e={}),null!==e.options&&\"object\"==typeof e.options||(e.options={}),e.options={...DEFAULT_OPTIONS,...e.options},e.broker=new MessageBroker,e.main={modules:{},appModules:{},setUpModules:[],startedModules:[]},appUtils.extend(e),logUtils.extend(e,{appId:e.options.id}),step(function(){e.info(\"Starting...\");const t=[];o.forEach(function(o,t){const s=t.name;e.logger.extend(t,{module:s}),t.info(\"Setting up...\");const n=require(t.path);null!==n&&\"object\"==typeof n?(t.config||(t.config={}),null!=n.DEFAULT_CONFIG&&Object.keys(n.DEFAULT_CONFIG).forEach(e=>{void 0===t.config[e]&&(t.config[e]=n.DEFAULT_CONFIG[e])}),e.main.modules[s]=t,e.main.appModules[s]=n,e.broker.publish(\"app.modules.settingUp\",{module:t,appModule:n}),\"function\"==typeof n.setUp&&n.setUp(e,t),e.broker.publish(\"app.modules.setUp\",{module:t,appModule:n}),\"function\"==typeof n.onModuleSetUp&&(e.main.setUpModules.forEach(o=>{n.onModuleSetUp(e,{moduleName:o,module:t,appModule:n,setUpModule:e.main.modules[o],setUpAppModule:e.main.appModules[o]})}),e.broker.subscribe(\"app.modules.setUp\",o=>{n.onModuleSetUp(e,{module:t,appModule:n,setUpModule:o.module,setUpAppModule:o.appModule})})),e.main.setUpModules.push(s),o.push(p(0,t,n))):t.info(\"Skipping empty module.\")}.bind(null,t)),t.push(this.next()),step(t)},function(){const o=e.options.env,t=Date.now()-e.options.startTime;e.info(\"Started.\",{env:o,startTime:t}),e.broker.publish(\"app.started\",{id:e.options.id,env:o,time:t})})});","node_modules/h5.step/lib/index.js":"module.exports=step;var ACTION_NONE=\"none\",ACTION_NEXT=\"next\",ACTION_SKIP=\"skip\",ACTION_DONE=\"done\",ACTION_GROUP=\"group\",ACTION_PARALLEL=\"parallel\",slice=Array.prototype.slice;function step(){var n=Array.isArray(arguments[0])?arguments[0]:arguments,r=n.length;if(0!==r){var e=-1,l=ACTION_NONE,t=null,u=!1,a=null,N=0,c=0,A=null,O={};Object.defineProperties(O,{next:{value:function(){return-1!==e&&(assertAction(ACTION_NEXT,l),l=ACTION_NEXT),i}},skip:{value:function(){assertAction(ACTION_SKIP,l),l=ACTION_SKIP,t=arguments}},done:{value:function(){assertAction(ACTION_DONE,l),l=ACTION_DONE,t=arguments}},parallel:{value:function(){l===ACTION_PARALLEL?++N:(assertAction(ACTION_PARALLEL,l),l=ACTION_PARALLEL,N=1,c=0,A=[]);var n=N-1;return function(){A[n]=slice.call(arguments),++c,l===ACTION_NONE&&c===N&&s()}}},group:{value:function(){l===ACTION_GROUP?++N:(assertAction(ACTION_GROUP,l),l=ACTION_GROUP,N=1,c=0,A=[]);var n=N-1;return function(){A[n]=slice.call(arguments),++c,l===ACTION_NONE&&c===N&&T()}}}}),i()}function i(){if(l!==ACTION_NONE){if(u)return;return u=!0,a=slice.call(arguments),process.nextTick(function(){l=ACTION_NONE;var n=a;return u=!1,a=null,i.apply(null,n)})}if(!(++e>=r)){var t=n[e].apply(O,arguments);t&&t.then&&t.catch?t.then(function(n){o(null,n)}).catch(function(n){o(n,null)}):o()}}function o(n,u){var a=l,A=t;switch(l=ACTION_NONE,t=null,a){case ACTION_NEXT:return;case ACTION_NONE:return i(n,u);case ACTION_SKIP:var O=r-1;if(e<O)return e=O-1,i.apply(null,slice.call(A));break;case ACTION_DONE:if(0===A.length)return;var o=A[0];if(\"function\"!=typeof o)return;return o.apply(null,slice.call(A,1));case ACTION_PARALLEL:if(N===c)return s();break;case ACTION_GROUP:if(N===c)return T()}}function s(){for(var n=[null],r=0;r<N;++r){var e=A[r];null===n[0]&&e[0]&&(n[0]=e[0]),n.push(e[1])}i.apply(null,n)}function T(){for(var n=null,r=[],e=0;e<N;++e){var l=A[e];null===n&&l[0]&&(n=l[0]),r.push(l[1])}i.call(null,n,r)}}function assertAction(n,r){if(r!==ACTION_NONE)throw new Error(n+\"() cannot be used because \"+r+\"() was already invoked.\")}","node_modules/h5.pubsub/lib/index.js":"\"use strict\";exports.MessageBroker=require(\"./MessageBroker\");","node_modules/h5.main/lib/utils/app.js":"\"use strict\";const path=require(\"path\");exports.extend=(t=>{t.createError=((t,...e)=>{const o=new Error(t);for(let t=0;t<e.length;++t){const n=e[t];switch(typeof n){case\"string\":o.code=n;break;case\"number\":o.statusCode=n;break;case\"object\":Object.assign(o,n)}}return o}),t.pathTo=((...e)=>path.join.apply(null,t.options&&t.options.rootPath?[t.options.rootPath].concat(e):e)),t.onModuleReady=((e,o)=>{const n=[].concat(e);if(n.some(t=>!t))return;const s=t.broker.subscribe(\"app.modules.started\",({module:t})=>c(t.name));function c(e){if(t.main.startedModules.includes(e)){const t=n.indexOf(e);-1!==t&&(n.splice(t,1),0===n.length&&(s.cancel(),setImmediate(o)))}}[].concat(n).forEach(c)})});","node_modules/h5.main/lib/utils/log.js":"\"use strict\";const util=require(\"util\"),ENABLED={debug:!0,info:!0,warn:!0,error:!0},getCircularReplacer=()=>{const e=new WeakSet;return(r,t)=>{if(\"object\"==typeof t&&null!==t){if(e.has(t))return;e.add(t)}return t}};exports.write=(e=>console.log(JSON.stringify(e,getCircularReplacer()))),exports.extend=((e,r)=>(e.logger={enabled:ENABLED,extend:(e,t)=>exports.extend(e,{...r,...t}),create:e=>exports.extend({},{...r,...e})},[\"debug\",\"info\",\"warn\",\"error\"].forEach(t=>{e[t]=((...e)=>{if(!ENABLED[t])return;const s={severity:t,time:new Date,...r};for(let r=0;r<e.length;++r){const t=e[r];if(t){if(r>0&&\"string\"==typeof s.message&&s.message.includes(\"%\")){s.message=util.format.apply(util,[s.message,...e.slice(r)]);break}\"string\"==typeof t?s.message=t:t instanceof Error?s.error={stack:t.stack||t.message,...t}:Object.assign(s,t)}}exports.write(s)})}),e));","backend/node_modules/updater/index.js":"\"use strict\";const dgram=require(\"dgram\"),fs=require(\"fs\"),_=require(\"lodash\"),expressMiddleware=require(\"./expressMiddleware\");exports.DEFAULT_CONFIG={expressId:\"express\",sioId:\"sio\",packageJsonPath:\"package.json\",versionsKey:\"wmes\",backendVersionKey:\"backend\",frontendVersionKey:\"frontend\",manifestPath:null,restartDelay:15e3,errorTemplate:\"error503\",pull:{exe:\"git\",cwd:process.cwd(),timeout:6e4},manifests:[],captureSigint:!0,restartBroadcastPort:1337},exports.republishTopics=[\"updater.newVersion\"],exports.optionalModules={express:require(\"./routes\"),sio:require(\"./commands\")},exports.start=((e,n)=>{let r=null,t=null;function s(){return delete require.cache[n.config.packageJsonPath],n.package=require(n.config.packageJsonPath),n.package}function o(){r=null;const t=n.getVersions(!0),o=n.getBackendVersion(),a=n.getFrontendVersion();s();const c=n.getVersions(!1),d=n.getBackendVersion(),p=n.getFrontendVersion();d!==o?(n.info(\"Backend version changed.\",{oldBackendVersion:o,newBackendVersion:d}),i(o,d)):p!==a&&(n.info(\"Frontend version changed.\",{oldFrontendVersion:a,newFrontendVersion:p}),function(n,r){e.broker.publish(\"updater.newVersion\",{service:\"frontend\",oldVersion:n,newVersion:r})}(a,p)),_.forEach(c,(n,r)=>{const s=t[r]||0;n!==s&&e.broker.publish(\"updater.newVersion\",{service:r,oldVersion:s,newVersion:n})})}function i(r,s){return null===t&&(n.restarting=Date.now(),n.info(\"Restarting...\",{restartDelay:n.config.restartDelay/1e3}),t=setTimeout(a,n.config.restartDelay),e.broker.publish(\"updater.newVersion\",{service:\"backend\",oldVersion:r,newVersion:s,delay:n.config.restartDelay}),e.broker.publish(\"updater.restarting\",{appId:e.options.id,delay:n.config.restartDelay}),function(){const r=n.config.restartBroadcastPort;if(r<=0)return;const t=dgram.createSocket(\"udp4\");t.once(\"listening\",()=>t.setBroadcast(!0));const s=Buffer.from(JSON.stringify({topic:\"updater.restarting\",payload:{appId:e.options.id,delay:n.config.restartDelay}}),\"utf8\");t.send(s,0,s.length,r,\"255.255.255.255\",e=>{e?n.error(e,\"Failed to broadcast restarting message.\"):n.info(\"Broadcasted restarting message!\")})}(),!0)}function a(){n.info(\"Exiting the process...\"),setImmediate(process.exit.bind(process))}n.config.packageJsonPath=require.resolve(n.config.packageJsonPath),n.package=s(),n.restarting=0,n.manifest=n.config.manifestPath?fs.readFileSync(n.config.manifestPath,\"utf8\"):null,n.config.manifests.forEach(e=>_.defaults(e,{frontendVersionKey:n.config.frontendVersionKey,template:n.manifest})),n.getManifest=(e=>n.config.manifests.find(r=>{return(r.frontendVersionKey||n.config.frontendVersionKey)===e})),n.getAppTemplateData=((r,t,s)=>{const o=n.getManifest(r);if(!o)throw new Error(`Manifest not found for app [${r}]!`);t||(t={session:null,secure:!1});const i=t.session&&t.session.user,a=i&&i.locale?i.locale:\"pl\",c=(t.headers[\"user-agent\"]||\"\").match(/Chrome\\/([0-9]+)/),d=c?+c[1]:99;return{appCacheManifest:\"development\"!==e.options.env&&(d<70||t.secure)?o.path:\"\",appData:n.extendAppData(r,{LOCALE:JSON.stringify(a),...s}),mainJsFile:o.mainJsFile,mainCssFile:o.mainCssFile}}),n.extendAppData=((r,t)=>{t||(t={});const s=n.getManifest(r);return Object.assign(t,{ENV:JSON.stringify(e.options.env),VERSIONS:JSON.stringify(n.getVersions()),TIME:JSON.stringify(Date.now()),FRONTEND_SERVICE:JSON.stringify(r)}),e.broker.publish(\"app.prepareAppData\",{appId:r,appData:t}),s?(_.forEach(s.dictionaryModules,(n,r)=>{const s=e[r];if(!s)return;const o=s.models;0!==o.length?\"function\"==typeof o[0].toDictionaryObject?t[n]=JSON.stringify(_.invokeMap(o,\"toDictionaryObject\")):t[n]=JSON.stringify(o):t[n]=\"[]\"}),_.forEach(s.frontendAppData,(n,r)=>{t[r]=JSON.stringify(_.isFunction(n)?n(e):n)}),t):t}),n.getVersions=(e=>{n.package.updater||(n.package.updater={});const r=n.package.updater,t=n.config.versionsKey;return r[t]||(r[t]={},r[t][n.config.backendVersionKey]=-1,r[t][n.config.frontendVersionKey]=-1),r[t].package=n.package.version,!1===e?r[t]:_.cloneDeep(r[t])}),n.getBackendVersion=(e=>n.getVersions(!1)[e||n.config.backendVersionKey]),n.getFrontendVersion=(e=>n.getVersions(!1)[e||n.config.frontendVersionKey]),n.updateFrontendVersion=(e=>{const r=n.getVersions(!1);void 0===r[e]&&(e=n.config.frontendVersionKey),r[e]=Date.now()}),e.broker.subscribe(\"express.beforeMiddleware\").setLimit(1).on(\"message\",r=>{r.module.app.use(expressMiddleware.bind(null,e,n))}),fs.watch(n.config.packageJsonPath,()=>{null!==r&&clearTimeout(r),r=setTimeout(o,1e3)}),n.config.captureSigint&&process.on(\"SIGINT\",function(){const e=n.getBackendVersion();i(e,e)||(n.info(\"Forcing shutdown...\"),a())})});","backend/node_modules/h5-mongoose/index.js":"\"use strict\";const mongoose=require(\"mongoose\"),expressMiddleware=require(\"./expressMiddleware\");exports.DEFAULT_CONFIG={maxConnectTries:10,connectAttemptDelay:500,uri:\"mongodb://localhost/test\",mongoClient:{},models:null,keepAliveQueryInterval:3e4,stopOnConnectError:!0},exports.onModuleSetUp=((e,{module:o,setUpModule:n,setUpAppModule:t})=>{t.models&&\"object\"==typeof t.models&&(o.modelsToLoad||(o.modelsToLoad=[]),o.modelsToLoad.push({setUpModule:n,setUpModels:t.models}))}),exports.start=((e,o,n)=>{let t=!1,c=!1;function i(e){o.connection.readyState!==mongoose.Connection.STATES.connected&&o.connection.readyState!==mongoose.Connection.STATES.connecting&&o.connect(o.config.uri,o.config.mongoClient).then(()=>setImmediate(s)).catch(n=>{e>=o.config.maxConnectTries?s(n):setTimeout(i.bind(null,e+1),o.config.connectAttemptDelay)})}function s(t){if(t){if(o.config.stopOnConnectError)return n(t);o.error(t),setTimeout(i,1e4,0)}c||(c=!0,function(){o.info(\"Loading models...\");const t=new Set,c=new Map;o.modelsToLoad.forEach(({setUpModels:e})=>{(Array.isArray(e)?e:Object.values(e)).forEach(e=>t.add(e))}),t.forEach(({name:n,setUp:t})=>{c.set(t,n),t(e,o)}),o.modelsToLoad.forEach(({setUpModule:e,setUpModels:n})=>{(Array.isArray(n)?n:Object.values(n)).forEach(({setUp:n})=>{const t=c.get(n);e[t]=o.model(t)})}),o.modelsToLoad=[],setImmediate(n)}())}(o=e[o.name]=Object.assign(mongoose,o)).Promise=global.Promise,o.set(\"objectIdGetter\",!1),o.set(\"strict\",!0),o.set(\"debug\",!1),o.connection.on(\"connecting\",()=>o.info(\"Connecting...\")),o.connection.on(\"connected\",()=>o.info(\"Connected.\")),o.connection.on(\"open\",()=>o.info(\"Open.\")),o.connection.on(\"reconnected\",()=>o.info(\"Reconnected.\")),o.connection.on(\"disconnecting\",()=>o.warn(\"Disconnecting...\")),o.connection.on(\"disconnected\",()=>o.warn(\"Disconnected.\")),o.connection.on(\"close\",()=>o.warn(\"Closed.\")),o.connection.on(\"unauthorized\",()=>o.warn(\"Unauthorized.\")),o.connection.on(\"error\",e=>o.error(e)),e.broker.subscribe(\"app.started\",function e(){if(!o.config.keepAliveQueryInterval)return;if(!o.connection.db)return setTimeout(e,o.config.keepAliveQueryInterval);o.connection.db.stats((n,c)=>{n?(t||o.error(n,\"Keep alive query failed.\"),t=!0):(t&&o.info(\"Kept alive.\",{stats:c}),t=!1),setTimeout(e,o.config.keepAliveQueryInterval)})}).setLimit(1),e.broker.subscribe(\"express.beforeMiddleware\",function(n){n.module.app.use(expressMiddleware.bind(null,e,o))}).setLimit(1),i(0)});","backend/node_modules/events/index.js":"\"use strict\";const _=require(\"lodash\");exports.DEFAULT_CONFIG={mongooseId:\"mongoose\",userId:\"user\",expressId:\"express\",collection:e=>e.mongodb.db.collection(\"events\"),insertDelay:1e3,topics:[\"events.**\"],blacklist:[],print:[]},exports.models=[require(\"./models/event\")],exports.recordTopics=[\"events.**\"],exports.republishTopics=[\"events.saved\"],exports.userPrivileges=[\"EVENTS:VIEW\",\"EVENTS:MANAGE\"],exports.optionalModules={\"mongoose user express\":require(\"./routes\")},exports.onModuleSetUp=((e,{module:s,setUpAppModule:t})=>{t.recordTopics&&(Array.isArray(t.recordTopics)?Array.isArray(s.config.topics)&&t.recordTopics.forEach(e=>s.config.topics.push(e)):Object.keys(t.recordTopics).forEach(e=>{let o=s.config.topics;o=\"blacklist\"===e||\"print\"===e?s.config[e]:o[e]?o[e]:o[e]=[],t.recordTopics[e].forEach(e=>o.push(e))}))}),exports.start=((e,s)=>{const{config:t}=s,o=t.collection(e);let r=null,n=0,i=null,c=0;const l={};function u(){const e=Date.now()-n;e<6e4?null===i&&(i=setTimeout(u,e)):o.distinct(\"type\",null,null,(e,t)=>{e?s.error(e,\"Failed to fetch event types.\"):t.forEach(e=>s.types[e]=1),n=Date.now(),i=null})}function p(e,t){s.info({topic:t,message:e})}function a(e,t,o){if(\"events.saved\"===o)return void u();if(l[o])return;const n=(t=_.isObject(t)?JSON.parse(JSON.stringify(t)):{}).user,i=_.isObject(n)?{_id:String(n._id||n.id),name:n.lastName&&n.firstName?`${n.lastName} ${n.firstName}`:n.login||n.label,login:n.login||n.label,ipAddress:n.ipAddress||n.ip}:null,p=o.replace(/^events\\./,\"\");_.isString(t.severity)&&(e=t.severity,delete t.severity),null!==i&&delete t.user;const a={type:p,severity:e,time:Date.now(),user:i,data:t};null===r&&(r=[],setTimeout(d,s.config.insertDelay),c=a.time),r.push(a),s.types[p]=1}function d(){if(null===r)return;const t=r;r=null,o.insertMany(t,o=>{o?s.error(o,`Failed to save ${t.length} events.`):e.broker.publish(\"events.saved\",t)})}function f(){null!==r&&Date.now()-c>3333&&(s.warn(`Blocked! Forcing insert of ${r.length} pending events!`),d())}s.types={},s.getPendingEvents=function(){return r||[]},s.insertEvents=d,t.blacklist.forEach(e=>l[e]=!0),function(){if(Array.isArray(t.topics)){const s=a.bind(null,\"info\");_.uniq(t.topics).forEach(t=>{e.broker.subscribe(t,s)})}else Object.keys(t.topics).forEach(s=>{const o=a.bind(null,s);_.uniq(t.topics[s]).forEach(s=>{e.broker.subscribe(s,o)})});_.uniq(s.config.print).forEach(s=>{e.broker.subscribe(s,p)})}(),e.broker.subscribe(\"app.started\").setLimit(1).on(\"message\",()=>{u(),setInterval(f,5e3)})});","backend/node_modules/modbus/index.js":"\"use strict\";const fs=require(\"fs\"),_=require(\"lodash\"),csv=require(\"csv\"),deepEqual=require(\"deep-equal\"),modbus=require(\"h5.modbus\"),Tag=require(\"./Tag\");exports.DEFAULT_CONFIG={messengerServerId:\"messenger/server\",programId:\"program\",settingsCollection:function(e){return e.mongodb.db.collection(\"tags.settings\")},broadcastDelay:100,broadcastFilter:[],writeAllTheThings:null,maxReadQuantity:100,ignoredErrors:[],controlMasters:[],masters:{},tagsFile:null,tags:{},ignoreRe:null,resetTagsDelay:1337},exports.start=function(e,t,n){function s(){Object.keys(t.config.masters).forEach(a),function(){const n=t.config;_.forEach(Object.keys(t.masters),function(e){const s=`masters.${e}`;let r=n.tags[s];null!==r&&\"object\"==typeof r||(r=n.tags[s]={}),r.master=e,r.kind=\"virtual\",r.type=\"bool\",r.address=null,r.unit=null,r.readable=!1,r.writable=!1,t.values[s]=!1});let s=0;_.forEach(n.tags,function(r,a){let o=t.masters[r.master];!n.writeAllTheThings||o&&!1===o.writeAllTheThings||\"virtual\"===r.kind||\"setting\"===r.kind||\"memory\"===r.kind||(_.assign(r,{kind:\"register\",address:s,master:n.writeAllTheThings,writable:!0}),o=t.masters[n.writeAllTheThings],s+=u(r.type));const i=new Tag(e.broker,t,a,r);o&&o.tags.push(i),t.tags[a]=i,null==t.values[a]&&(t.values[a]=null)})}(),Object.keys(t.masters).forEach(o),t.config.settingsCollection().find().toArray(function(e,n){if(e)return t.error(e,\"Failed to read the setting tags.\");const s=Date.now();_.forEach(n,function(e){const n=t.tags[e._id];n&&\"setting\"===n.kind&&n.setValue(e.value,s)})}),require(\"./virtuals\")(e,t),require(\"./safeGuards\")(e,t),n()}function r(e,n){t.setTagValue(e.name,e.value,n)}function a(n){const s=t.config,r=modbus.createMaster(s.masters[n]);r.tags=[],r.on(\"error\",function(t){-1===s.ignoredErrors.indexOf(t.code)&&e.broker.publish(\"modbus.error\",{severity:\"debug\",master:n,unit:-1,message:t.stack,code:t.code})});const a=`masters.${n}`;let o=!1,i=null;r.on(\"transaction complete\",function(e){o||e||(t.debug(\"Master really connected.\",{masterName:n}),o=!0,t.tags[a].setValue(o),null!==i&&(clearTimeout(i),i=null))}),r.on(\"open\",function(){t.debug(\"Master maybe connected.\",{masterName:n})}),r.on(\"close\",function(){t.debug(\"Master disconnected.\",{masterName:n}),o=!1,t.tags[a].setValue(o),null===i&&(i=setTimeout(function(){i=null,_.forEach(r.tags,e=>{e.setValue(null)})},t.config.resetTagsDelay||1337))}),t.masters[n]=r}function o(n){const s=t.masters[n],r=function(e){const t={};return _.forEach(e,function(e){e.isReadable()&&(null==t[e.unit]&&(t[e.unit]={}),Array.isArray(t[e.unit][e.code])||(t[e.unit][e.code]=[]),t[e.unit][e.code].push(e))}),t}(s.tags),a=[];_.forEach(r,function(e){_.forEach(e,function(e){!function(e,n){const s=n.length-1;let r,a;function o(e,t,n){n===s&&(e.quantity+=u(t.type)-1)}n.sort((e,t)=>e.address-t.address),_.forEach(n,function(s,c){if(0===c)return r=i(s),a=s.address,o(r,s,c),void e.push(r);const l=s.address-a;if(r.quantity+l>function(e){const n=t.config.masters[e];return n&&n.maxReadQuantity||t.config.maxReadQuantity}(s.master))return r.quantity+=u(n[c-1].type)-1,r=i(s),a=s.address,o(r,s,c),void e.push(r);r.quantity+=l,o(r,s,c),r.tags.push(s.name),a=s.address})}(a,e)})}),s.once(\"open\",function(){_.forEach(a,function(r){const a={functionCode:r.functionCode,startingAddress:r.startingAddress,quantity:r.quantity},o=r.unit,i=s.execute({request:a,unit:o,maxRetries:0,interval:t.config.masters[n].interval||25+Math.round(25*Math.random())});i.on(\"request\",function(){this.startTime=Date.now()}),i.on(\"complete\",function(e,t){s.emit(\"transaction complete\",e,t)}),i.on(\"error\",function(s){const r=(s.code||s.name).replace(\"Error\",\"\");-1===t.config.ignoredErrors.indexOf(r)&&e.broker.publish(\"modbus.error\",{severity:\"debug\",message:s.stack,master:n,unit:o,request:a})}),i.on(\"response\",function(n,s){const r=s.functionCode===modbus.FunctionCode.ReadDiscreteInputs||s.functionCode===modbus.FunctionCode.ReadCoils;return function(a){if(a.isException())return a.exceptionCode===modbus.ExceptionCode.GatewayTargetDeviceFailedToRespond?(o=s.tags,void _.forEach(o,function(e){const n=t.tags[e];n&&n.setValue(null)})):void e.broker.publish(\"modbus.exception\",{severity:\"debug\",master:n,unit:s.unit,functionCode:a.functionCode,exceptionCode:a.exceptionCode,message:a.toString()});var o;if(a.quantity<s.quantity)return void e.broker.publish(\"modbus.incompleteResponse\",{severity:\"debug\",master:n,unit:s.unit,expectedQuantity:s.quantity,actualQuantity:a.quantity});const i=r?a.states:a.data;for(let e=0,n=s.tags.length;e<n;++e){const n=t.tags[s.tags[e]],a=r?i[n.address-s.startingAddress]:c(s,n,i);n.setValue(a)}}}(n,r))})})}function i(e){return{functionCode:e.code,startingAddress:e.address,unit:e.unit,quantity:1,tags:[e.name]}}function u(e){switch(e){case\"double\":return 4;case\"float\":case\"uint32\":case\"int32\":return 2;default:return 1}}function c(e,t,n){const s=2*(t.address-e.startingAddress);switch(t.type){case\"double\":return n.readDoubleBE(s,!0);case\"float\":return n.readFloatBE(s,!0);case\"uint32\":return n.readUInt32BE(s,!0);case\"int32\":return n.readInt32BE(s,!0);case\"int16\":case\"int8\":return n.readInt16BE(s,!0);case\"bool\":return 0===n.readInt16BE(s,!0)?0:1;case\"string\":return n.toString();default:return n.readUInt16BE(s,!0)}}t.config.settingsCollection=t.config.settingsCollection.bind(null,e),t.masters={},t.tags={},t.values={},t.getTagValue=function(e){return t.values[e]},t.setTagValue=function(e,n,s){if(s||(s=(()=>{})),t.config.ignoreRe&&t.config.ignoreRe.test(e))return t.warn(\"Tried to set ignored tag.\",{tagName:e}),s();const r=t.tags[e];return void 0===r?(t.warn(\"Tried to set unknown tag.\",{tagName:e}),s(Object.assign(new Error(\"UNKNOWN_TAG\"),{tagName:e}))):deepEqual(n,r.getValue())?s():void r.writeValue(n,s)},e.onModuleReady(t.config.messengerServerId,function(){const n=e[t.config.messengerServerId];n.handle(\"modbus.sync\",function(e,n){n(null,{tags:t.tags,values:t.values})}),n.handle(\"modbus.setTagValue\",r),function(){const n=e[t.config.messengerServerId];let s=null;e.broker.subscribe(\"tagValueChanged.**\",function(r){r.tag.broadcastable&&(null===s&&(s={},setTimeout(function(){e.broker.publish(\"tagValuesChanged\",s),n.broadcast(\"modbus.tagValuesChanged\",s),s=null},t.config.broadcastDelay)),s[r.tag.name]=r.newValue)})}()}),t.config.tagsFile?function(e,t,n){let s;try{s=fs.readFileSync(e,\"utf8\")}catch(e){return void n()}const r=csv.parse(s,{delimiter:\",\",rowDelimiter:\"\\n\",quote:'\"',trim:!0,columns:!0}),a=_.once(n);r.on(\"error\",a),r.on(\"finish\",a),r.on(\"readable\",()=>{let e;for(;e=r.read();)_.isEmpty(e.name)||t[e.name]||(_.forEach(e,(t,n)=>{/^[A-Z]/.test(n)?delete e[n]:\"-\"===t||\"?\"===t?e[n]=null:/^[0-9]+(\\.[0-9]+)?$/.test(t)&&(e[n]=parseFloat(t))}),t[e.name]=e)})}(t.config.tagsFile,t.config.tags,s):s()};","backend/node_modules/messenger/server.js":"\"use strict\";const _=require(\"lodash\"),axon=require(\"axon\"),Message=require(\"amp-message\");function monkeyPatch(){axon.RepSocket.prototype.onmessage=function(o){const n=this;return e=>{const t=new Message(e).args,r=t.pop();t.unshift(\"message\"),t.push(function(...e){e[0]=e[0]||null;let t=()=>{};\"function\"==typeof e[e.length-1]&&(t=e.pop());if(e.push(r),o.writable)return o.write(n.pack(e),()=>{t(!0)}),!0;return process.nextTick(()=>{t(!1)}),!1},o),n.emit.apply(n,t)}}}exports.DEFAULT_CONFIG={pubHost:\"0.0.0.0\",pubPort:5050,repHost:\"0.0.0.0\",repPort:5051,pullHost:null,pullPort:5052,broadcastTopics:[]},exports.onModuleSetUp=(o=>{monkeyPatch(o)}),exports.start=function(o,n,e){const t={\"@broadcast\":function(n,e){o.broker.publish(n.topic,n.message,n.meta),e()},\"@subscribe\":function({sock:n,topics:e},t){n.broker||(n.broker=o.broker.sandbox()),_.forEach(e,o=>{n.broker.subscribe(o,(o,e,t)=>{if(n.writable){const r=new Message([{topic:e,message:o,meta:t},\"@publish\"]);n.write(r.toBuffer())}})}),t()}};let r=null,s=null,c=null;function i(o,n,e,r){if(!_.isString(o))return;const s=t[o];_.isFunction(s)&&s({...n,sock:r},(...o)=>{if(o.length&&o[0]instanceof Error){const n=o[0],e={message:n.message,stack:n.stack};Object.keys(n).forEach(o=>e[o]=n[o]),o[0]=e}_.isFunction(e)&&e(...o)})}_.forEach(n.config.broadcastTopics,function(e){o.broker.subscribe(e,function(o,e){n.broadcast(e,void 0===o?null:o)})}),function(){if(!n.config.pullHost)return n.info(\"pull socket not used.\");let e=!1;(c=axon.socket(\"rep\")).set(\"hwm\",10),c.connect(n.config.pullPort,n.config.pullHost),c.on(\"error\",function(o){n.error(o,\"pull socket error\")}),c.on(\"connect\",function(){e=!0,n.info(`pull socket connected on port ${n.config.pullPort}.`),o.broker.publish(\"messenger.client.connected\",{moduleName:n.name,socketType:\"pull\",host:n.config.pullHost,port:n.config.pullPort})}),c.on(\"reconnect attempt\",function(){e&&(n.info(\"pull socket disconnected. Reconnecting...\"),e=!1)}),c.on(\"message\",i)}(),function(o){const e=axon.socket(\"pub\");e.set(\"hwm\",10),e.bind(n.config.pubPort,n.config.pubHost),e.once(\"error\",o),e.on(\"bind\",function(){e.removeListener(\"error\",o),o(null,e)})}(function(o,t){if(o)return e(o);r=t,n.info(`pub socket listening on port ${n.config.pubPort}.`),function(o){const e=axon.socket(\"rep\");e.set(\"hwm\",10),e.bind(n.config.repPort,n.config.repHost),e.once(\"error\",o),e.on(\"disconnect\",o=>{o.broker&&(o.broker.destroy(),o.broker=null)}),e.on(\"bind\",function(){e.removeListener(\"error\",o),e.on(\"message\",i),o(null,e)})}(function(o,t){if(o)return e(o);s=t,n.info(`rep socket listening on port ${n.config.repPort}`),e()})}),n.handle=function(o,n){t[o]=n},n.broadcast=function(o,n){r&&r.send(o,n)}};","backend/node_modules/messenger/client.js":"\"use strict\";const _=require(\"lodash\"),axon=require(\"axon\"),Message=require(\"amp-message\");function monkeyPatch(e){axon.ReqSocket.prototype.onmessage=function(){const o=this;return function(n){const t=new Message(n),s=t.pop(),c=o.callbacks[s],r=t.args;c?(c.apply(null,t.args),delete o.callbacks[s]):\"@publish\"===s&&r.length&&r[0].topic&&e.broker.publish(r[0].topic,r[0].message,r[0].meta)}}}exports.DEFAULT_CONFIG={pubHost:\"127.0.0.1\",pubPort:5050,repHost:\"127.0.0.1\",repPort:5051,pushHost:null,pushPort:5052,responseTimeout:5e3,broadcastTopics:[],subscribeTopics:[]},exports.onModuleSetUp=(e=>{monkeyPatch(e)}),exports.start=((e,o,n)=>{let t,s,c=null;function r(e,n,t,s){s=_.isFunction(s)?_.once(s):function(){};let c=null,r=null;if(r=_.once(function(e){null!==c&&clearTimeout(c),_.isString(e)&&(arguments[0]={message:e}),s.apply(null,arguments)}),\"client\"===e.type&&!e.connected||\"server\"===e.type&&0===e.socks.length)return r({code:\"NO_CONNECTION\",message:\"client\"===e.type?\"Not connected to the server.\":\"No clients connected.\"});e.send(n,t,r);const i=t&&t.responseTimeout||o.config.responseTimeout;c=setTimeout(()=>{c=null,r({code:\"RESPONSE_TIMEOUT\",message:\"Response timeout.\"})},i)}function i(o,n){e.broker.publish(o,n)}function u(){_.isEmpty(o.config.subscribeTopics)||o.request(\"@subscribe\",{topics:o.config.subscribeTopics},e=>{e&&o.error(e,\"Failed to subscribe.\")})}_.forEach(o.config.broadcastTopics,n=>{e.broker.subscribe(n,(e,n,t)=>{o.request(\"@broadcast\",{topic:n,message:e,meta:t})})}),function(){let n=!1;(t=axon.socket(\"sub\")).set(\"hwm\",10),t.connect(o.config.pubPort,o.config.pubHost),t.on(\"error\",function(e){o.error(e,\"sub socket error\")}),t.on(\"connect\",function(){n=!0,o.info(`sub socket connected on port ${o.config.pubPort}.`),e.broker.publish(\"messenger.client.connected\",{moduleName:o.name,socketType:\"sub\",host:o.config.pubHost,port:o.config.pubPort})}),t.on(\"reconnect attempt\",function(){n&&(o.info(\"sub socket disconnected. Reconnecting...\"),n=!1)}),t.on(\"message\",i)}(),function(){let n=!1;(s=axon.socket(\"req\")).set(\"hwm\",10),s.connect(o.config.repPort,o.config.repHost),s.on(\"error\",function(e){o.error(e,\"req socket error\")}),s.on(\"connect\",function(){n=!0,o.info(`req socket connected on port ${o.config.repPort}.`),e.broker.publish(\"messenger.client.connected\",{moduleName:o.name,socketType:\"req\",host:o.config.repHost,port:o.config.repPort}),setImmediate(u)}),s.on(\"reconnect attempt\",function(){n&&(o.info(\"req socket disconnected. Reconnecting...\"),n=!1,e.broker.publish(\"messenger.client.disconnected\",{moduleName:o.name,socketType:\"req\",host:o.config.repHost,port:o.config.repPort}))})}(),function(e){if(!o.config.pushHost)return e(null,null);const n=axon.socket(\"req\");n.set(\"hwm\",10),n.bind(o.config.pushPort,o.config.pushHost),n.once(\"error\",e),n.on(\"bind\",function(){n.removeListener(\"error\",e),e(null,n)})}(function(e,t){if(e)return setImmediate(n,e);null===(c=t)?o.info(\"push socket not used.\"):o.info(`push socket listening on port ${o.config.pushPort}.`),setImmediate(n)}),o.isConnected=function(){return t&&t.connected&&s&&s.connected},o.request=function(e,o,n){r(s,e,o,n)},o.push=function(e,o,n){if(null===c)return n(new Error(\"NO_PUSH_SOCKET\"));r(c,e,o,n)}});","backend/node_modules/program/index.js":"\"use strict\";const _=require(\"lodash\"),Watchdog=require(\"./Watchdog\"),ProgramManager=require(\"./ProgramManager\"),TestManager=require(\"./TestManager\");exports.DEFAULT_CONFIG={modbusId:\"modbus\",messengerServerId:\"messenger/server\"},exports.models=[require(\"snf-programs/models/snfProgram\"),require(\"snf-tests/models/snfTest\")],exports.requiredModules=\"modbus\",exports.start=((e,r)=>{const s=e[r.config.modbusId];let t=null;r.exec=((e,r)=>{null===t&&(t={},process.nextTick(()=>{const e=t;t=null,_.forEach(e,e=>{e()})})),t[r||e.name]=e}),e.onModuleReady(r.config.messengerServerId,()=>{e[r.config.messengerServerId].handle(\"snf.tests.getData\",(e,s)=>{r.testManager?s({currentTest:r.testManager.currentTest,lastTest:r.testManager.lastTest}):s({currentTest:null,lastTest:null})})});let a=null;function n(){if(r.watchdog=new Watchdog(e),s.values.watchdog)return o();a=e.broker.subscribe(\"tagValueChanged.watchdog\",o)}function o(s){s&&!s.newValue||(a&&(a.cancel(),a=null),r.programManager=new ProgramManager(e),r.testManager=new TestManager(e))}r.config.simulate||s.values[\"masters.controlProcess\"]?n():e.broker.subscribe(\"tagValueChanged.masters.controlProcess\",n).setLimit(1)});","node_modules/h5.pubsub/lib/MessageBroker.js":"\"use strict\";var Subscriptions=require(\"./Subscriptions\"),Subscription=require(\"./Subscription\"),Sandbox=require(\"./Sandbox\");function MessageBroker(){this.subscriptions=new Subscriptions(this),this.nextSubscriptionId=0,this.listeners={subscribe:[],cancel:[],\"new topic\":[],\"empty topic\":[],message:[]}}module.exports=MessageBroker,MessageBroker.prototype.destroy=function(){this.subscriptions.destroy(),this.subscriptions=null,this.listeners=null},MessageBroker.prototype.sandbox=function(){return new Sandbox(this)},MessageBroker.prototype.publish=function(e,t,s){return void 0===s&&(s={}),this.emit(\"message\",e,t,s),this.subscriptions.send(e,t,s),this},MessageBroker.prototype.subscribe=function(e,t){var s=new Subscription(this.getNextSubscriptionId(),e);return\"function\"==typeof t&&s.on(\"message\",t),this.subscriptions.add(s),this.emit(\"subscribe\",s),s},MessageBroker.prototype.unsubscribe=function(e){return this.subscriptions.remove(e),this},MessageBroker.prototype.count=function(){var e={};if(null===this.subscriptions)return e;return this.subscriptions.count(\"\",e),e},MessageBroker.prototype.on=function(e,t){var s=this.listeners[e];if(\"undefined\"===typeof s)throw new Error(\"Unknown event: \"+e);return s.push(t),this},MessageBroker.prototype.off=function(e,t){var s=this.listeners[e];if(\"undefined\"===typeof s)throw new Error(\"Unknown event: \"+e);var r=s.indexOf(t);return-1!==r&&s.splice(r,1),this},MessageBroker.prototype.emit=function(e,t){var s=this.listeners[e];if(\"undefined\"===typeof s)throw new Error(\"Unknown event: \"+e);if(!s.length)return this;var r=arguments.length;r>4&&(t=Array.prototype.slice.call(arguments)).shift();for(var i=0,n=s.length;i<n;++i){var o=s[i];switch(r){case 4:o(arguments[1],arguments[2],arguments[3]);break;case 3:o(arguments[1],arguments[2]);break;case 2:o(arguments[1]);break;default:o.apply(null,t)}}return this},MessageBroker.prototype.getNextSubscriptionId=function(){return(this.nextSubscriptionId++).toString(36)};","node_modules/h5.pubsub/lib/Subscriptions.js":"\"use strict\";module.exports=Subscriptions;var EMPTY_TOPIC_PARTS=[];function Subscriptions(i){this.messageBroker=i,this.children={},this.subscriptions=[],this.subscriptionsPendingRemoval=[],this.sendingMessagesCount=0,this.removeSubscription=this.removeSubscription.bind(this)}Subscriptions.TOKEN={SEPARATOR:\".\",ANY:\"*\",ALL:\"**\"},Subscriptions.prototype.destroy=function(){for(var i=this.children,s=Object.keys(i),t=0,e=s.length;t<e;++t)i[s[t]].destroy();this.children=null,this.removeSubscriptions(),this.subscriptionsPendingRemoval=null,this.messageBroker=null},Subscriptions.prototype.count=function(i,s){this.subscriptions.length&&(s[i]=this.subscriptions.length);var t=Object.keys(this.children),e=t.length;if(e){0!==i.length&&(i+=Subscriptions.TOKEN.SEPARATOR);for(var n=0;n<e;++n){var o=t[n];this.children[o].count(i+o,s)}}},Subscriptions.prototype.add=function(i){var s=this.splitTopic(i.getTopic());this.addSubscription(s,i)},Subscriptions.prototype.remove=function(i){this.removeSubscriptions(this.splitTopic(i))},Subscriptions.prototype.send=function(i,s,t){var e=this.splitTopic(i);this.sendMessage(e,i,s,t)},Subscriptions.prototype.addSubscription=function(i,s){if(0===i.length)return this.subscriptions.push(s),s.on(\"cancel\",this.removeSubscription),void(1===this.subscriptions.length&&this.messageBroker.emit(\"new topic\",s.getTopic()));var t=this.children,e=i.shift();void 0===t[e]&&(t[e]=new Subscriptions(this.messageBroker)),t[e].addSubscription(i,s)},Subscriptions.prototype.removeSubscriptions=function(i){var s,t;if(void 0!==i&&0!==i.length){var e=i.shift();void 0!==this.children[e]&&this.children[e].removeSubscriptions(i)}else{var n=this.subscriptions;if(!n.length)return;this.subscriptions=[];var o=n[0].getTopic();for(s=0,t=n.length;s<t;++s)n[s].cancel();this.messageBroker.emit(\"empty topic\",o)}},Subscriptions.prototype.sendMessage=function(i,s,t,e){if(++this.sendingMessagesCount,void 0!==this.children[Subscriptions.TOKEN.ALL]&&this.children[Subscriptions.TOKEN.ALL].sendMessage(EMPTY_TOPIC_PARTS,s,t,e),0===i.length)for(var n=0,o=this.subscriptions.length;n<o;++n)this.subscriptions[n].send(s,t,e);else{var r=i.shift();void 0!==this.children[Subscriptions.TOKEN.ANY]&&this.children[Subscriptions.TOKEN.ANY].sendMessage([].concat(i),s,t,e),void 0!==this.children[r]&&this.children[r].sendMessage(i,s,t,e)}--this.sendingMessagesCount,this.removePendingSubscriptions()},Subscriptions.prototype.splitTopic=function(i){var s=i.split(Subscriptions.TOKEN.SEPARATOR).filter(function(i){return 0!==i.length});if(0===s.length)throw new Error(\"Invalid subscription topic: \"+i);return s},Subscriptions.prototype.removeSubscription=function(i){if(this.messageBroker.emit(\"cancel\",i),0!==this.subscriptions.length)return 1===this.subscriptions.length&&this.subscriptions[0]===i?(this.subscriptions.length=0,void this.messageBroker.emit(\"empty topic\",i.getTopic())):void this.removeOrQueueRemoval(i)},Subscriptions.prototype.removeOrQueueRemoval=function(i){0===this.sendingMessagesCount?this.subscriptions.splice(this.subscriptions.indexOf(i),1):this.subscriptionsPendingRemoval.push(i)},Subscriptions.prototype.removePendingSubscriptions=function(){var i=this.subscriptionsPendingRemoval,s=i.length;if(s&&!this.sendingMessagesCount){var t=this.subscriptions;if(s===t.length)return i.length=0,void(t.length=0);var e,n,o=[];for(e=0;e<s;++e)o.push(t.indexOf(i[e]));for(o.sort(function(i,s){return s-i}),e=0,n=o.length;e<n;++e)t.splice(o[e],1);i.length=0}};","node_modules/h5.pubsub/lib/Subscription.js":"\"use strict\";function Subscription(t,i){this.cancelled=!1,this.id=t,this.topic=i,this.messageFilter=null,this.messageLimit=0,this.messageCount=0,this.doFilter=null,this.listeners={cancel:null,message:null}}module.exports=Subscription,Subscription.compileFilter=function(){throw new Error(\"Subscription.compileFilter() is not implemented!\")},Subscription.prototype.toJSON=function(){var t=this.getFilter();return\"function\"==typeof t&&(t=t.toString()),{id:this.getId(),topic:this.getTopic(),limit:this.getLimit(),filter:t}},Subscription.prototype.getId=function(){return this.id},Subscription.prototype.getTopic=function(){return this.topic},Subscription.prototype.getFilter=function(){return this.messageFilter},Subscription.prototype.setFilter=function(t){if(this.messageFilter=t,\"function\"==typeof t)this.doFilter=t;else if(this.doFilter=Subscription.compileFilter(t),\"function\"!=typeof this.doFilter)throw new Error(\"Subscription.compileFilter() must return a function.\");return this},Subscription.prototype.getLimit=function(){return this.messageLimit},Subscription.prototype.setLimit=function(t){if(t<1)throw new Error(\"Subscription limit must be greater than 0.\");return this.messageLimit=t,this},Subscription.prototype.getMessageCount=function(){return this.messageCount},Subscription.prototype.on=function(t,i){if(this.cancelled)return this;var e=this.listeners[t],n=typeof e;if(\"undefined\"===n)throw new Error(\"Unknown event: \"+t);return\"function\"===n?this.listeners[t]=[e,i]:null===e?this.listeners[t]=i:this.listeners[t].push(i),this},Subscription.prototype.off=function(t,i){if(this.cancelled)return this;var e=this.listeners[t],n=typeof e;if(\"undefined\"===n)throw new Error(\"Unknown event: \"+t);if(\"function\"===n&&e===i)this.listeners[t]=null;else if(\"object\"===n&&null!==e){for(var s=-1,r=e.length,o=0;o<r;++o)if(e[o]===i){s=o;break}-1!==s&&(e.splice(s,1),2===r&&(this.listeners[t]=e[0]))}return this},Subscription.prototype.cancel=function(){this.cancelled||(this.cancelled=!0,this.emit(\"cancel\",this),this.listeners=null,this.doFilter=null)},Subscription.prototype.send=function(t,i,e){this.cancelled||null!==this.doFilter&&!this.doFilter(i,t,e,this)||(++this.messageCount,this.emit(\"message\",i,t,e,this),this.messageCount===this.messageLimit&&this.cancel())},Subscription.prototype.emit=function(t){var i=this.listeners[t];if(null!==i){var e=arguments.length;if(\"function\"!=typeof i)for(var n=0,s=i.length;n<s;++n)5===e?i[n](arguments[1],arguments[2],arguments[3],arguments[4]):i[n](arguments[1]);else 5===e?i(arguments[1],arguments[2],arguments[3],arguments[4]):i(arguments[1])}};","node_modules/h5.pubsub/lib/Sandbox.js":"\"use strict\";function Sandbox(t){this.broker=t,this.subscriptions={},this.removeSubscription=this.removeSubscription.bind(this)}module.exports=Sandbox,Sandbox.prototype.destroy=function(){var t=this.subscriptions;null!==t&&Object.keys(t).forEach(function(o){t[o].cancel()}),this.subscriptions=null,this.broker=null},Sandbox.prototype.sandbox=function(){return new Sandbox(this)},Sandbox.prototype.publish=function(t,o,s){return this.broker.publish(t,o,s),this},Sandbox.prototype.subscribe=function(t,o){var s=this.broker.subscribe(t,o);return s.on(\"cancel\",this.removeSubscription),this.subscriptions[s.getId()]=s,s},Sandbox.prototype.unsubscribe=function(t){var o=[],s=this.subscriptions;for(var i in s)s.hasOwnProperty(i)&&s[i].getTopic()===t&&o.push(i);for(var n=0,r=o.length;n<r;++n)s[o[n]].cancel();return this},Sandbox.prototype.removeSubscription=function(t){delete this.subscriptions[t.getId()]};","node_modules/moment/locale/pl.js":"!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module&&\"function\"==typeof require?t(require(\"../moment\")):\"function\"==typeof define&&define.amd?define([\"../moment\"],t):t(e.moment)}(this,function(e){\"use strict\";var t=\"stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie\".split(\"_\"),i=\"stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia\".split(\"_\");function n(e){return e%10<5&&e%10>1&&~~(e/10)%10!=1}function r(e,t,i){var r=e+\" \";switch(i){case\"ss\":return r+(n(e)?\"sekundy\":\"sekund\");case\"m\":return t?\"minuta\":\"minut\";case\"mm\":return r+(n(e)?\"minuty\":\"minut\");case\"h\":return t?\"godzina\":\"godzin\";case\"hh\":return r+(n(e)?\"godziny\":\"godzin\");case\"MM\":return r+(n(e)?\"miesice\":\"miesicy\");case\"yy\":return r+(n(e)?\"lata\":\"lat\")}}return e.defineLocale(\"pl\",{months:function(e,n){return e?\"\"===n?\"(\"+i[e.month()]+\"|\"+t[e.month()]+\")\":/D MMMM/.test(n)?i[e.month()]:t[e.month()]:t},monthsShort:\"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru\".split(\"_\"),weekdays:\"niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota\".split(\"_\"),weekdaysShort:\"ndz_pon_wt_r_czw_pt_sob\".split(\"_\"),weekdaysMin:\"Nd_Pn_Wt_r_Cz_Pt_So\".split(\"_\"),longDateFormat:{LT:\"HH:mm\",LTS:\"HH:mm:ss\",L:\"DD.MM.YYYY\",LL:\"D MMMM YYYY\",LLL:\"D MMMM YYYY HH:mm\",LLLL:\"dddd, D MMMM YYYY HH:mm\"},calendar:{sameDay:\"[Dzi o] LT\",nextDay:\"[Jutro o] LT\",nextWeek:function(){switch(this.day()){case 0:return\"[W niedziel o] LT\";case 2:return\"[We wtorek o] LT\";case 3:return\"[W rod o] LT\";case 6:return\"[W sobot o] LT\";default:return\"[W] dddd [o] LT\"}},lastDay:\"[Wczoraj o] LT\",lastWeek:function(){switch(this.day()){case 0:return\"[W zesz niedziel o] LT\";case 3:return\"[W zesz rod o] LT\";case 6:return\"[W zesz sobot o] LT\";default:return\"[W zeszy] dddd [o] LT\"}},sameElse:\"L\"},relativeTime:{future:\"za %s\",past:\"%s temu\",s:\"kilka sekund\",ss:r,m:r,mm:r,h:r,hh:r,d:\"1 dzie\",dd:\"%d dni\",M:\"miesic\",MM:r,y:\"rok\",yy:r},dayOfMonthOrdinalParse:/\\d{1,2}\\./,ordinal:\"%d.\",week:{dow:1,doy:4}})});","node_modules/lodash/lodash.js":"(function(){var n,t=200,r=\"Unsupported core-js use. Try https://npms.io/search?q=ponyfill.\",e=\"Expected a function\",u=\"__lodash_hash_undefined__\",i=500,o=\"__lodash_placeholder__\",f=1,a=2,c=4,l=1,s=2,h=1,p=2,v=4,_=8,g=16,y=32,d=64,b=128,w=256,m=512,x=30,j=\"...\",A=800,k=16,O=1,I=2,R=1/0,E=9007199254740991,z=1.7976931348623157e308,S=NaN,L=4294967295,W=L-1,C=L>>>1,U=[[\"ary\",b],[\"bind\",h],[\"bindKey\",p],[\"curry\",_],[\"curryRight\",g],[\"flip\",m],[\"partial\",y],[\"partialRight\",d],[\"rearg\",w]],B=\"[object Arguments]\",T=\"[object Array]\",$=\"[object AsyncFunction]\",D=\"[object Boolean]\",M=\"[object Date]\",F=\"[object DOMException]\",N=\"[object Error]\",P=\"[object Function]\",q=\"[object GeneratorFunction]\",Z=\"[object Map]\",K=\"[object Number]\",V=\"[object Null]\",G=\"[object Object]\",H=\"[object Proxy]\",J=\"[object RegExp]\",Y=\"[object Set]\",Q=\"[object String]\",X=\"[object Symbol]\",nn=\"[object Undefined]\",tn=\"[object WeakMap]\",rn=\"[object WeakSet]\",en=\"[object ArrayBuffer]\",un=\"[object DataView]\",on=\"[object Float32Array]\",fn=\"[object Float64Array]\",an=\"[object Int8Array]\",cn=\"[object Int16Array]\",ln=\"[object Int32Array]\",sn=\"[object Uint8Array]\",hn=\"[object Uint8ClampedArray]\",pn=\"[object Uint16Array]\",vn=\"[object Uint32Array]\",_n=/\\b__p \\+= '';/g,gn=/\\b(__p \\+=) '' \\+/g,yn=/(__e\\(.*?\\)|\\b__t\\)) \\+\\n'';/g,dn=/&(?:amp|lt|gt|quot|#39);/g,bn=/[&<>\"']/g,wn=RegExp(dn.source),mn=RegExp(bn.source),xn=/<%-([\\s\\S]+?)%>/g,jn=/<%([\\s\\S]+?)%>/g,An=/<%=([\\s\\S]+?)%>/g,kn=/\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,On=/^\\w*$/,In=/[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g,Rn=/[\\\\^$.*+?()[\\]{}|]/g,En=RegExp(Rn.source),zn=/^\\s+|\\s+$/g,Sn=/^\\s+/,Ln=/\\s+$/,Wn=/\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/,Cn=/\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,Un=/,? & /,Bn=/[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g,Tn=/\\\\(\\\\)?/g,$n=/\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g,Dn=/\\w*$/,Mn=/^[-+]0x[0-9a-f]+$/i,Fn=/^0b[01]+$/i,Nn=/^\\[object .+?Constructor\\]$/,Pn=/^0o[0-7]+$/i,qn=/^(?:0|[1-9]\\d*)$/,Zn=/[\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f]/g,Kn=/($^)/,Vn=/['\\n\\r\\u2028\\u2029\\\\]/g,Gn=\"\\\\u0300-\\\\u036f\\\\ufe20-\\\\ufe2f\\\\u20d0-\\\\u20ff\",Hn=\"\\\\xac\\\\xb1\\\\xd7\\\\xf7\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf\\\\u2000-\\\\u206f \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000\",Jn=\"[\\\\ud800-\\\\udfff]\",Yn=\"[\"+Hn+\"]\",Qn=\"[\"+Gn+\"]\",Xn=\"\\\\d+\",nt=\"[\\\\u2700-\\\\u27bf]\",tt=\"[a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff]\",rt=\"[^\\\\ud800-\\\\udfff\"+Hn+Xn+\"\\\\u2700-\\\\u27bfa-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xffA-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde]\",et=\"\\\\ud83c[\\\\udffb-\\\\udfff]\",ut=\"[^\\\\ud800-\\\\udfff]\",it=\"(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}\",ot=\"[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]\",ft=\"[A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde]\",at=\"(?:\"+tt+\"|\"+rt+\")\",ct=\"(?:\"+ft+\"|\"+rt+\")\",lt=\"(?:\"+Qn+\"|\"+et+\")\"+\"?\",st=\"[\\\\ufe0e\\\\ufe0f]?\"+lt+(\"(?:\\\\u200d(?:\"+[ut,it,ot].join(\"|\")+\")[\\\\ufe0e\\\\ufe0f]?\"+lt+\")*\"),ht=\"(?:\"+[nt,it,ot].join(\"|\")+\")\"+st,pt=\"(?:\"+[ut+Qn+\"?\",Qn,it,ot,Jn].join(\"|\")+\")\",vt=RegExp(\"[']\",\"g\"),_t=RegExp(Qn,\"g\"),gt=RegExp(et+\"(?=\"+et+\")|\"+pt+st,\"g\"),yt=RegExp([ft+\"?\"+tt+\"+(?:['](?:d|ll|m|re|s|t|ve))?(?=\"+[Yn,ft,\"$\"].join(\"|\")+\")\",ct+\"+(?:['](?:D|LL|M|RE|S|T|VE))?(?=\"+[Yn,ft+at,\"$\"].join(\"|\")+\")\",ft+\"?\"+at+\"+(?:['](?:d|ll|m|re|s|t|ve))?\",ft+\"+(?:['](?:D|LL|M|RE|S|T|VE))?\",\"\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])\",\"\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])\",Xn,ht].join(\"|\"),\"g\"),dt=RegExp(\"[\\\\u200d\\\\ud800-\\\\udfff\"+Gn+\"\\\\ufe0e\\\\ufe0f]\"),bt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,wt=[\"Array\",\"Buffer\",\"DataView\",\"Date\",\"Error\",\"Float32Array\",\"Float64Array\",\"Function\",\"Int8Array\",\"Int16Array\",\"Int32Array\",\"Map\",\"Math\",\"Object\",\"Promise\",\"RegExp\",\"Set\",\"String\",\"Symbol\",\"TypeError\",\"Uint8Array\",\"Uint8ClampedArray\",\"Uint16Array\",\"Uint32Array\",\"WeakMap\",\"_\",\"clearTimeout\",\"isFinite\",\"parseInt\",\"setTimeout\"],mt=-1,xt={};xt[on]=xt[fn]=xt[an]=xt[cn]=xt[ln]=xt[sn]=xt[hn]=xt[pn]=xt[vn]=!0,xt[B]=xt[T]=xt[en]=xt[D]=xt[un]=xt[M]=xt[N]=xt[P]=xt[Z]=xt[K]=xt[G]=xt[J]=xt[Y]=xt[Q]=xt[tn]=!1;var jt={};jt[B]=jt[T]=jt[en]=jt[un]=jt[D]=jt[M]=jt[on]=jt[fn]=jt[an]=jt[cn]=jt[ln]=jt[Z]=jt[K]=jt[G]=jt[J]=jt[Y]=jt[Q]=jt[X]=jt[sn]=jt[hn]=jt[pn]=jt[vn]=!0,jt[N]=jt[P]=jt[tn]=!1;var At={\"\\\\\":\"\\\\\",\"'\":\"'\",\"\\n\":\"n\",\"\\r\":\"r\",\"\\u2028\":\"u2028\",\"\\u2029\":\"u2029\"},kt=parseFloat,Ot=parseInt,It=\"object\"==typeof global&&global&&global.Object===Object&&global,Rt=\"object\"==typeof self&&self&&self.Object===Object&&self,Et=It||Rt||Function(\"return this\")(),zt=\"object\"==typeof exports&&exports&&!exports.nodeType&&exports,St=zt&&\"object\"==typeof module&&module&&!module.nodeType&&module,Lt=St&&St.exports===zt,Wt=Lt&&It.process,Ct=function(){try{var n=St&&St.require&&St.require(\"util\").types;return n||Wt&&Wt.binding&&Wt.binding(\"util\")}catch(n){}}(),Ut=Ct&&Ct.isArrayBuffer,Bt=Ct&&Ct.isDate,Tt=Ct&&Ct.isMap,$t=Ct&&Ct.isRegExp,Dt=Ct&&Ct.isSet,Mt=Ct&&Ct.isTypedArray;function Ft(n,t,r){switch(r.length){case 0:return n.call(t);case 1:return n.call(t,r[0]);case 2:return n.call(t,r[0],r[1]);case 3:return n.call(t,r[0],r[1],r[2])}return n.apply(t,r)}function Nt(n,t,r,e){for(var u=-1,i=null==n?0:n.length;++u<i;){var o=n[u];t(e,o,r(o),n)}return e}function Pt(n,t){for(var r=-1,e=null==n?0:n.length;++r<e&&!1!==t(n[r],r,n););return n}function qt(n,t){for(var r=null==n?0:n.length;r--&&!1!==t(n[r],r,n););return n}function Zt(n,t){for(var r=-1,e=null==n?0:n.length;++r<e;)if(!t(n[r],r,n))return!1;return!0}function Kt(n,t){for(var r=-1,e=null==n?0:n.length,u=0,i=[];++r<e;){var o=n[r];t(o,r,n)&&(i[u++]=o)}return i}function Vt(n,t){return!!(null==n?0:n.length)&&er(n,t,0)>-1}function Gt(n,t,r){for(var e=-1,u=null==n?0:n.length;++e<u;)if(r(t,n[e]))return!0;return!1}function Ht(n,t){for(var r=-1,e=null==n?0:n.length,u=Array(e);++r<e;)u[r]=t(n[r],r,n);return u}function Jt(n,t){for(var r=-1,e=t.length,u=n.length;++r<e;)n[u+r]=t[r];return n}function Yt(n,t,r,e){var u=-1,i=null==n?0:n.length;for(e&&i&&(r=n[++u]);++u<i;)r=t(r,n[u],u,n);return r}function Qt(n,t,r,e){var u=null==n?0:n.length;for(e&&u&&(r=n[--u]);u--;)r=t(r,n[u],u,n);return r}function Xt(n,t){for(var r=-1,e=null==n?0:n.length;++r<e;)if(t(n[r],r,n))return!0;return!1}var nr=fr(\"length\");function tr(n,t,r){var e;return r(n,function(n,r,u){if(t(n,r,u))return e=r,!1}),e}function rr(n,t,r,e){for(var u=n.length,i=r+(e?1:-1);e?i--:++i<u;)if(t(n[i],i,n))return i;return-1}function er(n,t,r){return t==t?function(n,t,r){var e=r-1,u=n.length;for(;++e<u;)if(n[e]===t)return e;return-1}(n,t,r):rr(n,ir,r)}function ur(n,t,r,e){for(var u=r-1,i=n.length;++u<i;)if(e(n[u],t))return u;return-1}function ir(n){return n!=n}function or(n,t){var r=null==n?0:n.length;return r?lr(n,t)/r:S}function fr(t){return function(r){return null==r?n:r[t]}}function ar(t){return function(r){return null==t?n:t[r]}}function cr(n,t,r,e,u){return u(n,function(n,u,i){r=e?(e=!1,n):t(r,n,u,i)}),r}function lr(t,r){for(var e,u=-1,i=t.length;++u<i;){var o=r(t[u]);o!==n&&(e=e===n?o:e+o)}return e}function sr(n,t){for(var r=-1,e=Array(n);++r<n;)e[r]=t(r);return e}function hr(n){return function(t){return n(t)}}function pr(n,t){return Ht(t,function(t){return n[t]})}function vr(n,t){return n.has(t)}function _r(n,t){for(var r=-1,e=n.length;++r<e&&er(t,n[r],0)>-1;);return r}function gr(n,t){for(var r=n.length;r--&&er(t,n[r],0)>-1;);return r}var yr=ar({\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"C\",\"\":\"c\",\"\":\"D\",\"\":\"d\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"N\",\"\":\"n\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"Y\",\"\":\"y\",\"\":\"y\",\"\":\"Ae\",\"\":\"ae\",\"\":\"Th\",\"\":\"th\",\"\":\"ss\",\"\":\"A\",\"\":\"A\",\"\":\"A\",\"\":\"a\",\"\":\"a\",\"\":\"a\",\"\":\"C\",\"\":\"C\",\"\":\"C\",\"\":\"C\",\"\":\"c\",\"\":\"c\",\"\":\"c\",\"\":\"c\",\"\":\"D\",\"\":\"D\",\"\":\"d\",\"\":\"d\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"E\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"e\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"G\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"g\",\"\":\"H\",\"\":\"H\",\"\":\"h\",\"\":\"h\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"I\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"i\",\"\":\"J\",\"\":\"j\",\"\":\"K\",\"\":\"k\",\"\":\"k\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"L\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"l\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"N\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"n\",\"\":\"O\",\"\":\"O\",\"\":\"O\",\"\":\"o\",\"\":\"o\",\"\":\"o\",\"\":\"R\",\"\":\"R\",\"\":\"R\",\"\":\"r\",\"\":\"r\",\"\":\"r\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"S\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"s\",\"\":\"T\",\"\":\"T\",\"\":\"T\",\"\":\"t\",\"\":\"t\",\"\":\"t\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"U\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"u\",\"\":\"W\",\"\":\"w\",\"\":\"Y\",\"\":\"y\",\"\":\"Y\",\"\":\"Z\",\"\":\"Z\",\"\":\"Z\",\"\":\"z\",\"\":\"z\",\"\":\"z\",\"\":\"IJ\",\"\":\"ij\",\"\":\"Oe\",\"\":\"oe\",\"\":\"'n\",\"\":\"s\"}),dr=ar({\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\"});function br(n){return\"\\\\\"+At[n]}function wr(n){return dt.test(n)}function mr(n){var t=-1,r=Array(n.size);return n.forEach(function(n,e){r[++t]=[e,n]}),r}function xr(n,t){return function(r){return n(t(r))}}function jr(n,t){for(var r=-1,e=n.length,u=0,i=[];++r<e;){var f=n[r];f!==t&&f!==o||(n[r]=o,i[u++]=r)}return i}function Ar(n){var t=-1,r=Array(n.size);return n.forEach(function(n){r[++t]=n}),r}function kr(n){var t=-1,r=Array(n.size);return n.forEach(function(n){r[++t]=[n,n]}),r}function Or(n){return wr(n)?function(n){var t=gt.lastIndex=0;for(;gt.test(n);)++t;return t}(n):nr(n)}function Ir(n){return wr(n)?function(n){return n.match(gt)||[]}(n):function(n){return n.split(\"\")}(n)}var Rr=ar({\"&amp;\":\"&\",\"&lt;\":\"<\",\"&gt;\":\">\",\"&quot;\":'\"',\"&#39;\":\"'\"});var Er=function Gn(Hn){var Jn,Yn=(Hn=null==Hn?Et:Er.defaults(Et.Object(),Hn,Er.pick(Et,wt))).Array,Qn=Hn.Date,Xn=Hn.Error,nt=Hn.Function,tt=Hn.Math,rt=Hn.Object,et=Hn.RegExp,ut=Hn.String,it=Hn.TypeError,ot=Yn.prototype,ft=nt.prototype,at=rt.prototype,ct=Hn[\"__core-js_shared__\"],lt=ft.toString,st=at.hasOwnProperty,ht=0,pt=(Jn=/[^.]+$/.exec(ct&&ct.keys&&ct.keys.IE_PROTO||\"\"))?\"Symbol(src)_1.\"+Jn:\"\",gt=at.toString,dt=lt.call(rt),At=Et._,It=et(\"^\"+lt.call(st).replace(Rn,\"\\\\$&\").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g,\"$1.*?\")+\"$\"),Rt=Lt?Hn.Buffer:n,zt=Hn.Symbol,St=Hn.Uint8Array,Wt=Rt?Rt.allocUnsafe:n,Ct=xr(rt.getPrototypeOf,rt),nr=rt.create,ar=at.propertyIsEnumerable,zr=ot.splice,Sr=zt?zt.isConcatSpreadable:n,Lr=zt?zt.iterator:n,Wr=zt?zt.toStringTag:n,Cr=function(){try{var n=$i(rt,\"defineProperty\");return n({},\"\",{}),n}catch(n){}}(),Ur=Hn.clearTimeout!==Et.clearTimeout&&Hn.clearTimeout,Br=Qn&&Qn.now!==Et.Date.now&&Qn.now,Tr=Hn.setTimeout!==Et.setTimeout&&Hn.setTimeout,$r=tt.ceil,Dr=tt.floor,Mr=rt.getOwnPropertySymbols,Fr=Rt?Rt.isBuffer:n,Nr=Hn.isFinite,Pr=ot.join,qr=xr(rt.keys,rt),Zr=tt.max,Kr=tt.min,Vr=Qn.now,Gr=Hn.parseInt,Hr=tt.random,Jr=ot.reverse,Yr=$i(Hn,\"DataView\"),Qr=$i(Hn,\"Map\"),Xr=$i(Hn,\"Promise\"),ne=$i(Hn,\"Set\"),te=$i(Hn,\"WeakMap\"),re=$i(rt,\"create\"),ee=te&&new te,ue={},ie=lo(Yr),oe=lo(Qr),fe=lo(Xr),ae=lo(ne),ce=lo(te),le=zt?zt.prototype:n,se=le?le.valueOf:n,he=le?le.toString:n;function pe(n){if(Ef(n)&&!df(n)&&!(n instanceof ye)){if(n instanceof ge)return n;if(st.call(n,\"__wrapped__\"))return so(n)}return new ge(n)}var ve=function(){function t(){}return function(r){if(!Rf(r))return{};if(nr)return nr(r);t.prototype=r;var e=new t;return t.prototype=n,e}}();function _e(){}function ge(t,r){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=n}function ye(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=L,this.__views__=[]}function de(n){var t=-1,r=null==n?0:n.length;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}function be(n){var t=-1,r=null==n?0:n.length;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}function we(n){var t=-1,r=null==n?0:n.length;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}function me(n){var t=-1,r=null==n?0:n.length;for(this.__data__=new we;++t<r;)this.add(n[t])}function xe(n){var t=this.__data__=new be(n);this.size=t.size}function je(n,t){var r=df(n),e=!r&&yf(n),u=!r&&!e&&xf(n),i=!r&&!e&&!u&&Tf(n),o=r||e||u||i,f=o?sr(n.length,ut):[],a=f.length;for(var c in n)!t&&!st.call(n,c)||o&&(\"length\"==c||u&&(\"offset\"==c||\"parent\"==c)||i&&(\"buffer\"==c||\"byteLength\"==c||\"byteOffset\"==c)||Zi(c,a))||f.push(c);return f}function Ae(t){var r=t.length;return r?t[mu(0,r-1)]:n}function ke(n,t){return fo(ri(n),Ce(t,0,n.length))}function Oe(n){return fo(ri(n))}function Ie(t,r,e){(e===n||vf(t[r],e))&&(e!==n||r in t)||Le(t,r,e)}function Re(t,r,e){var u=t[r];st.call(t,r)&&vf(u,e)&&(e!==n||r in t)||Le(t,r,e)}function Ee(n,t){for(var r=n.length;r--;)if(vf(n[r][0],t))return r;return-1}function ze(n,t,r,e){return De(n,function(n,u,i){t(e,n,r(n),i)}),e}function Se(n,t){return n&&ei(t,ia(t),n)}function Le(n,t,r){\"__proto__\"==t&&Cr?Cr(n,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):n[t]=r}function We(t,r){for(var e=-1,u=r.length,i=Yn(u),o=null==t;++e<u;)i[e]=o?n:na(t,r[e]);return i}function Ce(t,r,e){return t==t&&(e!==n&&(t=t<=e?t:e),r!==n&&(t=t>=r?t:r)),t}function Ue(t,r,e,u,i,o){var l,s=r&f,h=r&a,p=r&c;if(e&&(l=i?e(t,u,i,o):e(t)),l!==n)return l;if(!Rf(t))return t;var v=df(t);if(v){if(l=function(n){var t=n.length,r=new n.constructor(t);return t&&\"string\"==typeof n[0]&&st.call(n,\"index\")&&(r.index=n.index,r.input=n.input),r}(t),!s)return ri(t,l)}else{var _=Fi(t),g=_==P||_==q;if(xf(t))return Ju(t,s);if(_==G||_==B||g&&!i){if(l=h||g?{}:Pi(t),!s)return h?function(n,t){return ei(n,Mi(n),t)}(t,function(n,t){return n&&ei(t,oa(t),n)}(l,t)):function(n,t){return ei(n,Di(n),t)}(t,Se(l,t))}else{if(!jt[_])return i?t:{};l=function(n,t,r){var e,u,i,o=n.constructor;switch(t){case en:return Yu(n);case D:case M:return new o(+n);case un:return function(n,t){var r=t?Yu(n.buffer):n.buffer;return new n.constructor(r,n.byteOffset,n.byteLength)}(n,r);case on:case fn:case an:case cn:case ln:case sn:case hn:case pn:case vn:return Qu(n,r);case Z:return new o;case K:case Q:return new o(n);case J:return(i=new(u=n).constructor(u.source,Dn.exec(u))).lastIndex=u.lastIndex,i;case Y:return new o;case X:return e=n,se?rt(se.call(e)):{}}}(t,_,s)}}o||(o=new xe);var y=o.get(t);if(y)return y;o.set(t,l),Cf(t)?t.forEach(function(n){l.add(Ue(n,r,e,n,t,o))}):zf(t)&&t.forEach(function(n,u){l.set(u,Ue(n,r,e,u,t,o))});var d=v?n:(p?h?Si:zi:h?oa:ia)(t);return Pt(d||t,function(n,u){d&&(n=t[u=n]),Re(l,u,Ue(n,r,e,u,t,o))}),l}function Be(t,r,e){var u=e.length;if(null==t)return!u;for(t=rt(t);u--;){var i=e[u],o=r[i],f=t[i];if(f===n&&!(i in t)||!o(f))return!1}return!0}function Te(t,r,u){if(\"function\"!=typeof t)throw new it(e);return eo(function(){t.apply(n,u)},r)}function $e(n,r,e,u){var i=-1,o=Vt,f=!0,a=n.length,c=[],l=r.length;if(!a)return c;e&&(r=Ht(r,hr(e))),u?(o=Gt,f=!1):r.length>=t&&(o=vr,f=!1,r=new me(r));n:for(;++i<a;){var s=n[i],h=null==e?s:e(s);if(s=u||0!==s?s:0,f&&h==h){for(var p=l;p--;)if(r[p]===h)continue n;c.push(s)}else o(r,h,u)||c.push(s)}return c}pe.templateSettings={escape:xn,evaluate:jn,interpolate:An,variable:\"\",imports:{_:pe}},pe.prototype=_e.prototype,pe.prototype.constructor=pe,ge.prototype=ve(_e.prototype),ge.prototype.constructor=ge,ye.prototype=ve(_e.prototype),ye.prototype.constructor=ye,de.prototype.clear=function(){this.__data__=re?re(null):{},this.size=0},de.prototype.delete=function(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t},de.prototype.get=function(t){var r=this.__data__;if(re){var e=r[t];return e===u?n:e}return st.call(r,t)?r[t]:n},de.prototype.has=function(t){var r=this.__data__;return re?r[t]!==n:st.call(r,t)},de.prototype.set=function(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=re&&r===n?u:r,this},be.prototype.clear=function(){this.__data__=[],this.size=0},be.prototype.delete=function(n){var t=this.__data__,r=Ee(t,n);return!(r<0||(r==t.length-1?t.pop():zr.call(t,r,1),--this.size,0))},be.prototype.get=function(t){var r=this.__data__,e=Ee(r,t);return e<0?n:r[e][1]},be.prototype.has=function(n){return Ee(this.__data__,n)>-1},be.prototype.set=function(n,t){var r=this.__data__,e=Ee(r,n);return e<0?(++this.size,r.push([n,t])):r[e][1]=t,this},we.prototype.clear=function(){this.size=0,this.__data__={hash:new de,map:new(Qr||be),string:new de}},we.prototype.delete=function(n){var t=Bi(this,n).delete(n);return this.size-=t?1:0,t},we.prototype.get=function(n){return Bi(this,n).get(n)},we.prototype.has=function(n){return Bi(this,n).has(n)},we.prototype.set=function(n,t){var r=Bi(this,n),e=r.size;return r.set(n,t),this.size+=r.size==e?0:1,this},me.prototype.add=me.prototype.push=function(n){return this.__data__.set(n,u),this},me.prototype.has=function(n){return this.__data__.has(n)},xe.prototype.clear=function(){this.__data__=new be,this.size=0},xe.prototype.delete=function(n){var t=this.__data__,r=t.delete(n);return this.size=t.size,r},xe.prototype.get=function(n){return this.__data__.get(n)},xe.prototype.has=function(n){return this.__data__.has(n)},xe.prototype.set=function(n,r){var e=this.__data__;if(e instanceof be){var u=e.__data__;if(!Qr||u.length<t-1)return u.push([n,r]),this.size=++e.size,this;e=this.__data__=new we(u)}return e.set(n,r),this.size=e.size,this};var De=oi(Ve),Me=oi(Ge,!0);function Fe(n,t){var r=!0;return De(n,function(n,e,u){return r=!!t(n,e,u)}),r}function Ne(t,r,e){for(var u=-1,i=t.length;++u<i;){var o=t[u],f=r(o);if(null!=f&&(a===n?f==f&&!Bf(f):e(f,a)))var a=f,c=o}return c}function Pe(n,t){var r=[];return De(n,function(n,e,u){t(n,e,u)&&r.push(n)}),r}function qe(n,t,r,e,u){var i=-1,o=n.length;for(r||(r=qi),u||(u=[]);++i<o;){var f=n[i];t>0&&r(f)?t>1?qe(f,t-1,r,e,u):Jt(u,f):e||(u[u.length]=f)}return u}var Ze=fi(),Ke=fi(!0);function Ve(n,t){return n&&Ze(n,t,ia)}function Ge(n,t){return n&&Ke(n,t,ia)}function He(n,t){return Kt(t,function(t){return kf(n[t])})}function Je(t,r){for(var e=0,u=(r=Ku(r,t)).length;null!=t&&e<u;)t=t[co(r[e++])];return e&&e==u?t:n}function Ye(n,t,r){var e=t(n);return df(n)?e:Jt(e,r(n))}function Qe(t){return null==t?t===n?nn:V:Wr&&Wr in rt(t)?function(t){var r=st.call(t,Wr),e=t[Wr];try{t[Wr]=n;var u=!0}catch(n){}var i=gt.call(t);return u&&(r?t[Wr]=e:delete t[Wr]),i}(t):function(n){return gt.call(n)}(t)}function Xe(n,t){return n>t}function nu(n,t){return null!=n&&st.call(n,t)}function tu(n,t){return null!=n&&t in rt(n)}function ru(t,r,e){for(var u=e?Gt:Vt,i=t[0].length,o=t.length,f=o,a=Yn(o),c=1/0,l=[];f--;){var s=t[f];f&&r&&(s=Ht(s,hr(r))),c=Kr(s.length,c),a[f]=!e&&(r||i>=120&&s.length>=120)?new me(f&&s):n}s=t[0];var h=-1,p=a[0];n:for(;++h<i&&l.length<c;){var v=s[h],_=r?r(v):v;if(v=e||0!==v?v:0,!(p?vr(p,_):u(l,_,e))){for(f=o;--f;){var g=a[f];if(!(g?vr(g,_):u(t[f],_,e)))continue n}p&&p.push(_),l.push(v)}}return l}function eu(t,r,e){var u=null==(t=no(t,r=Ku(r,t)))?t:t[co(jo(r))];return null==u?n:Ft(u,t,e)}function uu(n){return Ef(n)&&Qe(n)==B}function iu(t,r,e,u,i){return t===r||(null==t||null==r||!Ef(t)&&!Ef(r)?t!=t&&r!=r:function(t,r,e,u,i,o){var f=df(t),a=df(r),c=f?T:Fi(t),h=a?T:Fi(r),p=(c=c==B?G:c)==G,v=(h=h==B?G:h)==G,_=c==h;if(_&&xf(t)){if(!xf(r))return!1;f=!0,p=!1}if(_&&!p)return o||(o=new xe),f||Tf(t)?Ri(t,r,e,u,i,o):function(n,t,r,e,u,i,o){switch(r){case un:if(n.byteLength!=t.byteLength||n.byteOffset!=t.byteOffset)return!1;n=n.buffer,t=t.buffer;case en:return!(n.byteLength!=t.byteLength||!i(new St(n),new St(t)));case D:case M:case K:return vf(+n,+t);case N:return n.name==t.name&&n.message==t.message;case J:case Q:return n==t+\"\";case Z:var f=mr;case Y:var a=e&l;if(f||(f=Ar),n.size!=t.size&&!a)return!1;var c=o.get(n);if(c)return c==t;e|=s,o.set(n,t);var h=Ri(f(n),f(t),e,u,i,o);return o.delete(n),h;case X:if(se)return se.call(n)==se.call(t)}return!1}(t,r,c,e,u,i,o);if(!(e&l)){var g=p&&st.call(t,\"__wrapped__\"),y=v&&st.call(r,\"__wrapped__\");if(g||y){var d=g?t.value():t,b=y?r.value():r;return o||(o=new xe),i(d,b,e,u,o)}}return!!_&&(o||(o=new xe),function(t,r,e,u,i,o){var f=e&l,a=zi(t),c=a.length,s=zi(r).length;if(c!=s&&!f)return!1;for(var h=c;h--;){var p=a[h];if(!(f?p in r:st.call(r,p)))return!1}var v=o.get(t);if(v&&o.get(r))return v==r;var _=!0;o.set(t,r),o.set(r,t);for(var g=f;++h<c;){p=a[h];var y=t[p],d=r[p];if(u)var b=f?u(d,y,p,r,t,o):u(y,d,p,t,r,o);if(!(b===n?y===d||i(y,d,e,u,o):b)){_=!1;break}g||(g=\"constructor\"==p)}if(_&&!g){var w=t.constructor,m=r.constructor;w!=m&&\"constructor\"in t&&\"constructor\"in r&&!(\"function\"==typeof w&&w instanceof w&&\"function\"==typeof m&&m instanceof m)&&(_=!1)}return o.delete(t),o.delete(r),_}(t,r,e,u,i,o))}(t,r,e,u,iu,i))}function ou(t,r,e,u){var i=e.length,o=i,f=!u;if(null==t)return!o;for(t=rt(t);i--;){var a=e[i];if(f&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){var c=(a=e[i])[0],h=t[c],p=a[1];if(f&&a[2]){if(h===n&&!(c in t))return!1}else{var v=new xe;if(u)var _=u(h,p,c,t,r,v);if(!(_===n?iu(p,h,l|s,u,v):_))return!1}}return!0}function fu(n){return!(!Rf(n)||pt&&pt in n)&&(kf(n)?It:Nn).test(lo(n))}function au(n){return\"function\"==typeof n?n:null==n?Sa:\"object\"==typeof n?df(n)?vu(n[0],n[1]):pu(n):Ma(n)}function cu(n){if(!Ji(n))return qr(n);var t=[];for(var r in rt(n))st.call(n,r)&&\"constructor\"!=r&&t.push(r);return t}function lu(n){if(!Rf(n))return function(n){var t=[];if(null!=n)for(var r in rt(n))t.push(r);return t}(n);var t=Ji(n),r=[];for(var e in n)(\"constructor\"!=e||!t&&st.call(n,e))&&r.push(e);return r}function su(n,t){return n<t}function hu(n,t){var r=-1,e=wf(n)?Yn(n.length):[];return De(n,function(n,u,i){e[++r]=t(n,u,i)}),e}function pu(n){var t=Ti(n);return 1==t.length&&t[0][2]?Qi(t[0][0],t[0][1]):function(r){return r===n||ou(r,n,t)}}function vu(t,r){return Vi(t)&&Yi(r)?Qi(co(t),r):function(e){var u=na(e,t);return u===n&&u===r?ta(e,t):iu(r,u,l|s)}}function _u(t,r,e,u,i){t!==r&&Ze(r,function(o,f){if(i||(i=new xe),Rf(o))!function(t,r,e,u,i,o,f){var a=to(t,e),c=to(r,e),l=f.get(c);if(l)Ie(t,e,l);else{var s=o?o(a,c,e+\"\",t,r,f):n,h=s===n;if(h){var p=df(c),v=!p&&xf(c),_=!p&&!v&&Tf(c);s=c,p||v||_?df(a)?s=a:mf(a)?s=ri(a):v?(h=!1,s=Ju(c,!0)):_?(h=!1,s=Qu(c,!0)):s=[]:Lf(c)||yf(c)?(s=a,yf(a)?s=Zf(a):Rf(a)&&!kf(a)||(s=Pi(c))):h=!1}h&&(f.set(c,s),i(s,c,u,o,f),f.delete(c)),Ie(t,e,s)}}(t,r,f,e,_u,u,i);else{var a=u?u(to(t,f),o,f+\"\",t,r,i):n;a===n&&(a=o),Ie(t,f,a)}},oa)}function gu(t,r){var e=t.length;if(e)return Zi(r+=r<0?e:0,e)?t[r]:n}function yu(n,t,r){var e=-1;return t=Ht(t.length?t:[Sa],hr(Ui())),function(n,t){var r=n.length;for(n.sort(t);r--;)n[r]=n[r].value;return n}(hu(n,function(n,r,u){return{criteria:Ht(t,function(t){return t(n)}),index:++e,value:n}}),function(n,t){return function(n,t,r){for(var e=-1,u=n.criteria,i=t.criteria,o=u.length,f=r.length;++e<o;){var a=Xu(u[e],i[e]);if(a){if(e>=f)return a;var c=r[e];return a*(\"desc\"==c?-1:1)}}return n.index-t.index}(n,t,r)})}function du(n,t,r){for(var e=-1,u=t.length,i={};++e<u;){var o=t[e],f=Je(n,o);r(f,o)&&Ou(i,Ku(o,n),f)}return i}function bu(n,t,r,e){var u=e?ur:er,i=-1,o=t.length,f=n;for(n===t&&(t=ri(t)),r&&(f=Ht(n,hr(r)));++i<o;)for(var a=0,c=t[i],l=r?r(c):c;(a=u(f,l,a,e))>-1;)f!==n&&zr.call(f,a,1),zr.call(n,a,1);return n}function wu(n,t){for(var r=n?t.length:0,e=r-1;r--;){var u=t[r];if(r==e||u!==i){var i=u;Zi(u)?zr.call(n,u,1):$u(n,u)}}return n}function mu(n,t){return n+Dr(Hr()*(t-n+1))}function xu(n,t){var r=\"\";if(!n||t<1||t>E)return r;do{t%2&&(r+=n),(t=Dr(t/2))&&(n+=n)}while(t);return r}function ju(n,t){return uo(Xi(n,t,Sa),n+\"\")}function Au(n){return Ae(va(n))}function ku(n,t){var r=va(n);return fo(r,Ce(t,0,r.length))}function Ou(t,r,e,u){if(!Rf(t))return t;for(var i=-1,o=(r=Ku(r,t)).length,f=o-1,a=t;null!=a&&++i<o;){var c=co(r[i]),l=e;if(i!=f){var s=a[c];(l=u?u(s,c,a):n)===n&&(l=Rf(s)?s:Zi(r[i+1])?[]:{})}Re(a,c,l),a=a[c]}return t}var Iu=ee?function(n,t){return ee.set(n,t),n}:Sa,Ru=Cr?function(n,t){return Cr(n,\"toString\",{configurable:!0,enumerable:!1,value:Ra(t),writable:!0})}:Sa;function Eu(n){return fo(va(n))}function zu(n,t,r){var e=-1,u=n.length;t<0&&(t=-t>u?0:u+t),(r=r>u?u:r)<0&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0;for(var i=Yn(u);++e<u;)i[e]=n[e+t];return i}function Su(n,t){var r;return De(n,function(n,e,u){return!(r=t(n,e,u))}),!!r}function Lu(n,t,r){var e=0,u=null==n?e:n.length;if(\"number\"==typeof t&&t==t&&u<=C){for(;e<u;){var i=e+u>>>1,o=n[i];null!==o&&!Bf(o)&&(r?o<=t:o<t)?e=i+1:u=i}return u}return Wu(n,t,Sa,r)}function Wu(t,r,e,u){r=e(r);for(var i=0,o=null==t?0:t.length,f=r!=r,a=null===r,c=Bf(r),l=r===n;i<o;){var s=Dr((i+o)/2),h=e(t[s]),p=h!==n,v=null===h,_=h==h,g=Bf(h);if(f)var y=u||_;else y=l?_&&(u||p):a?_&&p&&(u||!v):c?_&&p&&!v&&(u||!g):!v&&!g&&(u?h<=r:h<r);y?i=s+1:o=s}return Kr(o,W)}function Cu(n,t){for(var r=-1,e=n.length,u=0,i=[];++r<e;){var o=n[r],f=t?t(o):o;if(!r||!vf(f,a)){var a=f;i[u++]=0===o?0:o}}return i}function Uu(n){return\"number\"==typeof n?n:Bf(n)?S:+n}function Bu(n){if(\"string\"==typeof n)return n;if(df(n))return Ht(n,Bu)+\"\";if(Bf(n))return he?he.call(n):\"\";var t=n+\"\";return\"0\"==t&&1/n==-R?\"-0\":t}function Tu(n,r,e){var u=-1,i=Vt,o=n.length,f=!0,a=[],c=a;if(e)f=!1,i=Gt;else if(o>=t){var l=r?null:xi(n);if(l)return Ar(l);f=!1,i=vr,c=new me}else c=r?[]:a;n:for(;++u<o;){var s=n[u],h=r?r(s):s;if(s=e||0!==s?s:0,f&&h==h){for(var p=c.length;p--;)if(c[p]===h)continue n;r&&c.push(h),a.push(s)}else i(c,h,e)||(c!==a&&c.push(h),a.push(s))}return a}function $u(n,t){return null==(n=no(n,t=Ku(t,n)))||delete n[co(jo(t))]}function Du(n,t,r,e){return Ou(n,t,r(Je(n,t)),e)}function Mu(n,t,r,e){for(var u=n.length,i=e?u:-1;(e?i--:++i<u)&&t(n[i],i,n););return r?zu(n,e?0:i,e?i+1:u):zu(n,e?i+1:0,e?u:i)}function Fu(n,t){var r=n;return r instanceof ye&&(r=r.value()),Yt(t,function(n,t){return t.func.apply(t.thisArg,Jt([n],t.args))},r)}function Nu(n,t,r){var e=n.length;if(e<2)return e?Tu(n[0]):[];for(var u=-1,i=Yn(e);++u<e;)for(var o=n[u],f=-1;++f<e;)f!=u&&(i[u]=$e(i[u]||o,n[f],t,r));return Tu(qe(i,1),t,r)}function Pu(t,r,e){for(var u=-1,i=t.length,o=r.length,f={};++u<i;){var a=u<o?r[u]:n;e(f,t[u],a)}return f}function qu(n){return mf(n)?n:[]}function Zu(n){return\"function\"==typeof n?n:Sa}function Ku(n,t){return df(n)?n:Vi(n,t)?[n]:ao(Kf(n))}var Vu=ju;function Gu(t,r,e){var u=t.length;return e=e===n?u:e,!r&&e>=u?t:zu(t,r,e)}var Hu=Ur||function(n){return Et.clearTimeout(n)};function Ju(n,t){if(t)return n.slice();var r=n.length,e=Wt?Wt(r):new n.constructor(r);return n.copy(e),e}function Yu(n){var t=new n.constructor(n.byteLength);return new St(t).set(new St(n)),t}function Qu(n,t){var r=t?Yu(n.buffer):n.buffer;return new n.constructor(r,n.byteOffset,n.length)}function Xu(t,r){if(t!==r){var e=t!==n,u=null===t,i=t==t,o=Bf(t),f=r!==n,a=null===r,c=r==r,l=Bf(r);if(!a&&!l&&!o&&t>r||o&&f&&c&&!a&&!l||u&&f&&c||!e&&c||!i)return 1;if(!u&&!o&&!l&&t<r||l&&e&&i&&!u&&!o||a&&e&&i||!f&&i||!c)return-1}return 0}function ni(n,t,r,e){for(var u=-1,i=n.length,o=r.length,f=-1,a=t.length,c=Zr(i-o,0),l=Yn(a+c),s=!e;++f<a;)l[f]=t[f];for(;++u<o;)(s||u<i)&&(l[r[u]]=n[u]);for(;c--;)l[f++]=n[u++];return l}function ti(n,t,r,e){for(var u=-1,i=n.length,o=-1,f=r.length,a=-1,c=t.length,l=Zr(i-f,0),s=Yn(l+c),h=!e;++u<l;)s[u]=n[u];for(var p=u;++a<c;)s[p+a]=t[a];for(;++o<f;)(h||u<i)&&(s[p+r[o]]=n[u++]);return s}function ri(n,t){var r=-1,e=n.length;for(t||(t=Yn(e));++r<e;)t[r]=n[r];return t}function ei(t,r,e,u){var i=!e;e||(e={});for(var o=-1,f=r.length;++o<f;){var a=r[o],c=u?u(e[a],t[a],a,e,t):n;c===n&&(c=t[a]),i?Le(e,a,c):Re(e,a,c)}return e}function ui(n,t){return function(r,e){var u=df(r)?Nt:ze,i=t?t():{};return u(r,n,Ui(e,2),i)}}function ii(t){return ju(function(r,e){var u=-1,i=e.length,o=i>1?e[i-1]:n,f=i>2?e[2]:n;for(o=t.length>3&&\"function\"==typeof o?(i--,o):n,f&&Ki(e[0],e[1],f)&&(o=i<3?n:o,i=1),r=rt(r);++u<i;){var a=e[u];a&&t(r,a,u,o)}return r})}function oi(n,t){return function(r,e){if(null==r)return r;if(!wf(r))return n(r,e);for(var u=r.length,i=t?u:-1,o=rt(r);(t?i--:++i<u)&&!1!==e(o[i],i,o););return r}}function fi(n){return function(t,r,e){for(var u=-1,i=rt(t),o=e(t),f=o.length;f--;){var a=o[n?f:++u];if(!1===r(i[a],a,i))break}return t}}function ai(t){return function(r){var e=wr(r=Kf(r))?Ir(r):n,u=e?e[0]:r.charAt(0),i=e?Gu(e,1).join(\"\"):r.slice(1);return u[t]()+i}}function ci(n){return function(t){return Yt(ka(ya(t).replace(vt,\"\")),n,\"\")}}function li(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=ve(n.prototype),e=n.apply(r,t);return Rf(e)?e:r}}function si(t){return function(r,e,u){var i=rt(r);if(!wf(r)){var o=Ui(e,3);r=ia(r),e=function(n){return o(i[n],n,i)}}var f=t(r,e,u);return f>-1?i[o?r[f]:f]:n}}function hi(t){return Ei(function(r){var u=r.length,i=u,o=ge.prototype.thru;for(t&&r.reverse();i--;){var f=r[i];if(\"function\"!=typeof f)throw new it(e);if(o&&!a&&\"wrapper\"==Wi(f))var a=new ge([],!0)}for(i=a?i:u;++i<u;){var c=Wi(f=r[i]),l=\"wrapper\"==c?Li(f):n;a=l&&Gi(l[0])&&l[1]==(b|_|y|w)&&!l[4].length&&1==l[9]?a[Wi(l[0])].apply(a,l[3]):1==f.length&&Gi(f)?a[c]():a.thru(f)}return function(){var n=arguments,t=n[0];if(a&&1==n.length&&df(t))return a.plant(t).value();for(var e=0,i=u?r[e].apply(this,n):t;++e<u;)i=r[e].call(this,i);return i}})}function pi(t,r,e,u,i,o,f,a,c,l){var s=r&b,v=r&h,y=r&p,d=r&(_|g),w=r&m,x=y?n:li(t);return function h(){for(var p=arguments.length,_=Yn(p),g=p;g--;)_[g]=arguments[g];if(d)var b=Ci(h),m=function(n,t){for(var r=n.length,e=0;r--;)n[r]===t&&++e;return e}(_,b);if(u&&(_=ni(_,u,i,d)),o&&(_=ti(_,o,f,d)),p-=m,d&&p<l){var j=jr(_,b);return wi(t,r,pi,h.placeholder,e,_,j,a,c,l-p)}var A=v?e:this,k=y?A[t]:t;return p=_.length,a?_=function(t,r){for(var e=t.length,u=Kr(r.length,e),i=ri(t);u--;){var o=r[u];t[u]=Zi(o,e)?i[o]:n}return t}(_,a):w&&p>1&&_.reverse(),s&&c<p&&(_.length=c),this&&this!==Et&&this instanceof h&&(k=x||li(k)),k.apply(A,_)}}function vi(n,t){return function(r,e){return function(n,t,r,e){return Ve(n,function(n,u,i){t(e,r(n),u,i)}),e}(r,n,t(e),{})}}function _i(t,r){return function(e,u){var i;if(e===n&&u===n)return r;if(e!==n&&(i=e),u!==n){if(i===n)return u;\"string\"==typeof e||\"string\"==typeof u?(e=Bu(e),u=Bu(u)):(e=Uu(e),u=Uu(u)),i=t(e,u)}return i}}function gi(n){return Ei(function(t){return t=Ht(t,hr(Ui())),ju(function(r){var e=this;return n(t,function(n){return Ft(n,e,r)})})})}function yi(t,r){var e=(r=r===n?\" \":Bu(r)).length;if(e<2)return e?xu(r,t):r;var u=xu(r,$r(t/Or(r)));return wr(r)?Gu(Ir(u),0,t).join(\"\"):u.slice(0,t)}function di(t){return function(r,e,u){return u&&\"number\"!=typeof u&&Ki(r,e,u)&&(e=u=n),r=Ff(r),e===n?(e=r,r=0):e=Ff(e),function(n,t,r,e){for(var u=-1,i=Zr($r((t-n)/(r||1)),0),o=Yn(i);i--;)o[e?i:++u]=n,n+=r;return o}(r,e,u=u===n?r<e?1:-1:Ff(u),t)}}function bi(n){return function(t,r){return\"string\"==typeof t&&\"string\"==typeof r||(t=qf(t),r=qf(r)),n(t,r)}}function wi(t,r,e,u,i,o,f,a,c,l){var s=r&_;r|=s?y:d,(r&=~(s?d:y))&v||(r&=~(h|p));var g=[t,r,i,s?o:n,s?f:n,s?n:o,s?n:f,a,c,l],b=e.apply(n,g);return Gi(t)&&ro(b,g),b.placeholder=u,io(b,t,r)}function mi(n){var t=tt[n];return function(n,r){if(n=qf(n),(r=null==r?0:Kr(Nf(r),292))&&Nr(n)){var e=(Kf(n)+\"e\").split(\"e\");return+((e=(Kf(t(e[0]+\"e\"+(+e[1]+r)))+\"e\").split(\"e\"))[0]+\"e\"+(+e[1]-r))}return t(n)}}var xi=ne&&1/Ar(new ne([,-0]))[1]==R?function(n){return new ne(n)}:Ba;function ji(n){return function(t){var r=Fi(t);return r==Z?mr(t):r==Y?kr(t):function(n,t){return Ht(t,function(t){return[t,n[t]]})}(t,n(t))}}function Ai(t,r,u,i,f,a,c,l){var s=r&p;if(!s&&\"function\"!=typeof t)throw new it(e);var m=i?i.length:0;if(m||(r&=~(y|d),i=f=n),c=c===n?c:Zr(Nf(c),0),l=l===n?l:Nf(l),m-=f?f.length:0,r&d){var x=i,j=f;i=f=n}var A=s?n:Li(t),k=[t,r,u,i,f,x,j,a,c,l];if(A&&function(n,t){var r=n[1],e=t[1],u=r|e,i=u<(h|p|b),f=e==b&&r==_||e==b&&r==w&&n[7].length<=t[8]||e==(b|w)&&t[7].length<=t[8]&&r==_;if(!i&&!f)return n;e&h&&(n[2]=t[2],u|=r&h?0:v);var a=t[3];if(a){var c=n[3];n[3]=c?ni(c,a,t[4]):a,n[4]=c?jr(n[3],o):t[4]}(a=t[5])&&(c=n[5],n[5]=c?ti(c,a,t[6]):a,n[6]=c?jr(n[5],o):t[6]),(a=t[7])&&(n[7]=a),e&b&&(n[8]=null==n[8]?t[8]:Kr(n[8],t[8])),null==n[9]&&(n[9]=t[9]),n[0]=t[0],n[1]=u}(k,A),t=k[0],r=k[1],u=k[2],i=k[3],f=k[4],!(l=k[9]=k[9]===n?s?0:t.length:Zr(k[9]-m,0))&&r&(_|g)&&(r&=~(_|g)),r&&r!=h)O=r==_||r==g?function(t,r,e){var u=li(t);return function i(){for(var o=arguments.length,f=Yn(o),a=o,c=Ci(i);a--;)f[a]=arguments[a];var l=o<3&&f[0]!==c&&f[o-1]!==c?[]:jr(f,c);return(o-=l.length)<e?wi(t,r,pi,i.placeholder,n,f,l,n,n,e-o):Ft(this&&this!==Et&&this instanceof i?u:t,this,f)}}(t,r,l):r!=y&&r!=(h|y)||f.length?pi.apply(n,k):function(n,t,r,e){var u=t&h,i=li(n);return function t(){for(var o=-1,f=arguments.length,a=-1,c=e.length,l=Yn(c+f),s=this&&this!==Et&&this instanceof t?i:n;++a<c;)l[a]=e[a];for(;f--;)l[a++]=arguments[++o];return Ft(s,u?r:this,l)}}(t,r,u,i);else var O=function(n,t,r){var e=t&h,u=li(n);return function t(){return(this&&this!==Et&&this instanceof t?u:n).apply(e?r:this,arguments)}}(t,r,u);return io((A?Iu:ro)(O,k),t,r)}function ki(t,r,e,u){return t===n||vf(t,at[e])&&!st.call(u,e)?r:t}function Oi(t,r,e,u,i,o){return Rf(t)&&Rf(r)&&(o.set(r,t),_u(t,r,n,Oi,o),o.delete(r)),t}function Ii(t){return Lf(t)?n:t}function Ri(t,r,e,u,i,o){var f=e&l,a=t.length,c=r.length;if(a!=c&&!(f&&c>a))return!1;var h=o.get(t);if(h&&o.get(r))return h==r;var p=-1,v=!0,_=e&s?new me:n;for(o.set(t,r),o.set(r,t);++p<a;){var g=t[p],y=r[p];if(u)var d=f?u(y,g,p,r,t,o):u(g,y,p,t,r,o);if(d!==n){if(d)continue;v=!1;break}if(_){if(!Xt(r,function(n,t){if(!vr(_,t)&&(g===n||i(g,n,e,u,o)))return _.push(t)})){v=!1;break}}else if(g!==y&&!i(g,y,e,u,o)){v=!1;break}}return o.delete(t),o.delete(r),v}function Ei(t){return uo(Xi(t,n,yo),t+\"\")}function zi(n){return Ye(n,ia,Di)}function Si(n){return Ye(n,oa,Mi)}var Li=ee?function(n){return ee.get(n)}:Ba;function Wi(n){for(var t=n.name+\"\",r=ue[t],e=st.call(ue,t)?r.length:0;e--;){var u=r[e],i=u.func;if(null==i||i==n)return u.name}return t}function Ci(n){return(st.call(pe,\"placeholder\")?pe:n).placeholder}function Ui(){var n=pe.iteratee||La;return n=n===La?au:n,arguments.length?n(arguments[0],arguments[1]):n}function Bi(n,t){var r,e,u=n.__data__;return(\"string\"==(e=typeof(r=t))||\"number\"==e||\"symbol\"==e||\"boolean\"==e?\"__proto__\"!==r:null===r)?u[\"string\"==typeof t?\"string\":\"hash\"]:u.map}function Ti(n){for(var t=ia(n),r=t.length;r--;){var e=t[r],u=n[e];t[r]=[e,u,Yi(u)]}return t}function $i(t,r){var e=function(t,r){return null==t?n:t[r]}(t,r);return fu(e)?e:n}var Di=Mr?function(n){return null==n?[]:(n=rt(n),Kt(Mr(n),function(t){return ar.call(n,t)}))}:Pa,Mi=Mr?function(n){for(var t=[];n;)Jt(t,Di(n)),n=Ct(n);return t}:Pa,Fi=Qe;function Ni(n,t,r){for(var e=-1,u=(t=Ku(t,n)).length,i=!1;++e<u;){var o=co(t[e]);if(!(i=null!=n&&r(n,o)))break;n=n[o]}return i||++e!=u?i:!!(u=null==n?0:n.length)&&If(u)&&Zi(o,u)&&(df(n)||yf(n))}function Pi(n){return\"function\"!=typeof n.constructor||Ji(n)?{}:ve(Ct(n))}function qi(n){return df(n)||yf(n)||!!(Sr&&n&&n[Sr])}function Zi(n,t){var r=typeof n;return!!(t=null==t?E:t)&&(\"number\"==r||\"symbol\"!=r&&qn.test(n))&&n>-1&&n%1==0&&n<t}function Ki(n,t,r){if(!Rf(r))return!1;var e=typeof t;return!!(\"number\"==e?wf(r)&&Zi(t,r.length):\"string\"==e&&t in r)&&vf(r[t],n)}function Vi(n,t){if(df(n))return!1;var r=typeof n;return!(\"number\"!=r&&\"symbol\"!=r&&\"boolean\"!=r&&null!=n&&!Bf(n))||On.test(n)||!kn.test(n)||null!=t&&n in rt(t)}function Gi(n){var t=Wi(n),r=pe[t];if(\"function\"!=typeof r||!(t in ye.prototype))return!1;if(n===r)return!0;var e=Li(r);return!!e&&n===e[0]}(Yr&&Fi(new Yr(new ArrayBuffer(1)))!=un||Qr&&Fi(new Qr)!=Z||Xr&&\"[object Promise]\"!=Fi(Xr.resolve())||ne&&Fi(new ne)!=Y||te&&Fi(new te)!=tn)&&(Fi=function(t){var r=Qe(t),e=r==G?t.constructor:n,u=e?lo(e):\"\";if(u)switch(u){case ie:return un;case oe:return Z;case fe:return\"[object Promise]\";case ae:return Y;case ce:return tn}return r});var Hi=ct?kf:qa;function Ji(n){var t=n&&n.constructor;return n===(\"function\"==typeof t&&t.prototype||at)}function Yi(n){return n==n&&!Rf(n)}function Qi(t,r){return function(e){return null!=e&&e[t]===r&&(r!==n||t in rt(e))}}function Xi(t,r,e){return r=Zr(r===n?t.length-1:r,0),function(){for(var n=arguments,u=-1,i=Zr(n.length-r,0),o=Yn(i);++u<i;)o[u]=n[r+u];u=-1;for(var f=Yn(r+1);++u<r;)f[u]=n[u];return f[r]=e(o),Ft(t,this,f)}}function no(n,t){return t.length<2?n:Je(n,zu(t,0,-1))}function to(n,t){if((\"constructor\"!==t||\"function\"!=typeof n[t])&&\"__proto__\"!=t)return n[t]}var ro=oo(Iu),eo=Tr||function(n,t){return Et.setTimeout(n,t)},uo=oo(Ru);function io(n,t,r){var e=t+\"\";return uo(n,function(n,t){var r=t.length;if(!r)return n;var e=r-1;return t[e]=(r>1?\"& \":\"\")+t[e],t=t.join(r>2?\", \":\" \"),n.replace(Wn,\"{\\n/* [wrapped with \"+t+\"] */\\n\")}(e,function(n,t){return Pt(U,function(r){var e=\"_.\"+r[0];t&r[1]&&!Vt(n,e)&&n.push(e)}),n.sort()}(function(n){var t=n.match(Cn);return t?t[1].split(Un):[]}(e),r)))}function oo(t){var r=0,e=0;return function(){var u=Vr(),i=k-(u-e);if(e=u,i>0){if(++r>=A)return arguments[0]}else r=0;return t.apply(n,arguments)}}function fo(t,r){var e=-1,u=t.length,i=u-1;for(r=r===n?u:r;++e<r;){var o=mu(e,i),f=t[o];t[o]=t[e],t[e]=f}return t.length=r,t}var ao=function(n){var t=af(n,function(n){return r.size===i&&r.clear(),n}),r=t.cache;return t}(function(n){var t=[];return 46===n.charCodeAt(0)&&t.push(\"\"),n.replace(In,function(n,r,e,u){t.push(e?u.replace(Tn,\"$1\"):r||n)}),t});function co(n){if(\"string\"==typeof n||Bf(n))return n;var t=n+\"\";return\"0\"==t&&1/n==-R?\"-0\":t}function lo(n){if(null!=n){try{return lt.call(n)}catch(n){}try{return n+\"\"}catch(n){}}return\"\"}function so(n){if(n instanceof ye)return n.clone();var t=new ge(n.__wrapped__,n.__chain__);return t.__actions__=ri(n.__actions__),t.__index__=n.__index__,t.__values__=n.__values__,t}var ho=ju(function(n,t){return mf(n)?$e(n,qe(t,1,mf,!0)):[]}),po=ju(function(t,r){var e=jo(r);return mf(e)&&(e=n),mf(t)?$e(t,qe(r,1,mf,!0),Ui(e,2)):[]}),vo=ju(function(t,r){var e=jo(r);return mf(e)&&(e=n),mf(t)?$e(t,qe(r,1,mf,!0),n,e):[]});function _o(n,t,r){var e=null==n?0:n.length;if(!e)return-1;var u=null==r?0:Nf(r);return u<0&&(u=Zr(e+u,0)),rr(n,Ui(t,3),u)}function go(t,r,e){var u=null==t?0:t.length;if(!u)return-1;var i=u-1;return e!==n&&(i=Nf(e),i=e<0?Zr(u+i,0):Kr(i,u-1)),rr(t,Ui(r,3),i,!0)}function yo(n){return null!=n&&n.length?qe(n,1):[]}function bo(t){return t&&t.length?t[0]:n}var wo=ju(function(n){var t=Ht(n,qu);return t.length&&t[0]===n[0]?ru(t):[]}),mo=ju(function(t){var r=jo(t),e=Ht(t,qu);return r===jo(e)?r=n:e.pop(),e.length&&e[0]===t[0]?ru(e,Ui(r,2)):[]}),xo=ju(function(t){var r=jo(t),e=Ht(t,qu);return(r=\"function\"==typeof r?r:n)&&e.pop(),e.length&&e[0]===t[0]?ru(e,n,r):[]});function jo(t){var r=null==t?0:t.length;return r?t[r-1]:n}var Ao=ju(ko);function ko(n,t){return n&&n.length&&t&&t.length?bu(n,t):n}var Oo=Ei(function(n,t){var r=null==n?0:n.length,e=We(n,t);return wu(n,Ht(t,function(n){return Zi(n,r)?+n:n}).sort(Xu)),e});function Io(n){return null==n?n:Jr.call(n)}var Ro=ju(function(n){return Tu(qe(n,1,mf,!0))}),Eo=ju(function(t){var r=jo(t);return mf(r)&&(r=n),Tu(qe(t,1,mf,!0),Ui(r,2))}),zo=ju(function(t){var r=jo(t);return r=\"function\"==typeof r?r:n,Tu(qe(t,1,mf,!0),n,r)});function So(n){if(!n||!n.length)return[];var t=0;return n=Kt(n,function(n){if(mf(n))return t=Zr(n.length,t),!0}),sr(t,function(t){return Ht(n,fr(t))})}function Lo(t,r){if(!t||!t.length)return[];var e=So(t);return null==r?e:Ht(e,function(t){return Ft(r,n,t)})}var Wo=ju(function(n,t){return mf(n)?$e(n,t):[]}),Co=ju(function(n){return Nu(Kt(n,mf))}),Uo=ju(function(t){var r=jo(t);return mf(r)&&(r=n),Nu(Kt(t,mf),Ui(r,2))}),Bo=ju(function(t){var r=jo(t);return r=\"function\"==typeof r?r:n,Nu(Kt(t,mf),n,r)}),To=ju(So);var $o=ju(function(t){var r=t.length,e=r>1?t[r-1]:n;return Lo(t,e=\"function\"==typeof e?(t.pop(),e):n)});function Do(n){var t=pe(n);return t.__chain__=!0,t}function Mo(n,t){return t(n)}var Fo=Ei(function(t){var r=t.length,e=r?t[0]:0,u=this.__wrapped__,i=function(n){return We(n,t)};return!(r>1||this.__actions__.length)&&u instanceof ye&&Zi(e)?((u=u.slice(e,+e+(r?1:0))).__actions__.push({func:Mo,args:[i],thisArg:n}),new ge(u,this.__chain__).thru(function(t){return r&&!t.length&&t.push(n),t})):this.thru(i)});var No=ui(function(n,t,r){st.call(n,r)?++n[r]:Le(n,r,1)});var Po=si(_o),qo=si(go);function Zo(n,t){return(df(n)?Pt:De)(n,Ui(t,3))}function Ko(n,t){return(df(n)?qt:Me)(n,Ui(t,3))}var Vo=ui(function(n,t,r){st.call(n,r)?n[r].push(t):Le(n,r,[t])});var Go=ju(function(n,t,r){var e=-1,u=\"function\"==typeof t,i=wf(n)?Yn(n.length):[];return De(n,function(n){i[++e]=u?Ft(t,n,r):eu(n,t,r)}),i}),Ho=ui(function(n,t,r){Le(n,r,t)});function Jo(n,t){return(df(n)?Ht:hu)(n,Ui(t,3))}var Yo=ui(function(n,t,r){n[r?0:1].push(t)},function(){return[[],[]]});var Qo=ju(function(n,t){if(null==n)return[];var r=t.length;return r>1&&Ki(n,t[0],t[1])?t=[]:r>2&&Ki(t[0],t[1],t[2])&&(t=[t[0]]),yu(n,qe(t,1),[])}),Xo=Br||function(){return Et.Date.now()};function nf(t,r,e){return r=e?n:r,r=t&&null==r?t.length:r,Ai(t,b,n,n,n,n,r)}function tf(t,r){var u;if(\"function\"!=typeof r)throw new it(e);return t=Nf(t),function(){return--t>0&&(u=r.apply(this,arguments)),t<=1&&(r=n),u}}var rf=ju(function(n,t,r){var e=h;if(r.length){var u=jr(r,Ci(rf));e|=y}return Ai(n,e,t,r,u)}),ef=ju(function(n,t,r){var e=h|p;if(r.length){var u=jr(r,Ci(ef));e|=y}return Ai(t,e,n,r,u)});function uf(t,r,u){var i,o,f,a,c,l,s=0,h=!1,p=!1,v=!0;if(\"function\"!=typeof t)throw new it(e);function _(r){var e=i,u=o;return i=o=n,s=r,a=t.apply(u,e)}function g(t){var e=t-l;return l===n||e>=r||e<0||p&&t-s>=f}function y(){var n=Xo();if(g(n))return d(n);c=eo(y,function(n){var t=r-(n-l);return p?Kr(t,f-(n-s)):t}(n))}function d(t){return c=n,v&&i?_(t):(i=o=n,a)}function b(){var t=Xo(),e=g(t);if(i=arguments,o=this,l=t,e){if(c===n)return function(n){return s=n,c=eo(y,r),h?_(n):a}(l);if(p)return Hu(c),c=eo(y,r),_(l)}return c===n&&(c=eo(y,r)),a}return r=qf(r)||0,Rf(u)&&(h=!!u.leading,f=(p=\"maxWait\"in u)?Zr(qf(u.maxWait)||0,r):f,v=\"trailing\"in u?!!u.trailing:v),b.cancel=function(){c!==n&&Hu(c),s=0,i=l=o=c=n},b.flush=function(){return c===n?a:d(Xo())},b}var of=ju(function(n,t){return Te(n,1,t)}),ff=ju(function(n,t,r){return Te(n,qf(t)||0,r)});function af(n,t){if(\"function\"!=typeof n||null!=t&&\"function\"!=typeof t)throw new it(e);var r=function(){var e=arguments,u=t?t.apply(this,e):e[0],i=r.cache;if(i.has(u))return i.get(u);var o=n.apply(this,e);return r.cache=i.set(u,o)||i,o};return r.cache=new(af.Cache||we),r}function cf(n){if(\"function\"!=typeof n)throw new it(e);return function(){var t=arguments;switch(t.length){case 0:return!n.call(this);case 1:return!n.call(this,t[0]);case 2:return!n.call(this,t[0],t[1]);case 3:return!n.call(this,t[0],t[1],t[2])}return!n.apply(this,t)}}af.Cache=we;var lf=Vu(function(n,t){var r=(t=1==t.length&&df(t[0])?Ht(t[0],hr(Ui())):Ht(qe(t,1),hr(Ui()))).length;return ju(function(e){for(var u=-1,i=Kr(e.length,r);++u<i;)e[u]=t[u].call(this,e[u]);return Ft(n,this,e)})}),sf=ju(function(t,r){var e=jr(r,Ci(sf));return Ai(t,y,n,r,e)}),hf=ju(function(t,r){var e=jr(r,Ci(hf));return Ai(t,d,n,r,e)}),pf=Ei(function(t,r){return Ai(t,w,n,n,n,r)});function vf(n,t){return n===t||n!=n&&t!=t}var _f=bi(Xe),gf=bi(function(n,t){return n>=t}),yf=uu(function(){return arguments}())?uu:function(n){return Ef(n)&&st.call(n,\"callee\")&&!ar.call(n,\"callee\")},df=Yn.isArray,bf=Ut?hr(Ut):function(n){return Ef(n)&&Qe(n)==en};function wf(n){return null!=n&&If(n.length)&&!kf(n)}function mf(n){return Ef(n)&&wf(n)}var xf=Fr||qa,jf=Bt?hr(Bt):function(n){return Ef(n)&&Qe(n)==M};function Af(n){if(!Ef(n))return!1;var t=Qe(n);return t==N||t==F||\"string\"==typeof n.message&&\"string\"==typeof n.name&&!Lf(n)}function kf(n){if(!Rf(n))return!1;var t=Qe(n);return t==P||t==q||t==$||t==H}function Of(n){return\"number\"==typeof n&&n==Nf(n)}function If(n){return\"number\"==typeof n&&n>-1&&n%1==0&&n<=E}function Rf(n){var t=typeof n;return null!=n&&(\"object\"==t||\"function\"==t)}function Ef(n){return null!=n&&\"object\"==typeof n}var zf=Tt?hr(Tt):function(n){return Ef(n)&&Fi(n)==Z};function Sf(n){return\"number\"==typeof n||Ef(n)&&Qe(n)==K}function Lf(n){if(!Ef(n)||Qe(n)!=G)return!1;var t=Ct(n);if(null===t)return!0;var r=st.call(t,\"constructor\")&&t.constructor;return\"function\"==typeof r&&r instanceof r&&lt.call(r)==dt}var Wf=$t?hr($t):function(n){return Ef(n)&&Qe(n)==J};var Cf=Dt?hr(Dt):function(n){return Ef(n)&&Fi(n)==Y};function Uf(n){return\"string\"==typeof n||!df(n)&&Ef(n)&&Qe(n)==Q}function Bf(n){return\"symbol\"==typeof n||Ef(n)&&Qe(n)==X}var Tf=Mt?hr(Mt):function(n){return Ef(n)&&If(n.length)&&!!xt[Qe(n)]};var $f=bi(su),Df=bi(function(n,t){return n<=t});function Mf(n){if(!n)return[];if(wf(n))return Uf(n)?Ir(n):ri(n);if(Lr&&n[Lr])return function(n){for(var t,r=[];!(t=n.next()).done;)r.push(t.value);return r}(n[Lr]());var t=Fi(n);return(t==Z?mr:t==Y?Ar:va)(n)}function Ff(n){return n?(n=qf(n))===R||n===-R?(n<0?-1:1)*z:n==n?n:0:0===n?n:0}function Nf(n){var t=Ff(n),r=t%1;return t==t?r?t-r:t:0}function Pf(n){return n?Ce(Nf(n),0,L):0}function qf(n){if(\"number\"==typeof n)return n;if(Bf(n))return S;if(Rf(n)){var t=\"function\"==typeof n.valueOf?n.valueOf():n;n=Rf(t)?t+\"\":t}if(\"string\"!=typeof n)return 0===n?n:+n;n=n.replace(zn,\"\");var r=Fn.test(n);return r||Pn.test(n)?Ot(n.slice(2),r?2:8):Mn.test(n)?S:+n}function Zf(n){return ei(n,oa(n))}function Kf(n){return null==n?\"\":Bu(n)}var Vf=ii(function(n,t){if(Ji(t)||wf(t))ei(t,ia(t),n);else for(var r in t)st.call(t,r)&&Re(n,r,t[r])}),Gf=ii(function(n,t){ei(t,oa(t),n)}),Hf=ii(function(n,t,r,e){ei(t,oa(t),n,e)}),Jf=ii(function(n,t,r,e){ei(t,ia(t),n,e)}),Yf=Ei(We);var Qf=ju(function(t,r){t=rt(t);var e=-1,u=r.length,i=u>2?r[2]:n;for(i&&Ki(r[0],r[1],i)&&(u=1);++e<u;)for(var o=r[e],f=oa(o),a=-1,c=f.length;++a<c;){var l=f[a],s=t[l];(s===n||vf(s,at[l])&&!st.call(t,l))&&(t[l]=o[l])}return t}),Xf=ju(function(t){return t.push(n,Oi),Ft(aa,n,t)});function na(t,r,e){var u=null==t?n:Je(t,r);return u===n?e:u}function ta(n,t){return null!=n&&Ni(n,t,tu)}var ra=vi(function(n,t,r){null!=t&&\"function\"!=typeof t.toString&&(t=gt.call(t)),n[t]=r},Ra(Sa)),ea=vi(function(n,t,r){null!=t&&\"function\"!=typeof t.toString&&(t=gt.call(t)),st.call(n,t)?n[t].push(r):n[t]=[r]},Ui),ua=ju(eu);function ia(n){return wf(n)?je(n):cu(n)}function oa(n){return wf(n)?je(n,!0):lu(n)}var fa=ii(function(n,t,r){_u(n,t,r)}),aa=ii(function(n,t,r,e){_u(n,t,r,e)}),ca=Ei(function(n,t){var r={};if(null==n)return r;var e=!1;t=Ht(t,function(t){return t=Ku(t,n),e||(e=t.length>1),t}),ei(n,Si(n),r),e&&(r=Ue(r,f|a|c,Ii));for(var u=t.length;u--;)$u(r,t[u]);return r});var la=Ei(function(n,t){return null==n?{}:function(n,t){return du(n,t,function(t,r){return ta(n,r)})}(n,t)});function sa(n,t){if(null==n)return{};var r=Ht(Si(n),function(n){return[n]});return t=Ui(t),du(n,r,function(n,r){return t(n,r[0])})}var ha=ji(ia),pa=ji(oa);function va(n){return null==n?[]:pr(n,ia(n))}var _a=ci(function(n,t,r){return t=t.toLowerCase(),n+(r?ga(t):t)});function ga(n){return Aa(Kf(n).toLowerCase())}function ya(n){return(n=Kf(n))&&n.replace(Zn,yr).replace(_t,\"\")}var da=ci(function(n,t,r){return n+(r?\"-\":\"\")+t.toLowerCase()}),ba=ci(function(n,t,r){return n+(r?\" \":\"\")+t.toLowerCase()}),wa=ai(\"toLowerCase\");var ma=ci(function(n,t,r){return n+(r?\"_\":\"\")+t.toLowerCase()});var xa=ci(function(n,t,r){return n+(r?\" \":\"\")+Aa(t)});var ja=ci(function(n,t,r){return n+(r?\" \":\"\")+t.toUpperCase()}),Aa=ai(\"toUpperCase\");function ka(t,r,e){return t=Kf(t),(r=e?n:r)===n?function(n){return bt.test(n)}(t)?function(n){return n.match(yt)||[]}(t):function(n){return n.match(Bn)||[]}(t):t.match(r)||[]}var Oa=ju(function(t,r){try{return Ft(t,n,r)}catch(n){return Af(n)?n:new Xn(n)}}),Ia=Ei(function(n,t){return Pt(t,function(t){t=co(t),Le(n,t,rf(n[t],n))}),n});function Ra(n){return function(){return n}}var Ea=hi(),za=hi(!0);function Sa(n){return n}function La(n){return au(\"function\"==typeof n?n:Ue(n,f))}var Wa=ju(function(n,t){return function(r){return eu(r,n,t)}}),Ca=ju(function(n,t){return function(r){return eu(n,r,t)}});function Ua(n,t,r){var e=ia(t),u=He(t,e);null!=r||Rf(t)&&(u.length||!e.length)||(r=t,t=n,n=this,u=He(t,ia(t)));var i=!(Rf(r)&&\"chain\"in r&&!r.chain),o=kf(n);return Pt(u,function(r){var e=t[r];n[r]=e,o&&(n.prototype[r]=function(){var t=this.__chain__;if(i||t){var r=n(this.__wrapped__);return(r.__actions__=ri(this.__actions__)).push({func:e,args:arguments,thisArg:n}),r.__chain__=t,r}return e.apply(n,Jt([this.value()],arguments))})}),n}function Ba(){}var Ta=gi(Ht),$a=gi(Zt),Da=gi(Xt);function Ma(n){return Vi(n)?fr(co(n)):function(n){return function(t){return Je(t,n)}}(n)}var Fa=di(),Na=di(!0);function Pa(){return[]}function qa(){return!1}var Za=_i(function(n,t){return n+t},0),Ka=mi(\"ceil\"),Va=_i(function(n,t){return n/t},1),Ga=mi(\"floor\");var Ha,Ja=_i(function(n,t){return n*t},1),Ya=mi(\"round\"),Qa=_i(function(n,t){return n-t},0);return pe.after=function(n,t){if(\"function\"!=typeof t)throw new it(e);return n=Nf(n),function(){if(--n<1)return t.apply(this,arguments)}},pe.ary=nf,pe.assign=Vf,pe.assignIn=Gf,pe.assignInWith=Hf,pe.assignWith=Jf,pe.at=Yf,pe.before=tf,pe.bind=rf,pe.bindAll=Ia,pe.bindKey=ef,pe.castArray=function(){if(!arguments.length)return[];var n=arguments[0];return df(n)?n:[n]},pe.chain=Do,pe.chunk=function(t,r,e){r=(e?Ki(t,r,e):r===n)?1:Zr(Nf(r),0);var u=null==t?0:t.length;if(!u||r<1)return[];for(var i=0,o=0,f=Yn($r(u/r));i<u;)f[o++]=zu(t,i,i+=r);return f},pe.compact=function(n){for(var t=-1,r=null==n?0:n.length,e=0,u=[];++t<r;){var i=n[t];i&&(u[e++]=i)}return u},pe.concat=function(){var n=arguments.length;if(!n)return[];for(var t=Yn(n-1),r=arguments[0],e=n;e--;)t[e-1]=arguments[e];return Jt(df(r)?ri(r):[r],qe(t,1))},pe.cond=function(n){var t=null==n?0:n.length,r=Ui();return n=t?Ht(n,function(n){if(\"function\"!=typeof n[1])throw new it(e);return[r(n[0]),n[1]]}):[],ju(function(r){for(var e=-1;++e<t;){var u=n[e];if(Ft(u[0],this,r))return Ft(u[1],this,r)}})},pe.conforms=function(n){return function(n){var t=ia(n);return function(r){return Be(r,n,t)}}(Ue(n,f))},pe.constant=Ra,pe.countBy=No,pe.create=function(n,t){var r=ve(n);return null==t?r:Se(r,t)},pe.curry=function t(r,e,u){var i=Ai(r,_,n,n,n,n,n,e=u?n:e);return i.placeholder=t.placeholder,i},pe.curryRight=function t(r,e,u){var i=Ai(r,g,n,n,n,n,n,e=u?n:e);return i.placeholder=t.placeholder,i},pe.debounce=uf,pe.defaults=Qf,pe.defaultsDeep=Xf,pe.defer=of,pe.delay=ff,pe.difference=ho,pe.differenceBy=po,pe.differenceWith=vo,pe.drop=function(t,r,e){var u=null==t?0:t.length;return u?zu(t,(r=e||r===n?1:Nf(r))<0?0:r,u):[]},pe.dropRight=function(t,r,e){var u=null==t?0:t.length;return u?zu(t,0,(r=u-(r=e||r===n?1:Nf(r)))<0?0:r):[]},pe.dropRightWhile=function(n,t){return n&&n.length?Mu(n,Ui(t,3),!0,!0):[]},pe.dropWhile=function(n,t){return n&&n.length?Mu(n,Ui(t,3),!0):[]},pe.fill=function(t,r,e,u){var i=null==t?0:t.length;return i?(e&&\"number\"!=typeof e&&Ki(t,r,e)&&(e=0,u=i),function(t,r,e,u){var i=t.length;for((e=Nf(e))<0&&(e=-e>i?0:i+e),(u=u===n||u>i?i:Nf(u))<0&&(u+=i),u=e>u?0:Pf(u);e<u;)t[e++]=r;return t}(t,r,e,u)):[]},pe.filter=function(n,t){return(df(n)?Kt:Pe)(n,Ui(t,3))},pe.flatMap=function(n,t){return qe(Jo(n,t),1)},pe.flatMapDeep=function(n,t){return qe(Jo(n,t),R)},pe.flatMapDepth=function(t,r,e){return e=e===n?1:Nf(e),qe(Jo(t,r),e)},pe.flatten=yo,pe.flattenDeep=function(n){return null!=n&&n.length?qe(n,R):[]},pe.flattenDepth=function(t,r){return null!=t&&t.length?qe(t,r=r===n?1:Nf(r)):[]},pe.flip=function(n){return Ai(n,m)},pe.flow=Ea,pe.flowRight=za,pe.fromPairs=function(n){for(var t=-1,r=null==n?0:n.length,e={};++t<r;){var u=n[t];e[u[0]]=u[1]}return e},pe.functions=function(n){return null==n?[]:He(n,ia(n))},pe.functionsIn=function(n){return null==n?[]:He(n,oa(n))},pe.groupBy=Vo,pe.initial=function(n){return null!=n&&n.length?zu(n,0,-1):[]},pe.intersection=wo,pe.intersectionBy=mo,pe.intersectionWith=xo,pe.invert=ra,pe.invertBy=ea,pe.invokeMap=Go,pe.iteratee=La,pe.keyBy=Ho,pe.keys=ia,pe.keysIn=oa,pe.map=Jo,pe.mapKeys=function(n,t){var r={};return t=Ui(t,3),Ve(n,function(n,e,u){Le(r,t(n,e,u),n)}),r},pe.mapValues=function(n,t){var r={};return t=Ui(t,3),Ve(n,function(n,e,u){Le(r,e,t(n,e,u))}),r},pe.matches=function(n){return pu(Ue(n,f))},pe.matchesProperty=function(n,t){return vu(n,Ue(t,f))},pe.memoize=af,pe.merge=fa,pe.mergeWith=aa,pe.method=Wa,pe.methodOf=Ca,pe.mixin=Ua,pe.negate=cf,pe.nthArg=function(n){return n=Nf(n),ju(function(t){return gu(t,n)})},pe.omit=ca,pe.omitBy=function(n,t){return sa(n,cf(Ui(t)))},pe.once=function(n){return tf(2,n)},pe.orderBy=function(t,r,e,u){return null==t?[]:(df(r)||(r=null==r?[]:[r]),df(e=u?n:e)||(e=null==e?[]:[e]),yu(t,r,e))},pe.over=Ta,pe.overArgs=lf,pe.overEvery=$a,pe.overSome=Da,pe.partial=sf,pe.partialRight=hf,pe.partition=Yo,pe.pick=la,pe.pickBy=sa,pe.property=Ma,pe.propertyOf=function(t){return function(r){return null==t?n:Je(t,r)}},pe.pull=Ao,pe.pullAll=ko,pe.pullAllBy=function(n,t,r){return n&&n.length&&t&&t.length?bu(n,t,Ui(r,2)):n},pe.pullAllWith=function(t,r,e){return t&&t.length&&r&&r.length?bu(t,r,n,e):t},pe.pullAt=Oo,pe.range=Fa,pe.rangeRight=Na,pe.rearg=pf,pe.reject=function(n,t){return(df(n)?Kt:Pe)(n,cf(Ui(t,3)))},pe.remove=function(n,t){var r=[];if(!n||!n.length)return r;var e=-1,u=[],i=n.length;for(t=Ui(t,3);++e<i;){var o=n[e];t(o,e,n)&&(r.push(o),u.push(e))}return wu(n,u),r},pe.rest=function(t,r){if(\"function\"!=typeof t)throw new it(e);return ju(t,r=r===n?r:Nf(r))},pe.reverse=Io,pe.sampleSize=function(t,r,e){return r=(e?Ki(t,r,e):r===n)?1:Nf(r),(df(t)?ke:ku)(t,r)},pe.set=function(n,t,r){return null==n?n:Ou(n,t,r)},pe.setWith=function(t,r,e,u){return u=\"function\"==typeof u?u:n,null==t?t:Ou(t,r,e,u)},pe.shuffle=function(n){return(df(n)?Oe:Eu)(n)},pe.slice=function(t,r,e){var u=null==t?0:t.length;return u?(e&&\"number\"!=typeof e&&Ki(t,r,e)?(r=0,e=u):(r=null==r?0:Nf(r),e=e===n?u:Nf(e)),zu(t,r,e)):[]},pe.sortBy=Qo,pe.sortedUniq=function(n){return n&&n.length?Cu(n):[]},pe.sortedUniqBy=function(n,t){return n&&n.length?Cu(n,Ui(t,2)):[]},pe.split=function(t,r,e){return e&&\"number\"!=typeof e&&Ki(t,r,e)&&(r=e=n),(e=e===n?L:e>>>0)?(t=Kf(t))&&(\"string\"==typeof r||null!=r&&!Wf(r))&&!(r=Bu(r))&&wr(t)?Gu(Ir(t),0,e):t.split(r,e):[]},pe.spread=function(n,t){if(\"function\"!=typeof n)throw new it(e);return t=null==t?0:Zr(Nf(t),0),ju(function(r){var e=r[t],u=Gu(r,0,t);return e&&Jt(u,e),Ft(n,this,u)})},pe.tail=function(n){var t=null==n?0:n.length;return t?zu(n,1,t):[]},pe.take=function(t,r,e){return t&&t.length?zu(t,0,(r=e||r===n?1:Nf(r))<0?0:r):[]},pe.takeRight=function(t,r,e){var u=null==t?0:t.length;return u?zu(t,(r=u-(r=e||r===n?1:Nf(r)))<0?0:r,u):[]},pe.takeRightWhile=function(n,t){return n&&n.length?Mu(n,Ui(t,3),!1,!0):[]},pe.takeWhile=function(n,t){return n&&n.length?Mu(n,Ui(t,3)):[]},pe.tap=function(n,t){return t(n),n},pe.throttle=function(n,t,r){var u=!0,i=!0;if(\"function\"!=typeof n)throw new it(e);return Rf(r)&&(u=\"leading\"in r?!!r.leading:u,i=\"trailing\"in r?!!r.trailing:i),uf(n,t,{leading:u,maxWait:t,trailing:i})},pe.thru=Mo,pe.toArray=Mf,pe.toPairs=ha,pe.toPairsIn=pa,pe.toPath=function(n){return df(n)?Ht(n,co):Bf(n)?[n]:ri(ao(Kf(n)))},pe.toPlainObject=Zf,pe.transform=function(n,t,r){var e=df(n),u=e||xf(n)||Tf(n);if(t=Ui(t,4),null==r){var i=n&&n.constructor;r=u?e?new i:[]:Rf(n)&&kf(i)?ve(Ct(n)):{}}return(u?Pt:Ve)(n,function(n,e,u){return t(r,n,e,u)}),r},pe.unary=function(n){return nf(n,1)},pe.union=Ro,pe.unionBy=Eo,pe.unionWith=zo,pe.uniq=function(n){return n&&n.length?Tu(n):[]},pe.uniqBy=function(n,t){return n&&n.length?Tu(n,Ui(t,2)):[]},pe.uniqWith=function(t,r){return r=\"function\"==typeof r?r:n,t&&t.length?Tu(t,n,r):[]},pe.unset=function(n,t){return null==n||$u(n,t)},pe.unzip=So,pe.unzipWith=Lo,pe.update=function(n,t,r){return null==n?n:Du(n,t,Zu(r))},pe.updateWith=function(t,r,e,u){return u=\"function\"==typeof u?u:n,null==t?t:Du(t,r,Zu(e),u)},pe.values=va,pe.valuesIn=function(n){return null==n?[]:pr(n,oa(n))},pe.without=Wo,pe.words=ka,pe.wrap=function(n,t){return sf(Zu(t),n)},pe.xor=Co,pe.xorBy=Uo,pe.xorWith=Bo,pe.zip=To,pe.zipObject=function(n,t){return Pu(n||[],t||[],Re)},pe.zipObjectDeep=function(n,t){return Pu(n||[],t||[],Ou)},pe.zipWith=$o,pe.entries=ha,pe.entriesIn=pa,pe.extend=Gf,pe.extendWith=Hf,Ua(pe,pe),pe.add=Za,pe.attempt=Oa,pe.camelCase=_a,pe.capitalize=ga,pe.ceil=Ka,pe.clamp=function(t,r,e){return e===n&&(e=r,r=n),e!==n&&(e=(e=qf(e))==e?e:0),r!==n&&(r=(r=qf(r))==r?r:0),Ce(qf(t),r,e)},pe.clone=function(n){return Ue(n,c)},pe.cloneDeep=function(n){return Ue(n,f|c)},pe.cloneDeepWith=function(t,r){return Ue(t,f|c,r=\"function\"==typeof r?r:n)},pe.cloneWith=function(t,r){return Ue(t,c,r=\"function\"==typeof r?r:n)},pe.conformsTo=function(n,t){return null==t||Be(n,t,ia(t))},pe.deburr=ya,pe.defaultTo=function(n,t){return null==n||n!=n?t:n},pe.divide=Va,pe.endsWith=function(t,r,e){t=Kf(t),r=Bu(r);var u=t.length,i=e=e===n?u:Ce(Nf(e),0,u);return(e-=r.length)>=0&&t.slice(e,i)==r},pe.eq=vf,pe.escape=function(n){return(n=Kf(n))&&mn.test(n)?n.replace(bn,dr):n},pe.escapeRegExp=function(n){return(n=Kf(n))&&En.test(n)?n.replace(Rn,\"\\\\$&\"):n},pe.every=function(t,r,e){var u=df(t)?Zt:Fe;return e&&Ki(t,r,e)&&(r=n),u(t,Ui(r,3))},pe.find=Po,pe.findIndex=_o,pe.findKey=function(n,t){return tr(n,Ui(t,3),Ve)},pe.findLast=qo,pe.findLastIndex=go,pe.findLastKey=function(n,t){return tr(n,Ui(t,3),Ge)},pe.floor=Ga,pe.forEach=Zo,pe.forEachRight=Ko,pe.forIn=function(n,t){return null==n?n:Ze(n,Ui(t,3),oa)},pe.forInRight=function(n,t){return null==n?n:Ke(n,Ui(t,3),oa)},pe.forOwn=function(n,t){return n&&Ve(n,Ui(t,3))},pe.forOwnRight=function(n,t){return n&&Ge(n,Ui(t,3))},pe.get=na,pe.gt=_f,pe.gte=gf,pe.has=function(n,t){return null!=n&&Ni(n,t,nu)},pe.hasIn=ta,pe.head=bo,pe.identity=Sa,pe.includes=function(n,t,r,e){n=wf(n)?n:va(n),r=r&&!e?Nf(r):0;var u=n.length;return r<0&&(r=Zr(u+r,0)),Uf(n)?r<=u&&n.indexOf(t,r)>-1:!!u&&er(n,t,r)>-1},pe.indexOf=function(n,t,r){var e=null==n?0:n.length;if(!e)return-1;var u=null==r?0:Nf(r);return u<0&&(u=Zr(e+u,0)),er(n,t,u)},pe.inRange=function(t,r,e){return r=Ff(r),e===n?(e=r,r=0):e=Ff(e),function(n,t,r){return n>=Kr(t,r)&&n<Zr(t,r)}(t=qf(t),r,e)},pe.invoke=ua,pe.isArguments=yf,pe.isArray=df,pe.isArrayBuffer=bf,pe.isArrayLike=wf,pe.isArrayLikeObject=mf,pe.isBoolean=function(n){return!0===n||!1===n||Ef(n)&&Qe(n)==D},pe.isBuffer=xf,pe.isDate=jf,pe.isElement=function(n){return Ef(n)&&1===n.nodeType&&!Lf(n)},pe.isEmpty=function(n){if(null==n)return!0;if(wf(n)&&(df(n)||\"string\"==typeof n||\"function\"==typeof n.splice||xf(n)||Tf(n)||yf(n)))return!n.length;var t=Fi(n);if(t==Z||t==Y)return!n.size;if(Ji(n))return!cu(n).length;for(var r in n)if(st.call(n,r))return!1;return!0},pe.isEqual=function(n,t){return iu(n,t)},pe.isEqualWith=function(t,r,e){var u=(e=\"function\"==typeof e?e:n)?e(t,r):n;return u===n?iu(t,r,n,e):!!u},pe.isError=Af,pe.isFinite=function(n){return\"number\"==typeof n&&Nr(n)},pe.isFunction=kf,pe.isInteger=Of,pe.isLength=If,pe.isMap=zf,pe.isMatch=function(n,t){return n===t||ou(n,t,Ti(t))},pe.isMatchWith=function(t,r,e){return e=\"function\"==typeof e?e:n,ou(t,r,Ti(r),e)},pe.isNaN=function(n){return Sf(n)&&n!=+n},pe.isNative=function(n){if(Hi(n))throw new Xn(r);return fu(n)},pe.isNil=function(n){return null==n},pe.isNull=function(n){return null===n},pe.isNumber=Sf,pe.isObject=Rf,pe.isObjectLike=Ef,pe.isPlainObject=Lf,pe.isRegExp=Wf,pe.isSafeInteger=function(n){return Of(n)&&n>=-E&&n<=E},pe.isSet=Cf,pe.isString=Uf,pe.isSymbol=Bf,pe.isTypedArray=Tf,pe.isUndefined=function(t){return t===n},pe.isWeakMap=function(n){return Ef(n)&&Fi(n)==tn},pe.isWeakSet=function(n){return Ef(n)&&Qe(n)==rn},pe.join=function(n,t){return null==n?\"\":Pr.call(n,t)},pe.kebabCase=da,pe.last=jo,pe.lastIndexOf=function(t,r,e){var u=null==t?0:t.length;if(!u)return-1;var i=u;return e!==n&&(i=(i=Nf(e))<0?Zr(u+i,0):Kr(i,u-1)),r==r?function(n,t,r){for(var e=r+1;e--;)if(n[e]===t)return e;return e}(t,r,i):rr(t,ir,i,!0)},pe.lowerCase=ba,pe.lowerFirst=wa,pe.lt=$f,pe.lte=Df,pe.max=function(t){return t&&t.length?Ne(t,Sa,Xe):n},pe.maxBy=function(t,r){return t&&t.length?Ne(t,Ui(r,2),Xe):n},pe.mean=function(n){return or(n,Sa)},pe.meanBy=function(n,t){return or(n,Ui(t,2))},pe.min=function(t){return t&&t.length?Ne(t,Sa,su):n},pe.minBy=function(t,r){return t&&t.length?Ne(t,Ui(r,2),su):n},pe.stubArray=Pa,pe.stubFalse=qa,pe.stubObject=function(){return{}},pe.stubString=function(){return\"\"},pe.stubTrue=function(){return!0},pe.multiply=Ja,pe.nth=function(t,r){return t&&t.length?gu(t,Nf(r)):n},pe.noConflict=function(){return Et._===this&&(Et._=At),this},pe.noop=Ba,pe.now=Xo,pe.pad=function(n,t,r){n=Kf(n);var e=(t=Nf(t))?Or(n):0;if(!t||e>=t)return n;var u=(t-e)/2;return yi(Dr(u),r)+n+yi($r(u),r)},pe.padEnd=function(n,t,r){n=Kf(n);var e=(t=Nf(t))?Or(n):0;return t&&e<t?n+yi(t-e,r):n},pe.padStart=function(n,t,r){n=Kf(n);var e=(t=Nf(t))?Or(n):0;return t&&e<t?yi(t-e,r)+n:n},pe.parseInt=function(n,t,r){return r||null==t?t=0:t&&(t=+t),Gr(Kf(n).replace(Sn,\"\"),t||0)},pe.random=function(t,r,e){if(e&&\"boolean\"!=typeof e&&Ki(t,r,e)&&(r=e=n),e===n&&(\"boolean\"==typeof r?(e=r,r=n):\"boolean\"==typeof t&&(e=t,t=n)),t===n&&r===n?(t=0,r=1):(t=Ff(t),r===n?(r=t,t=0):r=Ff(r)),t>r){var u=t;t=r,r=u}if(e||t%1||r%1){var i=Hr();return Kr(t+i*(r-t+kt(\"1e-\"+((i+\"\").length-1))),r)}return mu(t,r)},pe.reduce=function(n,t,r){var e=df(n)?Yt:cr,u=arguments.length<3;return e(n,Ui(t,4),r,u,De)},pe.reduceRight=function(n,t,r){var e=df(n)?Qt:cr,u=arguments.length<3;return e(n,Ui(t,4),r,u,Me)},pe.repeat=function(t,r,e){return r=(e?Ki(t,r,e):r===n)?1:Nf(r),xu(Kf(t),r)},pe.replace=function(){var n=arguments,t=Kf(n[0]);return n.length<3?t:t.replace(n[1],n[2])},pe.result=function(t,r,e){var u=-1,i=(r=Ku(r,t)).length;for(i||(i=1,t=n);++u<i;){var o=null==t?n:t[co(r[u])];o===n&&(u=i,o=e),t=kf(o)?o.call(t):o}return t},pe.round=Ya,pe.runInContext=Gn,pe.sample=function(n){return(df(n)?Ae:Au)(n)},pe.size=function(n){if(null==n)return 0;if(wf(n))return Uf(n)?Or(n):n.length;var t=Fi(n);return t==Z||t==Y?n.size:cu(n).length},pe.snakeCase=ma,pe.some=function(t,r,e){var u=df(t)?Xt:Su;return e&&Ki(t,r,e)&&(r=n),u(t,Ui(r,3))},pe.sortedIndex=function(n,t){return Lu(n,t)},pe.sortedIndexBy=function(n,t,r){return Wu(n,t,Ui(r,2))},pe.sortedIndexOf=function(n,t){var r=null==n?0:n.length;if(r){var e=Lu(n,t);if(e<r&&vf(n[e],t))return e}return-1},pe.sortedLastIndex=function(n,t){return Lu(n,t,!0)},pe.sortedLastIndexBy=function(n,t,r){return Wu(n,t,Ui(r,2),!0)},pe.sortedLastIndexOf=function(n,t){if(null!=n&&n.length){var r=Lu(n,t,!0)-1;if(vf(n[r],t))return r}return-1},pe.startCase=xa,pe.startsWith=function(n,t,r){return n=Kf(n),r=null==r?0:Ce(Nf(r),0,n.length),t=Bu(t),n.slice(r,r+t.length)==t},pe.subtract=Qa,pe.sum=function(n){return n&&n.length?lr(n,Sa):0},pe.sumBy=function(n,t){return n&&n.length?lr(n,Ui(t,2)):0},pe.template=function(t,r,e){var u=pe.templateSettings;e&&Ki(t,r,e)&&(r=n),t=Kf(t),r=Hf({},r,u,ki);var i,o,f=Hf({},r.imports,u.imports,ki),a=ia(f),c=pr(f,a),l=0,s=r.interpolate||Kn,h=\"__p += '\",p=et((r.escape||Kn).source+\"|\"+s.source+\"|\"+(s===An?$n:Kn).source+\"|\"+(r.evaluate||Kn).source+\"|$\",\"g\"),v=\"//# sourceURL=\"+(st.call(r,\"sourceURL\")?(r.sourceURL+\"\").replace(/[\\r\\n]/g,\" \"):\"lodash.templateSources[\"+ ++mt+\"]\")+\"\\n\";t.replace(p,function(n,r,e,u,f,a){return e||(e=u),h+=t.slice(l,a).replace(Vn,br),r&&(i=!0,h+=\"' +\\n__e(\"+r+\") +\\n'\"),f&&(o=!0,h+=\"';\\n\"+f+\";\\n__p += '\"),e&&(h+=\"' +\\n((__t = (\"+e+\")) == null ? '' : __t) +\\n'\"),l=a+n.length,n}),h+=\"';\\n\";var _=st.call(r,\"variable\")&&r.variable;_||(h=\"with (obj) {\\n\"+h+\"\\n}\\n\"),h=(o?h.replace(_n,\"\"):h).replace(gn,\"$1\").replace(yn,\"$1;\"),h=\"function(\"+(_||\"obj\")+\") {\\n\"+(_?\"\":\"obj || (obj = {});\\n\")+\"var __t, __p = ''\"+(i?\", __e = _.escape\":\"\")+(o?\", __j = Array.prototype.join;\\nfunction print() { __p += __j.call(arguments, '') }\\n\":\";\\n\")+h+\"return __p\\n}\";var g=Oa(function(){return nt(a,v+\"return \"+h).apply(n,c)});if(g.source=h,Af(g))throw g;return g},pe.times=function(n,t){if((n=Nf(n))<1||n>E)return[];var r=L,e=Kr(n,L);t=Ui(t),n-=L;for(var u=sr(e,t);++r<n;)t(r);return u},pe.toFinite=Ff,pe.toInteger=Nf,pe.toLength=Pf,pe.toLower=function(n){return Kf(n).toLowerCase()},pe.toNumber=qf,pe.toSafeInteger=function(n){return n?Ce(Nf(n),-E,E):0===n?n:0},pe.toString=Kf,pe.toUpper=function(n){return Kf(n).toUpperCase()},pe.trim=function(t,r,e){if((t=Kf(t))&&(e||r===n))return t.replace(zn,\"\");if(!t||!(r=Bu(r)))return t;var u=Ir(t),i=Ir(r);return Gu(u,_r(u,i),gr(u,i)+1).join(\"\")},pe.trimEnd=function(t,r,e){if((t=Kf(t))&&(e||r===n))return t.replace(Ln,\"\");if(!t||!(r=Bu(r)))return t;var u=Ir(t);return Gu(u,0,gr(u,Ir(r))+1).join(\"\")},pe.trimStart=function(t,r,e){if((t=Kf(t))&&(e||r===n))return t.replace(Sn,\"\");if(!t||!(r=Bu(r)))return t;var u=Ir(t);return Gu(u,_r(u,Ir(r))).join(\"\")},pe.truncate=function(t,r){var e=x,u=j;if(Rf(r)){var i=\"separator\"in r?r.separator:i;e=\"length\"in r?Nf(r.length):e,u=\"omission\"in r?Bu(r.omission):u}var o=(t=Kf(t)).length;if(wr(t)){var f=Ir(t);o=f.length}if(e>=o)return t;var a=e-Or(u);if(a<1)return u;var c=f?Gu(f,0,a).join(\"\"):t.slice(0,a);if(i===n)return c+u;if(f&&(a+=c.length-a),Wf(i)){if(t.slice(a).search(i)){var l,s=c;for(i.global||(i=et(i.source,Kf(Dn.exec(i))+\"g\")),i.lastIndex=0;l=i.exec(s);)var h=l.index;c=c.slice(0,h===n?a:h)}}else if(t.indexOf(Bu(i),a)!=a){var p=c.lastIndexOf(i);p>-1&&(c=c.slice(0,p))}return c+u},pe.unescape=function(n){return(n=Kf(n))&&wn.test(n)?n.replace(dn,Rr):n},pe.uniqueId=function(n){var t=++ht;return Kf(n)+t},pe.upperCase=ja,pe.upperFirst=Aa,pe.each=Zo,pe.eachRight=Ko,pe.first=bo,Ua(pe,(Ha={},Ve(pe,function(n,t){st.call(pe.prototype,t)||(Ha[t]=n)}),Ha),{chain:!1}),pe.VERSION=\"4.17.15\",Pt([\"bind\",\"bindKey\",\"curry\",\"curryRight\",\"partial\",\"partialRight\"],function(n){pe[n].placeholder=pe}),Pt([\"drop\",\"take\"],function(t,r){ye.prototype[t]=function(e){e=e===n?1:Zr(Nf(e),0);var u=this.__filtered__&&!r?new ye(this):this.clone();return u.__filtered__?u.__takeCount__=Kr(e,u.__takeCount__):u.__views__.push({size:Kr(e,L),type:t+(u.__dir__<0?\"Right\":\"\")}),u},ye.prototype[t+\"Right\"]=function(n){return this.reverse()[t](n).reverse()}}),Pt([\"filter\",\"map\",\"takeWhile\"],function(n,t){var r=t+1,e=r==O||3==r;ye.prototype[n]=function(n){var t=this.clone();return t.__iteratees__.push({iteratee:Ui(n,3),type:r}),t.__filtered__=t.__filtered__||e,t}}),Pt([\"head\",\"last\"],function(n,t){var r=\"take\"+(t?\"Right\":\"\");ye.prototype[n]=function(){return this[r](1).value()[0]}}),Pt([\"initial\",\"tail\"],function(n,t){var r=\"drop\"+(t?\"\":\"Right\");ye.prototype[n]=function(){return this.__filtered__?new ye(this):this[r](1)}}),ye.prototype.compact=function(){return this.filter(Sa)},ye.prototype.find=function(n){return this.filter(n).head()},ye.prototype.findLast=function(n){return this.reverse().find(n)},ye.prototype.invokeMap=ju(function(n,t){return\"function\"==typeof n?new ye(this):this.map(function(r){return eu(r,n,t)})}),ye.prototype.reject=function(n){return this.filter(cf(Ui(n)))},ye.prototype.slice=function(t,r){t=Nf(t);var e=this;return e.__filtered__&&(t>0||r<0)?new ye(e):(t<0?e=e.takeRight(-t):t&&(e=e.drop(t)),r!==n&&(e=(r=Nf(r))<0?e.dropRight(-r):e.take(r-t)),e)},ye.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},ye.prototype.toArray=function(){return this.take(L)},Ve(ye.prototype,function(t,r){var e=/^(?:filter|find|map|reject)|While$/.test(r),u=/^(?:head|last)$/.test(r),i=pe[u?\"take\"+(\"last\"==r?\"Right\":\"\"):r],o=u||/^find/.test(r);i&&(pe.prototype[r]=function(){var r=this.__wrapped__,f=u?[1]:arguments,a=r instanceof ye,c=f[0],l=a||df(r),s=function(n){var t=i.apply(pe,Jt([n],f));return u&&h?t[0]:t};l&&e&&\"function\"==typeof c&&1!=c.length&&(a=l=!1);var h=this.__chain__,p=!!this.__actions__.length,v=o&&!h,_=a&&!p;if(!o&&l){r=_?r:new ye(this);var g=t.apply(r,f);return g.__actions__.push({func:Mo,args:[s],thisArg:n}),new ge(g,h)}return v&&_?t.apply(this,f):(g=this.thru(s),v?u?g.value()[0]:g.value():g)})}),Pt([\"pop\",\"push\",\"shift\",\"sort\",\"splice\",\"unshift\"],function(n){var t=ot[n],r=/^(?:push|sort|unshift)$/.test(n)?\"tap\":\"thru\",e=/^(?:pop|shift)$/.test(n);pe.prototype[n]=function(){var n=arguments;if(e&&!this.__chain__){var u=this.value();return t.apply(df(u)?u:[],n)}return this[r](function(r){return t.apply(df(r)?r:[],n)})}}),Ve(ye.prototype,function(n,t){var r=pe[t];if(r){var e=r.name+\"\";st.call(ue,e)||(ue[e]=[]),ue[e].push({name:t,func:r})}}),ue[pi(n,p).name]=[{name:\"wrapper\",func:n}],ye.prototype.clone=function(){var n=new ye(this.__wrapped__);return n.__actions__=ri(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=ri(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=ri(this.__views__),n},ye.prototype.reverse=function(){if(this.__filtered__){var n=new ye(this);n.__dir__=-1,n.__filtered__=!0}else(n=this.clone()).__dir__*=-1;return n},ye.prototype.value=function(){var n=this.__wrapped__.value(),t=this.__dir__,r=df(n),e=t<0,u=r?n.length:0,i=function(n,t,r){for(var e=-1,u=r.length;++e<u;){var i=r[e],o=i.size;switch(i.type){case\"drop\":n+=o;break;case\"dropRight\":t-=o;break;case\"take\":t=Kr(t,n+o);break;case\"takeRight\":n=Zr(n,t-o)}}return{start:n,end:t}}(0,u,this.__views__),o=i.start,f=i.end,a=f-o,c=e?f:o-1,l=this.__iteratees__,s=l.length,h=0,p=Kr(a,this.__takeCount__);if(!r||!e&&u==a&&p==a)return Fu(n,this.__actions__);var v=[];n:for(;a--&&h<p;){for(var _=-1,g=n[c+=t];++_<s;){var y=l[_],d=y.iteratee,b=y.type,w=d(g);if(b==I)g=w;else if(!w){if(b==O)continue n;break n}}v[h++]=g}return v},pe.prototype.at=Fo,pe.prototype.chain=function(){return Do(this)},pe.prototype.commit=function(){return new ge(this.value(),this.__chain__)},pe.prototype.next=function(){this.__values__===n&&(this.__values__=Mf(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?n:this.__values__[this.__index__++]}},pe.prototype.plant=function(t){for(var r,e=this;e instanceof _e;){var u=so(e);u.__index__=0,u.__values__=n,r?i.__wrapped__=u:r=u;var i=u;e=e.__wrapped__}return i.__wrapped__=t,r},pe.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof ye){var r=t;return this.__actions__.length&&(r=new ye(this)),(r=r.reverse()).__actions__.push({func:Mo,args:[Io],thisArg:n}),new ge(r,this.__chain__)}return this.thru(Io)},pe.prototype.toJSON=pe.prototype.valueOf=pe.prototype.value=function(){return Fu(this.__wrapped__,this.__actions__)},pe.prototype.first=pe.prototype.head,Lr&&(pe.prototype[Lr]=function(){return this}),pe}();\"function\"==typeof define&&\"object\"==typeof define.amd&&define.amd?(Et._=Er,define(function(){return Er})):St?((St.exports=Er)._=Er,zt._=Er):Et._=Er}).call(this);","backend/node_modules/updater/expressMiddleware.js":"\"use strict\";module.exports=((e,t,r,n,a)=>{if(!t.restarting)return a();const s=t.config.restartDelay-(Date.now()-t.restarting)+5e3;n.status(503).format({text:function(){n.send(\"503 - Service Unavailable - Restarting... try again in \"+Math.ceil(s/1e3)+\"s\")},html:function(){n.render(t.config.errorTemplate,{restartDelay:s})},json:function(){n.send({error:{message:\"503\"},restartDelay:s})}})});","backend/node_modules/updater/routes.js":"\"use strict\";module.exports=((e,s)=>{const t=e[s.config.expressId];s.config.manifests.forEach(n=>{n.path&&t.get(n.path,(t,i)=>{const a=n.template||s.manifest,r=(t.headers[\"user-agent\"]||\"\").match(/Chrome\\/([0-9]+)/),o=r?+r[1]:99;if(!t.secure&&o>=70||\"development\"===e.options.env||\"string\"!=typeof a)return i.sendStatus(404);const c=a.replace(\"{version}\",\"v\"+s.getFrontendVersion(n.frontendVersionKey)).replace(\"{mainJsFile}\",n.mainJsFile).replace(\"{mainCssFile}\",n.mainCssFile);i.type(\"text/cache-manifest\"),i.send(c)})})});","backend/node_modules/updater/commands.js":"\"use strict\";const{exec:exec}=require(\"child_process\");module.exports=((e,t)=>{e[t.config.sioId].sockets.on(\"connection\",e=>{e.emit(\"updater.versions\",t.getVersions()),e.on(\"updater.pull\",n=>{\"function\"!=typeof n&&(n=function(){});const o=e.handshake.user;if(!o||!o.super)return t.warn(\"Unauthorized pull attempt.\",{socket:e.handshake}),n(new Error(\"AUTH\"));const l='\"'+t.config.pull.exe+'\" pull';t.info(\"Attempting a pull...\"),exec(l,t.config.pull,function(e,o,l){e?t.error(e,\"Failed the pull.\"):l&&l.length?t.info(\"Failed the pull.\"):t.info(\"Pull succeeded.\"),n(e,{stdout:o,stderr:l})})})})});","package.json":{"name":"walkner-snf","version":"2.1.0","updater":{"snf":{"backend":3,"frontend":4,"controller":3}},"description":"Application for SNF/AV tester.","license":"CC-BY-NC-SA-4.0","homepage":"https://github.com/morkai/walkner-snf","author":{"name":"ukasz Walukiewicz","email":"lukasz@miracle.systems","url":"http://miracle.systems/"},"bugs":"https://github.com/morkai/walkner-snf/issues","repository":{"type":"git","url":"http://github.com/morkai/walkner-snf.git"},"engines":{"node":">=12.0.0"},"main":"./backend/main","dependencies":{"axon":"^2.0.3","bcrypt":"3.0.6","body-parser":"^1.19.0","cookie":"^0.4.0","cookie-parser":"^1.4.4","csv":"1.1.1","deep-equal":"^1.1.1","ejs":"~2.7.4","ejs-amd":"morkai/ejs-amd","express":"^4.17.1","express-session":"^1.17.0","fs-extra":"^8.1.0","h5.main":"morkai/h5.main","h5.modbus":"morkai/h5.modbus","h5.pubsub":"morkai/h5.pubsub","h5.rql":"morkai/h5.rql","h5.step":"morkai/h5.step","lodash":"^4.17.15","messageformat":"0.2.2","messageformat-amd":"morkai/messageformat-amd","moment":"^2.24.0","mongodb":"^3.3.5","mongoose":"^5.7.12","multer":"^1.4.2","request":"^2.88.0","socket.io":"1.7.4","transliteration":"^2.1.7","uuid":"^3.3.3"},"devDependencies":{"chalk":"^3.0.0","grunt":"^1.0.4","grunt-contrib-clean":"^2.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-requirejs":"~1.0.0","grunt-uglify-es-multicore":"morkai/grunt-uglify-es-multicore","grunt-ejs-amd":"morkai/grunt-ejs-amd","grunt-eslint":"^22.0.0","grunt-messageformat-amd":"morkai/grunt-messageformat-amd"}},"node_modules/mongoose/index.js":"\"use strict\";module.exports=require(\"./lib/\");","backend/node_modules/h5-mongoose/expressMiddleware.js":"\"use strict\";const mongoose=require(\"mongoose\");module.exports=((e,n,o,t,a)=>{if(n.connection.readyState===mongoose.Connection.STATES.connected)return a();t.status(503).format({text:function(){t.send(\"503 - Service Unavailable - No database connection. Please try again later.\")},html:function(){t.render(\"mongoose:unavailable\")},json:function(){t.json({error:{message:\"503\"}})}})});","node_modules/mongoose/lib/index.js":"\"use strict\";if(global.MONGOOSE_DRIVER_PATH){const o=\"The `MONGOOSE_DRIVER_PATH` global property is deprecated. Use `mongoose.driver.set()` instead.\";require(\"util\").deprecate(function(){require(\"./driver\").set(require(global.MONGOOSE_DRIVER_PATH))},o)()}else require(\"./driver\").set(require(\"./drivers/node-mongodb-native\"));const Schema=require(\"./schema\"),SchemaType=require(\"./schematype\"),SchemaTypes=require(\"./schema/index\"),VirtualType=require(\"./virtualtype\"),STATES=require(\"./connectionstate\"),Types=require(\"./types\"),Query=require(\"./query\"),Model=require(\"./model\"),Document=require(\"./document\"),applyPlugins=require(\"./helpers/schema/applyPlugins\"),get=require(\"./helpers/get\"),legacyPluralize=require(\"mongoose-legacy-pluralize\"),utils=require(\"./utils\"),pkg=require(\"../package.json\"),cast=require(\"./cast\"),removeSubdocs=require(\"./plugins/removeSubdocs\"),saveSubdocs=require(\"./plugins/saveSubdocs\"),validateBeforeSave=require(\"./plugins/validateBeforeSave\"),Aggregate=require(\"./aggregate\"),PromiseProvider=require(\"./promise_provider\"),shardingPlugin=require(\"./plugins/sharding\"),defaultMongooseSymbol=Symbol.for(\"mongoose:default\");function Mongoose(o){if(this.connections=[],this.models={},this.modelSchemas={},this.options=Object.assign({pluralization:!0},o),this.createConnection().models=this.models,this.options.pluralization&&(this._pluralize=legacyPluralize),o&&o[defaultMongooseSymbol])for(const o of[\"Schema\",\"model\"])this[o]=Mongoose.prototype[o];else{const o=this;this.Schema=function(){return this.base=o,Schema.apply(this,arguments)},this.Schema.prototype=Object.create(Schema.prototype),Object.assign(this.Schema,Schema),this.Schema.base=this,this.Schema.Types=Object.assign({},Schema.Types)}this.Schema.prototype.base=this,Object.defineProperty(this,\"plugins\",{configurable:!1,enumerable:!0,writable:!1,value:[[saveSubdocs,{deduplicate:!0}],[validateBeforeSave,{deduplicate:!0}],[shardingPlugin,{deduplicate:!0}],[removeSubdocs,{deduplicate:!0}]]})}require(\"./helpers/printJestWarning\"),Mongoose.prototype.cast=cast,Mongoose.prototype.STATES=STATES,Mongoose.prototype.driver=require(\"./driver\"),Mongoose.prototype.set=function(o,e){const t=this instanceof Mongoose?this:mongoose;return 1===arguments.length?t.options[o]:(t.options[o]=e,\"objectIdGetter\"===o&&(e?Object.defineProperty(mongoose.Types.ObjectId.prototype,\"_id\",{enumerable:!1,configurable:!0,get:function(){return this}}):delete mongoose.Types.ObjectId.prototype._id),t)},Mongoose.prototype.get=Mongoose.prototype.set,Mongoose.prototype.createConnection=function(o,e,t){const n=this instanceof Mongoose?this:mongoose,r=new Connection(n);return\"function\"==typeof e&&(t=e,e=null),n.connections.push(r),arguments.length>0?r.openUri(o,e,t):r},Mongoose.prototype.connect=function(){const o=this instanceof Mongoose?this:mongoose;return o.connection.openUri(arguments[0],arguments[1],arguments[2]).then(()=>o)},Mongoose.prototype.disconnect=function(o){const e=this instanceof Mongoose?this:mongoose;return utils.promiseOrCallback(o,o=>{let t=e.connections.length;if(t<=0)return o(null);e.connections.forEach(e=>{e.close(function(e){if(e)return o(e);--t||o(null)})})})},Mongoose.prototype.startSession=function(){const o=this instanceof Mongoose?this:mongoose;return o.connection.startSession.apply(o.connection,arguments)},Mongoose.prototype.pluralize=function(o){const e=this instanceof Mongoose?this:mongoose;return arguments.length>0&&(e._pluralize=o),e._pluralize},Mongoose.prototype.model=function(o,e,t,n){const r=this instanceof Mongoose?this:mongoose;let s,i;if(\"function\"==typeof o&&(o=(s=o).name,!(s.prototype instanceof Model)))throw new r.Error(\"The provided class \"+o+\" must extend Model\");if(\"string\"==typeof e&&(t=e,e=!1),utils.isObject(e)&&!e.instanceOfSchema&&(e=new Schema(e)),e&&!e.instanceOfSchema)throw new Error(\"The 2nd parameter to `mongoose.model()` should be a schema or a POJO\");if(\"boolean\"==typeof t&&(n=t,t=null),n&&utils.isObject(n)?(i=n,n=!0):i={},!r.modelSchemas[o]){if(!e)throw new mongoose.Error.MissingSchemaError(o);r.modelSchemas[o]=e}const c=e;let p;if(e&&(r.get(\"cloneSchemas\")&&(e=e.clone()),r._applyPlugins(e)),r.models[o]&&!1!==i.cache){if(c&&c.instanceOfSchema&&c!==r.models[o].schema)throw new r.Error.OverwriteModelError(o);return t&&t!==r.models[o].collection.name?(e=(s=r.models[o]).prototype.schema,p=s.__subclass(r.connection,e,t)):r.models[o]}if(!e&&!(e=this.modelSchemas[o]))throw new mongoose.Error.MissingSchemaError(o);\"pluralization\"in e.options||(e.options.pluralization=r.options.pluralization),t||(t=e.get(\"collection\")||utils.toCollectionName(o,r.pluralize()));const l=i.connection||r.connection;return s=r.Model.compile(s||o,e,t,l,r),n||s.init(function(){}),!1===i.cache?s:(r.models[o]=s,r.models[o])},Mongoose.prototype.deleteModel=function(o){const e=this instanceof Mongoose?this:mongoose;return e.connection.deleteModel(o),e},Mongoose.prototype.modelNames=function(){const o=this instanceof Mongoose?this:mongoose;return Object.keys(o.models)},Mongoose.prototype._applyPlugins=function(o,e){const t=this instanceof Mongoose?this:mongoose;(e=e||{}).applyPluginsToDiscriminators=get(t,\"options.applyPluginsToDiscriminators\",!1),e.applyPluginsToChildSchemas=get(t,\"options.applyPluginsToChildSchemas\",!0),applyPlugins(o,t.plugins,e,\"$globalPluginsApplied\")},Mongoose.prototype.plugin=function(o,e){const t=this instanceof Mongoose?this:mongoose;return t.plugins.push([o,e]),t},Mongoose.prototype.__defineGetter__(\"connection\",function(){return this.connections[0]}),Mongoose.prototype.__defineSetter__(\"connection\",function(o){o instanceof Connection&&(this.connections[0]=o,this.models=o.models)}),Mongoose.prototype.connections;const driver=global.MONGOOSE_DRIVER_PATH||\"./drivers/node-mongodb-native\",Connection=require(driver+\"/connection\"),Collection=require(driver+\"/collection\");Mongoose.prototype.Aggregate=Aggregate,Mongoose.prototype.Collection=Collection,Mongoose.prototype.Connection=Connection,Mongoose.prototype.version=pkg.version,Mongoose.prototype.Mongoose=Mongoose,Mongoose.prototype.Schema=Schema,Mongoose.prototype.SchemaType=SchemaType,Mongoose.prototype.SchemaTypes=Schema.Types,Mongoose.prototype.VirtualType=VirtualType,Mongoose.prototype.Types=Types,Mongoose.prototype.Query=Query,Object.defineProperty(Mongoose.prototype,\"Promise\",{get:function(){return PromiseProvider.get()},set:function(o){PromiseProvider.set(o)}}),Mongoose.prototype.PromiseProvider=PromiseProvider,Mongoose.prototype.Model=Model,Mongoose.prototype.Document=Document,Mongoose.prototype.DocumentProvider=require(\"./document_provider\"),Mongoose.prototype.ObjectId=SchemaTypes.ObjectId,Mongoose.prototype.isValidObjectId=function(o){if(null==o)return!0;const e=(this||mongoose).driver.get().ObjectId;if(o instanceof e)return!0;if(null!=o._id){if(o._id instanceof e)return!0;if(o._id.toString instanceof Function)return\"string\"==typeof(o=o._id.toString())&&(12===o.length||24===o.length)}return o.toString instanceof Function&&(o=o.toString()),\"string\"==typeof o&&(12===o.length||24===o.length)},Mongoose.prototype.Decimal128=SchemaTypes.Decimal128,Mongoose.prototype.Mixed=SchemaTypes.Mixed,Mongoose.prototype.Number=SchemaTypes.Number,Mongoose.prototype.Error=require(\"./error/index\"),Mongoose.prototype.now=function(){return new Date},Mongoose.prototype.CastError=require(\"./error/cast\"),Mongoose.prototype.SchemaTypeOptions=require(\"./options/SchemaTypeOptions\"),Mongoose.prototype.mongo=require(\"mongodb\"),Mongoose.prototype.mquery=require(\"mquery\");const mongoose=module.exports=exports=new Mongoose({[defaultMongooseSymbol]:!0});","node_modules/mongoose/lib/driver.js":"\"use strict\";let driver=null;module.exports.get=function(){return driver},module.exports.set=function(e){driver=e};","node_modules/mongoose/lib/drivers/node-mongodb-native/index.js":"\"use strict\";exports.Binary=require(\"./binary\"),exports.Collection=require(\"./collection\"),exports.Decimal128=require(\"./decimal128\"),exports.ObjectId=require(\"./objectid\"),exports.ReadPreference=require(\"./ReadPreference\");","node_modules/mongoose/lib/schema.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter,Kareem=require(\"kareem\"),SchemaType=require(\"./schematype\"),SchemaTypeOptions=require(\"./options/SchemaTypeOptions\"),VirtualType=require(\"./virtualtype\"),applyTimestampsToChildren=require(\"./helpers/update/applyTimestampsToChildren\"),applyTimestampsToUpdate=require(\"./helpers/update/applyTimestampsToUpdate\"),arrayParentSymbol=require(\"./helpers/symbols\").arrayParentSymbol,get=require(\"./helpers/get\"),getIndexes=require(\"./helpers/schema/getIndexes\"),handleTimestampOption=require(\"./helpers/schema/handleTimestampOption\"),merge=require(\"./helpers/schema/merge\"),mpath=require(\"mpath\"),readPref=require(\"./driver\").get().ReadPreference,symbols=require(\"./schema/symbols\"),util=require(\"util\"),utils=require(\"./utils\"),validateRef=require(\"./helpers/populate/validateRef\");let MongooseTypes;const queryHooks=require(\"./helpers/query/applyQueryMiddleware\").middlewareFunctions,documentHooks=require(\"./helpers/model/applyHooks\").middlewareFunctions,hookNames=queryHooks.concat(documentHooks).reduce((e,t)=>e.add(t),new Set);let id=0;function Schema(e,t){if(!(this instanceof Schema))return new Schema(e,t);if(this.obj=e,this.paths={},this.aliases={},this.subpaths={},this.virtuals={},this.singleNestedPaths={},this.nested={},this.inherits={},this.callQueue=[],this._indexes=[],this.methods={},this.methodOptions={},this.statics={},this.tree={},this.query={},this.childSchemas=[],this.plugins=[],this.$id=++id,this.s={hooks:new Kareem},this.options=this.defaultOptions(t),Array.isArray(e))for(const t of e)this.add(t);else e&&this.add(e);const s=e&&e._id&&utils.isObject(e._id);if(!this.paths._id&&!this.options.noId&&this.options._id&&!s){const e={_id:{auto:!0}};e._id[this.options.typeKey]=Schema.ObjectId,this.add(e)}this.setupTimestamp(this.options.timestamps)}function aliasFields(e,t){t=t||Object.keys(e.paths);for(const s of t){const t=get(e.paths[s],\"options\");if(null==t)continue;const i=e.paths[s].path,r=t.alias;if(r){if(\"string\"!=typeof r)throw new Error(\"Invalid value for alias option on \"+i+\", got \"+r);e.aliases[r]=i,e.virtual(r).get(function(e){return function(){return\"function\"==typeof this.get?this.get(e):this[e]}}(i)).set(function(e){return function(t){return this.set(e,t)}}(i))}}}Schema.prototype=Object.create(EventEmitter.prototype),Schema.prototype.constructor=Schema,Schema.prototype.instanceOfSchema=!0,Object.defineProperty(Schema.prototype,\"$schemaType\",{configurable:!1,enumerable:!1,writable:!0}),Object.defineProperty(Schema.prototype,\"childSchemas\",{configurable:!1,enumerable:!0,writable:!0}),Schema.prototype.obj,Schema.prototype.paths,Schema.prototype.tree,Schema.prototype.clone=function(){const e=new Schema({},this._userProvidedOptions);return e.base=this.base,e.obj=this.obj,e.options=utils.clone(this.options),e.callQueue=this.callQueue.map(function(e){return e}),e.methods=utils.clone(this.methods),e.methodOptions=utils.clone(this.methodOptions),e.statics=utils.clone(this.statics),e.query=utils.clone(this.query),e.plugins=Array.prototype.slice.call(this.plugins),e._indexes=utils.clone(this._indexes),e.s.hooks=this.s.hooks.clone(),e.tree=utils.clone(this.tree),e.paths=utils.clone(this.paths),e.nested=utils.clone(this.nested),e.subpaths=utils.clone(this.subpaths),e.singleNestedPaths=utils.clone(this.singleNestedPaths),e.childSchemas=gatherChildSchemas(e),e.virtuals=utils.clone(this.virtuals),e.$globalPluginsApplied=this.$globalPluginsApplied,e.$isRootDiscriminator=this.$isRootDiscriminator,e.$implicitlyCreated=this.$implicitlyCreated,null!=this.discriminatorMapping&&(e.discriminatorMapping=Object.assign({},this.discriminatorMapping)),null!=this.discriminators&&(e.discriminators=Object.assign({},this.discriminators)),e.aliases=Object.assign({},this.aliases),e.on(\"init\",e=>this.emit(\"init\",e)),e},Schema.prototype.defaultOptions=function(e){e&&!1===e.safe&&(e.safe={w:0}),e&&e.safe&&0===e.safe.w&&(e.versionKey=!1),this._userProvidedOptions=null==e?{}:utils.clone(e);const t=get(this,\"base.options\",{});return(e=utils.options({strict:!(\"strict\"in t)||t.strict,bufferCommands:!0,capped:!1,versionKey:\"__v\",discriminatorKey:\"__t\",minimize:!0,autoIndex:null,shardKey:null,read:null,validateBeforeSave:!0,noId:!1,_id:!0,noVirtualId:!1,id:!0,typeKey:\"type\"},utils.clone(e))).read&&(e.read=readPref(e.read)),e},Schema.prototype.add=function(e,t){if(e instanceof Schema)return merge(this,e),this;!1===e._id&&null==t&&(this.options._id=!1),t=t||\"\";const s=Object.keys(e);for(let i=0;i<s.length;++i){const r=s[i],n=t+r;if(null==e[r])throw new TypeError(\"Invalid value for schema path `\"+n+'`, got value \"'+e[r]+'\"');if(\"_id\"!==r||!1!==e[r]){if(Array.isArray(e[r])&&1===e[r].length&&null==e[r][0])throw new TypeError(\"Invalid value for schema Array path `\"+n+'`, got value \"'+e[r][0]+'\"');(utils.isPOJO(e[r])||e[r]instanceof SchemaTypeOptions)&&(!e[r][this.options.typeKey]||\"type\"===this.options.typeKey&&e[r].type.type)?Object.keys(e[r]).length?(this.nested[n]=!0,this.add(e[r],n+\".\")):(t&&(this.nested[t.substr(0,t.length-1)]=!0),this.path(n,e[r])):(t&&(this.nested[t.substr(0,t.length-1)]=!0),this.path(t+r,e[r]))}}return aliasFields(this,Object.keys(e).map(e=>t?t+e:e)),this},Schema.reserved=Object.create(null),Schema.prototype.reserved=Schema.reserved;const reserved=Schema.reserved;reserved.prototype=reserved.emit=reserved.on=reserved.once=reserved.listeners=reserved.removeListener=reserved.collection=reserved.db=reserved.errors=reserved.init=reserved.isModified=reserved.isNew=reserved.get=reserved.modelName=reserved.save=reserved.schema=reserved.toObject=reserved.validate=reserved.remove=reserved.populated=1;const warnings={};function gatherChildSchemas(e){const t=[];for(const s of Object.keys(e.paths)){const i=e.paths[s];(i.$isMongooseDocumentArray||i.$isSingleNested)&&t.push({schema:i.schema,model:i.caster})}return t}function _getPath(e,t,s){return e.paths.hasOwnProperty(t)?e.paths[t]:e.subpaths.hasOwnProperty(s)?e.subpaths[s]:e.singleNestedPaths.hasOwnProperty(s)?e.singleNestedPaths[s]:null}function _pathToPositionalSyntax(e){return e.replace(/\\.\\d+\\./g,\".$.\").replace(/\\.\\d+$/,\".$\")}function getMapPath(e,t){for(const s of Object.keys(e.paths)){if(!s.includes(\".$*\"))continue;if(new RegExp(\"^\"+s.replace(/\\.\\$\\*/g,\"\\\\.[^.]+\")+\"$\").test(t))return e.paths[s]}return null}function getPositionalPathType(e,t){const s=t.split(/\\.(\\d+)\\.|\\.(\\d+)$/).filter(Boolean);if(s.length<2)return e.paths.hasOwnProperty(s[0])?e.paths[s[0]]:\"adhocOrUndefined\";let i=e.path(s[0]),r=!1;if(!i)return\"adhocOrUndefined\";const n=s.length-1;for(let e=1;e<s.length;++e){r=!1;const t=s[e];if(e===n&&i&&!/\\D/.test(t)){i=i.$isMongooseDocumentArray?i.$embeddedSchemaType:i instanceof MongooseTypes.Array?i.caster:void 0;break}if(/\\D/.test(t)){if(!i||!i.schema){i=void 0;break}r=\"nested\"===i.schema.pathType(t),i=i.schema.path(t)}else i instanceof MongooseTypes.Array&&e!==n&&(i=i.caster)}return e.subpaths[t]=i,i?\"real\":r?\"nested\":\"adhocOrUndefined\"}function getPositionalPath(e,t){return getPositionalPathType(e,t),e.subpaths[t]}warnings.increment=\"`increment` should not be used as a schema path name unless you have disabled versioning.\",Schema.prototype.path=function(e,t){const s=_pathToPositionalSyntax(e);if(void 0===t){let t=_getPath(this,e,s);if(null!=t)return t;const i=getMapPath(this,e);return null!=i?i:null!=(t=this.hasMixedParent(s))?t:/\\.\\d+\\.?.*$/.test(e)?getPositionalPath(this,e):void 0}if(reserved[e])throw new Error(\"`\"+e+\"` may not be used as a schema pathname\");warnings[e]&&console.log(\"WARN: \"+warnings[e]),\"object\"==typeof t&&utils.hasUserDefinedProperty(t,\"ref\")&&validateRef(t.ref,e);const i=e.split(/\\./),r=i.pop();let n=this.tree;i.forEach(function(t,s){if(n[t]||(n[t]={}),\"object\"!=typeof n[t]){const r=\"Cannot set nested path `\"+e+\"`. Parent path `\"+i.slice(0,s).concat([t]).join(\".\")+\"` already set to type \"+n[t].name+\".\";throw new Error(r)}n=n[t]}),n[r]=utils.clone(t),this.paths[e]=this.interpretAsType(e,t,this.options);const o=this.paths[e];if(o.$isSchemaMap){const s=e+\".$*\";let i={type:{}};if(utils.hasUserDefinedProperty(t,\"of\")){i=utils.isPOJO(t.of)&&Object.keys(t.of).length>0&&!utils.hasUserDefinedProperty(t.of,this.options.typeKey)?new Schema(t.of):t.of}this.paths[s]=this.interpretAsType(s,i,this.options),o.$__schemaType=this.paths[s]}if(o.$isSingleNested){for(const t in o.schema.paths)this.singleNestedPaths[e+\".\"+t]=o.schema.paths[t];for(const t in o.schema.singleNestedPaths)this.singleNestedPaths[e+\".\"+t]=o.schema.singleNestedPaths[t];for(const t in o.schema.subpaths)this.singleNestedPaths[e+\".\"+t]=o.schema.subpaths[t];Object.defineProperty(o.schema,\"base\",{configurable:!0,enumerable:!1,writable:!1,value:this.base}),o.caster.base=this.base,this.childSchemas.push({schema:o.schema,model:o.caster})}else o.$isMongooseDocumentArray&&(Object.defineProperty(o.schema,\"base\",{configurable:!0,enumerable:!1,writable:!1,value:this.base}),o.casterConstructor.base=this.base,this.childSchemas.push({schema:o.schema,model:o.casterConstructor}));if(o.$isMongooseArray&&o.caster instanceof SchemaType){let t=e,s=o,i=[];for(;s.$isMongooseArray;){if(t+=\".$\",s.$isMongooseDocumentArray){i=[];break}(s=s.caster.clone()).path=t,i.push(s)}for(const e of i)this.subpaths[e.path]=e}if(o.$isMongooseDocumentArray){for(const t of Object.keys(o.schema.paths))this.subpaths[e+\".\"+t]=o.schema.paths[t],o.schema.paths[t].$isUnderneathDocArray=!0;for(const t of Object.keys(o.schema.subpaths))this.subpaths[e+\".\"+t]=o.schema.subpaths[t],o.schema.subpaths[t].$isUnderneathDocArray=!0;for(const t of Object.keys(o.schema.singleNestedPaths))this.subpaths[e+\".\"+t]=o.schema.singleNestedPaths[t],o.schema.singleNestedPaths[t].$isUnderneathDocArray=!0}return this},Object.defineProperty(Schema.prototype,\"base\",{configurable:!0,enumerable:!1,writable:!0,value:null}),Schema.prototype.interpretAsType=function(e,t,s){if(t instanceof SchemaType)return t;const i=null!=this.base?this.base.Schema.Types:Schema.Types;if(!(utils.isPOJO(t)||t instanceof SchemaTypeOptions)){if(\"Object\"!==utils.getFunctionName(t.constructor)){const e=t;(t={})[s.typeKey]=e}}let r,n=!t[s.typeKey]||\"type\"===s.typeKey&&t.type.type?{}:t[s.typeKey];if(utils.isPOJO(n)||\"mixed\"===n)return new i.Mixed(e,t);if(Array.isArray(n)||Array===n||\"array\"===n){let o=Array===n||\"array\"===n?t.cast:n[0];if(o&&o.instanceOfSchema)return new i.DocumentArray(e,o,t);if(o&&o[s.typeKey]&&o[s.typeKey].instanceOfSchema)return new i.DocumentArray(e,o[s.typeKey],t,o);if(Array.isArray(o))return new i.Array(e,this.interpretAsType(e,o,s),t);if(\"string\"==typeof o)o=i[o.charAt(0).toUpperCase()+o.substring(1)];else if(o&&(!o[s.typeKey]||\"type\"===s.typeKey&&o.type.type)&&utils.isPOJO(o)){if(Object.keys(o).length){const r={minimize:s.minimize};s.typeKey&&(r.typeKey=s.typeKey),s.hasOwnProperty(\"strict\")&&(r.strict=s.strict);const n=new Schema(o,r);return n.$implicitlyCreated=!0,new i.DocumentArray(e,n,t)}return new i.Array(e,i.Mixed,t)}if(o&&(r=\"string\"==typeof(n=!o[s.typeKey]||\"type\"===s.typeKey&&o.type.type?o:o[s.typeKey])?n:n.schemaName||utils.getFunctionName(n),!i.hasOwnProperty(r)))throw new TypeError(\"Invalid schema configuration: \"+`\\`${r}\\` is not a valid type within the array \\`${e}\\`.`+\"See http://bit.ly/mongoose-schematypes for a list of valid schema types.\");return new i.Array(e,o||i.Mixed,t,s)}if(n&&n.instanceOfSchema)return new i.Embedded(n,e,t);if((r=Buffer.isBuffer(n)?\"Buffer\":\"function\"==typeof n||\"object\"==typeof n?n.schemaName||utils.getFunctionName(n):null==n?\"\"+n:n.toString())&&(r=r.charAt(0).toUpperCase()+r.substring(1)),\"ObjectID\"===r&&(r=\"ObjectId\"),null==i[r])throw new TypeError(`Invalid schema configuration: \\`${r}\\` is not `+`a valid type at path \\`${e}\\`. See `+\"http://bit.ly/mongoose-schematypes for a list of valid schema types.\");return new i[r](e,t)},Schema.prototype.eachPath=function(e){const t=Object.keys(this.paths),s=t.length;for(let i=0;i<s;++i)e(t[i],this.paths[t[i]]);return this},Schema.prototype.requiredPaths=function(e){if(this._requiredpaths&&!e)return this._requiredpaths;const t=Object.keys(this.paths);let s=t.length;const i=[];for(;s--;){const e=t[s];this.paths[e].isRequired&&i.push(e)}return this._requiredpaths=i,this._requiredpaths},Schema.prototype.indexedPaths=function(){return this._indexedpaths?this._indexedpaths:(this._indexedpaths=this.indexes(),this._indexedpaths)},Schema.prototype.pathType=function(e){const t=e.replace(/\\.\\d+\\./g,\".$.\").replace(/\\.\\d+$/,\".$\");return this.paths.hasOwnProperty(e)?\"real\":this.virtuals.hasOwnProperty(e)?\"virtual\":this.nested.hasOwnProperty(e)?\"nested\":this.subpaths.hasOwnProperty(t)?\"real\":this.singleNestedPaths.hasOwnProperty(t)?\"real\":null!=getMapPath(this,e)?\"real\":/\\.\\d+\\.|\\.\\d+$/.test(e)?getPositionalPathType(this,e):\"adhocOrUndefined\"},Schema.prototype.hasMixedParent=function(e){const t=e.split(/\\./g);e=\"\";for(let s=0;s<t.length;++s)if((e=s>0?e+\".\"+t[s]:t[s])in this.paths&&this.paths[e]instanceof MongooseTypes.Mixed)return this.paths[e];return null},Schema.prototype.setupTimestamp=function(e){const t=this.childSchemas.find(function(e){return!!e.schema.options.timestamps});if(!e&&!t)return;const s=handleTimestampOption(e,\"createdAt\"),i=handleTimestampOption(e,\"updatedAt\"),r={};this.$timestamps={createdAt:s,updatedAt:i},i&&!this.paths[i]&&(r[i]=Date),s&&!this.paths[s]&&(r[s]=Date),this.add(r),this.pre(\"save\",function(e){const t=get(this,\"$__.saveOptions.timestamps\");if(!1===t)return e();const r=null!=t&&!1===t.updatedAt,n=null!=t&&!1===t.createdAt,o=(this.ownerDocument?this.ownerDocument():this).constructor.base.now(),a=this._id&&this._id.auto;if(!n&&s&&!this.get(s)&&this.isSelected(s)&&this.set(s,a?this._id.getTimestamp():o),!r&&i&&(this.isNew||this.isModified())){let e=o;this.isNew&&(null!=s?e=this.$__getValue(s):a&&(e=this._id.getTimestamp())),this.set(i,e)}e()}),this.methods.initializeTimestamps=function(){return s&&!this.get(s)&&this.set(s,new Date),i&&!this.get(i)&&this.set(i,new Date),this},o[symbols.builtInMiddleware]=!0;const n={query:!0,model:!1};function o(e){const t=this.model.base.now();applyTimestampsToUpdate(t,s,i,this.getUpdate(),this.options,this.schema),applyTimestampsToChildren(t,this.getUpdate(),this.model.schema),e()}this.pre(\"findOneAndUpdate\",n,o),this.pre(\"replaceOne\",n,o),this.pre(\"update\",n,o),this.pre(\"updateOne\",n,o),this.pre(\"updateMany\",n,o)},Schema.prototype.queue=function(e,t){return this.callQueue.push([e,t]),this},Schema.prototype.pre=function(e){if(e instanceof RegExp){const t=Array.prototype.slice.call(arguments,1);for(const s of hookNames)e.test(s)&&this.pre.apply(this,[s].concat(t));return this}if(Array.isArray(e)){const t=Array.prototype.slice.call(arguments,1);for(const s of e)this.pre.apply(this,[s].concat(t));return this}return this.s.hooks.pre.apply(this.s.hooks,arguments),this},Schema.prototype.post=function(e){if(e instanceof RegExp){const t=Array.prototype.slice.call(arguments,1);for(const s of hookNames)e.test(s)&&this.post.apply(this,[s].concat(t));return this}if(Array.isArray(e)){const t=Array.prototype.slice.call(arguments,1);for(const s of e)this.post.apply(this,[s].concat(t));return this}return this.s.hooks.post.apply(this.s.hooks,arguments),this},Schema.prototype.plugin=function(e,t){if(\"function\"!=typeof e)throw new Error('First param to `schema.plugin()` must be a function, got \"'+typeof e+'\"');if(t&&t.deduplicate)for(let t=0;t<this.plugins.length;++t)if(this.plugins[t].fn===e)return this;return this.plugins.push({fn:e,opts:t}),e(this,t),this},Schema.prototype.method=function(e,t,s){if(\"string\"!=typeof e)for(const t in e)this.methods[t]=e[t],this.methodOptions[t]=utils.clone(s);else this.methods[e]=t,this.methodOptions[e]=utils.clone(s);return this},Schema.prototype.static=function(e,t){if(\"string\"!=typeof e)for(const t in e)this.statics[t]=e[t];else this.statics[e]=t;return this},Schema.prototype.index=function(e,t){return e||(e={}),t||(t={}),t.expires&&utils.expires(t),this._indexes.push([e,t]),this},Schema.prototype.set=function(e,t,s){if(1===arguments.length)return this.options[e];switch(e){case\"read\":this.options[e]=readPref(t,s),this._userProvidedOptions[e]=this.options[e];break;case\"safe\":setSafe(this.options,t),this._userProvidedOptions[e]=this.options[e];break;case\"timestamps\":this.setupTimestamp(t),this.options[e]=t,this._userProvidedOptions[e]=this.options[e];break;default:this.options[e]=t,this._userProvidedOptions[e]=this.options[e]}return this};const safeDeprecationWarning=\"Mongoose: The `safe` option for schemas is deprecated. Use the `writeConcern` option instead: http://bit.ly/mongoose-write-concern\",setSafe=util.deprecate(function(e,t){e.safe=!1===t?{w:0}:t},safeDeprecationWarning);Schema.prototype.get=function(e){return this.options[e]};const indexTypes=\"2d 2dsphere hashed text\".split(\" \");function _deletePath(e,t){const s=t.split(\".\"),i=s.pop();let r=e.tree;for(let e=0;e<s.length;++e)r=r[s[e]];delete r[i]}function isArrayFilter(e){return e.startsWith(\"$[\")&&e.endsWith(\"]\")}Object.defineProperty(Schema,\"indexTypes\",{get:function(){return indexTypes},set:function(){throw new Error(\"Cannot overwrite Schema.indexTypes\")}}),Schema.prototype.indexes=function(){return getIndexes(this)},Schema.prototype.virtual=function(e,t){if(utils.hasUserDefinedProperty(t,[\"ref\",\"refPath\"])){if(!t.localField)throw new Error(\"Reference virtuals require `localField` option\");if(!t.foreignField)throw new Error(\"Reference virtuals require `foreignField` option\");this.pre(\"init\",function(s){if(mpath.has(e,s)){const i=mpath.get(e,s);this.$$populatedVirtuals||(this.$$populatedVirtuals={}),t.justOne||t.count?this.$$populatedVirtuals[e]=Array.isArray(i)?i[0]:i:this.$$populatedVirtuals[e]=Array.isArray(i)?i:null==i?[]:[i],mpath.unset(e,s)}});const s=this.virtual(e);return s.options=t,s.get(function(){if(this.$$populatedVirtuals||(this.$$populatedVirtuals={}),this.$$populatedVirtuals.hasOwnProperty(e))return this.$$populatedVirtuals[e]}).set(function(s){this.$$populatedVirtuals||(this.$$populatedVirtuals={}),t.justOne||t.count?(this.$$populatedVirtuals[e]=Array.isArray(s)?s[0]:s,\"object\"!=typeof this.$$populatedVirtuals[e]&&(this.$$populatedVirtuals[e]=t.count?s:null)):(this.$$populatedVirtuals[e]=Array.isArray(s)?s:null==s?[]:[s],this.$$populatedVirtuals[e]=this.$$populatedVirtuals[e].filter(function(e){return e&&\"object\"==typeof e}))})}const s=this.virtuals,i=e.split(\".\");if(\"real\"===this.pathType(e))throw new Error('Virtual path \"'+e+'\" conflicts with a real path in the schema');s[e]=i.reduce(function(s,r,n){return s[r]||(s[r]=n===i.length-1?new VirtualType(t,e):{}),s[r]},this.tree);let r=i[0];for(let e=0;e<i.length-1;++e){if(null!=this.paths[r]&&this.paths[r].$isMongooseDocumentArray){const t=i.slice(e+1).join(\".\");this.paths[r].schema.virtual(t).get((e,s,i)=>{const n=i.__parentArray[arrayParentSymbol],o=r+\".\"+i.__index+\".\"+t;return n.get(o)});break}r+=\".\"+i[e+1]}return s[e]},Schema.prototype.virtualpath=function(e){return this.virtuals.hasOwnProperty(e)?this.virtuals[e]:null},Schema.prototype.remove=function(e){return\"string\"==typeof e&&(e=[e]),Array.isArray(e)&&e.forEach(function(e){if(null!=this.path(e)||this.nested[e]){if(this.nested[e]){const t=Object.keys(this.paths).concat(Object.keys(this.nested));for(const s of t)s.startsWith(e+\".\")&&(delete this.paths[s],delete this.nested[s],_deletePath(this,s));return delete this.nested[e],void _deletePath(this,e)}delete this.paths[e],_deletePath(this,e)}},this),this},Schema.prototype.loadClass=function(e,t){return e===Object.prototype||e===Function.prototype||e.prototype.hasOwnProperty(\"$isMongooseModelPrototype\")?this:(this.loadClass(Object.getPrototypeOf(e)),t||Object.getOwnPropertyNames(e).forEach(function(t){if(t.match(/^(length|name|prototype)$/))return;const s=Object.getOwnPropertyDescriptor(e,t);\"function\"==typeof s.value&&this.static(t,s.value)},this),Object.getOwnPropertyNames(e.prototype).forEach(function(s){if(s.match(/^(constructor)$/))return;const i=Object.getOwnPropertyDescriptor(e.prototype,s);t||\"function\"==typeof i.value&&this.method(s,i.value),\"function\"==typeof i.get&&this.virtual(s).get(i.get),\"function\"==typeof i.set&&this.virtual(s).set(i.set)},this),this)},Schema.prototype._getSchema=function(e){const t=this.path(e),s=[];if(t)return t.$fullPath=e,t;const i=e.split(\".\");for(let e=0;e<i.length;++e)(\"$\"===i[e]||isArrayFilter(i[e]))&&(i[e]=\"0\");return function e(t,i){let r,n,o=t.length+1;for(;o--;)if(n=t.slice(0,o).join(\".\"),r=i.path(n)){if(s.push(n),r.caster){if(r.caster instanceof MongooseTypes.Mixed)return r.caster.$fullPath=s.join(\".\"),r.caster;if(o!==t.length&&r.schema){let s;return\"$\"===t[o]||isArrayFilter(t[o])?o+1===t.length?r:((s=e(t.slice(o+1),r.schema))&&(s.$isUnderneathDocArray=s.$isUnderneathDocArray||!r.schema.$isSingleNested),s):((s=e(t.slice(o),r.schema))&&(s.$isUnderneathDocArray=s.$isUnderneathDocArray||!r.schema.$isSingleNested),s)}}return r.$fullPath=s.join(\".\"),r}}(i,this)},Schema.prototype._getPathType=function(e){if(this.path(e))return\"real\";return function e(t,s){let i,r,n=t.length+1;for(;n--;){if(r=t.slice(0,n).join(\".\"),i=s.path(r))return i.caster?i.caster instanceof MongooseTypes.Mixed?{schema:i,pathType:\"mixed\"}:n!==t.length&&i.schema?\"$\"===t[n]||isArrayFilter(t[n])?n===t.length-1?{schema:i,pathType:\"nested\"}:e(t.slice(n+1),i.schema):e(t.slice(n),i.schema):{schema:i,pathType:i.$isSingleNested?\"nested\":\"array\"}:{schema:i,pathType:\"real\"};if(n===t.length&&s.nested[r])return{schema:s,pathType:\"nested\"}}return{schema:i||s,pathType:\"undefined\"}}(e.split(\".\"),this)},module.exports=exports=Schema,Schema.Types=MongooseTypes=require(\"./schema/index\"),exports.ObjectId=MongooseTypes.ObjectId;","node_modules/mongoose/lib/schematype.js":"\"use strict\";const MongooseError=require(\"./error/index\"),SchemaTypeOptions=require(\"./options/SchemaTypeOptions\"),$exists=require(\"./schema/operators/exists\"),$type=require(\"./schema/operators/type\"),get=require(\"./helpers/get\"),handleImmutable=require(\"./helpers/schematype/handleImmutable\"),immediate=require(\"./helpers/immediate\"),schemaTypeSymbol=require(\"./helpers/symbols\").schemaTypeSymbol,util=require(\"util\"),utils=require(\"./utils\"),validatorErrorSymbol=require(\"./helpers/symbols\").validatorErrorSymbol,CastError=MongooseError.CastError,ValidatorError=MongooseError.ValidatorError;function SchemaType(t,e,i){this[schemaTypeSymbol]=!0,this.path=t,this.instance=i,this.validators=[],this.getters=this.constructor.hasOwnProperty(\"getters\")?this.constructor.getters.slice():[],this.setters=[];const r=this.OptionsConstructor||SchemaTypeOptions;this.options=new r(e),this._index=null,this.selected,utils.hasUserDefinedProperty(this.options,\"immutable\")&&(this.$immutable=this.options.immutable,handleImmutable(this));const s=Object.keys(this.options);for(const t of s)if(utils.hasUserDefinedProperty(this.options,t)&&\"function\"==typeof this[t]){if(\"index\"===t&&this._index){if(!1===e.index){const t=this._index;if(\"object\"==typeof t&&null!=t){if(t.unique)throw new Error('Path \"'+this.path+'\" may not have `index` set to false and `unique` set to true');if(t.sparse)throw new Error('Path \"'+this.path+'\" may not have `index` set to false and `sparse` set to true')}this._index=!1}continue}const i=e[t];if(\"default\"===t){this.default(i);continue}const r=Array.isArray(i)?i:[i];this[t].apply(this,r)}Object.defineProperty(this,\"$$context\",{enumerable:!1,configurable:!1,writable:!0,value:null})}SchemaType.prototype.OptionsConstructor=SchemaTypeOptions,SchemaType.cast=function(t){return 0===arguments.length?this._cast:(!1===t&&(t=(t=>t)),this._cast=t,this._cast)},SchemaType.get=function(t){this.getters=this.hasOwnProperty(\"getters\")?this.getters:[],this.getters.push(t)},SchemaType.prototype.default=function(t){return 1===arguments.length?void 0===t?void(this.defaultValue=void 0):(this.defaultValue=t,this.defaultValue):(arguments.length>1&&(this.defaultValue=utils.args(arguments)),this.defaultValue)},SchemaType.prototype.index=function(t){return this._index=t,utils.expires(this._index),this},SchemaType.prototype.unique=function(t){if(!1===this._index){if(!t)return;throw new Error('Path \"'+this.path+'\" may not have `index` set to false and `unique` set to true')}return null==this._index||!0===this._index?this._index={}:\"string\"==typeof this._index&&(this._index={type:this._index}),this._index.unique=t,this},SchemaType.prototype.text=function(t){if(!1===this._index){if(!t)return;throw new Error('Path \"'+this.path+'\" may not have `index` set to false and `text` set to true')}return null===this._index||void 0===this._index||\"boolean\"==typeof this._index?this._index={}:\"string\"==typeof this._index&&(this._index={type:this._index}),this._index.text=t,this},SchemaType.prototype.sparse=function(t){if(!1===this._index){if(!t)return;throw new Error('Path \"'+this.path+'\" may not have `index` set to false and `sparse` set to true')}return null==this._index||\"boolean\"==typeof this._index?this._index={}:\"string\"==typeof this._index&&(this._index={type:this._index}),this._index.sparse=t,this},SchemaType.prototype.immutable=function(t){return this.$immutable=t,handleImmutable(this),this},SchemaType.prototype.set=function(t){if(\"function\"!=typeof t)throw new TypeError(\"A setter must be a function.\");return this.setters.push(t),this},SchemaType.prototype.get=function(t){if(\"function\"!=typeof t)throw new TypeError(\"A getter must be a function.\");return this.getters.push(t),this},SchemaType.prototype.validate=function(t,e,i){if(\"function\"==typeof t||t&&\"RegExp\"===utils.getFunctionName(t.constructor)){let r;return e instanceof Object&&!i?((r=utils.clone(e)).message||(r.message=r.msg),r.validator=t,r.type=r.type||\"user defined\"):(e||(e=MongooseError.messages.general.default),i||(i=\"user defined\"),r={message:e,type:i,validator:t}),r.isAsync&&handleIsAsync(),this.validators.push(r),this}let r,s,n;for(r=0,s=arguments.length;r<s;r++){if(n=arguments[r],!utils.isPOJO(n)){throw new Error(\"Invalid validator. Received (\"+typeof n+\") \"+n+\". See http://mongoosejs.com/docs/api.html#schematype_SchemaType-validate\")}this.validate(n.validator,n)}return this};const handleIsAsync=util.deprecate(function(){},\"Mongoose: the `isAsync` option for custom validators is deprecated. Make your async validators return a promise instead: https://mongoosejs.com/docs/validation.html#async-custom-validators\");function asyncValidate(t,e,i,r,s){let n=!1;const o=t.call(e,i,function(t,e){n||(n=!0,e&&(r.message=e),s(t,r))});\"boolean\"==typeof o?(n=!0,s(o,r)):o&&\"function\"==typeof o.then&&o.then(function(t){n||(n=!0,s(t,r))},function(t){n||(n=!0,r.reason=t,r.message=t.message,s(!1,r))})}function handleSingle(t){return this.castForQuery(t)}function handleArray(t){const e=this;return Array.isArray(t)?t.map(function(t){return e.castForQuery(t)}):[this.castForQuery(t)]}function handle$in(t){const e=this;return Array.isArray(t)?t.map(function(t){return Array.isArray(t)&&0===t.length?t:e.castForQuery(t)}):[this.castForQuery(t)]}SchemaType.prototype.required=function(t,e){let i={};if(arguments.length>0&&null==t)return this.validators=this.validators.filter(function(t){return t.validator!==this.requiredValidator},this),this.isRequired=!1,delete this.originalRequiredValue,this;if(\"object\"==typeof t&&(e=(i=t).message||e,t=t.isRequired),!1===t)return this.validators=this.validators.filter(function(t){return t.validator!==this.requiredValidator},this),this.isRequired=!1,delete this.originalRequiredValue,this;const r=this;this.isRequired=!0,this.requiredValidator=function(e){const i=get(this,\"$__.cachedRequired\");if(null!=i&&!this.isSelected(r.path)&&!this.isModified(r.path))return!0;if(null!=i&&r.path in i){const t=!i[r.path]||r.checkRequired(e,this);return delete i[r.path],t}return\"function\"==typeof t&&!t.apply(this)||r.checkRequired(e,this)},this.originalRequiredValue=t,\"string\"==typeof t&&(e=t,t=void 0);const s=e||MongooseError.messages.general.required;return this.validators.unshift(Object.assign({},i,{validator:this.requiredValidator,message:s,type:\"required\"})),this},SchemaType.prototype.ref=function(t){return this.options.ref=t,this},SchemaType.prototype.getDefault=function(t,e){let i=\"function\"==typeof this.defaultValue?this.defaultValue.call(t):this.defaultValue;if(null!==i&&void 0!==i){\"object\"!=typeof i||this.options&&this.options.shared||(i=utils.clone(i));const r=this.applySetters(i,t,e);return r&&r.$isSingleNested&&(r.$parent=t),r}return i},SchemaType.prototype._applySetters=function(t,e,i,r){let s=t;const n=this.setters;let o=n.length;const a=this.caster;for(;o--;)s=n[o].call(e,s,this);if(Array.isArray(s)&&a&&a.setters){const t=[];for(let n=0;n<s.length;n++)t.push(a.applySetters(s[n],e,i,r));s=t}return s},SchemaType.prototype.applySetters=function(t,e,i,r,s){let n=this._applySetters(t,e,i,r,s);return null==n?n:n=this.cast(n,e,i,r,s)},SchemaType.prototype.applyGetters=function(t,e){let i=t;const r=this.getters,s=r.length;if(0===s)return i;for(let t=0;t<s;++t)i=r[t].call(e,i,this);return i},SchemaType.prototype.select=function(t){return this.selected=!!t,this},SchemaType.prototype.doValidate=function(t,e,i,r){let s=!1;const n=this.path,o=this.validators.filter(t=>null!=t&&\"object\"==typeof t);let a=o.length;if(!a)return e(null);const h=function(t,i){if(!s)if(void 0===t||t)--a<=0&&immediate(function(){e(null)});else{const t=i.ErrorConstructor||ValidatorError;(s=new t(i))[validatorErrorSymbol]=!0,immediate(function(){e(s)})}},l=this;o.forEach(function(e){if(s)return;const o=e.validator;let a;const u=utils.clone(e);if(u.path=r&&r.path?r.path:n,u.value=t,o instanceof RegExp)h(o.test(t),u);else if(\"function\"==typeof o){if(void 0===t&&o!==l.requiredValidator)return void h(!0,u);if(u.isAsync)asyncValidate(o,i,t,u,h);else{try{a=u.propsParameter?o.call(i,t,u):o.call(i,t)}catch(t){a=!1,u.reason=t,t.message&&(u.message=t.message)}null!=a&&\"function\"==typeof a.then?a.then(function(t){h(t,u)},function(t){u.reason=t,u.message=t.message,h(a=!1,u)}):h(a,u)}}})},SchemaType.prototype.doValidateSync=function(t,e,i){let r=null;const s=this.path;if(!this.validators.length)return null;const n=function(t,e){if(!r&&void 0!==t&&!t){const t=e.ErrorConstructor||ValidatorError;(r=new t(e))[validatorErrorSymbol]=!0}};let o=this.validators;if(void 0===t){if(!(this.validators.length>0&&\"required\"===this.validators[0].type))return null;o=[this.validators[0]]}return o.forEach(function(o){if(r)return;if(null==o||\"object\"!=typeof o)return;const a=o.validator,h=utils.clone(o);let l;if(h.path=i&&i.path?i.path:s,h.value=t,!a.isAsync)if(a instanceof RegExp)n(a.test(t),h);else if(\"function\"==typeof a){try{l=h.propsParameter?a.call(e,t,h):a.call(e,t)}catch(t){l=!1,h.reason=t}if(null!=l&&\"function\"==typeof l.then)return;n(l,h)}}),r},SchemaType._isRef=function(t,e,i,r){let s=r&&t.options&&(t.options.ref||t.options.refPath);if(!s&&i&&null!=i.$__){const e=i.$__fullPath(t.path);s=(i.ownerDocument?i.ownerDocument():i).populated(e)||i.populated(t.path)}if(s){if(null==e)return!0;if(!Buffer.isBuffer(e)&&\"Binary\"!==e._bsontype&&utils.isObject(e))return!0}return!1},SchemaType.prototype.$conditionalHandlers={$all:handleArray,$eq:handleSingle,$in:handle$in,$ne:handleSingle,$nin:handle$in,$exists:$exists,$type:$type},SchemaType.prototype.castForQueryWrapper=function(t){return this.$$context=t.context,\"$conditional\"in t?this.castForQuery(t.$conditional,t.val):t.$skipQueryCastForUpdate?this._castForQuery(t.val):this.castForQuery(t.val)},SchemaType.prototype.castForQuery=function(t,e){let i;if(2===arguments.length){if(!(i=this.$conditionalHandlers[t]))throw new Error(\"Can't use \"+t);return i.call(this,e)}return e=t,this._castForQuery(e)},SchemaType.prototype._castForQuery=function(t){return this.applySetters(t,this.$$context)},SchemaType.checkRequired=function(t){return arguments.length>0&&(this._checkRequired=t),this._checkRequired},SchemaType.prototype.checkRequired=function(t){return null!=t},SchemaType.prototype.clone=function(){const t=Object.assign({},this.options),e=new this.constructor(this.path,t,this.instance);return e.validators=this.validators.slice(),e.requiredValidator=this.requiredValidator,e.getters=this.getters.slice(),e.setters=this.setters.slice(),e},module.exports=exports=SchemaType,exports.CastError=CastError,exports.ValidatorError=ValidatorError;","node_modules/mongoose/lib/schema/index.js":"\"use strict\";exports.String=require(\"./string\"),exports.Number=require(\"./number\"),exports.Boolean=require(\"./boolean\"),exports.DocumentArray=require(\"./documentarray\"),exports.Embedded=require(\"./SingleNestedPath\"),exports.Array=require(\"./array\"),exports.Buffer=require(\"./buffer\"),exports.Date=require(\"./date\"),exports.ObjectId=require(\"./objectid\"),exports.Mixed=require(\"./mixed\"),exports.Decimal128=exports.Decimal=require(\"./decimal128\"),exports.Map=require(\"./map\"),exports.Oid=exports.ObjectId,exports.Object=exports.Mixed,exports.Bool=exports.Boolean,exports.ObjectID=exports.ObjectId;","node_modules/mongoose/lib/virtualtype.js":"\"use strict\";function VirtualType(t,e){this.path=e,this.getters=[],this.setters=[],this.options=Object.assign({},t)}VirtualType.prototype._applyDefaultGetters=function(){if(this.getters.length>0||this.setters.length>0)return;const t=\"$\"+this.path;this.getters.push(function(){return this[t]}),this.setters.push(function(e){this[t]=e})},VirtualType.prototype.clone=function(){const t=new VirtualType(this.name,this.options);return t.getters=[].concat(this.getters),t.setters=[].concat(this.setters),t},VirtualType.prototype.get=function(t){return this.getters.push(t),this},VirtualType.prototype.set=function(t){return this.setters.push(t),this},VirtualType.prototype.applyGetters=function(t,e){let s=t;for(let t=this.getters.length-1;t>=0;t--)s=this.getters[t].call(e,s,this,e);return s},VirtualType.prototype.applySetters=function(t,e){let s=t;for(let t=this.setters.length-1;t>=0;t--)s=this.setters[t].call(e,s,this,e);return s},module.exports=VirtualType;","node_modules/mongoose/lib/connectionstate.js":"\"use strict\";const STATES=module.exports=exports=Object.create(null),disconnected=\"disconnected\",connected=\"connected\",connecting=\"connecting\",disconnecting=\"disconnecting\",uninitialized=\"uninitialized\";STATES[0]=disconnected,STATES[1]=connected,STATES[2]=connecting,STATES[3]=disconnecting,STATES[99]=uninitialized,STATES.disconnected=0,STATES.connected=1,STATES.connecting=2,STATES.disconnecting=3,STATES.uninitialized=99;","node_modules/mongoose/lib/types/index.js":"\"use strict\";exports.Array=require(\"./array\"),exports.Buffer=require(\"./buffer\"),exports.Document=exports.Embedded=require(\"./embedded\"),exports.DocumentArray=require(\"./documentarray\"),exports.Decimal128=require(\"./decimal128\"),exports.ObjectId=require(\"./objectid\"),exports.Map=require(\"./map\"),exports.Subdocument=require(\"./subdocument\");","node_modules/mongoose/lib/query.js":"\"use strict\";const CastError=require(\"./error/cast\"),DocumentNotFoundError=require(\"./error/notFound\"),Kareem=require(\"kareem\"),MongooseError=require(\"./error/mongooseError\"),ObjectParameterError=require(\"./error/objectParameter\"),QueryCursor=require(\"./cursor/QueryCursor\"),ReadPreference=require(\"./driver\").get().ReadPreference,applyGlobalMaxTimeMS=require(\"./helpers/query/applyGlobalMaxTimeMS\"),applyWriteConcern=require(\"./helpers/schema/applyWriteConcern\"),cast=require(\"./cast\"),castArrayFilters=require(\"./helpers/update/castArrayFilters\"),castUpdate=require(\"./helpers/query/castUpdate\"),completeMany=require(\"./helpers/query/completeMany\"),get=require(\"./helpers/get\"),getDiscriminatorByValue=require(\"./helpers/discriminator/getDiscriminatorByValue\"),hasDollarKeys=require(\"./helpers/query/hasDollarKeys\"),helpers=require(\"./queryhelpers\"),isInclusive=require(\"./helpers/projection/isInclusive\"),mquery=require(\"mquery\"),selectPopulatedFields=require(\"./helpers/query/selectPopulatedFields\"),setDefaultsOnInsert=require(\"./helpers/setDefaultsOnInsert\"),slice=require(\"sliced\"),updateValidators=require(\"./helpers/updateValidators\"),util=require(\"util\"),utils=require(\"./utils\"),wrapThunk=require(\"./helpers/query/wrapThunk\");function Query(t,e,i,o){this._mongooseOptions||(this._mongooseOptions={}),e=e||{},this._transforms=[],this._hooks=new Kareem,this._executionCount=0;const n=Object.keys(e);for(let t=0;t<n.length;++t){const i=n[t];this._mongooseOptions[i]=e[i]}o&&(this.mongooseCollection=o),i&&(this.model=i,this.schema=i.schema),this.model&&this.model._mapreduce&&this.lean(),mquery.call(this,this.mongooseCollection,e),t&&this.find(t),this.options=this.options||{},this.$useProjection=!0;const r=get(this,\"schema.options.collation\",null);null!=r&&(this.options.collation=r)}Query.prototype=new mquery,Query.prototype.constructor=Query,Query.base=mquery.prototype,Query.use$geoWithin=mquery.use$geoWithin,Query.prototype.toConstructor=function(){const t=this.model,e=this.mongooseCollection,i=function(n,r){if(!(this instanceof i))return new i(n,r);this._mongooseOptions=utils.clone(o._mongooseOptions),Query.call(this,n,r||null,t,e)};util.inherits(i,t.Query);const o=i.prototype;o.options={};const n=Object.assign({},this.options);return null!=n.sort&&(o.sort(n.sort),delete n.sort),o.setOptions(n),o.op=this.op,o._conditions=utils.clone(this._conditions),o._fields=utils.clone(this._fields),o._update=utils.clone(this._update,{flattenDecimals:!1}),o._path=this._path,o._distinct=this._distinct,o._collection=this._collection,o._mongooseOptions=this._mongooseOptions,i},Query.prototype.slice=function(){if(0===arguments.length)return this;let t,e;if(this._validate(\"slice\"),1===arguments.length){const i=arguments[0];if(\"object\"==typeof i&&!Array.isArray(i)){const t=Object.keys(i),e=t.length;for(let o=0;o<e;++o)this.slice(t[o],i[t[o]]);return this}this._ensurePath(\"slice\"),t=this._path,e=arguments[0]}else 2===arguments.length?\"number\"==typeof arguments[0]?(this._ensurePath(\"slice\"),t=this._path,e=slice(arguments)):(t=arguments[0],e=arguments[1]):3===arguments.length&&(t=arguments[0],e=slice(arguments,1));const i={};return i[t]={$slice:e},this.select(i),this},Query.prototype.mod=function(){let t,e;return 1===arguments.length?(this._ensurePath(\"mod\"),t=arguments[0],e=this._path):2!==arguments.length||Array.isArray(arguments[1])?3===arguments.length?(t=slice(arguments,1),e=arguments[0]):(t=arguments[1],e=arguments[0]):(this._ensurePath(\"mod\"),t=slice(arguments),e=this._path),(this._conditions[e]||(this._conditions[e]={})).$mod=t,this},Query.prototype.projection=function(t){return 0===arguments.length?this._fields:(this._fields={},this._userProvidedFields={},this.select(t),this._fields)},Query.prototype.select=function(){let t,e,i=arguments[0];if(!i)return this;if(1!==arguments.length)throw new Error(\"Invalid select: select only takes 1 argument\");this._validate(\"select\");const o=this._fields||(this._fields={}),n=this._userProvidedFields||(this._userProvidedFields={}),r=typeof i;if((\"string\"==r||\"[object Arguments]\"===Object.prototype.toString.call(i))&&\"number\"==typeof i.length||Array.isArray(i)){for(\"string\"==r&&(i=i.split(/\\s+/)),t=0,e=i.length;t<e;++t){let e=i[t];if(!e)continue;const r=\"-\"==e[0]?0:1;0===r&&(e=e.substring(1)),o[e]=r,n[e]=r}return this}if(utils.isObject(i)){const e=Object.keys(i);for(t=0;t<e.length;++t)o[e[t]]=i[e[t]],n[e[t]]=i[e[t]];return this}throw new TypeError(\"Invalid select() argument. Must be string or object.\")},Query.prototype.read=function(t,e){const i=new ReadPreference(t,e);return this.options.readPreference=i,this},Query.prototype.session=function(t){return null==t&&delete this.options.session,this.options.session=t,this},Query.prototype.w=function(t){return null==t&&delete this.options.w,this.options.w=t,this},Query.prototype.j=function(t){return null==t&&delete this.options.j,this.options.j=t,this},Query.prototype.wtimeout=function(t){return null==t&&delete this.options.wtimeout,this.options.wtimeout=t,this},Query.prototype.getOptions=function(){return this.options},Query.prototype.setOptions=function(t,e){if(e)return this._mongooseOptions=t&&utils.clone(t)||{},this.options=t||{},\"populate\"in t&&this.populate(this._mongooseOptions),this;if(null==t)return this;if(\"object\"!=typeof t)throw new Error('Options must be an object, got \"'+t+'\"');if(Array.isArray(t.populate)){const e=t.populate;delete t.populate;const i=e.length;for(let t=0;t<i;++t)this.populate(e[t])}return\"useFindAndModify\"in t&&(this._mongooseOptions.useFindAndModify=t.useFindAndModify,delete t.useFindAndModify),\"omitUndefined\"in t&&(this._mongooseOptions.omitUndefined=t.omitUndefined,delete t.omitUndefined),Query.base.setOptions.call(this,t)},Query.prototype.explain=function(t){return 0===arguments.length?(this.options.explain=!0,this):(this.options.explain=t,this)},Query.prototype.maxTimeMS=function(t){return this.options.maxTimeMS=t,this},Query.prototype.getFilter=function(){return this._conditions},Query.prototype.getQuery=function(){return this._conditions},Query.prototype.setQuery=function(t){this._conditions=t},Query.prototype.getUpdate=function(){return this._update},Query.prototype.setUpdate=function(t){this._update=t},Query.prototype._fieldsForExec=function(){return utils.clone(this._fields)},Query.prototype._updateForExec=function(){const t=utils.clone(this._update,{transform:!1,depopulate:!0}),e=Object.keys(t);let i=e.length;const o={};for(;i--;){const n=e[i];this.options.overwrite?o[n]=t[n]:\"$\"!==n[0]?(o.$set||(t.$set?o.$set=t.$set:o.$set={}),o.$set[n]=t[n],e.splice(i,1),~e.indexOf(\"$set\")||e.push(\"$set\")):\"$set\"===n&&o.$set||(o[n]=t[n])}return o},Query.prototype._optionsForExec=function(t){const e=utils.clone(this.options);if(delete e.populate,!(t=t||this.model))return e;const i=get(t,\"schema.options.safe\",null);\"safe\"in e||null==i||setSafe(e,i),applyWriteConcern(t.schema,e);const o=get(t,\"schema.options.read\");return\"readPreference\"in e||!o||(e.readPreference=o),void 0!==e.upsert&&(e.upsert=!!e.upsert),e};const safeDeprecationWarning=\"Mongoose: the `safe` option is deprecated. Use write concerns instead: http://bit.ly/mongoose-w\",setSafe=util.deprecate(function(t,e){t.safe=e},safeDeprecationWarning);function _castArrayFilters(t){try{castArrayFilters(t)}catch(e){t.error(e)}}function completeOne(t,e,i,o,n,r,s,u){const l=s?{populated:s}:void 0;if(o.rawResult&&null==e)return c(null),null;const p=helpers.createModel(t,e,n,r);try{p.init(e,l,c)}catch(t){c(t)}function c(t){return t?process.nextTick(()=>u(t)):o.rawResult?(e&&p?(p.$session(o.session),i.value=p):i.value=null,process.nextTick(()=>u(null,i))):(p.$session(o.session),void process.nextTick(()=>u(null,p)))}}function prepareDiscriminatorCriteria(t){if(!t||!t.model||!t.model.schema)return;const e=t.model.schema;e&&e.discriminatorMapping&&!e.discriminatorMapping.isRoot&&(t._conditions[e.discriminatorMapping.key]=e.discriminatorMapping.value)}function convertNewToReturnOriginal(t){\"new\"in t&&(t.returnOriginal=!t.new,delete t.new)}function _getOption(t,e,i){const o=t._optionsForExec(t.model);return e in o?o[e]:e in t.model.base.options?t.model.base.options[e]:i}function _completeOneLean(t,e,i,o){return i.rawResult?o(null,e):o(null,t)}Query.prototype.lean=function(t){return this._mongooseOptions.lean=!arguments.length||t,this},Query.prototype.set=function(t,e){if(\"object\"==typeof t){const e=Object.keys(t);for(const i of e)this.set(i,t[i]);return this}return this._update=this._update||{},this._update.$set=this._update.$set||{},this._update.$set[t]=e,this},Query.prototype.get=function(t){const e=this._update;if(null==e)return;const i=e.$set;return null==i?e[t]:utils.hasUserDefinedProperty(e,t)?e[t]:utils.hasUserDefinedProperty(i,t)?i[t]:void 0},Query.prototype.error=function(t){return 0===arguments.length?this._error:(this._error=t,this)},Query.prototype._unsetCastError=function(){if(null==this._error||this._error instanceof CastError)return this.error(null)},Query.prototype.mongooseOptions=function(t){return arguments.length>0&&(this._mongooseOptions=t),this._mongooseOptions},Query.prototype._castConditions=function(){try{this.cast(this.model),this._unsetCastError()}catch(t){this.error(t)}},Query.prototype._find=wrapThunk(function(t){if(this._castConditions(),null!=this.error())return t(this.error()),null;t=_wrapThunkCallback(this,t),this._applyPaths(),this._fields=this._castFields(this._fields);const e=this._fieldsForExec(),i=this._mongooseOptions,o=this,n=o._userProvidedFields||{};applyGlobalMaxTimeMS(this.options,this.model);const r=Object.assign({},{session:get(this,\"options.session\",null)}),s=this._optionsForExec();s.projection=this._fieldsForExec();const u=this._conditions;return this._collection.find(u,s,(s,u)=>{if(s)return t(s);if(0===u.length)return t(null,u);if(this.options.explain)return t(null,u);if(!i.populate)return i.lean?t(null,u):completeMany(o.model,u,e,n,r,t);const l=helpers.preparePopulationOptionsMQ(o,i);r.populated=l,o.model.populate(u,l,function(s,u){return s?t(s):i.lean?t(null,u):completeMany(o.model,u,e,n,r,t)})}),null}),Query.prototype.find=function(t,e){return\"function\"==typeof t&&(e=t,t={}),t=utils.toObject(t),mquery.canMerge(t)?(this.merge(t),prepareDiscriminatorCriteria(this)):null!=t&&this.error(new ObjectParameterError(t,\"filter\",\"find\")),e?(this._find(e),this):Query.base.find.call(this)},Query.prototype.merge=function(t){if(!t)return this;const e={overwrite:!0};return t instanceof Query?(t._conditions&&utils.merge(this._conditions,t._conditions,e),t._fields&&(this._fields||(this._fields={}),utils.merge(this._fields,t._fields,e)),t.options&&(this.options||(this.options={}),utils.merge(this.options,t.options,e)),t._update&&(this._update||(this._update={}),utils.mergeClone(this._update,t._update)),t._distinct&&(this._distinct=t._distinct),utils.merge(this._mongooseOptions,t._mongooseOptions),this):(utils.merge(this._conditions,t,e),this)},Query.prototype.collation=function(t){return null==this.options&&(this.options={}),this.options.collation=t,this},Query.prototype._completeOne=function(t,e,i){if(!t&&!this.options.rawResult)return i(null,null);const o=this.model,n=utils.clone(this._fields),r=this._userProvidedFields||{},s=this._mongooseOptions,u=this.options;if(u.explain)return i(null,t);if(!s.populate)return s.lean?_completeOneLean(t,e,u,i):completeOne(o,t,e,u,n,r,null,i);const l=helpers.preparePopulationOptionsMQ(this,this._mongooseOptions);o.populate(t,l,(t,p)=>t?i(t):s.lean?_completeOneLean(p,e,u,i):completeOne(o,p,e,u,n,r,l,i))},Query.prototype._findOne=wrapThunk(function(t){if(this._castConditions(),this.error())return t(this.error()),null;this._applyPaths(),this._fields=this._castFields(this._fields),applyGlobalMaxTimeMS(this.options,this.model),Query.base.findOne.call(this,{},(e,i)=>{if(e)return t(e),null;this._completeOne(i,null,_wrapThunkCallback(this,t))})}),Query.prototype.findOne=function(t,e,i,o){return\"function\"==typeof t?(o=t,t=null,e=null,i=null):\"function\"==typeof e?(o=e,i=null,e=null):\"function\"==typeof i&&(o=i,i=null),t=utils.toObject(t),this.op=\"findOne\",i&&this.setOptions(i),e&&this.select(e),mquery.canMerge(t)?(this.merge(t),prepareDiscriminatorCriteria(this)):null!=t&&this.error(new ObjectParameterError(t,\"filter\",\"findOne\")),o?(this._findOne(o),this):Query.base.findOne.call(this)},Query.prototype._count=wrapThunk(function(t){try{this.cast(this.model)}catch(t){this.error(t)}if(this.error())return t(this.error());const e=this._conditions,i=this._optionsForExec();this._collection.count(e,i,utils.tick(t))}),Query.prototype._countDocuments=wrapThunk(function(t){try{this.cast(this.model)}catch(t){this.error(t)}if(this.error())return t(this.error());const e=this._conditions,i=this._optionsForExec();this._collection.collection.countDocuments(e,i,utils.tick(t))}),Query.prototype._estimatedDocumentCount=wrapThunk(function(t){if(this.error())return t(this.error());const e=this._optionsForExec();this._collection.collection.estimatedDocumentCount(e,utils.tick(t))}),Query.prototype.count=function(t,e){return\"function\"==typeof t&&(e=t,t=void 0),t=utils.toObject(t),mquery.canMerge(t)&&this.merge(t),this.op=\"count\",e?(this._count(e),this):this},Query.prototype.estimatedDocumentCount=function(t,e){return\"function\"==typeof t&&(e=t,t=void 0),\"object\"==typeof t&&null!=t&&this.setOptions(t),this.op=\"estimatedDocumentCount\",e?(this._estimatedDocumentCount(e),this):this},Query.prototype.countDocuments=function(t,e){return\"function\"==typeof t&&(e=t,t=void 0),t=utils.toObject(t),mquery.canMerge(t)&&this.merge(t),this.op=\"countDocuments\",e?(this._countDocuments(e),this):this},Query.prototype.__distinct=wrapThunk(function(t){if(this._castConditions(),this.error())return t(this.error()),null;this._collection.collection.distinct(this._distinct,this._conditions,t)}),Query.prototype.distinct=function(t,e,i){return i||(\"function\"==typeof e?(i=e,e=void 0):\"function\"==typeof t&&(i=t,t=void 0,e=void 0)),e=utils.toObject(e),mquery.canMerge(e)?(this.merge(e),prepareDiscriminatorCriteria(this)):null!=e&&this.error(new ObjectParameterError(e,\"filter\",\"distinct\")),null!=t&&(this._distinct=t),this.op=\"distinct\",null!=i&&this.__distinct(i),this},Query.prototype.sort=function(t){if(arguments.length>1)throw new Error(\"sort() only takes 1 Argument\");return Query.base.sort.call(this,t)},Query.prototype.remove=function(t,e){return\"function\"==typeof t&&(e=t,t=null),t=utils.toObject(t),mquery.canMerge(t)?(this.merge(t),prepareDiscriminatorCriteria(this)):null!=t&&this.error(new ObjectParameterError(t,\"filter\",\"remove\")),e?(this._remove(e),this):Query.base.remove.call(this)},Query.prototype._remove=wrapThunk(function(t){return this._castConditions(),null!=this.error()?(t(this.error()),this):(t=_wrapThunkCallback(this,t),Query.base.remove.call(this,helpers.handleDeleteWriteOpResult(t)))}),Query.prototype.deleteOne=function(t,e,i){return\"function\"==typeof t?(i=t,t=null,e=null):\"function\"==typeof e?(i=e,e=null):this.setOptions(e),t=utils.toObject(t),mquery.canMerge(t)?(this.merge(t),prepareDiscriminatorCriteria(this)):null!=t&&this.error(new ObjectParameterError(t,\"filter\",\"deleteOne\")),i?(this._deleteOne.call(this,i),this):Query.base.deleteOne.call(this)},Query.prototype._deleteOne=wrapThunk(function(t){return this._castConditions(),null!=this.error()?(t(this.error()),this):(t=_wrapThunkCallback(this,t),Query.base.deleteOne.call(this,helpers.handleDeleteWriteOpResult(t)))}),Query.prototype.deleteMany=function(t,e,i){return\"function\"==typeof t?(i=t,t=null,e=null):\"function\"==typeof e?(i=e,e=null):this.setOptions(e),t=utils.toObject(t),mquery.canMerge(t)?(this.merge(t),prepareDiscriminatorCriteria(this)):null!=t&&this.error(new ObjectParameterError(t,\"filter\",\"deleteMany\")),i?(this._deleteMany.call(this,i),this):Query.base.deleteMany.call(this)},Query.prototype._deleteMany=wrapThunk(function(t){return this._castConditions(),null!=this.error()?(t(this.error()),this):(t=_wrapThunkCallback(this,t),Query.base.deleteMany.call(this,helpers.handleDeleteWriteOpResult(t)))}),Query.prototype.findOneAndUpdate=function(t,e,i,o){switch(this.op=\"findOneAndUpdate\",this._validate(),arguments.length){case 3:\"function\"==typeof i&&(o=i,i={});break;case 2:\"function\"==typeof e&&(o=e,e=t,t=void 0),i=void 0;break;case 1:\"function\"==typeof t?(o=t,t=i=e=void 0):(e=t,t=i=void 0)}return mquery.canMerge(t)&&this.merge(t),e&&this._mergeUpdate(e),i&&((i=utils.clone(i)).projection&&(this.select(i.projection),delete i.projection),i.fields&&(this.select(i.fields),delete i.fields),this.setOptions(i)),o?(this._findOneAndUpdate(o),this):this},Query.prototype._findOneAndUpdate=wrapThunk(function(t){if(null!=this.error())return t(this.error());this._findAndModify(\"update\",t)}),Query.prototype.findOneAndRemove=function(t,e,i){switch(this.op=\"findOneAndRemove\",this._validate(),arguments.length){case 2:\"function\"==typeof e&&(i=e,e={});break;case 1:\"function\"==typeof t&&(i=t,t=void 0,e=void 0)}return mquery.canMerge(t)&&this.merge(t),e&&this.setOptions(e),i?(this._findOneAndRemove(i),this):this},Query.prototype.findOneAndDelete=function(t,e,i){switch(this.op=\"findOneAndDelete\",this._validate(),arguments.length){case 2:\"function\"==typeof e&&(i=e,e={});break;case 1:\"function\"==typeof t&&(i=t,t=void 0,e=void 0)}return mquery.canMerge(t)&&this.merge(t),e&&this.setOptions(e),i?(this._findOneAndDelete(i),this):this},Query.prototype._findOneAndDelete=wrapThunk(function(t){if(this._castConditions(),null!=this.error())return t(this.error()),null;const e=this._conditions,i=this._optionsForExec();let o=null;if(null!=this._fields&&(i.projection=this._castFields(utils.clone(this._fields)),(o=i.projection)instanceof Error))return t(o),null;this._collection.collection.findOneAndDelete(e,i,_wrapThunkCallback(this,(e,i)=>{if(e)return t(e);const o=i.value;return this._completeOne(o,i,t)}))}),Query.prototype.findOneAndReplace=function(t,e,i,o){switch(this.op=\"findOneAndReplace\",this._validate(),arguments.length){case 3:\"function\"==typeof i&&(o=i,i=void 0);break;case 2:\"function\"==typeof e&&(o=e,e=void 0);break;case 1:\"function\"==typeof t&&(o=t,t=void 0,e=void 0,i=void 0)}if(mquery.canMerge(t)&&this.merge(t),null!=e){if(hasDollarKeys(e))throw new Error(\"The replacement document must not contain atomic operators.\");this._mergeUpdate(e)}return i&&this.setOptions(i),o?(this._findOneAndReplace(o),this):this},Query.prototype._findOneAndReplace=wrapThunk(function(t){if(this._castConditions(),null!=this.error())return t(this.error()),null;const e=this._conditions,i=this._optionsForExec();convertNewToReturnOriginal(i);let o=null,n=new this.model(this._update,null,!0);if(this._update=n,this._applyPaths(),null!=this._fields&&(i.projection=this._castFields(utils.clone(this._fields)),(o=i.projection)instanceof Error))return t(o),null;n.validate(o=>{if(null!=o)return t(o);n.toBSON&&(n=n.toBSON()),this._collection.collection.findOneAndReplace(e,n,i,_wrapThunkCallback(this,(e,i)=>{if(e)return t(e);const o=i.value;return this._completeOne(o,i,t)}))})}),Query.prototype._findOneAndRemove=wrapThunk(function(t){null==this.error()?this._findAndModify(\"remove\",t):t(this.error())}),Query.prototype._findAndModify=function(t,e){if(\"function\"!=typeof e)throw new Error(\"Expected callback in _findAndModify\");const i=this.model,o=i.schema,n=this;let r;const s=castQuery(this);if(s instanceof Error)return e(s);_castArrayFilters(this);const u=this._optionsForExec(i);\"strict\"in u&&(this._mongooseOptions.strict=u.strict);const l=this.options.overwrite&&!hasDollarKeys(this._update);if(l&&(this._update=new this.model(this._update,null,!0)),\"remove\"===t)u.remove=!0;else if(\"new\"in u||\"returnOriginal\"in u||(u.new=!1),\"upsert\"in u||(u.upsert=!1),(u.upsert||u.new)&&(u.remove=!1),!l)if(this._update=castDoc(this,u.overwrite),this._update=setDefaultsOnInsert(this._conditions,o,this._update,u),this._update){if(this._update instanceof Error)return e(this._update);this._update.$set&&0===Object.keys(this._update.$set).length&&delete this._update.$set}else{if(!u.upsert)return this.findOne(e),this;{const t=utils.clone(s);delete t._id,this._update={$set:t}}}this._applyPaths();const p=this._mongooseOptions;if(this._fields&&(r=utils.clone(this._fields),u.projection=this._castFields(r),u.projection instanceof Error))return e(u.projection);u.sort&&convertSortToArray(u);const c=function(t,i,o){if(t)return e(t);n._completeOne(i,o,e)};let a=!0;const h=_getOption(this,\"runValidators\",!1),d=n.model&&n.model.base,f=get(i,\"collection.conn\",{});if(\"useFindAndModify\"in d.options&&(a=d.get(\"useFindAndModify\")),\"useFindAndModify\"in f.config&&(a=f.config.useFindAndModify),\"useFindAndModify\"in p&&(a=p.useFindAndModify),!1===a){const i=n._collection.collection;if(convertNewToReturnOriginal(u),\"remove\"===t)return i.findOneAndDelete(s,u,_wrapThunkCallback(n,function(t,e){return c(t,e?e.value:e,e)})),this;const o=l?\"findOneAndReplace\":\"findOneAndUpdate\";return h?this.validate(this._update,u,l,t=>{if(t)return e(t);this._update&&this._update.toBSON&&(this._update=this._update.toBSON()),i[o](s,this._update,u,_wrapThunkCallback(n,function(t,e){return c(t,e?e.value:e,e)}))}):(this._update&&this._update.toBSON&&(this._update=this._update.toBSON()),i[o](s,this._update,u,_wrapThunkCallback(n,function(t,e){return c(t,e?e.value:e,e)}))),this}return h?this.validate(this._update,u,l,function(t){if(t)return e(t);_legacyFindAndModify.call(n,s,n._update,u,c)}):_legacyFindAndModify.call(n,s,n._update,u,c),this};const _legacyFindAndModify=util.deprecate(function(t,e,i,o){e&&e.toBSON&&(e=e.toBSON());const n=this._collection,r=null!=i&&Array.isArray(i.sort)?i.sort:[],s=_wrapThunkCallback(this,function(t,e){return o(t,e?e.value:e,e)});n.collection._findAndModify(t,r,e,i,s)},\"Mongoose: `findOneAndUpdate()` and `findOneAndDelete()` without the `useFindAndModify` option set to false are deprecated. See: https://mongoosejs.com/docs/deprecations.html#-findandmodify-\");function convertSortToArray(t){if(Array.isArray(t.sort))return;if(!utils.isObject(t.sort))return;const e=[];for(const i in t.sort)utils.object.hasOwnProperty(t.sort,i)&&e.push([i,t.sort[i]]);t.sort=e}function _updateThunk(t,e){if(this._castConditions(),_castArrayFilters(this),null!=this.error())return e(this.error()),null;e=_wrapThunkCallback(this,e);const i=this._conditions,o=this._optionsForExec(this.model);++this._executionCount,this._update=utils.clone(this._update,o);const n=this.options.overwrite&&!hasDollarKeys(this._update);if(n){if(\"updateOne\"===t||\"updateMany\"===t)return e(new MongooseError(\"The MongoDB server disallows overwriting documents using `\"+t+\"`. See: https://mongoosejs.com/docs/deprecations.html#-update-\"));this._update=new this.model(this._update,null,!0)}else{if(this._update=castDoc(this,o.overwrite),this._update instanceof Error)return e(this._update),null;if(null==this._update||0===Object.keys(this._update).length)return e(null,0),null;this._update=setDefaultsOnInsert(this._conditions,this.model.schema,this._update,o)}return _getOption(this,\"runValidators\",!1)?(this.validate(this._update,o,n,n=>{if(n)return e(n);this._update.toBSON&&(this._update=this._update.toBSON()),this._collection[t](i,this._update,o,e)}),null):(this._update.toBSON&&(this._update=this._update.toBSON()),this._collection[t](i,this._update,o,e),null)}function _update(t,e,i,o,n,r){t.op=e,i=utils.toObject(i),o=o||{};const s=r;if(s){if(\"function\"!=typeof s)throw new Error(\"Invalid callback() argument.\");r=function(t,e){s(t,e?e.result:{ok:0,n:0,nModified:0})}}return null!=n&&\"strict\"in n&&(t._mongooseOptions.strict=n.strict),i instanceof Query||null==i||\"[object Object]\"===i.toString()?t.merge(i):t.error(new ObjectParameterError(i,\"filter\",e)),utils.isObject(n)&&t.setOptions(n),t._mergeUpdate(o),r?\"update\"===e?(t._execUpdate(r),t):(t[\"_\"+e](r),t):Query.base[e].call(t,i,o,n,r)}function _orFailError(t,e){return\"function\"==typeof t&&(t=t.call(e)),null==t&&(t=new DocumentNotFoundError(e.getQuery(),e.model.modelName)),t}function _wrapThunkCallback(t,e){return function(i,o){if(null!=i)return e(i);for(const n of t._transforms)try{o=n(o)}catch(i){return e(i)}return e(null,o)}}function castQuery(t){try{return t.cast(t.model)}catch(t){return t}}function castDoc(t,e){try{return t._castUpdate(t._update,e)}catch(t){return t}}function _getPopulatedPaths(t,e,i){for(const o of e)t.push(i+o.path),Array.isArray(o.populate)&&_getPopulatedPaths(t,o.populate,i+o.path+\".\")}Query.prototype._mergeUpdate=function(t){this._update||(this._update={}),t instanceof Query?t._update&&utils.mergeClone(this._update,t._update):utils.mergeClone(this._update,t)},Query.prototype.validate=function(t,e,i,o){return utils.promiseOrCallback(o,o=>{try{i?t.validate(o):updateValidators(this,this.model.schema,t,e,o)}catch(t){process.nextTick(function(){o(t)})}})},Query.prototype._execUpdate=wrapThunk(function(t){return _updateThunk.call(this,\"update\",t)}),Query.prototype._updateMany=wrapThunk(function(t){return _updateThunk.call(this,\"updateMany\",t)}),Query.prototype._updateOne=wrapThunk(function(t){return _updateThunk.call(this,\"updateOne\",t)}),Query.prototype._replaceOne=wrapThunk(function(t){return _updateThunk.call(this,\"replaceOne\",t)}),Query.prototype.update=function(t,e,i,o){return\"function\"==typeof i?(o=i,i=null):\"function\"==typeof e?(o=e,e=t,t={},i=null):\"function\"==typeof t?(o=t,t=void 0,e=void 0,i=void 0):\"object\"!=typeof t||e||i||o||(e=t,t=void 0,i=void 0,o=void 0),_update(this,\"update\",t,e,i,o)},Query.prototype.updateMany=function(t,e,i,o){return\"function\"==typeof i?(o=i,i=null):\"function\"==typeof e?(o=e,e=t,t={},i=null):\"function\"==typeof t?(o=t,t=void 0,e=void 0,i=void 0):\"object\"!=typeof t||e||i||o||(e=t,t=void 0,i=void 0,o=void 0),_update(this,\"updateMany\",t,e,i,o)},Query.prototype.updateOne=function(t,e,i,o){return\"function\"==typeof i?(o=i,i=null):\"function\"==typeof e?(o=e,e=t,t={},i=null):\"function\"==typeof t?(o=t,t=void 0,e=void 0,i=void 0):\"object\"!=typeof t||e||i||o||(e=t,t=void 0,i=void 0,o=void 0),_update(this,\"updateOne\",t,e,i,o)},Query.prototype.replaceOne=function(t,e,i,o){return\"function\"==typeof i?(o=i,i=null):\"function\"==typeof e?(o=e,e=t,t={},i=null):\"function\"==typeof t?(o=t,t=void 0,e=void 0,i=void 0):\"object\"!=typeof t||e||i||o||(e=t,t=void 0,i=void 0,o=void 0),this.setOptions({overwrite:!0}),_update(this,\"replaceOne\",t,e,i,o)},Query.prototype.map=function(t){return this._transforms.push(t),this},Query.prototype.orFail=function(t){return this.map(e=>{switch(this.op){case\"find\":if(0===e.length)throw _orFailError(t,this);break;case\"findOne\":if(null==e)throw _orFailError(t,this);break;case\"update\":case\"updateMany\":case\"updateOne\":if(0===get(e,\"result.nModified\"))throw _orFailError(t,this);break;case\"findOneAndDelete\":if(0===get(e,\"lastErrorObject.n\"))throw _orFailError(t,this);break;case\"findOneAndUpdate\":case\"findOneAndReplace\":if(!1===get(e,\"lastErrorObject.updatedExisting\"))throw _orFailError(t,this);break;case\"deleteMany\":case\"deleteOne\":case\"remove\":if(0===e.n)throw _orFailError(t,this)}return e}),this},Query.prototype.exec=function(t,e){const i=this;return\"function\"==typeof t?(e=t,t=null):\"string\"==typeof t&&(this.op=t),e=this.model.$handleCallbackError(e),utils.promiseOrCallback(e,this.model.$wrapCallback(t=>{i.op?this._hooks.execPre(\"exec\",this,[],e=>{if(e)return t(e);this[this.op].call(this,(e,i)=>{if(e)return t(e);this._hooks.execPost(\"exec\",this,[],{},e=>{if(e)return t(e);t(null,i)})})}):t()}),this.model.events)},Query.prototype.then=function(t,e){return this.exec().then(t,e)},Query.prototype.catch=function(t){return this.exec().then(null,t)},Query.prototype._pre=function(t){return this._hooks.pre(\"exec\",t),this},Query.prototype._post=function(t){return this._hooks.post(\"exec\",t),this},Query.prototype._castUpdate=function(t,e){let i;i=\"strict\"in this._mongooseOptions?this._mongooseOptions.strict:!this.schema||!this.schema.options||this.schema.options.strict;let o,n=!1;\"omitUndefined\"in this._mongooseOptions&&(n=this._mongooseOptions.omitUndefined),\"useNestedStrict\"in this.options&&(o=this.options.useNestedStrict);let r=this.schema;const s=this._conditions;if(null!=r&&utils.hasUserDefinedProperty(s,r.options.discriminatorKey)&&\"object\"!=typeof s[r.options.discriminatorKey]&&null!=r.discriminators){const t=s[r.options.discriminatorKey],e=getDiscriminatorByValue(this.model,t);r=r.discriminators[t]||e&&e.schema||r}return castUpdate(r,t,{overwrite:e,strict:i,omitUndefined:n,useNestedStrict:o},this,this._conditions)},Query.prototype.populate=function(){if(!Array.from(arguments).some(Boolean))return this;const t=utils.populate.apply(null,arguments);if(null!=this.options){const e=this.options.readConcern,i=this.options.readPreference;for(let o=0;o<t.length;++o)null!=e&&null==get(t[o],\"options.readConcern\")&&(t[o].options=t[o].options||{},t[o].options.readConcern=e),null!=i&&null==get(t[o],\"options.readPreference\")&&(t[o].options=t[o].options||{},t[o].options.readPreference=i)}const e=this._mongooseOptions;if(null!=e.lean){const i=e.lean;for(let e=0;e<t.length;++e)null==get(t[e],\"options.lean\")&&(t[e].options=t[e].options||{},t[e].options.lean=i)}utils.isObject(e.populate)||(e.populate={});const i=e.populate;for(let e=0;e<t.length;++e){const o=t[e].path;i[o]&&i[o].populate&&t[e].populate&&(t[e].populate=i[o].populate.concat(t[e].populate)),i[t[e].path]=t[e]}return this},Query.prototype.getPopulatedPaths=function(){const t=this._mongooseOptions.populate||{},e=Object.keys(t);for(const i of Object.keys(t)){const o=t[i];Array.isArray(o.populate)&&_getPopulatedPaths(e,o.populate,i+\".\")}return e},Query.prototype.cast=function(t,e){e||(e=this._conditions),t=t||this.model;try{return cast(t.schema,e,{upsert:this.options&&this.options.upsert,strict:this.options&&\"strict\"in this.options?this.options.strict:get(t,\"schema.options.strict\",null),strictQuery:this.options&&this.options.strictQuery||get(t,\"schema.options.strictQuery\",null)},this)}catch(e){throw\"function\"==typeof e.setModel&&e.setModel(t),e}},Query.prototype._castFields=function(t){let e,i,o,n,r,s;if(t)for(i=[],s=(o=Object.keys(t)).length;s--;)t[n=o[s]].$elemMatch&&(e||(e={}),e[n]=t[n],i.push(n));if(e){try{r=this.cast(this.model,e)}catch(t){return t}for(s=i.length;s--;)t[n=i[s]]=r[n]}return t},Query.prototype._applyPaths=function(){this._fields=this._fields||{},helpers.applyPaths(this._fields,this.model.schema);let t=!0;\"selectPopulatedPaths\"in this.model.base.options&&(t=this.model.base.options.selectPopulatedPaths),\"selectPopulatedPaths\"in this.model.schema.options&&(t=this.model.schema.options.selectPopulatedPaths),t&&selectPopulatedFields(this)},Query.prototype.cursor=function(t){this._applyPaths(),this._fields=this._castFields(this._fields),this.setOptions({projection:this._fieldsForExec()}),t&&this.setOptions(t);const e=Object.assign({},this.options,{projection:this.projection()});try{this.cast(this.model)}catch(t){return new QueryCursor(this,e)._markError(t)}return new QueryCursor(this,e)},Query.prototype.maxscan=Query.base.maxScan,Query.prototype.tailable=function(t,e){if(t&&\"Object\"===t.constructor.name&&(e=t,t=!0),void 0===t&&(t=!0),e&&\"object\"==typeof e)for(const t in e)this.options[t]=\"awaitdata\"===t?!!e[t]:e[t];return Query.base.tailable.call(this,t)},Query.prototype.near=function(){const t=[],e=this._mongooseOptions.nearSphere;if(1===arguments.length)if(Array.isArray(arguments[0]))t.push({center:arguments[0],spherical:e});else if(\"string\"==typeof arguments[0])t.push(arguments[0]);else{if(!utils.isObject(arguments[0]))throw new TypeError(\"invalid argument\");\"boolean\"!=typeof arguments[0].spherical&&(arguments[0].spherical=e),t.push(arguments[0])}else if(2===arguments.length)if(\"number\"==typeof arguments[0]&&\"number\"==typeof arguments[1])t.push({center:[arguments[0],arguments[1]],spherical:e});else if(\"string\"==typeof arguments[0]&&Array.isArray(arguments[1]))t.push(arguments[0]),t.push({center:arguments[1],spherical:e});else{if(\"string\"!=typeof arguments[0]||!utils.isObject(arguments[1]))throw new TypeError(\"invalid argument\");t.push(arguments[0]),\"boolean\"!=typeof arguments[1].spherical&&(arguments[1].spherical=e),t.push(arguments[1])}else{if(3!==arguments.length)throw new TypeError(\"invalid argument\");if(\"string\"!=typeof arguments[0]||\"number\"!=typeof arguments[1]||\"number\"!=typeof arguments[2])throw new TypeError(\"invalid argument\");t.push(arguments[0]),t.push({center:[arguments[1],arguments[2]],spherical:e})}return Query.base.near.apply(this,t)},Query.prototype.nearSphere=function(){return this._mongooseOptions.nearSphere=!0,this.near.apply(this,arguments),this},null!=Symbol.asyncIterator&&(Query.prototype[Symbol.asyncIterator]=function(){return this.cursor().transformNull().map(t=>null==t?{done:!0}:{value:t,done:!1})}),Query.prototype.box=function(t,e){return!Array.isArray(t)&&utils.isObject(t)&&(e=t.ur,t=t.ll),Query.base.box.call(this,t,e)},Query.prototype.center=Query.base.circle,Query.prototype.centerSphere=function(){arguments[0]&&\"Object\"===arguments[0].constructor.name&&(arguments[0].spherical=!0),arguments[1]&&\"Object\"===arguments[1].constructor.name&&(arguments[1].spherical=!0),Query.base.circle.apply(this,arguments)},Query.prototype.selectedInclusively=function(){return isInclusive(this._fields)},Query.prototype.selectedExclusively=function(){if(!this._fields)return!1;const t=Object.keys(this._fields);if(0===t.length)return!1;for(let e=0;e<t.length;++e){const i=t[e];if(\"_id\"!==i&&(0===this._fields[i]||!1===this._fields[i]))return!0}return!1},module.exports=Query;","node_modules/mongoose/lib/model.js":"\"use strict\";const Aggregate=require(\"./aggregate\"),ChangeStream=require(\"./cursor/ChangeStream\"),Document=require(\"./document\"),DocumentNotFoundError=require(\"./error/notFound\"),DivergentArrayError=require(\"./error/divergentArray\"),EventEmitter=require(\"events\").EventEmitter,MongooseBuffer=require(\"./types/buffer\"),MongooseError=require(\"./error/index\"),OverwriteModelError=require(\"./error/overwriteModel\"),PromiseProvider=require(\"./promise_provider\"),Query=require(\"./query\"),RemoveOptions=require(\"./options/removeOptions\"),SaveOptions=require(\"./options/saveOptions\"),Schema=require(\"./schema\"),VersionError=require(\"./error/version\"),ParallelSaveError=require(\"./error/parallelSave\"),applyQueryMiddleware=require(\"./helpers/query/applyQueryMiddleware\"),applyHooks=require(\"./helpers/model/applyHooks\"),applyMethods=require(\"./helpers/model/applyMethods\"),applyStaticHooks=require(\"./helpers/model/applyStaticHooks\"),applyStatics=require(\"./helpers/model/applyStatics\"),applyWriteConcern=require(\"./helpers/schema/applyWriteConcern\"),assignVals=require(\"./helpers/populate/assignVals\"),castBulkWrite=require(\"./helpers/model/castBulkWrite\"),discriminator=require(\"./helpers/model/discriminator\"),each=require(\"./helpers/each\"),getDiscriminatorByValue=require(\"./helpers/discriminator/getDiscriminatorByValue\"),getModelsMapForPopulate=require(\"./helpers/populate/getModelsMapForPopulate\"),immediate=require(\"./helpers/immediate\"),internalToObjectOptions=require(\"./options\").internalToObjectOptions,isPathSelectedInclusive=require(\"./helpers/projection/isPathSelectedInclusive\"),get=require(\"./helpers/get\"),leanPopulateMap=require(\"./helpers/populate/leanPopulateMap\"),modifiedPaths=require(\"./helpers/update/modifiedPaths\"),parallelLimit=require(\"./helpers/parallelLimit\"),util=require(\"util\"),utils=require(\"./utils\"),VERSION_WHERE=1,VERSION_INC=2,VERSION_ALL=VERSION_WHERE|VERSION_INC,arrayAtomicsSymbol=require(\"./helpers/symbols\").arrayAtomicsSymbol,modelCollectionSymbol=Symbol(\"mongoose#Model#collection\"),modelDbSymbol=Symbol(\"mongoose#Model#db\"),modelSymbol=require(\"./helpers/symbols\").modelSymbol,subclassedSymbol=Symbol(\"mongoose#Model#subclassed\"),saveToObjectOptions=Object.assign({},internalToObjectOptions,{bson:!0});function Model(e,t,o){if(t instanceof Schema)throw new TypeError(\"2nd argument to `Model` must be a POJO or string, **not** a schema. Make sure you're calling `mongoose.model()`, not `mongoose.Model()`.\");Document.call(this,e,t,o)}function _applyCustomWhere(e,t){if(null==e.$where)return;const o=Object.keys(e.$where),n=o.length;for(let i=0;i<n;++i)t[o[i]]=e.$where[o[i]]}function generateVersionError(e,t){const o=e.schema.options.versionKey;if(!o)return null;const n=e.$__getValue(o)||0;return new VersionError(e,n,t)}function shouldSkipVersioning(e,t){const o=e.schema.options.skipVersioning;return!!o&&o[t=t.replace(/\\.\\d+\\./,\".\")]}function operand(e,t,o,n,i,s){if(s||(s=\"$set\"),o[s]||(o[s]={}),o[s][n.path]=i,!1!==e.schema.options.versionKey&&!shouldSkipVersioning(e,n.path)&&VERSION_ALL!==(VERSION_ALL&e.$__.version)){switch(s){case\"$set\":case\"$unset\":case\"$pop\":case\"$pull\":case\"$pullAll\":case\"$push\":case\"$addToSet\":break;default:return}\"$push\"===s||\"$addToSet\"===s||\"$pullAll\"===s||\"$pull\"===s?e.$__.version=VERSION_INC:/^\\$p/.test(s)?e.increment():Array.isArray(i)?e.increment():/\\.\\d+\\.|\\.\\d+$/.test(n.path)&&(e.$__.version=VERSION_WHERE)}}function handleAtomics(e,t,o,n,i){if(o.$set&&o.$set[n.path])return;if(\"function\"==typeof i.$__getAtomics)return void i.$__getAtomics().forEach(function(i){const s=i[0],r=i[1];operand(e,t,o,n,r,s)});const s=i[arrayAtomicsSymbol],r=Object.keys(s);let l,c,a=r.length;if(0===a)return utils.isMongooseObject(i)?i=i.toObject({depopulate:1,_isNested:!0}):i.valueOf&&(i=i.valueOf()),operand(e,t,o,n,i);function u(e){return utils.isMongooseObject(e)?e.toObject({depopulate:1,_isNested:!0}):e}for(;a--;)l=s[c=r[a]],utils.isMongooseObject(l)?l=l.toObject({depopulate:!0,transform:!1,_isNested:!0}):Array.isArray(l)?l=l.map(u):l.valueOf&&(l=l.valueOf()),\"$addToSet\"===c&&(l={$each:l}),operand(e,t,o,n,l,c)}function checkDivergentArray(e,t,o){const n=e.populated(t,!0);if(!n&&e.$__.selected){const o=t.split(\".\")[0];if(e.$__.selected[o+\".$\"])return o}if(n&&o&&o.isMongooseArray&&(n.options.match||n.options.options&&utils.object.hasOwnProperty(n.options.options,\"limit\")||n.options.options&&n.options.options.skip||n.options.select&&(0===n.options.select._id||/\\s?-_id\\s?/.test(n.options.select)))){const e=o[arrayAtomicsSymbol];if(0===Object.keys(e).length||e.$set||e.$pop)return t}}function _checkContext(e,t){if(null==e||e===global)throw new MongooseError(\"`Model.\"+t+\"()` cannot run without a model as `this`. Make sure you are calling `MyModel.\"+t+\"()` where `MyModel` is a Mongoose model.\");if(null==e[modelSymbol])throw new MongooseError(\"`Model.\"+t+\"()` cannot run without a model as `this`. Make sure you are not calling `new Model.\"+t+\"()`\")}Model.prototype.__proto__=Document.prototype,Model.prototype.$isMongooseModelPrototype=!0,Model.prototype.db,Model.prototype.collection,Model.prototype.modelName,Model.prototype.$where,Model.prototype.baseModelName,Model.events,Model._middleware,Model.prototype.$__handleSave=function(e,t){const o=this;let n={};\"safe\"in e&&_handleSafe(e),applyWriteConcern(this.schema,e),\"w\"in e&&(n.w=e.w),\"j\"in e&&(n.j=e.j),\"wtimeout\"in e&&(n.wtimeout=e.wtimeout),\"checkKeys\"in e&&(n.checkKeys=e.checkKeys);const i=this.$session();if(n.hasOwnProperty(\"session\")||(n.session=i),0===Object.keys(n).length&&(n=null),this.isNew){const e=this.toObject(saveToObjectOptions);if(void 0===(e||{})._id)return void setTimeout(function(){t(new MongooseError(\"document must have an _id before saving\"))},0);this.$__version(!0,e),this[modelCollectionSymbol].insertOne(e,n,function(e,n){if(e)return _setIsNew(o,!0),void t(e,null);t(null,n)}),this.$__reset(),_setIsNew(this,!1),this.$__.inserting=!0}else{this.$__.inserting=!1;const e=this.$__delta();if(!e)return this.$__reset(),void t();{if(e instanceof MongooseError)return void t(e);const o=this.$__where(e[0]);if(o instanceof MongooseError)return void t(o);_applyCustomWhere(this,o),this[modelCollectionSymbol].updateOne(o,e[1],n,function(e,n){e?t(e):(n.$where=o,t(null,n))})}_setIsNew(this,!1)}},Model.prototype.$__save=function(e,t){this.$__handleSave(e,(o,n)=>{const i=this.schema.s.hooks;if(o)return i.execPost(\"save:error\",this,[this],{error:o},e=>{t(e,this)});const s=this.modifiedPaths();this.$__reset();let r=0;if(0!==get(e,\"safe.w\")&&0!==get(e,\"w\")){if(n&&(r=Array.isArray(n)?n.length:n.result&&void 0!==n.result.n?n.result.n:n.result&&void 0!==n.result.nModified?n.result.nModified:n),this.$__.version&&!this.$__.inserting){const e=VERSION_INC===(VERSION_INC&this.$__.version);this.$__.version=void 0;const o=this.schema.options.versionKey,n=this.$__getValue(o)||0;if(r<=0){const e=this.$__.$versionError||new VersionError(this,n,s);return t(e)}e&&this.$__setValue(o,n+1)}if(null!=n&&r<=0)return o=new DocumentNotFoundError(n.$where,this.constructor.modelName,r,n),i.execPost(\"save:error\",this,[this],{error:o},e=>{t(e,this)})}this.$__.saving=void 0,this.emit(\"save\",this,r),this.constructor.emit(\"save\",this,r),t(null,this)})},Model.prototype.save=function(e,t){let o;return this.$__.saving?o=new ParallelSaveError(this):this.$__.saving=new ParallelSaveError(this),\"function\"==typeof e&&(t=e,e=void 0),(e=new SaveOptions(e)).hasOwnProperty(\"session\")&&this.$session(e.session),this.$__.$versionError=generateVersionError(this,this.modifiedPaths()),t=this.constructor.$handleCallbackError(t),utils.promiseOrCallback(t,this.constructor.$wrapCallback(t=>{if(o)return this.$__handleReject(o),t(o);this.$__.saveOptions=e,this.$__save(e,e=>{if(this.$__.saving=void 0,delete this.$__.saveOptions,delete this.$__.$versionError,e)return this.$__handleReject(e),t(e);t(null,this)})}),this.constructor.events)},Model.prototype.$__delta=function(){const e=this.$__dirty();if(!e.length&&VERSION_ALL!==this.$__.version)return;const t={},o={},n=e.length,i=[];let s=0;for(t._id=this._doc._id,null!=get(t,\"_id.$__\",null)&&(t._id=t._id.toObject({transform:!1,depopulate:!0}));s<n;++s){const n=e[s];let r=n.value;const l=checkDivergentArray(this,n.path,r);if(l)i.push(l);else{if(!this.populated(n.path,!0)&&this.$__.selected){const e=n.path.split(\".\"),o=e[0];if(this.$__.selected[o]&&this.$__.selected[o].$elemMatch){if(!(e.length>1&&0==e[1]&&void 0===t[o])){i.push(n.path);continue}t[o]=this.$__.selected[o],e[1]=\"$\",n.path=e.join(\".\")}}i.length||(void 0===r?operand(this,t,o,n,1,\"$unset\"):null===r?operand(this,t,o,n,null):r.isMongooseArray&&r.$path()&&r[arrayAtomicsSymbol]?handleAtomics(this,t,o,n,r):r[MongooseBuffer.pathSymbol]&&Buffer.isBuffer(r)?operand(this,t,o,n,r=r.toObject()):operand(this,t,o,n,r=utils.clone(r,{depopulate:!0,transform:!1,virtuals:!1,getters:!1,_isNested:!0})))}}return i.length?new DivergentArrayError(i):(this.$__.version&&this.$__version(t,o),[t,o])},Model.prototype.$__version=function(e,t){const o=this.schema.options.versionKey;if(!0!==e){if(this.isSelected(o)){if(VERSION_WHERE===(VERSION_WHERE&this.$__.version)){const t=this.$__getValue(o);null!=t&&(e[o]=t)}VERSION_INC===(VERSION_INC&this.$__.version)&&(null!=get(t.$set,o,null)?++t.$set[o]:(t.$inc=t.$inc||{},t.$inc[o]=1))}}else o&&this.$__setValue(o,t[o]=0)},Model.prototype.increment=function(){return this.$__.version=VERSION_ALL,this},Model.prototype.$__where=function(e){return e||(e={}),e._id||(e._id=this._doc._id),void 0===this._doc._id?new MongooseError(\"No _id found on document!\"):e},Model.prototype.remove=function(e,t){return\"function\"==typeof e&&(t=e,e=void 0),(e=new RemoveOptions(e)).hasOwnProperty(\"session\")&&this.$session(e.session),t=this.constructor.$handleCallbackError(t),utils.promiseOrCallback(t,this.constructor.$wrapCallback(t=>{this.$__remove(e,t)}),this.constructor.events)},Model.prototype.delete=Model.prototype.remove,Model.prototype.deleteOne=function(e,t){return\"function\"==typeof e&&(t=e,e=void 0),e||(e={}),t=this.constructor.$handleCallbackError(t),utils.promiseOrCallback(t,this.constructor.$wrapCallback(t=>{this.$__deleteOne(e,t)}),this.constructor.events)},Model.prototype.$__remove=function(e,t){if(this.$__.isDeleted)return immediate(()=>t(null,this));const o=this.$__where();if(o instanceof MongooseError)return t(o);_applyCustomWhere(this,o);const n=this.$session();e.hasOwnProperty(\"session\")||(e.session=n),this[modelCollectionSymbol].deleteOne(o,e,e=>{if(!e)return this.$__.isDeleted=!0,this.emit(\"remove\",this),this.constructor.emit(\"remove\",this),t(null,this);this.$__.isDeleted=!1,t(e)})},Model.prototype.$__deleteOne=Model.prototype.$__remove,Model.prototype.model=function(e){return this[modelDbSymbol].model(e)},Model.exists=function(e,t,o){_checkContext(this,\"exists\"),\"function\"==typeof t&&(o=t,t=null);const n=this.findOne(e).select({_id:1}).lean().setOptions(t);if(\"function\"!=typeof o)return n.then(e=>!!e);n.exec(function(e,t){if(null!=e)return o(e);o(null,!!t)})},Model.discriminator=function(e,t,o){let n;if(\"function\"==typeof e&&(n=e,e=utils.getFunctionName(n),!(n.prototype instanceof Model)))throw new MongooseError(\"The provided class \"+e+\" must extend Model\");if(_checkContext(this,\"discriminator\"),t=discriminator(this,e,t,o,!0),this.db.models[e])throw new OverwriteModelError(e);t.$isRootDiscriminator=!0,t.$globalPluginsApplied=!0,n=this.db.model(n||e,t,this.collection.name),this.discriminators[e]=n;const i=this.discriminators[e];if(i.prototype.__proto__=this.prototype,Object.defineProperty(i,\"baseModelName\",{value:this.modelName,configurable:!0,writable:!1}),applyMethods(i,t),applyStatics(i,t),null!=this[subclassedSymbol])for(const o of this[subclassedSymbol])o.discriminators=o.discriminators||{},o.discriminators[e]=n.__subclass(n.db,t,o.collection.name);return i};for(const e in EventEmitter.prototype)Model[e]=EventEmitter.prototype[e];function isIndexEqual(e,t,o){const n=t[0],i=_decorateDiscriminatorIndexOptions(e,utils.clone(t[1])),s=[\"unique\",\"partialFilterExpression\",\"sparse\",\"expireAfterSeconds\"];for(const e of s)if((e in i||e in o)&&!utils.deepEqual(i[e],o[e]))return!1;const r=Object.keys(n),l=Object.keys(o.key);if(r.length!==l.length)return!1;for(let e=0;e<r.length;++e){if(r[e]!==l[e])return!1;if(!utils.deepEqual(n[r[e]],o.key[l[e]]))return!1}return!0}function _ensureIndexes(e,t,o){const n=e.schema.indexes();t=t||{};const i=function(t){t&&!e.$caught&&e.emit(\"error\",t),e.emit(\"index\",t),o&&o(t)};for(const t of n){const o=Object.keys(t[0]);1===o.length&&\"_id\"===o[0]&&\"hashed\"!==t[0]._id&&console.warn('mongoose: Cannot specify a custom index on `_id` for model name \"'+e.modelName+'\", MongoDB does not allow overwriting the default `_id` index. See http://bit.ly/mongodb-id-index')}if(!n.length)return void immediate(function(){i()});const s=e.schema._baseSchema,r=s?s.indexes():[],l=function(){if(t._automatic&&(!1===e.schema.options.autoIndex||null==e.schema.options.autoIndex&&!1===e.db.config.autoIndex))return i();const o=n.shift();if(!o)return i();if(r.find(e=>utils.deepEqual(e,o)))return l();const s=utils.clone(o[0]),c=utils.clone(o[1]);_decorateDiscriminatorIndexOptions(e,c),\"safe\"in t&&_handleSafe(t),applyWriteConcern(e.schema,c),function(t,o){e.emit(\"index-single-start\",t,o)}(s,t);let a=!!e.base.options.useCreateIndex;\"useCreateIndex\"in e.db.config&&(a=!!e.db.config.useCreateIndex),\"createIndex\"in t&&(a=!!t.createIndex);const u=a?\"createIndex\":\"ensureIndex\";e.collection[u](s,c,utils.tick(function(t,o){if(function(t,o,n,i){e.emit(\"index-single-done\",t,o,n,i)}(t,s,c,o),t)return i(t);l()}))};immediate(function(){t._automatic&&!e.collection.collection?e.collection.addQueue(l,[]):l()})}function _decorateDiscriminatorIndexOptions(e,t){if(null!=e.baseModelName&&t.unique&&!(\"partialFilterExpression\"in t)&&!(\"sparse\"in t)){const o=e.schema.discriminatorMapping&&e.schema.discriminatorMapping.value||e.modelName;t.partialFilterExpression={[e.schema.options.discriminatorKey]:o}}return t}Model.init=function(e){if(_checkContext(this,\"init\"),this.schema.emit(\"init\",this),null!=this.$init)return e?(this.$init.then(()=>e(),t=>e(t)),null):this.$init;const t=PromiseProvider.get(),o=utils.getOption(\"autoIndex\",this.schema.options,this.db.config,this.db.base.options),n=null==this.schema.options.autoCreate?this.db.config.autoCreate:this.schema.options.autoCreate,i=o?e=>this.ensureIndexes({_automatic:!0},e):e=>e(),s=n?e=>this.createCollection({},e):e=>e();if(this.$init=new t((e,t)=>{s(o=>{if(o)return t(o);i(o=>{if(o)return t(o);e(this)})})}),e)return this.$init.then(()=>e(),t=>e(t)),this.$caught=!0,null;{const e=this.$init.catch,t=this;this.$init.catch=function(){return this.$caught=!0,e.apply(t.$init,arguments)}}return this.$init},Model.createCollection=function(e,t){if(_checkContext(this,\"createCollection\"),\"string\"==typeof e)throw new MongooseError(\"You can't specify a new collection name in Model.createCollection.This is not like Connection.createCollection. Only options are accepted here.\");\"function\"==typeof e&&(t=e,e=null);const o=get(this,\"schema.options.collation\",null);return null!=o&&(e=Object.assign({collation:o},e)),t=this.$handleCallbackError(t),utils.promiseOrCallback(t,this.$wrapCallback(t=>{this.db.createCollection(this.collection.collectionName,e,utils.tick(o=>{if(o)return t(o);this.collection=this.db.collection(this.collection.collectionName,e),t(null,this.collection)}))}),this.events)},Model.syncIndexes=function(e,t){_checkContext(this,\"syncIndexes\");const o=e=>{this.listIndexes((t,o)=>{if(null!=t)return e(t);const i=this.schema.indexes(),s=[];for(const e of o){let t=!1;if(!e.key._id){for(const o of i)isIndexEqual(this,o,e)&&(t=!0);t||s.push(e.name)}}if(0===s.length)return e(null,[]);n(s,e)})},n=(e,t)=>{let o=e.length,n=!1;e.forEach(i=>{this.collection.dropIndex(i,i=>{if(null!=i)return n=!0,t(i);n||--o||t(null,e)})})};return t=this.$handleCallbackError(t),utils.promiseOrCallback(t,this.$wrapCallback(t=>{this.createCollection(n=>{if(n)return t(n);o((o,n)=>{if(null!=o)return t(o);this.createIndexes(e,e=>{if(null!=e)return t(e);t(null,n)})})})}),this.events)},Model.listIndexes=function(e){_checkContext(this,\"listIndexes\");const t=e=>{this.collection.listIndexes().toArray(e)};return e=this.$handleCallbackError(e),utils.promiseOrCallback(e,this.$wrapCallback(e=>{this.collection.buffer?this.collection.addQueue(t,[e]):t(e)}),this.events)},Model.ensureIndexes=function(e,t){return _checkContext(this,\"ensureIndexes\"),\"function\"==typeof e&&(t=e,e=null),t=this.$handleCallbackError(t),utils.promiseOrCallback(t,this.$wrapCallback(t=>{_ensureIndexes(this,e||{},e=>{if(e)return t(e);t(null)})}),this.events)},Model.createIndexes=function(e,t){return _checkContext(this,\"createIndexes\"),\"function\"==typeof e&&(t=e,e={}),(e=e||{}).createIndex=!0,this.ensureIndexes(e,t)};const safeDeprecationWarning=\"Mongoose: the `safe` option for `save()` is deprecated. Use the `w` option instead: http://bit.ly/mongoose-save\",_handleSafe=util.deprecate(function(e){e.safe&&(\"boolean\"==typeof e.safe&&(e.w=e.safe,delete e.safe),\"object\"==typeof e.safe&&(e.w=e.safe.w,e.j=e.safe.j,e.wtimeout=e.safe.wtimeout,delete e.safe))},safeDeprecationWarning);function _decorateUpdateWithVersionKey(e,t,o){if(!o||!get(t,\"upsert\",!1))return;modifiedPaths(e)[o]||(t.overwrite?e[o]=0:(e.$setOnInsert||(e.$setOnInsert={}),e.$setOnInsert[o]=0))}function _setIsNew(e,t){e.isNew=t,e.emit(\"isNew\",t),e.constructor.emit(\"isNew\",t);const o=e.$__getAllSubdocs();for(const e of o)e.isNew=t}function _update(e,t,o,n,i,s){const r=new e.Query({},{},e,e.collection);return s=e.$handleCallbackError(s),o=o instanceof Document?o.toObject():utils.clone(o),_decorateUpdateWithVersionKey(n,i=\"function\"==typeof i?i:utils.clone(i),get(e,\"schema.options.versionKey\",null)),r[t](o,n,i,s)}function _populate(e,t,o,n,i){const s=o.length;let r=o.length;if(0===s)return i(null,t);for(let n=0;n<s;++n)populate(e,t,o[n],l);function l(e){if(e)return i(e,null);--r||i(null,t)}}Model.schema,Model.db,Model.collection,Model.base,Model.discriminators,Model.translateAliases=function(e){_checkContext(this,\"translateAliases\");const t=(t,o)=>{let n;const i=[],s=t.split(\".\");let r=this.schema;for(const e in s){const t=s[e];r&&r.aliases[t]?(n=r.aliases[t],i.push(n)):i.push(t),r=r&&r.paths[n]?r.paths[n].schema:null}const l=i.join(\".\");return e instanceof Map?e.set(l,o):e[l]=o,l!==t&&(e instanceof Map?e.delete(t):delete e[t]),e};if(\"object\"==typeof e){if(e instanceof Map)for(const o of new Map(e))e=t(o[0],o[1]);else for(const o of Object.keys(e))if(e=t(o,e[o]),\"$\"===o[0]&&Array.isArray(e[o]))for(const t in e[o])e[o][t]=this.translateAliases(e[o][t]);return e}return e},Model.remove=function(e,t,o){_checkContext(this,\"remove\"),\"function\"==typeof e?(o=e,e={},t=null):\"function\"==typeof t&&(o=t,t=null);const n=new this.Query({},{},this,this.collection);return n.setOptions(t),o=this.$handleCallbackError(o),n.remove(e,o)},Model.deleteOne=function(e,t,o){_checkContext(this,\"deleteOne\"),\"function\"==typeof e?(o=e,e={},t=null):\"function\"==typeof t&&(o=t,t=null);const n=new this.Query(e,{},this,this.collection);return n.setOptions(t),o=this.$handleCallbackError(o),n.deleteOne(o)},Model.deleteMany=function(e,t,o){_checkContext(this,\"deleteMany\"),\"function\"==typeof e?(o=e,e={},t=null):\"function\"==typeof t&&(o=t,t=null);const n=new this.Query(e,{},this,this.collection);return n.setOptions(t),o=this.$handleCallbackError(o),n.deleteMany(o)},Model.find=function(e,t,o,n){_checkContext(this,\"find\"),\"function\"==typeof e?(n=e,e={},t=null,o=null):\"function\"==typeof t?(n=t,t=null,o=null):\"function\"==typeof o&&(n=o,o=null);const i=new this.Query({},{},this,this.collection);return i.select(t),i.setOptions(o),this.schema.discriminatorMapping&&this.schema.discriminatorMapping.isRoot&&i.selectedInclusively()&&i.select(this.schema.options.discriminatorKey),n=this.$handleCallbackError(n),i.find(e,n)},Model.findById=function(e,t,o,n){return _checkContext(this,\"findById\"),void 0===e&&(e=null),n=this.$handleCallbackError(n),this.findOne({_id:e},t,o,n)},Model.findOne=function(e,t,o,n){_checkContext(this,\"findOne\"),\"function\"==typeof o?(n=o,o=null):\"function\"==typeof t?(n=t,t=null,o=null):\"function\"==typeof e&&(n=e,e={},t=null,o=null);const i=new this.Query({},{},this,this.collection);return i.select(t),i.setOptions(o),this.schema.discriminatorMapping&&this.schema.discriminatorMapping.isRoot&&i.selectedInclusively()&&i.select(this.schema.options.discriminatorKey),n=this.$handleCallbackError(n),i.findOne(e,n)},Model.estimatedDocumentCount=function(e,t){_checkContext(this,\"estimatedDocumentCount\");const o=new this.Query({},{},this,this.collection);return t=this.$handleCallbackError(t),o.estimatedDocumentCount(e,t)},Model.countDocuments=function(e,t){_checkContext(this,\"countDocuments\"),\"function\"==typeof e&&(t=e,e={});const o=new this.Query({},{},this,this.collection);return t=this.$handleCallbackError(t),o.countDocuments(e,t)},Model.count=function(e,t){_checkContext(this,\"count\"),\"function\"==typeof e&&(t=e,e={});const o=new this.Query({},{},this,this.collection);return t=this.$handleCallbackError(t),o.count(e,t)},Model.distinct=function(e,t,o){_checkContext(this,\"distinct\");const n=new this.Query({},{},this,this.collection);return\"function\"==typeof t&&(o=t,t={}),o=this.$handleCallbackError(o),n.distinct(e,t,o)},Model.where=function(e,t){_checkContext(this,\"where\");const o=new this.Query({},{},this,this.collection).find({});return o.where.apply(o,arguments)},Model.$where=function(){_checkContext(this,\"$where\");const e=new this.Query({},{},this,this.collection).find({});return e.$where.apply(e,arguments)},Model.findOneAndUpdate=function(e,t,o,n){if(_checkContext(this,\"findOneAndUpdate\"),\"function\"==typeof o)n=o,o=null;else if(1===arguments.length){if(\"function\"==typeof e){const e=\"Model.findOneAndUpdate(): First argument must not be a function.\\n\\n  \"+this.modelName+\".findOneAndUpdate(conditions, update, options, callback)\\n  \"+this.modelName+\".findOneAndUpdate(conditions, update, options)\\n  \"+this.modelName+\".findOneAndUpdate(conditions, update)\\n  \"+this.modelName+\".findOneAndUpdate(update)\\n  \"+this.modelName+\".findOneAndUpdate()\\n\";throw new TypeError(e)}t=e,e=void 0}let i;n=this.$handleCallbackError(n),o&&(i=o.fields||o.projection),_decorateUpdateWithVersionKey(t=utils.clone(t,{depopulate:!0,_isNested:!0}),o,this.schema.options.versionKey);const s=new this.Query({},{},this,this.collection);return s.select(i),s.findOneAndUpdate(e,t,o,n)},Model.findByIdAndUpdate=function(e,t,o,n){if(_checkContext(this,\"findByIdAndUpdate\"),n=this.$handleCallbackError(n),1===arguments.length){if(\"function\"==typeof e){const e=\"Model.findByIdAndUpdate(): First argument must not be a function.\\n\\n  \"+this.modelName+\".findByIdAndUpdate(id, callback)\\n  \"+this.modelName+\".findByIdAndUpdate(id)\\n  \"+this.modelName+\".findByIdAndUpdate()\\n\";throw new TypeError(e)}return this.findOneAndUpdate({_id:e},void 0)}return e instanceof Document&&(e=e._id),this.findOneAndUpdate.call(this,{_id:e},t,o,n)},Model.findOneAndDelete=function(e,t,o){if(_checkContext(this,\"findOneAndDelete\"),1===arguments.length&&\"function\"==typeof e){const e=\"Model.findOneAndDelete(): First argument must not be a function.\\n\\n  \"+this.modelName+\".findOneAndDelete(conditions, callback)\\n  \"+this.modelName+\".findOneAndDelete(conditions)\\n  \"+this.modelName+\".findOneAndDelete()\\n\";throw new TypeError(e)}let n;\"function\"==typeof t&&(o=t,t=void 0),o=this.$handleCallbackError(o),t&&(n=t.select,t.select=void 0);const i=new this.Query({},{},this,this.collection);return i.select(n),i.findOneAndDelete(e,t,o)},Model.findByIdAndDelete=function(e,t,o){if(_checkContext(this,\"findByIdAndDelete\"),1===arguments.length&&\"function\"==typeof e){const e=\"Model.findByIdAndDelete(): First argument must not be a function.\\n\\n  \"+this.modelName+\".findByIdAndDelete(id, callback)\\n  \"+this.modelName+\".findByIdAndDelete(id)\\n  \"+this.modelName+\".findByIdAndDelete()\\n\";throw new TypeError(e)}return o=this.$handleCallbackError(o),this.findOneAndDelete({_id:e},t,o)},Model.findOneAndReplace=function(e,t,o,n){if(_checkContext(this,\"findOneAndReplace\"),1===arguments.length&&\"function\"==typeof e){const e=\"Model.findOneAndReplace(): First argument must not be a function.\\n\\n  \"+this.modelName+\".findOneAndReplace(conditions, callback)\\n  \"+this.modelName+\".findOneAndReplace(conditions)\\n  \"+this.modelName+\".findOneAndReplace()\\n\";throw new TypeError(e)}let i;3===arguments.length&&\"function\"==typeof o&&(n=o,o=t,t=void 0),2===arguments.length&&\"function\"==typeof t&&(n=t,t=void 0,o=void 0),n=this.$handleCallbackError(n),o&&(i=o.select,o.select=void 0);const s=new this.Query({},{},this,this.collection);return s.select(i),s.findOneAndReplace(e,t,o,n)},Model.findOneAndRemove=function(e,t,o){if(_checkContext(this,\"findOneAndRemove\"),1===arguments.length&&\"function\"==typeof e){const e=\"Model.findOneAndRemove(): First argument must not be a function.\\n\\n  \"+this.modelName+\".findOneAndRemove(conditions, callback)\\n  \"+this.modelName+\".findOneAndRemove(conditions)\\n  \"+this.modelName+\".findOneAndRemove()\\n\";throw new TypeError(e)}let n;\"function\"==typeof t&&(o=t,t=void 0),o=this.$handleCallbackError(o),t&&(n=t.select,t.select=void 0);const i=new this.Query({},{},this,this.collection);return i.select(n),i.findOneAndRemove(e,t,o)},Model.findByIdAndRemove=function(e,t,o){if(_checkContext(this,\"findByIdAndRemove\"),1===arguments.length&&\"function\"==typeof e){const e=\"Model.findByIdAndRemove(): First argument must not be a function.\\n\\n  \"+this.modelName+\".findByIdAndRemove(id, callback)\\n  \"+this.modelName+\".findByIdAndRemove(id)\\n  \"+this.modelName+\".findByIdAndRemove()\\n\";throw new TypeError(e)}return o=this.$handleCallbackError(o),this.findOneAndRemove({_id:e},t,o)},Model.create=function(e,t,o){let n,i;_checkContext(this,\"create\");const s=this.schema.options.discriminatorKey;if(Array.isArray(e))n=e,i=\"function\"==typeof t?t:o,t=null!=t&&\"object\"==typeof t?t:{};else{const e=arguments[arguments.length-1];t={},\"function\"!=typeof e&&e?n=utils.args(arguments):(i=e,n=utils.args(arguments,0,arguments.length-1)),2!==n.length||null==n[0]||null==n[1]||null!=n[0].session||null==e.session||\"ClientSession\"!==e.session.constructor.name||this.schema.path(\"session\")||console.warn(\"WARNING: to pass a `session` to `Model.create()` in Mongoose, you **must** pass an array as the first argument. See: https://mongoosejs.com/docs/api.html#model_Model.create\")}return utils.promiseOrCallback(i,this.$wrapCallback(o=>{if(0===n.length)return o(null);const i=[];let r;n.forEach(e=>{i.push(o=>{const n=this.discriminators&&null!=e[s]?this.discriminators[e[s]]||getDiscriminatorByValue(this,e[s]):this;if(null==n)throw new MongooseError(`Discriminator \"${e[s]}\" not `+`found for model \"${this.modelName}\"`);let i=e;const l=(e,t)=>{if(e)return r||(r=e),o(null,{error:e});o(null,{doc:t})};if(!(i instanceof n))try{i=new n(i)}catch(e){return l(e)}i.save(t,l)})});let l=i.length;if(0===l)return o(null,[]);const c=(t,n)=>{const i=[],s=n.length;for(let e=0;e<s;++e)n[e].doc&&i.push(n[e].doc);if(r)return o(r,i);e instanceof Array?o(null,i):o.apply(this,[null].concat(i))},a=[];i.forEach((e,t)=>{e((e,o)=>{if(a[t]=o,--l<=0)return c(0,a)})})}),this.events)},Model.watch=function(e,t){return _checkContext(this,\"watch\"),new ChangeStream(this,e,t)},Model.startSession=function(){return _checkContext(this,\"startSession\"),this.db.startSession.apply(this.db,arguments)},Model.insertMany=function(e,t,o){return _checkContext(this,\"insertMany\"),\"function\"==typeof t&&(o=t,t=null),utils.promiseOrCallback(o,o=>{this.$__insertMany(e,t,o)},this.events)},Model.$__insertMany=function(e,t,o){const n=this;\"function\"==typeof t&&(o=t,t=null),o&&(o=this.$handleCallbackError(o),o=this.$wrapCallback(o)),o=o||utils.noop;const i=get(t=t||{},\"limit\",1e3),s=get(t,\"rawResult\",!1),r=get(t,\"ordered\",!0);Array.isArray(e)||(e=[e]);const l=[],c=[];e.forEach(function(e){l.push(function(o){e instanceof n||(e=new n(e)),null!=t.session&&e.$session(t.session),e.validate({__noPromise:!0},function(t){if(t)return!1===r?(c.push(t),o(null,null)):o(t);o(null,e)})})}),parallelLimit(l,i,function(e,i){if(e)return void o(e,null);const l=i.filter(function(e){return null!=e});if(l.length<1)return void o(null,[]);const a=l.map(function(e){return e.schema.options.versionKey&&(e[e.schema.options.versionKey]=0),e.initializeTimestamps?e.initializeTimestamps().toObject(internalToObjectOptions):e.toObject(internalToObjectOptions)});n.collection.insertMany(a,t,function(e,t){if(e)o(e,null);else{for(let e=0;e<l.length;++e)l[e].$__reset(),_setIsNew(l[e],!1);if(s)return!1===r&&(t.mongoose={validationErrors:c}),o(null,t);o(null,l)}})})},Model.bulkWrite=function(e,t,o){_checkContext(this,\"bulkWrite\"),\"function\"==typeof t&&(o=t,t=null),t=t||{};const n=e.map(e=>castBulkWrite(this,e,t));return o=this.$handleCallbackError(o),utils.promiseOrCallback(o,this.$wrapCallback(o=>{each(n,(e,t)=>e(t),n=>{if(n)return o(n);this.collection.bulkWrite(e,t,(e,t)=>{if(e)return o(e);o(null,t)})})}),this.events)},Model.hydrate=function(e){_checkContext(this,\"hydrate\");const t=require(\"./queryhelpers\").createModel(this,e);return t.init(e),t},Model.update=function(e,t,o,n){return _checkContext(this,\"update\"),_update(this,\"update\",e,t,o,n)},Model.updateMany=function(e,t,o,n){return _checkContext(this,\"updateMany\"),_update(this,\"updateMany\",e,t,o,n)},Model.updateOne=function(e,t,o,n){return _checkContext(this,\"updateOne\"),_update(this,\"updateOne\",e,t,o,n)},Model.replaceOne=function(e,t,o,n){_checkContext(this,\"replaceOne\");const i=get(this,\"schema.options.versionKey\",null);return i&&!t[i]&&(t[i]=0),_update(this,\"replaceOne\",e,t,o,n)},Model.mapReduce=function(e,t){return _checkContext(this,\"mapReduce\"),t=this.$handleCallbackError(t),utils.promiseOrCallback(t,this.$wrapCallback(t=>{if(!Model.mapReduce.schema){const e={noId:!0,noVirtualId:!0,strict:!1};Model.mapReduce.schema=new Schema({},e)}if(e.out||(e.out={inline:1}),!1!==e.verbose&&(e.verbose=!0),e.map=String(e.map),e.reduce=String(e.reduce),e.query){let t=new this.Query(e.query);t.cast(this),e.query=t._conditions,t=void 0}this.collection.mapReduce(null,null,e,(e,o)=>{if(e)return t(e);if(o.collection){const e=Model.compile(\"_mapreduce_\"+o.collection.collectionName,Model.mapReduce.schema,o.collection.collectionName,this.db,this.base);return e._mapreduce=!0,o.model=e,t(null,o)}t(null,o)})}),this.events)},Model.aggregate=function(e,t){if(_checkContext(this,\"aggregate\"),arguments.length>2||\"Object\"===get(e,\"constructor.name\"))throw new MongooseError(\"Mongoose 5.x disallows passing a spread of operators to `Model.aggregate()`. Instead of `Model.aggregate({ $match }, { $skip })`, do `Model.aggregate([{ $match }, { $skip }])`\");\"function\"==typeof e&&(t=e,e=[]);const o=new Aggregate(e||[]);return o.model(this),void 0===t?o:(t=this.$handleCallbackError(t),t=this.$wrapCallback(t),o.exec(t),o)},Model.geoSearch=function(e,t,o){return _checkContext(this,\"geoSearch\"),\"function\"==typeof t&&(o=t,t={}),o=this.$handleCallbackError(o),utils.promiseOrCallback(o,this.$wrapCallback(o=>{let n;if(void 0!==e&&utils.isObject(e)?t.near?Array.isArray(t.near)||(n=new MongooseError(\"near option must be an array [x, y]\")):n=new MongooseError(\"Must specify the near option in geoSearch\"):n=new MongooseError(\"Must pass conditions to geoSearch\"),n)return o(n);t.search=e,this.collection.geoHaystackSearch(t.near[0],t.near[1],t,(e,n)=>{if(e)return o(e);let i=n.results.length;if(t.lean||0===i)return o(null,n.results);const s=!1;function r(e){if(e&&!s)return o(e);--i||s||o(null,n.results)}for(let e=0;e<n.results.length;++e){const t=n.results[e];n.results[e]=new this,n.results[e].init(t,{},r)}})}),this.events)},Model.populate=function(e,t,o){_checkContext(this,\"populate\");const n=this;t=utils.populate(t);const i={};return o=this.$handleCallbackError(o),utils.promiseOrCallback(o,this.$wrapCallback(o=>{_populate(n,e,t,i,o)}),this.events)};const excludeIdReg=/\\s?-_id\\s?/,excludeIdRegGlobal=/\\s?-_id\\s?/g;function populate(e,t,o,n){if(Array.isArray(t)||(t=[t]),0===t.length||t.every(utils.isNullOrUndefined))return n();const i=getModelsMapForPopulate(e,t,o);if(i instanceof MongooseError)return immediate(function(){n(i)});const s=i.length;let r=[];function l(e){return void 0!==e}let c=s,a=!1;const u=[];for(let t=0;t<s;++t){const o=i[t];let n=o.options.select;const s=_formatMatch(o.match);let r=utils.array.flatten(o.ids,l);r=utils.array.unique(r);const h={};if(h.sort=get(o,\"options.options.sort\",void 0),h.excludeId=excludeIdReg.test(n)||n&&0===n._id,0===r.length||r.every(utils.isNullOrUndefined))--c,(o.count||o.isVirtual)&&_assign(e,[],o,h);else{if(a=!0,1===o.foreignField.size){const e=Array.from(o.foreignField)[0],t=o.model.schema.path(e);\"_id\"===e&&s._id||(r=_filterInvalidIds(r,t,o.options.skipInvalidIds),s[e]={$in:r})}else{const e=[];Array.isArray(s.$or)?(s.$and=[{$or:s.$or},{$or:e}],delete s.$or):s.$or=e;for(const t of o.foreignField)if(\"_id\"!==t||!s._id){r=_filterInvalidIds(r,o.model.schema.path(t),o.options.skipInvalidIds),e.push({[t]:{$in:r}})}}h.excludeId&&(\"string\"==typeof n?n=n.replace(excludeIdRegGlobal,\" \"):delete(n=utils.object.shallowCopy(n))._id),o.options.options&&o.options.options.limit&&(h.originalLimit=o.options.options.limit,o.options.options.limit=o.options.options.limit*r.length),u.push([o,s,n,h,d])}}if(!a)return n();for(const e of u)_execPopulateQuery.apply(null,e);function d(t,o){if(null!=t)return n(t,null);r=r.concat(o),0==--c&&function(){for(const t of u){const o=t[0],n=t[3];_assign(e,r,o,n)}n()}()}}function _execPopulateQuery(e,t,o,n,i){const s=utils.clone(e.options.populate),r=e.model.find(t,o,e.options.options);for(const t of e.foreignField)\"_id\"!==t&&r.selectedInclusively()&&!isPathSelectedInclusive(r._fields,t)&&r.select(t);if(e.count)for(const t of e.foreignField)r.select(t);s&&r.populate(s),r.exec(i),e.options.options&&e.options.options.limit&&(e.options.options.limit=n.originalLimit)}function _assign(e,t,o,n){const i=o.options,s=o.isVirtual,r=o.justOne;let l;const c=i.options&&i.options.lean,a=t.length,u={},d={};let h,p;const f=utils.clone(o.allIds);for(let e=0;e<a;e++)if(null!=(p=t[e]))for(const t of o.foreignField){if(l=utils.getValue(t,p),Array.isArray(l)){const t=(l=utils.array.flatten(l)).length;for(let o=0;o<t;++o){let t=l[o];t instanceof Document&&(t=t._id),d[h=String(t)]?Array.isArray(d[h])?(d[h].push(p),u[h].push(e)):(d[h]=[d[h],p],u[h]=[u[h],e]):s&&!r?(d[h]=[p],u[h]=[e]):(d[h]=p,u[h]=e)}}else l instanceof Document&&(l=l._id),d[h=String(l)]?Array.isArray(d[h])?(d[h].push(p),u[h].push(e)):(d[h]=[d[h],p],u[h]=[u[h],e]):(d[h]=p,u[h]=e);c?leanPopulateMap.set(p,o.model):p.$__.wasPopulated=!0}assignVals({originalModel:e,rawIds:o.isVirtual?f:o.allIds,allIds:f,foreignField:o.foreignField,rawDocs:d,rawOrder:u,docs:o.docs,path:i.path,options:n,justOne:o.justOne,isVirtual:o.isVirtual,allOptions:o,lean:c,virtual:o.virtual,count:o.count,match:o.match})}function _filterInvalidIds(e,t,o){return o?e.filter(e=>{try{return t.cast(e),!0}catch(e){return!1}}):e}function _formatMatch(e){return Array.isArray(e)?e.length>1?{$or:[].concat(e.map(e=>Object.assign({},e)))}:Object.assign({},e[0]):Object.assign({},e)}function applyQueryMethods(e,t){for(const o in t)e.Query.prototype[o]=t[o]}Model.compile=function(e,t,o,n,i){if(!1!==t.options.versionKey&&!t.paths[t.options.versionKey]){const e={};e[t.options.versionKey]=Number,t.add(e)}let s;\"function\"==typeof e&&e.prototype instanceof Model?(e=(s=e).name,t.loadClass(s,!1),s.prototype.$isMongooseModelPrototype=!0):s=function e(t,o,n){if(e.hooks.execPreSync(\"createModel\",t),!(this instanceof e))return new e(t,o,n);const i=e.schema.options.discriminatorKey;if(null==e.discriminators||null==t||null==t[i])return void Model.call(this,t,o,n);const s=e.discriminators[t[i]]||getDiscriminatorByValue(e,t[i]);if(null!=s)return new s(t,o,n);Model.call(this,t,o,n)},s.hooks=t.s.hooks.clone(),s.base=i,s.modelName=e,s.prototype instanceof Model||(s.__proto__=Model,s.prototype.__proto__=Model.prototype),s.model=function(e){return this.db.model(e)},s.db=n,s.prototype.db=n,s.prototype[modelDbSymbol]=n,s.discriminators=s.prototype.discriminators=void 0,s[modelSymbol]=!0,s.events=new EventEmitter,s.prototype.$__setSchema(t);const r=t._userProvidedOptions||{};let l=!0;null!=n.base.get(\"bufferCommands\")&&(l=n.base.get(\"bufferCommands\")),null!=n.config.bufferCommands&&(l=n.config.bufferCommands),null!=r.bufferCommands&&(l=r.bufferCommands);const c={bufferCommands:l,capped:t.options.capped,Promise:s.base.Promise};return s.prototype.collection=n.collection(o,c),s.prototype[modelCollectionSymbol]=s.prototype.collection,applyMethods(s,t),applyStatics(s,t),applyHooks(s,t),applyStaticHooks(s,t.s.hooks,t.statics),s.schema=s.prototype.schema,s.collection=s.prototype.collection,s.Query=function(){Query.apply(this,arguments)},s.Query.prototype=Object.create(Query.prototype),s.Query.base=Query.base,applyQueryMiddleware(s.Query,s),applyQueryMethods(s,t.query),s},Model.__subclass=function(e,t,o){const n=this,i=function e(t,o,i){if(!(this instanceof e))return new e(t,o,i);n.call(this,t,o,i)};if(i.__proto__=n,i.prototype.__proto__=n.prototype,i.db=e,i.prototype.db=e,i.prototype[modelDbSymbol]=e,n[subclassedSymbol]=n[subclassedSymbol]||[],n[subclassedSymbol].push(i),null!=n.discriminators){i.discriminators={};for(const e of Object.keys(n.discriminators))i.discriminators[e]=n.discriminators[e].__subclass(n.db,n.discriminators[e].schema,o)}const s=t&&\"string\"!=typeof t?t:n.prototype.schema,r=s.options||{},l=s._userProvidedOptions||{};o||(o=n.prototype.schema.get(\"collection\")||utils.toCollectionName(n.modelName,this.base.pluralize()));let c=!0;s&&(null!=e.config.bufferCommands&&(c=e.config.bufferCommands),null!=l.bufferCommands&&(c=l.bufferCommands));const a={bufferCommands:c,capped:s&&r.capped};return i.prototype.collection=e.collection(o,a),i.prototype[modelCollectionSymbol]=i.prototype.collection,i.collection=i.prototype.collection,i.init(()=>{}),i},Model.$handleCallbackError=function(e){if(null==e)return e;if(\"function\"!=typeof e)throw new MongooseError(\"Callback must be a function, got \"+e);const t=this;return function(){try{e.apply(null,arguments)}catch(e){t.emit(\"error\",e)}}},Model.$wrapCallback=function(e){return e},Model.inspect=function(){return`Model { ${this.modelName} }`},util.inspect.custom&&(Model[util.inspect.custom]=Model.inspect),module.exports=exports=Model;","node_modules/mongoose/lib/document.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter,InternalCache=require(\"./internal\"),MongooseError=require(\"./error/index\"),MixedSchema=require(\"./schema/mixed\"),ObjectExpectedError=require(\"./error/objectExpected\"),ObjectParameterError=require(\"./error/objectParameter\"),Schema=require(\"./schema\"),StrictModeError=require(\"./error/strict\"),ValidatorError=require(\"./schematype\").ValidatorError,VirtualType=require(\"./virtualtype\"),cleanModifiedSubpaths=require(\"./helpers/document/cleanModifiedSubpaths\"),compile=require(\"./helpers/document/compile\").compile,defineKey=require(\"./helpers/document/compile\").defineKey,flatten=require(\"./helpers/common\").flatten,get=require(\"./helpers/get\"),getEmbeddedDiscriminatorPath=require(\"./helpers/document/getEmbeddedDiscriminatorPath\"),idGetter=require(\"./plugins/idGetter\"),isDefiningProjection=require(\"./helpers/projection/isDefiningProjection\"),isExclusive=require(\"./helpers/projection/isExclusive\"),inspect=require(\"util\").inspect,internalToObjectOptions=require(\"./options\").internalToObjectOptions,mpath=require(\"mpath\"),utils=require(\"./utils\"),ValidationError=MongooseError.ValidationError,clone=utils.clone,deepEqual=utils.deepEqual,isMongooseObject=utils.isMongooseObject,arrayAtomicsSymbol=require(\"./helpers/symbols\").arrayAtomicsSymbol,documentArrayParent=require(\"./helpers/symbols\").documentArrayParent,documentSchemaSymbol=require(\"./helpers/symbols\").documentSchemaSymbol,getSymbol=require(\"./helpers/symbols\").getSymbol,populateModelSymbol=require(\"./helpers/symbols\").populateModelSymbol;let DocumentArray,MongooseArray,Embedded;const specialProperties=utils.specialProperties;function Document(t,e,i,o){if(\"object\"==typeof i&&null!=i&&(i=(o=i).skipId),o=o||{},null==this.schema){const t=utils.isObject(e)&&!e.instanceOfSchema?new Schema(e):e;this.$__setSchema(t),e=i,i=o,o=arguments[4]||{}}if(this.$__=new InternalCache,this.$__.emitter=new EventEmitter,this.isNew=!(\"isNew\"in o)||o.isNew,this.errors=void 0,this.$__.$options=o||{},null!=t&&\"object\"!=typeof t)throw new ObjectParameterError(t,\"obj\",\"Document\");const s=this.schema;\"boolean\"==typeof e?(this.$__.strictMode=e,e=void 0):(this.$__.strictMode=s.options.strict,this.$__.selected=e);const n=s.requiredPaths(!0);for(let t=0;t<n.length;++t)this.$__.activePaths.require(n[t]);this.$__.emitter.setMaxListeners(0);let r=null;utils.isPOJO(e)&&(r=isExclusive(e));const c=!1===r&&e?$__hasIncludedChildren(e):{};if(null==this._doc&&(this.$__buildDoc(t,e,i,r,c,!1),$__applyDefaults(this,e,i,r,c,!0,{isNew:this.isNew})),t&&(t instanceof Document&&(this.isNew=t.isNew),this.$__original_set?this.$__original_set(t,void 0,!0):this.$set(t,void 0,!0)),o.willInit?EventEmitter.prototype.once.call(this,\"init\",()=>{$__applyDefaults(this,e,i,r,c,!1,o.skipDefaults,{isNew:this.isNew})}):$__applyDefaults(this,e,i,r,c,!1,o.skipDefaults,{isNew:this.isNew}),this.$__._id=this._id,this.$locals={},!s.options.strict&&t){const t=this;Object.keys(this._doc).forEach(function(e){e in s.tree||defineKey(e,null,t)})}applyQueue(this)}utils.each([\"on\",\"once\",\"emit\",\"listeners\",\"removeListener\",\"setMaxListeners\",\"removeAllListeners\",\"addListener\"],function(t){Document.prototype[t]=function(){return this.$__.emitter[t].apply(this.$__.emitter,arguments)}}),Document.prototype.constructor=Document;for(const t in EventEmitter.prototype)Document[t]=EventEmitter.prototype[t];function $__hasIncludedChildren(t){const e={},i=Object.keys(t);for(let t=0;t<i.length;++t){const o=i[t].split(\".\"),s=[];for(let t=0;t<o.length;++t)s.push(o[t]),e[s.join(\".\")]=1}return e}function $__applyDefaults(t,e,i,o,s,n,r){const c=Object.keys(t.schema.paths),a=c.length;for(let l=0;l<a;++l){let a,u=\"\";const h=c[l];if(\"_id\"===h&&i)continue;const p=t.schema.paths[h],d=h.split(\".\"),f=d.length;let _=!1,m=t._doc;for(let i=0;i<f&&null!=m;++i){const c=d[i];if(u+=(u.length?\".\":\"\")+c,!0===o){if(u in e)break}else if(!1===o&&e&&!_)if(u in e)_=!0;else if(!s[u])break;if(i===f-1){if(void 0!==m[c])break;if(\"function\"==typeof p.defaultValue){if(!p.defaultValue.$runBeforeSetters&&n)break;if(p.defaultValue.$runBeforeSetters&&!n)break}else if(!n)continue;if(r&&r[u])break;if(e&&null!==o)if(!0===o){if(h in e)continue;void 0!==(a=p.getDefault(t,!1))&&(m[c]=a,t.$__.activePaths.default(h))}else _&&void 0!==(a=p.getDefault(t,!1))&&(m[c]=a,t.$__.activePaths.default(h));else void 0!==(a=p.getDefault(t,!1))&&(m[c]=a,t.$__.activePaths.default(h))}else m=m[c]}}}function markArraySubdocsPopulated(t,e){if(null==t._id||null==e||0===e.length)return;const i=String(t._id);for(const o of e){if(o.isVirtual)continue;const e=o.path.split(\".\");for(let s=0;s<e.length-1;++s){const n=e.slice(0,s+1).join(\".\"),r=e.slice(s+1).join(\".\"),c=t.get(n);if(null!=c&&c.isMongooseDocumentArray){for(let t=0;t<c.length;++t)c[t].populated(r,o._docs[i][t],o);break}}}}function init(t,e,i,o,s){s=s||\"\";const n=Object.keys(e),r=n.length;let c,a,l,u=0;for(;u<r;)h(u++);function h(r){if(l=n[r],a=s+l,c=t.schema.path(a),!t.schema.$isRootDiscriminator||t.isSelected(a))if(!c&&utils.isPOJO(e[l]))i[l]||(i[l]={}),init(t,e[l],i[l],o,a+\".\");else if(c){if(null===e[l])i[l]=null;else if(void 0!==e[l]){const o=(e[l].$__||{}).wasPopulated||null;if(c&&!o)try{i[l]=c.cast(e[l],t,!0)}catch(e){t.invalidate(e.path,new ValidatorError({path:e.path,message:e.message,type:\"cast\",value:e.value}))}else i[l]=e[l]}t.isModified(a)||t.$__.activePaths.init(a)}else i[l]=e[l]}}function _isEmpty(t){if(null==t)return!0;if(\"object\"!=typeof t||Array.isArray(t))return!1;for(const e of Object.keys(t))if(!_isEmpty(t[e]))return!1;return!0}function _evaluateRequiredFunctions(t){Object.keys(t.$__.activePaths.states.require).forEach(e=>{const i=t.schema.path(e);null!=i&&\"function\"==typeof i.originalRequiredValue&&(t.$__.cachedRequired[e]=i.originalRequiredValue.call(t))})}function _getPathsToValidate(t){let e,i;const o={};_evaluateRequiredFunctions(t);let s=Object.keys(t.$__.activePaths.states.require).filter(function(e){return!(!t.isSelected(e)&&!t.isModified(e))&&(!(e in t.$__.cachedRequired)||t.$__.cachedRequired[e])});if(s=(s=(s=s.concat(Object.keys(t.$__.activePaths.states.init))).concat(Object.keys(t.$__.activePaths.states.modify))).concat(Object.keys(t.$__.activePaths.states.default)),!t.ownerDocument){const n=t.$__getAllSubdocs();let r;i=n.length;const c=t.modifiedPaths();for(e=0;e<i;++e)r=n[e],!t.isModified(r.$basePath,c)||t.isDirectModified(r.$basePath)||t.$isDefault(r.$basePath)||((s=s.filter(function(t){return null!=t&&0!==t.indexOf(r.$basePath+\".\")})).push(r.$basePath),o[r.$basePath]=!0)}for(i=s.length,e=0;e<i;++e){const i=s[e],o=t.schema.path(i);o&&o.$isMongooseArray&&(!o.$isMongooseDocumentArray||get(o,\"schemaOptions.required\"))&&n(t.$__getValue(i),s,i)}function n(t,e,i){if(null!=t){const o=t.length;for(let s=0;s<o;++s)Array.isArray(t[s])?n(t[s],e,i+\".\"+s):e.push(i+\".\"+s)}}const r={skipArrays:!0};for(i=s.length,e=0;e<i;++e){const i=s[e];if(t.schema.nested[i]){let e=t.$__getValue(i);isMongooseObject(e)&&(e=e.toObject({transform:!1}));const o=flatten(e,i,r,t.schema);s=s.concat(Object.keys(o))}}for(i=s.length,e=0;e<i;++e){const i=s[e],o=t.schema.path(i);if(!o||!o.$isSchemaMap)continue;const n=t.$__getValue(i);if(null!=n)for(const t of n.keys())s.push(i+\".\"+t)}return[s,o]}function applyQueue(t){const e=t.schema&&t.schema.callQueue;if(!e.length)return;let i;for(let o=0;o<e.length;++o)\"pre\"!==(i=e[o])[0]&&\"post\"!==i[0]&&\"on\"!==i[0]&&t[i[0]].apply(t,i[1])}function minimize(t){const e=Object.keys(t);let i,o,s,n=e.length;for(;n--;)s=t[o=e[n]],utils.isObject(s)&&!Buffer.isBuffer(s)&&(t[o]=minimize(s)),void 0!==t[o]?i=!0:delete t[o];return i?t:void 0}function applyVirtuals(t,e,i,o){const s=t.schema,n=Object.keys(s.virtuals);let r=n.length;const c=r;let a,l,u,h=t._doc;const p=get(o,\"aliases\",!0);if(!h)return e;for(i=i||{},r=0;r<c;++r){if(a=n[r],!p&&s.aliases.hasOwnProperty(a))continue;if(l=a,null!=i.path){if(!a.startsWith(i.path+\".\"))continue;l=a.substr(i.path.length+1)}const o=l.split(\".\");if(void 0===(u=clone(t.get(a),i)))continue;const c=o.length;h=e;for(let t=0;t<c-1;++t)h[o[t]]=h[o[t]]||{},h=h[o[t]];h[o[c-1]]=u}return e}function applyGetters(t,e,i){const o=t.schema,s=Object.keys(o.paths);let n,r,c=s.length,a=t._doc;if(!a)return e;for(;c--;){const o=(n=s[c]).split(\".\"),l=o.length,u=l-1;let h,p=e;if(a=t._doc,t.isSelected(n))for(let e=0;e<l;++e){if(r=a[h=o[e]],e===u){const e=t.get(n);p[h]=clone(e,i)}else{if(null==r){h in a&&(p[h]=r);break}p=p[h]||(p[h]={})}a=r}}return e}Document.prototype.schema,Object.defineProperty(Document.prototype,\"$locals\",{configurable:!1,enumerable:!1,writable:!0}),Document.prototype.isNew,Document.prototype.id,Document.prototype.errors,Document.prototype.$__buildDoc=function(t,e,i,o,s){const n={},r=Object.keys(this.schema.paths).filter(t=>!t.includes(\"$*\")),c=r.length;let a=0;for(;a<c;++a){const c=r[a];if(\"_id\"===c){if(i)continue;if(t&&\"_id\"in t)continue}const l=c.split(\".\"),u=l.length,h=u-1;let p=\"\",d=n,f=!1;for(let t=0;t<u;++t){const i=l[t];if(p+=(p.length?\".\":\"\")+i,!0===o){if(p in e)break}else if(!1===o&&e&&!f)if(p in e)f=!0;else if(!s[p])break;t<h&&(d=d[i]||(d[i]={}))}}this._doc=n},Document.prototype.toBSON=function(){return this.toObject(internalToObjectOptions)},Document.prototype.init=function(t,e,i){return\"function\"==typeof e&&(i=e,e=null),this.$__init(t,e),i&&i(null,this),this},Document.prototype.$__init=function(t,e){if(this.isNew=!1,this.$init=!0,e=e||{},null!=t._id&&e.populated&&e.populated.length){const i=String(t._id);for(let o=0;o<e.populated.length;++o){const s=e.populated[o];s.isVirtual?this.populated(s.path,utils.getValue(s.path,t),s):this.populated(s.path,s._docs[i],s)}}return init(this,t,this._doc,e),markArraySubdocsPopulated(this,e.populated),this.emit(\"init\",this),this.constructor.emit(\"init\",this),this.$__._id=this._id,this},Document.prototype.update=function(){const t=utils.args(arguments);t.unshift({_id:this._id});const e=this.constructor.update.apply(this.constructor,t);return null!=this.$session()&&(\"session\"in e.options||(e.options.session=this.$session())),e},Document.prototype.updateOne=function(t,e,i){const o=this.constructor.updateOne({_id:this._id},t,e);return o._pre(t=>{this.constructor._middleware.execPre(\"updateOne\",this,[],t)}),o._post(t=>{this.constructor._middleware.execPost(\"updateOne\",this,[],{},t)}),null!=this.$session()&&(\"session\"in o.options||(o.options.session=this.$session())),null!=i?o.exec(i):o},Document.prototype.replaceOne=function(){const t=utils.args(arguments);return t.unshift({_id:this._id}),this.constructor.replaceOne.apply(this.constructor,t)},Document.prototype.$session=function(t){if(0===arguments.length)return this.$__.session;if(this.$__.session=t,!this.ownerDocument){const e=this.$__getAllSubdocs();for(const i of e)i.$session(t)}return t},Document.prototype.overwrite=function(t){const e=Array.from(new Set(Object.keys(this._doc).concat(Object.keys(t))));for(const i of e)\"_id\"!==i&&(this.schema.options.versionKey&&i===this.schema.options.versionKey||this.$set(i,t[i]));return this},Document.prototype.$set=function(t,e,i,o){utils.isPOJO(i)&&(o=i,i=void 0);const s=(o=o||{}).merge,n=i&&!0!==i,r=!0===i;let c,a,l,u,h,p=0;const d=\"strict\"in o?o.strict:this.$__.strictMode;if(n&&((c=this.$__.adhocPaths||(this.$__.adhocPaths={}))[t]=this.schema.interpretAsType(t,i,this.schema.options)),\"string\"!=typeof t){if(null!==t&&void 0!==t){h=e?e+\".\":\"\",t instanceof Document&&(t=t.$__isNested?t.toObject():t._doc);const i=(a=Object.keys(t)).length;if(0===i&&!this.schema.options.minimize)return e&&this.$set(e,{}),this;for(;p<i;)f.call(this,p++);return this}{const i=t;t=e,e=i}}else this.$__.$setCalled.add(t);function f(e){u=a[e];const s=h+u;if(l=this.schema.pathType(s),!0!==i||h||null==t[u]||\"nested\"!==l||null==this._doc[u]||0!==Object.keys(this._doc[u]).length||delete this._doc[u],\"object\"!=typeof t[u]||utils.isNativeObject(t[u])||utils.isMongooseType(t[u])||null==t[u]||\"virtual\"===l||\"real\"===l||this.$__path(s)instanceof MixedSchema||this.schema.paths[s]&&this.schema.paths[s].options&&this.schema.paths[s].options.ref)if(d){if(r&&void 0===t[u]&&void 0!==this.get(u))return;if(\"adhocOrUndefined\"===l&&(l=getEmbeddedDiscriminatorPath(this,s,{typeOnly:!0})),\"real\"===l||\"virtual\"===l){let e=t[u];this.schema.paths[s]&&this.schema.paths[s].$isSingleNested&&t[u]instanceof Document&&(e=e.toObject({virtuals:!1,transform:!1})),this.$set(h+u,e,r,o)}else if(\"nested\"===l&&t[u]instanceof Document)this.$set(h+u,t[u].toObject({transform:!1}),r,o);else if(\"throw\"===d)throw\"nested\"===l?new ObjectExpectedError(u,t[u]):new StrictModeError(u)}else void 0!==t[u]&&this.$set(h+u,t[u],r,o);else this.$__.$setCalled.add(h+u),this.$set(t[u],h+u,r,o)}let _,m=this.schema.pathType(t);if(\"adhocOrUndefined\"===m&&(m=getEmbeddedDiscriminatorPath(this,t,{typeOnly:!0})),utils.isPOJO(e)&&null!=e.$__&&null!=e._doc&&(e=e._doc),\"nested\"===m&&e){if(\"object\"==typeof e&&null!=e){if(s)return this.$set(e,t,r);this.$__setValue(t,null),cleanModifiedSubpaths(this,t);const i=Object.keys(e);this.$__setValue(t,{});for(const o of i)this.$set(t+\".\"+o,e[o],r);return this.markModified(t),cleanModifiedSubpaths(this,t,{skipDocArrays:!0}),this}return this.invalidate(t,new MongooseError.CastError(\"Object\",e,t)),this}const y=t.split(\".\");if(\"string\"==typeof this.schema.aliases[y[0]]&&(y[0]=this.schema.aliases[y[0]]),\"adhocOrUndefined\"===m&&d){let i;for(p=0;p<y.length;++p){const o=y.slice(0,p+1).join(\".\");if(p+1<y.length&&\"virtual\"===this.schema.pathType(o))return mpath.set(t,e,this),this;if(null!=(_=this.schema.path(o))&&_ instanceof MixedSchema){i=!0;break}}if(null==_&&(_=getEmbeddedDiscriminatorPath(this,t)),!i&&!_){if(\"throw\"===d)throw new StrictModeError(t);return this}}else{if(\"virtual\"===m)return(_=this.schema.virtualpath(t)).applySetters(e,this),this;_=this.$__path(t)}let $,g=this._doc,b=\"\";for(p=0;p<y.length-1;++p)g=g[y[p]],b+=(b.length>0?\".\":\"\")+y[p],g||(this.$set(b,{}),this.isSelected(b)||this.unmarkModified(b),g=this.$__getValue(b));if(y.length<=1)$=t;else{for(p=0;p<y.length;++p){const t=y.slice(0,p+1).join(\".\");if(null===this.get(t,null,{getters:!1})){$=t;break}}$||($=t)}const v=(()=>null!=this.$__.$options.priorDoc?this.$__.$options.priorDoc.$__getValue(t):r?void 0:this.$__getValue(t))();if(!_)return this.$__set($,t,r,y,_,e,v),this;if(_.$isSingleNested&&null!=e&&s){e instanceof Document&&(e=e.toObject({virtuals:!1,transform:!1}));const i=Object.keys(e);for(const s of i)this.$set(t+\".\"+s,e[s],r,o);return this}let D=!0;try{const i=(()=>{if(null==_.options)return!1;if(!(e instanceof Document))return!1;const t=e.constructor,i=_.options.ref;if(null!=i&&(i===t.modelName||i===t.baseModelName))return!0;const o=_.options.refPath;if(null==o)return!1;const s=e.get(o);return s===t.modelName||s===t.baseModelName})();let o,s=!1;if(i&&e instanceof Document&&(this.populated(t,e._id,{[populateModelSymbol]:e.constructor}),s=!0),_.options&&Array.isArray(_.options[this.schema.options.typeKey])&&_.options[this.schema.options.typeKey].length&&_.options[this.schema.options.typeKey][0].ref&&Array.isArray(e)&&e.length>0&&e[0]instanceof Document&&e[0].constructor.modelName&&(_.options[this.schema.options.typeKey][0].ref===e[0].constructor.baseModelName||_.options[this.schema.options.typeKey][0].ref===e[0].constructor.modelName)&&(this.ownerDocument?(o={[populateModelSymbol]:e[0].constructor},this.ownerDocument().populated(this.$__fullPath(t),e.map(function(t){return t._id}),o)):(o={[populateModelSymbol]:e[0].constructor},this.populated(t,e.map(function(t){return t._id}),o)),s=!0),null==this.schema.singleNestedPaths[t]&&(e=_.applySetters(e,this,!1,v)),_.$isMongooseDocumentArray&&Array.isArray(e)&&e.length>0&&null!=e[0]&&null!=e[0].$__&&null!=e[0].$__.populated){const i=Object.keys(e[0].$__.populated);for(const o of i)this.populated(t+\".\"+o,e.map(t=>t.populated(o)),e[0].$__.populated[o].options);s=!0}!s&&this.$__.populated&&delete this.$__.populated[t],this.$markValid(t)}catch(i){i instanceof MongooseError.StrictModeError&&i.isImmutableError?this.invalidate(t,i):this.invalidate(t,new MongooseError.CastError(_.instance,e,t,i)),D=!1}return D&&this.$__set($,t,r,y,_,e,v),_.$isSingleNested&&(this.isDirectModified(t)||null==e)&&cleanModifiedSubpaths(this,t),this},Document.prototype.set=Document.prototype.$set,Document.prototype.$__shouldModify=function(t,e,i,o,s,n,r){return!!this.isNew||null==this.schema.singleNestedPaths[e]&&(void 0===n&&!this.isSelected(e)||!(void 0===n&&e in this.$__.activePaths.states.default)&&(!(this.populated(e)&&n instanceof Document&&deepEqual(n._id,r))&&(!deepEqual(n,r||this.get(e))||!!(!i&&null!==n&&void 0!==n&&e in this.$__.activePaths.states.default&&deepEqual(n,s.getDefault(this,i))))))},Document.prototype.$__set=function(t,e,i,o,s,n,r){Embedded=Embedded||require(\"./types/embedded\");const c=this;this.$__shouldModify(t,e,i,o,s,n,r)&&(this.markModified(t),MongooseArray||(MongooseArray=require(\"./types/array\")),n&&n.isMongooseArray&&(n._registerAtomic(\"$set\",n),n.isMongooseDocumentArray&&n.forEach(function(t){t&&t.__parentArray&&(t.__parentArray=n)}),this.$__.activePaths.forEach(function(t){t.startsWith(e+\".\")&&c.$__.activePaths.ignore(t)})));let a=this._doc,l=0;const u=o.length;let h=\"\";for(;l<u;l++){const t=l+1===u;if(h+=h?\".\"+o[l]:o[l],specialProperties.has(o[l]))return;t?a instanceof Map?a.set(o[l],n):a[o[l]]=n:utils.isPOJO(a[o[l]])?a=a[o[l]]:a[o[l]]&&a[o[l]]instanceof Embedded?a=a[o[l]]:a[o[l]]&&a[o[l]].$isSingleNested?a=a[o[l]]:a[o[l]]&&Array.isArray(a[o[l]])?a=a[o[l]]:(a[o[l]]=a[o[l]]||{},a=a[o[l]])}},Document.prototype.$__getValue=function(t){return utils.getValue(t,this._doc)},Document.prototype.$__setValue=function(t,e){return utils.setValue(t,e,this._doc),this},Document.prototype.get=function(t,e,i){let o;i=i||{},e&&(o=this.schema.interpretAsType(t,e,this.schema.options));let s=this.$__path(t);if(null==s&&(s=this.schema.virtualpath(t)),s instanceof MixedSchema){const e=this.schema.virtualpath(t);null!=e&&(s=e)}const n=t.split(\".\");let r=this._doc;if(s instanceof VirtualType){if(0===s.getters.length)return;return s.applyGetters(null,this)}\"string\"==typeof this.schema.aliases[n[0]]&&(n[0]=this.schema.aliases[n[0]]);for(let t=0,e=n.length;t<e;t++)r&&r._doc&&(r=r._doc),r=null==r?void 0:r instanceof Map?r.get(n[t]):t===e-1?utils.getValue(n[t],r):r[n[t]];if(o&&(r=o.cast(r)),null!=s&&!1!==i.getters)r=s.applyGetters(r,this);else if(this.schema.nested[t]&&i.virtuals)return applyVirtuals(this,utils.clone(r)||{},{path:t});return r},Document.prototype[getSymbol]=Document.prototype.get,Document.prototype.$__path=function(t){const e=this.$__.adhocPaths,i=e&&e.hasOwnProperty(t)?e[t]:null;return i||this.schema.path(t)},Document.prototype.markModified=function(t,e){this.$__.activePaths.modify(t),null==e||this.ownerDocument||(this.$__.pathsToScopes[t]=e)},Document.prototype.unmarkModified=function(t){this.$__.activePaths.init(t),delete this.$__.pathsToScopes[t]},Document.prototype.$ignore=function(t){this.$__.activePaths.ignore(t)},Document.prototype.directModifiedPaths=function(){return Object.keys(this.$__.activePaths.states.modify)},Document.prototype.$isEmpty=function(t){const e={minimize:!0,virtuals:!1,getters:!1,transform:!1};if(arguments.length>0){const i=this.get(t);return null==i||\"object\"==typeof i&&(utils.isPOJO(i)?_isEmpty(i):0===Object.keys(i.toObject(e)).length)}return 0===Object.keys(this.toObject(e)).length},Document.prototype.modifiedPaths=function(t){t=t||{};const e=this;return Object.keys(this.$__.activePaths.states.modify).reduce(function(i,o){const s=o.split(\".\");if(i=i.concat(s.reduce(function(t,e,i){return t.concat(s.slice(0,i).concat(e).join(\".\"))},[]).filter(function(t){return-1===i.indexOf(t)})),!t.includeChildren)return i;let n=e.get(o);if(null!=n&&\"object\"==typeof n)if(n._doc&&(n=n._doc),Array.isArray(n)){const t=n.length;for(let e=0;e<t;++e)if(-1===i.indexOf(o+\".\"+e)&&(i.push(o+\".\"+e),null!=n[e]&&n[e].$__)){const t=n[e].modifiedPaths();for(const s of t)i.push(o+\".\"+e+\".\"+s)}}else Object.keys(n).filter(function(t){return-1===i.indexOf(o+\".\"+t)}).forEach(function(t){i.push(o+\".\"+t)});return i},[])},Document.prototype.isModified=function(t,e){if(t){Array.isArray(t)||(t=t.split(\" \"));const i=e||this.modifiedPaths(),o=Object.keys(this.$__.activePaths.states.modify);return t.some(function(t){return!!~i.indexOf(t)})||t.some(function(t){return o.some(function(e){return e===t||t.startsWith(e+\".\")})})}return this.$__.activePaths.some(\"modify\")},Document.prototype.$isDefault=function(t){return t in this.$__.activePaths.states.default},Document.prototype.$isDeleted=function(t){return 0===arguments.length?!!this.$__.isDeleted:(this.$__.isDeleted=!!t,this)},Document.prototype.isDirectModified=function(t){return t in this.$__.activePaths.states.modify},Document.prototype.isInit=function(t){return t in this.$__.activePaths.states.init},Document.prototype.isSelected=function(t){if(this.$__.selected){if(\"_id\"===t)return 0!==this.$__.selected._id;const e=Object.keys(this.$__.selected);let i,o=e.length,s=null;if(1===o&&\"_id\"===e[0])return 0===this.$__.selected._id;for(;o--;)if(\"_id\"!==(i=e[o])&&isDefiningProjection(this.$__.selected[i])){s=!!this.$__.selected[i];break}if(null===s)return!0;if(t in this.$__.selected)return s;o=e.length;const n=t+\".\";for(;o--;)if(\"_id\"!==(i=e[o])){if(i.startsWith(n))return s||i!==n;if(n.startsWith(i+\".\"))return s}return!s}return!0},Document.prototype.isDirectSelected=function(t){if(this.$__.selected){if(\"_id\"===t)return 0!==this.$__.selected._id;const e=Object.keys(this.$__.selected);let i,o=e.length,s=null;if(1===o&&\"_id\"===e[0])return 0===this.$__.selected._id;for(;o--;)if(\"_id\"!==(i=e[o])&&isDefiningProjection(this.$__.selected[i])){s=!!this.$__.selected[i];break}return null===s||(t in this.$__.selected?s:!s)}return!0},Document.prototype.validate=function(t,e){return\"function\"==typeof t&&(e=t,t=null),utils.promiseOrCallback(e,e=>{this.$__validate(t,function(t){e(t)})},this.constructor.events)},Document.prototype.$__validate=function(t,e){let i;\"function\"==typeof t&&(e=t,t=null),i=t&&\"object\"==typeof t&&\"validateModifiedOnly\"in t?!!t.validateModifiedOnly:this.schema.options.validateModifiedOnly;const o=this,s=()=>{let t=this.$__.validationError;if(this.$__.validationError=void 0,i&&null!=t){const e=Object.keys(t.errors);for(const i of e)this.isModified(i)||delete t.errors[i];0===Object.keys(t.errors).length&&(t=void 0)}if(this.$__.cachedRequired={},this.emit(\"validate\",o),this.constructor.emit(\"validate\",o),t){for(const e in t.errors)!this[documentArrayParent]&&t.errors[e]instanceof MongooseError.CastError&&this.invalidate(e,t.errors[e]);return t}},n=_getPathsToValidate(this),r=i?n[0].filter(t=>this.isModified(t)):n[0],c=n[1];if(0===r.length)return process.nextTick(function(){const t=s();if(t)return o.schema.s.hooks.execPost(\"validate:error\",o,[o],{error:t},function(t){e(t)});e(null,o)});const a={};let l=0;const u=function(){const t=s();if(t)return o.schema.s.hooks.execPost(\"validate:error\",o,[o],{error:t},function(t){e(t)});e(null,o)},h=function(t){null==t||a[t]||(a[t]=!0,l++,process.nextTick(function(){const e=o.schema.path(t);if(!e)return--l||u();if(!o.$isValid(t))return void(--l||u());let i,s=o.$__getValue(t);null==s&&(i=o.populated(t))&&(s=i);const n=t in o.$__.pathsToScopes?o.$__.pathsToScopes[t]:o;e.doValidate(s,function(i){if(i&&(!e.$isMongooseDocumentArray||i.$isArrayValidatorError)){if(e.$isSingleNested&&\"ValidationError\"===i.name&&!1===e.schema.options.storeSubdocValidationError)return--l||u();o.invalidate(t,i,void 0,!0)}--l||u()},n,{skipSchemaValidators:c[t],path:t})}))},p=r.length;for(let t=0;t<p;++t)h(r[t])},Document.prototype.validateSync=function(t,e){const i=this;let o;o=e&&\"object\"==typeof e&&\"validateModifiedOnly\"in e?!!e.validateModifiedOnly:this.schema.options.validateModifiedOnly,\"string\"==typeof t&&(t=t.split(\" \"));const s=_getPathsToValidate(this);let n=o?s[0].filter(t=>this.isModified(t)):s[0];const r=s[1];if(t&&t.length){const e=[];for(let i=0;i<n.length;++i)-1!==t.indexOf(n[i])&&e.push(n[i]);n=e}const c={};n.forEach(function(t){if(c[t])return;c[t]=!0;const e=i.schema.path(t);if(!e)return;if(!i.$isValid(t))return;const o=i.$__getValue(t),s=e.doValidateSync(o,i,{skipSchemaValidators:r[t],path:t});if(s&&(!e.$isMongooseDocumentArray||s.$isArrayValidatorError)){if(e.$isSingleNested&&\"ValidationError\"===s.name&&!1===e.schema.options.storeSubdocValidationError)return;i.invalidate(t,s,void 0,!0)}});const a=i.$__.validationError;if(i.$__.validationError=void 0,i.emit(\"validate\",i),i.constructor.emit(\"validate\",i),a)for(const t in a.errors)a.errors[t]instanceof MongooseError.CastError&&i.invalidate(t,a.errors[t]);return a},Document.prototype.invalidate=function(t,e,i,o){if(this.$__.validationError||(this.$__.validationError=new ValidationError(this)),!this.$__.validationError.errors[t])return e&&\"string\"!=typeof e||(e=new ValidatorError({path:t,message:e,type:o||\"user defined\",value:i})),this.$__.validationError===e?this.$__.validationError:(this.$__.validationError.addError(t,e),this.$__.validationError)},Document.prototype.$markValid=function(t){this.$__.validationError&&this.$__.validationError.errors[t]&&(delete this.$__.validationError.errors[t],0===Object.keys(this.$__.validationError.errors).length&&(this.$__.validationError=null))},Document.prototype.$isValid=function(t){return!this.$__.validationError||!this.$__.validationError.errors[t]},Document.prototype.$__reset=function(){let t=this;return DocumentArray||(DocumentArray=require(\"./types/documentarray\")),this.$__.activePaths.map(\"init\",\"modify\",function(e){return t.$__getValue(e)}).filter(function(t){return t&&t instanceof Array&&t.isMongooseDocumentArray&&t.length}).forEach(function(e){let i=e.length;for(;i--;){const t=e[i];t&&t.$__reset()}t.$__.activePaths.init(e.$path()),e[arrayAtomicsSymbol]={}}),this.$__.activePaths.map(\"init\",\"modify\",function(e){return t.$__getValue(e)}).filter(function(t){return t&&t.$isSingleNested}).forEach(function(e){e.$__reset(),t.$__.activePaths.init(e.$basePath)}),this.$__dirty().forEach(function(t){const e=t.value;e&&e[arrayAtomicsSymbol]&&(e[arrayAtomicsSymbol]={})}),this.$__.activePaths.clear(\"modify\"),this.$__.activePaths.clear(\"default\"),this.$__.validationError=void 0,this.errors=void 0,t=this,this.schema.requiredPaths().forEach(function(e){t.$__.activePaths.require(e)}),this},Document.prototype.$__dirty=function(){const t=this;let e=this.$__.activePaths.map(\"modify\",function(e){return{path:e,value:t.$__getValue(e),schema:t.$__path(e)}});(e=e.concat(this.$__.activePaths.map(\"default\",function(e){if(\"_id\"!==e&&null!=t.$__getValue(e))return{path:e,value:t.$__getValue(e),schema:t.$__path(e)}}))).sort(function(t,e){return t.path<e.path?-1:t.path>e.path?1:0});const i=[];let o,s;return e.forEach(function(t){t&&(null==o||0!==t.path.indexOf(o)?(o=t.path+\".\",i.push(t),s=t):null!=s&&null!=s.value&&null!=s.value[arrayAtomicsSymbol]&&s.value.hasAtomics()&&(s.value[arrayAtomicsSymbol]={},s.value[arrayAtomicsSymbol].$set=s.value))}),s=o=null,i},Document.prototype.$__setSchema=function(t){t.plugin(idGetter,{deduplicate:!0}),compile(t.tree,this,void 0,t.options);for(const e of Object.keys(t.virtuals))t.virtuals[e]._applyDefaultGetters();this.schema=t,this[documentSchemaSymbol]=t},Document.prototype.$__getArrayPathsToValidate=function(){return DocumentArray||(DocumentArray=require(\"./types/documentarray\")),this.$__.activePaths.map(\"init\",\"modify\",function(t){return this.$__getValue(t)}.bind(this)).filter(function(t){return t&&t instanceof Array&&t.isMongooseDocumentArray&&t.length}).reduce(function(t,e){return t.concat(e)},[]).filter(function(t){return t})},Document.prototype.$__getAllSubdocs=function(){DocumentArray||(DocumentArray=require(\"./types/documentarray\")),Embedded=Embedded||require(\"./types/embedded\");const t=this;return Object.keys(this._doc).reduce(function(e,i){return function t(e,i,o){let s=e;return o&&(s=e instanceof Document&&e[documentSchemaSymbol].paths[o]?e._doc[o]:e[o]),s instanceof Embedded?i.push(s):s instanceof Map?i=Array.from(s.keys()).reduce(function(e,i){return t(s.get(i),e,null)},i):s&&s.$isSingleNested?(i=Object.keys(s._doc).reduce(function(e,i){return t(s._doc,e,i)},i)).push(s):s&&s.isMongooseDocumentArray?s.forEach(function(e){e&&e._doc&&(i=Object.keys(e._doc).reduce(function(i,o){return t(e._doc,i,o)},i),e instanceof Embedded&&i.push(e))}):s instanceof Document&&s.$__isNested&&(i=Object.keys(s).reduce(function(e,i){return t(s,e,i)},i)),i}(t,e,i)},[])},Document.prototype.$__handleReject=function(t){this.listeners(\"error\").length?this.emit(\"error\",t):this.constructor.listeners&&this.constructor.listeners(\"error\").length?this.constructor.emit(\"error\",t):this.listeners&&this.listeners(\"error\").length&&this.emit(\"error\",t)},Document.prototype.$toObject=function(t,e){let i={transform:!0,flattenDecimals:!0};const o=e?\"toJSON\":\"toObject\",s=get(this,\"constructor.base.options.\"+o,{}),n=get(this,\"schema.options\",{});let r;i=utils.options(i,clone(s)),i=utils.options(i,clone(n[o]||{})),\"flattenMaps\"in(t=utils.isPOJO(t)?clone(t):{})||(t.flattenMaps=i.flattenMaps),r=null!=t.minimize?t.minimize:null!=i.minimize?i.minimize:n.minimize;const c=Object.assign(utils.clone(t),{_isNested:!0,json:e,minimize:r});if(utils.hasUserDefinedProperty(t,\"getters\")&&(c.getters=t.getters),utils.hasUserDefinedProperty(t,\"virtuals\")&&(c.virtuals=t.virtuals),(t.depopulate||get(t,\"_parentOptions.depopulate\",!1))&&t._isNested&&this.$__.wasPopulated)return clone(this._id,c);(t=utils.options(i,t))._isNested=!0,t.json=e,t.minimize=r,c._parentOptions=t,c._skipSingleNestedGetters=!0;const a=Object.assign({},c);a._skipSingleNestedGetters=!1;const l=t.transform;let u=clone(this._doc,c)||{};t.getters&&(applyGetters(this,u,a),t.minimize&&(u=minimize(u)||{})),(t.virtuals||t.getters&&!1!==t.virtuals)&&applyVirtuals(this,u,a,t),!1===t.versionKey&&this.schema.options.versionKey&&delete u[this.schema.options.versionKey];let h=t.transform;if(!0===h||n.toObject&&h){const e=t.json?n.toJSON:n.toObject;e&&(h=\"function\"==typeof t.transform?t.transform:e.transform)}else t.transform=l;if(\"function\"==typeof h){const e=h(this,u,t);void 0!==e&&(u=e)}return u},Document.prototype.toObject=function(t){return this.$toObject(t)},Document.prototype.toJSON=function(t){return this.$toObject(t,!0)},Document.prototype.inspect=function(t){let e;utils.isPOJO(t)&&((e=t).minimize=!1);const i=this.toObject(e);return null==i?\"MongooseDocument { \"+i+\" }\":i},inspect.custom&&(Document.prototype[inspect.custom]=Document.prototype.inspect),Document.prototype.toString=function(){const t=this.inspect();return\"string\"==typeof t?t:inspect(t)},Document.prototype.equals=function(t){if(!t)return!1;const e=this.get(\"_id\"),i=t.get?t.get(\"_id\"):t;return e||i?e&&e.equals?e.equals(i):e===i:deepEqual(this,t)},Document.prototype.populate=function(){if(0===arguments.length)return this;const t=this.$__.populate||(this.$__.populate={}),e=utils.args(arguments);let i;if(\"function\"==typeof e[e.length-1]&&(i=e.pop()),e.length){const i=utils.populate.apply(null,e);for(let e=0;e<i.length;++e)t[i[e].path]=i[e]}if(i){const e=utils.object.vals(t);this.$__.populate=void 0;let o=this.constructor;if(this.$__isNested){o=this.$__.scope.constructor;const t=this.$__.nestedPath;e.forEach(function(e){e.path=t+\".\"+e.path})}if(null!=this.$session()){const t=this.$session();e.forEach(e=>{null!=e.options?\"session\"in e.options||(e.options.session=t):e.options={session:t}})}o.populate(this,e,i)}return this},Document.prototype.execPopulate=function(t){return utils.promiseOrCallback(t,t=>{this.populate(t)},this.constructor.events)},Document.prototype.populated=function(t,e,i){if(null===e||void 0===e){if(!this.$__.populated)return;const e=this.$__.populated[t];return e?e.value:void 0}if(!0===e){if(!this.$__.populated)return;return this.$__.populated[t]}this.$__.populated||(this.$__.populated={}),this.$__.populated[t]={value:e,options:i};const o=t.split(\".\");for(let t=0;t<o.length-1;++t){const s=o.slice(0,t+1).join(\".\"),n=this.get(s);if(null!=n&&null!=n.$__&&this.populated(s)){const s=o.slice(t+1).join(\".\");n.populated(s,e,i);break}}return e},Document.prototype.depopulate=function(t){let e;\"string\"==typeof t&&(t=t.split(\" \"));const i=this.$$populatedVirtuals?Object.keys(this.$$populatedVirtuals):[],o=get(this,\"$__.populated\",{});if(0===arguments.length){for(let t=0;t<i.length;t++)delete this.$$populatedVirtuals[i[t]],delete this._doc[i[t]],delete o[i[t]];const t=Object.keys(o);for(let i=0;i<t.length;i++)(e=this.populated(t[i]))&&(delete o[t[i]],this.$set(t[i],e));return this}for(let s=0;s<t.length;s++)e=this.populated(t[s]),delete o[t[s]],-1!==i.indexOf(t[s])?(delete this.$$populatedVirtuals[t[s]],delete this._doc[t[s]]):e&&this.$set(t[s],e);return this},Document.prototype.$__fullPath=function(t){return t||\"\"},Document.ValidationError=ValidationError,module.exports=exports=Document;","node_modules/mongoose/lib/helpers/schema/applyPlugins.js":"\"use strict\";module.exports=function e(s,t,i,o){if(s[o])return;if(s[o]=!0,!i||!i.skipTopLevel)for(let e=0;e<t.length;++e)s.plugin(t[e][0],t[e][1]);if(delete(i=Object.assign({},i)).skipTopLevel,!1!==i.applyPluginsToChildSchemas)for(const l of Object.keys(s.paths)){const n=s.paths[l];null!=n.schema&&(e(n.schema,t,i,o),n.caster.prototype.$__setSchema(n.schema))}const l=s.discriminators;if(null==l)return;const n=i.applyPluginsToDiscriminators,c=Object.keys(l);for(let s=0;s<c.length;++s){e(l[c[s]],t,{skipTopLevel:!n},o)}};","node_modules/mongoose/lib/helpers/get.js":"\"use strict\";function getProperty(t,n){return null==t?t:t instanceof Map?t.get(n):t[n]}module.exports=function(t,n,r){const e=n.split(\".\");let u=n,l=t;for(const t of e){if(null==l)return r;if(null!=l[u])return l[u];l=getProperty(l,t),u=u.substr(t.length+1)}return null==l?r:l};","node_modules/mongoose-legacy-pluralize/index.js":"module.exports=pluralize,exports.pluralization=[[/(m)an$/gi,\"$1en\"],[/(pe)rson$/gi,\"$1ople\"],[/(child)$/gi,\"$1ren\"],[/^(ox)$/gi,\"$1en\"],[/(ax|test)is$/gi,\"$1es\"],[/(octop|vir)us$/gi,\"$1i\"],[/(alias|status)$/gi,\"$1es\"],[/(bu)s$/gi,\"$1ses\"],[/(buffal|tomat|potat)o$/gi,\"$1oes\"],[/([ti])um$/gi,\"$1a\"],[/sis$/gi,\"ses\"],[/(?:([^f])fe|([lr])f)$/gi,\"$1$2ves\"],[/(hive)$/gi,\"$1s\"],[/([^aeiouy]|qu)y$/gi,\"$1ies\"],[/(x|ch|ss|sh)$/gi,\"$1es\"],[/(matr|vert|ind)ix|ex$/gi,\"$1ices\"],[/([m|l])ouse$/gi,\"$1ice\"],[/(kn|w|l)ife$/gi,\"$1ives\"],[/(quiz)$/gi,\"$1zes\"],[/s$/gi,\"s\"],[/([^a-z])$/,\"$1\"],[/$/gi,\"s\"]];var rules=exports.pluralization;exports.uncountables=[\"advice\",\"energy\",\"excretion\",\"digestion\",\"cooperation\",\"health\",\"justice\",\"labour\",\"machinery\",\"equipment\",\"information\",\"pollution\",\"sewage\",\"paper\",\"money\",\"species\",\"series\",\"rain\",\"rice\",\"fish\",\"sheep\",\"moose\",\"deer\",\"news\",\"expertise\",\"status\",\"media\"];var uncountables=exports.uncountables;function pluralize(e){var i;return e=e.toLowerCase(),!~uncountables.indexOf(e)&&(i=rules.filter(function(i){return e.match(i[0])}))[0]?e.replace(i[0][0],i[0][1]):e}","node_modules/mongoose/lib/utils.js":"\"use strict\";const Decimal=require(\"./types/decimal128\"),ObjectId=require(\"./types/objectid\"),PopulateOptions=require(\"./options/PopulateOptions\"),PromiseProvider=require(\"./promise_provider\"),cloneRegExp=require(\"regexp-clone\"),get=require(\"./helpers/get\"),sliced=require(\"sliced\"),mpath=require(\"mpath\"),ms=require(\"ms\"),symbols=require(\"./helpers/symbols\"),Buffer=require(\"safe-buffer\").Buffer,emittedSymbol=Symbol.for(\"mongoose:emitted\");let MongooseBuffer,MongooseArray,Document;const specialProperties=new Set([\"__proto__\",\"constructor\",\"prototype\"]);function isBsonType(e,t){return get(e,\"_bsontype\",void 0)===t}exports.specialProperties=specialProperties,exports.toCollectionName=function(e,t){return\"system.profile\"===e?e:\"system.indexes\"===e?e:\"function\"==typeof t?t(e):e},exports.deepEqual=function e(t,o){if(t===o)return!0;if(t instanceof Date&&o instanceof Date)return t.getTime()===o.getTime();if(isBsonType(t,\"ObjectID\")&&isBsonType(o,\"ObjectID\")||isBsonType(t,\"Decimal128\")&&isBsonType(o,\"Decimal128\"))return t.toString()===o.toString();if(t instanceof RegExp&&o instanceof RegExp)return t.source===o.source&&t.ignoreCase===o.ignoreCase&&t.multiline===o.multiline&&t.global===o.global;if(\"object\"!=typeof t&&\"object\"!=typeof o)return t==o;if(null===t||null===o||void 0===t||void 0===o)return!1;if(t.prototype!==o.prototype)return!1;if(t instanceof Number&&o instanceof Number)return t.valueOf()===o.valueOf();if(Buffer.isBuffer(t))return exports.buffer.areEqual(t,o);let r,n,s,i;isMongooseObject(t)&&(t=t.toObject()),isMongooseObject(o)&&(o=o.toObject());try{r=Object.keys(t),n=Object.keys(o)}catch(e){return!1}if(r.length!==n.length)return!1;for(r.sort(),n.sort(),i=r.length-1;i>=0;i--)if(r[i]!==n[i])return!1;for(i=r.length-1;i>=0;i--)if(!e(t[s=r[i]],o[s]))return!1;return!0},exports.last=function(e){if(e.length>0)return e[e.length-1]},exports.clone=function(e,t,o){if(null==e)return e;if(Array.isArray(e))return cloneArray(e,t);if(isMongooseObject(e))return t&&t._skipSingleNestedGetters&&e.$isSingleNested&&(t=Object.assign({},t,{getters:!1})),t&&t.json&&\"function\"==typeof e.toJSON?e.toJSON(t):e.toObject(t);if(e.constructor)switch(exports.getFunctionName(e.constructor)){case\"Object\":return cloneObject(e,t,o);case\"Date\":return new e.constructor(+e);case\"RegExp\":return cloneRegExp(e)}return e instanceof ObjectId?new ObjectId(e.id):isBsonType(e,\"Decimal128\")?t&&t.flattenDecimals?e.toJSON():Decimal.fromString(e.toString()):!e.constructor&&exports.isObject(e)?cloneObject(e,t,o):e[symbols.schemaTypeSymbol]?e.clone():t&&t.bson&&\"function\"==typeof e.toBSON?e:null!=e.valueOf?e.valueOf():cloneObject(e,t,o)};const clone=exports.clone;function cloneObject(e,t,o){const r=t&&t.minimize,n={};let s;for(const o in e){if(specialProperties.has(o))continue;const i=clone(e[o],t);r&&void 0===i||(s||(s=!0),n[o]=i)}return r&&!o?s&&n:n}function cloneArray(e,t){const o=[];for(let r=0,n=e.length;r<n;r++)o.push(clone(e[r],t,!0));return o}exports.promiseOrCallback=function(e,t,o){if(\"function\"==typeof e)return t(function(t){if(null==t)e.apply(this,arguments);else{null!=o&&o.listeners(\"error\").length>0&&!t[emittedSymbol]&&(t[emittedSymbol]=!0,o.emit(\"error\",t));try{e(t)}catch(t){return process.nextTick(()=>{throw t})}}});return new(PromiseProvider.get())((e,r)=>{t(function(t,n){return null!=t?(null!=o&&o.listeners(\"error\").length>0&&!t[emittedSymbol]&&(t[emittedSymbol]=!0,o.emit(\"error\",t)),r(t)):arguments.length>2?e(Array.prototype.slice.call(arguments,1)):void e(n)})})},exports.omit=function(e,t){if(null==t)return Object.assign({},e);Array.isArray(t)||(t=[t]);const o=Object.assign({},e);for(const e of t)delete o[e];return o},exports.options=function(e,t){const o=Object.keys(e);let r,n=o.length;for(t=t||{};n--;)(r=o[n])in t||(t[r]=e[r]);return t},exports.random=function(){return Math.random().toString().substr(3)},exports.merge=function e(t,o,r,n){r=r||{};const s=Object.keys(o);let i=0;const c=s.length;let u;n=n||\"\";const p=r.omitNested||{};for(;i<c;)if(u=s[i++],!(r.omit&&r.omit[u]||p[n]||specialProperties.has(u)))if(null==t[u])t[u]=o[u];else if(exports.isObject(o[u])){if(exports.isObject(t[u])||(t[u]={}),null!=o[u]){if(o[u].instanceOfSchema){t[u].instanceOfSchema?t[u].add(o[u].clone()):t[u]=o[u].clone();continue}if(o[u]instanceof ObjectId){t[u]=new ObjectId(o[u]);continue}}e(t[u],o[u],r,n?n+\".\"+u:u)}else r.overwrite&&(t[u]=o[u])},exports.toObject=function e(t){let o;if(Document||(Document=require(\"./document\")),null==t)return t;if(t instanceof Document)return t.toObject();if(Array.isArray(t)){o=[];for(let r=0,n=t.length;r<n;++r)o.push(e(t[r]));return o}if(exports.isPOJO(t)){o={};for(const r in t)specialProperties.has(r)||(o[r]=e(t[r]));return o}return t},exports.isObject=function(e){return!!Buffer.isBuffer(e)||\"[object Object]\"===Object.prototype.toString.call(e)},exports.isPOJO=function(e){if(null==e||\"object\"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return!t||\"Object\"===t.constructor.name},exports.isNativeObject=function(e){return Array.isArray(e)||e instanceof Date||e instanceof Boolean||e instanceof Number||e instanceof String},exports.isEmptyObject=function(e){return null!=e&&\"object\"==typeof e&&0===Object.keys(e).length},exports.hasKey=function(e,t){const o=Object.keys(e);for(const r of o){if(r===t)return!0;if(exports.isPOJO(e[r])&&exports.hasKey(e[r],t))return!0}return!1},exports.args=sliced,exports.tick=function(e){if(\"function\"==typeof e)return function(){try{e.apply(this,arguments)}catch(e){process.nextTick(function(){throw e})}}},exports.isMongooseType=function(e){return e instanceof ObjectId||e instanceof Decimal||e instanceof Buffer},exports.isMongooseObject=function(e){return Document||(Document=require(\"./document\")),MongooseArray||(MongooseArray=require(\"./types\").Array),MongooseBuffer||(MongooseBuffer=require(\"./types\").Buffer),null!=e&&(null!=e.$__||e.isMongooseArray||e.isMongooseBuffer||e.$isMongooseMap)};const isMongooseObject=exports.isMongooseObject;function _populateObj(e){if(Array.isArray(e.populate)){const t=[];e.populate.forEach(function(e){if(/[\\s]/.test(e.path)){const o=Object.assign({},e);o.path.split(\" \").forEach(function(e){o.path=e,t.push(exports.populate(o)[0])})}else t.push(exports.populate(e)[0])}),e.populate=exports.populate(t)}else null!=e.populate&&\"object\"==typeof e.populate&&(e.populate=exports.populate(e.populate));const t=[],o=e.path.split(\" \");null!=e.options&&(e.options=exports.clone(e.options));for(let r=0;r<o.length;++r)t.push(new PopulateOptions(Object.assign({},e,{path:o[r]})));return t}exports.expires=function(e){if(!e||\"Object\"!==e.constructor.name)return;if(!(\"expires\"in e))return;let t;t=\"string\"!=typeof e.expires?e.expires:Math.round(ms(e.expires)/1e3),e.expireAfterSeconds=t,delete e.expires},exports.populate=function(e,t,o,r,n,s,i,c){let u=null;if(1===arguments.length){if(e instanceof PopulateOptions)return[e];if(Array.isArray(e)){return function(e){const t=[];return e.forEach(function(e){/[\\s]/.test(e.path)?e.path.split(\" \").forEach(function(o){const r=Object.assign({},e);r.path=o,t.push(r)}):t.push(e)}),t}(e).map(e=>exports.populate(e)[0])}u=exports.isObject(e)?Object.assign({},e):{path:e}}else u=\"object\"==typeof o?{path:e,select:t,match:o,options:r}:{path:e,select:t,model:o,match:r,options:n,populate:s,justOne:i,count:c};if(\"string\"!=typeof u.path)throw new TypeError(\"utils.populate: invalid path. Expected string. Got typeof `\"+typeof e+\"`\");return _populateObj(u)},exports.getValue=function(e,t,o){return mpath.get(e,t,\"_doc\",o)},exports.setValue=function(e,t,o,r,n){mpath.set(e,t,o,\"_doc\",r,n)},exports.object={},exports.object.vals=function(e){const t=Object.keys(e);let o=t.length;const r=[];for(;o--;)r.push(e[t[o]]);return r},exports.object.shallowCopy=exports.options;const hop=Object.prototype.hasOwnProperty;exports.object.hasOwnProperty=function(e,t){return hop.call(e,t)},exports.isNullOrUndefined=function(e){return null===e||void 0===e},exports.array={},exports.array.flatten=function e(t,o,r){return r||(r=[]),t.forEach(function(t){Array.isArray(t)?e(t,o,r):o&&!o(t)||r.push(t)}),r};const _hasOwnProperty=Object.prototype.hasOwnProperty;exports.hasUserDefinedProperty=function(e,t){if(null==e)return!1;if(Array.isArray(t)){for(const o of t)if(exports.hasUserDefinedProperty(e,o))return!0;return!1}if(_hasOwnProperty.call(e,t))return!0;if(t in e){const o=e[t];return o!==Object.prototype[t]&&o!==Array.prototype[t]}return!1};const MAX_ARRAY_INDEX=Math.pow(2,32)-1;exports.isArrayIndex=function(e){return\"number\"==typeof e?e>=0&&e<=MAX_ARRAY_INDEX:\"string\"==typeof e&&(!!/^\\d+$/.test(e)&&((e=+e)>=0&&e<=MAX_ARRAY_INDEX))},exports.array.unique=function(e){const t={},o={},r=[],n=e.length;for(let s=0;s<n;++s)if(\"number\"==typeof e[s]||\"string\"==typeof e[s]||null==e[s]){if(t[e[s]])continue;r.push(e[s]),t[e[s]]=!0}else if(e[s]instanceof ObjectId){if(o[e[s].toString()])continue;r.push(e[s]),o[e[s].toString()]=!0}else r.push(e[s]);return r},exports.buffer={},exports.buffer.areEqual=function(e,t){if(!Buffer.isBuffer(e))return!1;if(!Buffer.isBuffer(t))return!1;if(e.length!==t.length)return!1;for(let o=0,r=e.length;o<r;++o)if(e[o]!==t[o])return!1;return!0},exports.getFunctionName=function(e){return e.name?e.name:(e.toString().trim().match(/^function\\s*([^\\s(]+)/)||[])[1]},exports.decorate=function(e,t){for(const o in t)specialProperties.has(o)||(e[o]=t[o])},exports.mergeClone=function(e,t){isMongooseObject(t)&&(t=t.toObject({transform:!1,virtuals:!1,depopulate:!0,getters:!1,flattenDecimals:!1}));const o=Object.keys(t),r=o.length;let n,s=0;for(;s<r;)if(n=o[s++],!specialProperties.has(n))if(void 0===e[n])e[n]=exports.clone(t[n],{transform:!1,virtuals:!1,depopulate:!0,getters:!1,flattenDecimals:!1});else{let o=t[n];if(null==o||!o.valueOf||o instanceof Date||(o=o.valueOf()),exports.isObject(o)){let t=o;isMongooseObject(o)&&!o.isMongooseBuffer&&(t=t.toObject({transform:!1,virtuals:!1,depopulate:!0,getters:!1,flattenDecimals:!1})),o.isMongooseBuffer&&(t=Buffer.from(t)),exports.mergeClone(e[n],t)}else e[n]=exports.clone(o,{flattenDecimals:!1})}},exports.each=function(e,t){for(let o=0;o<e.length;++o)t(e[o])},exports.getOption=function(e){const t=Array.prototype.slice.call(arguments,1);for(const o of t)if(null!=o[e])return o[e];return null},exports.noop=function(){};","node_modules/mongoose/package.json":{"_from":"mongoose@^5.7.12","_id":"mongoose@5.7.12","_inBundle":false,"_integrity":"sha512-TqRiJPUeHN1u7Xs/zQmiMHcrzEb1/uKjK3uGzZhyqw25RKQiMV2vSBeBTMt5HXoYlUuDEWXE75FMjpK9X9kD0w==","_location":"/mongoose","_phantomChildren":{"bson":"1.1.3","require_optional":"1.0.1","safe-buffer":"5.1.2","saslprep":"1.0.3"},"_requested":{"type":"range","registry":true,"raw":"mongoose@^5.7.12","name":"mongoose","escapedName":"mongoose","rawSpec":"^5.7.12","saveSpec":null,"fetchSpec":"^5.7.12"},"_requiredBy":["/"],"_resolved":"https://registry.npmjs.org/mongoose/-/mongoose-5.7.12.tgz","_shasum":"ef22a0f741970b6ba504995fdbe0ac9d8289d615","_spec":"mongoose@^5.7.12","_where":"C:\\Workspace\\walkner\\walkner-snf","author":{"name":"Guillermo Rauch","email":"guillermo@learnboost.com"},"browser":"./browser.js","bugs":{"url":"https://github.com/Automattic/mongoose/issues/new"},"bundleDependencies":false,"dependencies":{"bson":"~1.1.1","kareem":"2.3.1","mongodb":"3.3.4","mongoose-legacy-pluralize":"1.0.2","mpath":"0.6.0","mquery":"3.2.2","ms":"2.1.2","regexp-clone":"1.0.0","safe-buffer":"5.1.2","sift":"7.0.1","sliced":"1.0.1"},"deprecated":false,"description":"Mongoose MongoDB ODM","devDependencies":{"acorn":"5.7.3","acquit":"1.x","acquit-ignore":"0.1.x","acquit-require":"0.1.x","async":"2.6.2","babel-loader":"7.1.4","babel-preset-es2015":"6.24.1","benchmark":"2.1.4","bluebird":"3.5.5","chalk":"2.4.2","cheerio":"1.0.0-rc.2","co":"4.6.0","dox":"0.3.1","eslint":"5.16.0","highlight.js":"9.1.0","lodash.isequal":"4.5.0","lodash.isequalwith":"4.4.0","marked":"0.6.2","mocha":"5.x","moment":"2.x","mongodb-topology-manager":"1.0.11","mongoose-long":"0.2.1","node-static":"0.7.11","nyc":"14.1.1","object-sizeof":"1.3.0","promise-debug":"0.1.1","pug":"2.0.3","q":"1.5.1","semver":"5.5.0","uuid":"2.0.3","uuid-parse":"1.0.0","validator":"10.8.0","webpack":"4.16.4"},"directories":{"lib":"./lib/mongoose"},"engines":{"node":">=4.0.0"},"eslintConfig":{"extends":["eslint:recommended"],"parserOptions":{"ecmaVersion":2015},"env":{"node":true,"es6":true},"rules":{"comma-style":"error","indent":["error",2,{"SwitchCase":1,"VariableDeclarator":2}],"keyword-spacing":"error","no-buffer-constructor":"warn","no-console":"off","no-multi-spaces":"error","no-constant-condition":"off","func-call-spacing":"error","no-trailing-spaces":"error","quotes":["error","single"],"semi":"error","space-before-blocks":"error","space-before-function-paren":["error","never"],"space-infix-ops":"error","space-unary-ops":"error","no-var":"warn","prefer-const":"warn","strict":["error","global"],"no-restricted-globals":["error",{"name":"context","message":"Don't use Mocha's global context"}]}},"homepage":"https://mongoosejs.com","keywords":["mongodb","document","model","schema","database","odm","data","datastore","query","nosql","orm","db"],"license":"MIT","main":"./index.js","mocha":{"extension":["test.js"],"watch-files":["test/**/*.js"]},"name":"mongoose","repository":{"type":"git","url":"git://github.com/Automattic/mongoose.git"},"scripts":{"lint":"eslint .","release":"git pull && git push origin master --tags && npm publish","release-legacy":"git pull origin 4.x && git push origin 4.x --tags && npm publish --tag legacy","test":"mocha --exit","test-cov":"nyc --reporter=html --reporter=text npm test"},"version":"5.7.12"},"node_modules/mongoose/lib/cast.js":"\"use strict\";const StrictModeError=require(\"./error/strict\"),Types=require(\"./schema/index\"),castTextSearch=require(\"./schema/operators/text\"),get=require(\"./helpers/get\"),util=require(\"util\"),utils=require(\"./utils\"),ALLOWED_GEOWITHIN_GEOJSON_TYPES=[\"Polygon\",\"MultiPolygon\"];function _cast(e,t,r){if(Array.isArray(e))e.forEach(function(i,n){if(Array.isArray(i)||utils.isObject(i))return _cast(i,t,r);e[n]=t.castForQueryWrapper({val:i,context:r})});else{const i=Object.keys(e);let n=i.length;for(;n--;){const o=i[n],s=e[o];Array.isArray(s)||utils.isObject(s)?(_cast(s,t,r),e[o]=s):e[o]=t.castForQuery({val:s,context:r})}}}module.exports=function e(t,r,i,n){if(Array.isArray(r))throw new Error(\"Query filter must be an object, got an array \",util.inspect(r));r.hasOwnProperty(\"_bsontype\")&&\"ObjectID\"!==r._bsontype&&delete r._bsontype;const o=Object.keys(r);let s,c,a,l,u,y,$,f=o.length;for(i=i||{};f--;)if($=r[u=o[f]],\"$or\"===u||\"$nor\"===u||\"$and\"===u){let r=$.length;for(;r--;)$[r]=e(t,$[r],i,n)}else{if(\"$where\"===u){if(\"string\"!==(y=typeof $)&&\"function\"!==y)throw new Error(\"Must have a string or function for $where\");\"function\"===y&&(r[u]=$.toString());continue}if(\"$elemMatch\"===u)$=e(t,$,i,n);else if(\"$text\"===u)$=castTextSearch($,u);else{if(!t)continue;if(!(a=t.path(u))){const e=u.split(\".\");let i=e.length;for(;i--;){const n=e.slice(0,i).join(\".\"),o=e.slice(i).join(\".\"),s=t.path(n),c=get(s,\"schema.options.discriminatorKey\");if(null!=s&&null!=get(s,\"schema.discriminators\")&&null!=c&&o!==c){const e=get(r,n+\".\"+c);null!=e&&(a=s.schema.discriminators[e].path(o))}}}if(a){if(null==$)continue;if(\"Object\"===$.constructor.name)if(c=Object.keys($).some(function(e){return e.startsWith(\"$\")&&\"$id\"!==e&&\"$ref\"!==e})){const r=Object.keys($);let o,c=r.length;for(;c--;)if(l=$[o=r[c]],\"$not\"===o){if(l&&a&&!a.caster){if((s=Object.keys(l)).length&&s[0].startsWith(\"$\"))for(const e in l)l[e]=a.castForQueryWrapper({$conditional:e,val:l[e],context:n});else $[o]=a.castForQueryWrapper({$conditional:o,val:l,context:n});continue}e(a.caster?a.caster.schema:t,l,i,n)}else $[o]=a.castForQueryWrapper({$conditional:o,val:l,context:n})}else r[u]=a.castForQueryWrapper({val:$,context:n});else if(Array.isArray($)&&-1===[\"Buffer\",\"Array\"].indexOf(a.instance)){const e=[];for(let t=0;t<$.length;t++)e.push(a.castForQueryWrapper({val:$[t],context:n}));r[u]={$in:e}}else r[u]=a.castForQueryWrapper({val:$,context:n})}else{const o=u.split(\".\");let s,c,l,y=o.length;for(;y--&&(s=o.slice(0,y).join(\".\"),!(a=t.path(s))););if(a){a.caster&&a.caster.schema?((l={})[c=o.slice(y).join(\".\")]=$,r[u]=e(a.caster.schema,l,i,n)[c]):r[u]=$;continue}if(utils.isObject($)){let e=\"\";if($.$near?e=\"$near\":$.$nearSphere?e=\"$nearSphere\":$.$within?e=\"$within\":$.$geoIntersects?e=\"$geoIntersects\":$.$geoWithin&&(e=\"$geoWithin\"),e){const t=new Types.Number(\"__QueryCasting__\");let r=$[e];if(null!=$.$maxDistance&&($.$maxDistance=t.castForQueryWrapper({val:$.$maxDistance,context:n})),null!=$.$minDistance&&($.$minDistance=t.castForQueryWrapper({val:$.$minDistance,context:n})),\"$within\"===e){const e=r.$center||r.$centerSphere||r.$box||r.$polygon;if(!e)throw new Error(\"Bad $within parameter: \"+JSON.stringify($));r=e}else if(\"$near\"===e&&\"string\"==typeof r.type&&Array.isArray(r.coordinates))r=r.coordinates;else if((\"$near\"===e||\"$nearSphere\"===e||\"$geoIntersects\"===e)&&r.$geometry&&\"string\"==typeof r.$geometry.type&&Array.isArray(r.$geometry.coordinates))null!=r.$maxDistance&&(r.$maxDistance=t.castForQueryWrapper({val:r.$maxDistance,context:n})),null!=r.$minDistance&&(r.$minDistance=t.castForQueryWrapper({val:r.$minDistance,context:n})),utils.isMongooseObject(r.$geometry)&&(r.$geometry=r.$geometry.toObject({transform:!1,virtuals:!1})),r=r.$geometry.coordinates;else if(\"$geoWithin\"===e)if(r.$geometry){utils.isMongooseObject(r.$geometry)&&(r.$geometry=r.$geometry.toObject({virtuals:!1}));const e=r.$geometry.type;if(-1===ALLOWED_GEOWITHIN_GEOJSON_TYPES.indexOf(e))throw new Error('Invalid geoJSON type for $geoWithin \"'+e+'\", must be \"Polygon\" or \"MultiPolygon\"');r=r.$geometry.coordinates}else r=r.$box||r.$polygon||r.$center||r.$centerSphere,utils.isMongooseObject(r)&&(r=r.toObject({virtuals:!1}));_cast(r,t,n);continue}}if(t.nested[u])continue;if(i.upsert&&i.strict){if(\"throw\"===i.strict)throw new StrictModeError(u);throw new StrictModeError(u,'Path \"'+u+'\" is not in schema, strict mode is `true`, and upsert is `true`.')}if(\"throw\"===i.strictQuery)throw new StrictModeError(u,'Path \"'+u+\"\\\" is not in schema and strictQuery is 'throw'.\");i.strictQuery&&delete r[u]}}}return r};","node_modules/mongoose/lib/plugins/removeSubdocs.js":"\"use strict\";const each=require(\"../helpers/each\");module.exports=function(e){e.s.hooks.pre(\"remove\",!1,function(e){if(this.ownerDocument)return void e();const o=this,r=this.$__getAllSubdocs();each(r,function(e,o){e.$__remove(o)},function(r){if(r)return o.schema.s.hooks.execPost(\"remove:error\",o,[o],{error:r},function(o){e(o)});e()})},null,!0)};","node_modules/mongoose/lib/plugins/saveSubdocs.js":"\"use strict\";const each=require(\"../helpers/each\");module.exports=function(e){e.s.hooks.pre(\"save\",!1,function(e){if(this.ownerDocument)return void e();const o=this,s=this.$__getAllSubdocs();s.length?each(s,function(e,o){e.schema.s.hooks.execPre(\"save\",e,function(e){o(e)})},function(s){if(s)return o.schema.s.hooks.execPost(\"save:error\",o,[o],{error:s},function(o){e(o)});e()}):e()},null,!0),e.s.hooks.post(\"save\",function(e,o){if(this.ownerDocument)return void o();const s=this,n=this.$__getAllSubdocs();n.length?each(n,function(e,o){e.schema.s.hooks.execPost(\"save\",e,[e],function(e){o(e)})},function(e){if(e)return s.schema.s.hooks.execPost(\"save:error\",s,[s],{error:e},function(e){o(e)});o()}):o()},null,!0)};","node_modules/mongoose/lib/plugins/validateBeforeSave.js":"\"use strict\";module.exports=function(e){e.pre(\"save\",!1,function(e,t){const i=this;if(this.ownerDocument)return e();let o;if(o=t&&\"object\"==typeof t&&\"validateBeforeSave\"in t?!!t.validateBeforeSave:this.schema.options.validateBeforeSave){const o=t&&\"object\"==typeof t&&\"validateModifiedOnly\"in t?{validateModifiedOnly:t.validateModifiedOnly}:null;this.validate(o,function(t){return i.schema.s.hooks.execPost(\"save:error\",i,[i],{error:t},function(t){e(t)})})}else e()},null,!0)};","node_modules/mongoose/lib/aggregate.js":"\"use strict\";const AggregationCursor=require(\"./cursor/AggregationCursor\"),Query=require(\"./query\"),applyGlobalMaxTimeMS=require(\"./helpers/query/applyGlobalMaxTimeMS\"),util=require(\"util\"),utils=require(\"./utils\"),read=Query.prototype.read,readConcern=Query.prototype.readConcern;function Aggregate(t){this._pipeline=[],this._model=void 0,this.options={},1===arguments.length&&util.isArray(t)&&this.append.apply(this,t)}function isOperator(t){if(\"object\"!=typeof t)return!1;const e=Object.keys(t);return 1===e.length&&e.some(t=>\"$\"===t[0])}function prepareDiscriminatorPipeline(t){const e=t._model.schema,r=e&&e.discriminatorMapping;if(r&&!r.isRoot){const e=t._pipeline,o=r.key,n=r.value;if(e[0]&&e[0].$match&&!e[0].$match[o])e[0].$match[o]=n;else if(e[0]&&e[0].$geoNear)e[0].$geoNear.query=e[0].$geoNear.query||{},e[0].$geoNear.query[o]=n;else{const e={};e[o]=n,t._pipeline.unshift({$match:e})}}}Aggregate.prototype.options,Aggregate.prototype.model=function(t){return 0===arguments.length?this._model:(this._model=t,null!=t.schema&&(null==this.options.readPreference&&null!=t.schema.options.read&&(this.options.readPreference=t.schema.options.read),null==this.options.collation&&null!=t.schema.options.collation&&(this.options.collation=t.schema.options.collation)),this)},Aggregate.prototype.append=function(){const t=1===arguments.length&&util.isArray(arguments[0])?arguments[0]:utils.args(arguments);if(!t.every(isOperator))throw new Error(\"Arguments must be aggregate pipeline operators\");return this._pipeline=this._pipeline.concat(t),this},Aggregate.prototype.addFields=function(t){const e={};if(\"object\"!=typeof t||util.isArray(t))throw new Error(\"Invalid addFields() argument. Must be an object\");return Object.keys(t).forEach(function(r){e[r]=t[r]}),this.append({$addFields:e})},Aggregate.prototype.project=function(t){const e={};if(\"object\"!=typeof t||util.isArray(t)){if(1!==arguments.length||\"string\"!=typeof t)throw new Error(\"Invalid project() argument. Must be string or object\");t.split(/\\s+/).forEach(function(t){if(!t)return;const r=\"-\"===t[0]?0:1;0===r&&(t=t.substring(1)),e[t]=r})}else Object.keys(t).forEach(function(r){e[r]=t[r]});return this.append({$project:e})},Aggregate.prototype.near=function(t){const e={};return e.$geoNear=t,this.append(e)},\"group match skip limit out\".split(\" \").forEach(function(t){Aggregate.prototype[t]=function(e){const r={};return r[\"$\"+t]=e,this.append(r)}}),Aggregate.prototype.unwind=function(){const t=utils.args(arguments),e=[];for(let r=0;r<t.length;++r){const o=t[r];if(o&&\"object\"==typeof o)e.push({$unwind:o});else{if(\"string\"!=typeof o)throw new Error('Invalid arg \"'+o+'\" to unwind(), must be string or object');e.push({$unwind:o&&o.startsWith(\"$\")?o:\"$\"+o})}}return this.append.apply(this,e)},Aggregate.prototype.replaceRoot=function(t){let e;return e=\"string\"==typeof t?t.startsWith(\"$\")?t:\"$\"+t:t,this.append({$replaceRoot:{newRoot:e}})},Aggregate.prototype.count=function(t){return this.append({$count:t})},Aggregate.prototype.sortByCount=function(t){if(t&&\"object\"==typeof t)return this.append({$sortByCount:t});if(\"string\"==typeof t)return this.append({$sortByCount:t&&t.startsWith(\"$\")?t:\"$\"+t});throw new TypeError('Invalid arg \"'+t+'\" to sortByCount(), must be string or object')},Aggregate.prototype.lookup=function(t){return this.append({$lookup:t})},Aggregate.prototype.graphLookup=function(t){const e={};if(t){if(!utils.isObject(t))throw new TypeError(\"Invalid graphLookup() argument. Must be an object.\");utils.mergeClone(e,t);const r=e.startWith;r&&\"string\"==typeof r&&(e.startWith=e.startWith.startsWith(\"$\")?e.startWith:\"$\"+e.startWith)}return this.append({$graphLookup:e})},Aggregate.prototype.sample=function(t){return this.append({$sample:{size:t}})},Aggregate.prototype.sort=function(t){const e={};if(\"Object\"===t.constructor.name){const r=[\"desc\",\"descending\",-1];Object.keys(t).forEach(function(o){t[o]instanceof Object&&t[o].$meta?e[o]=t[o]:e[o]=-1===r.indexOf(t[o])?1:-1})}else{if(1!==arguments.length||\"string\"!=typeof t)throw new TypeError(\"Invalid sort() argument. Must be a string or object.\");t.split(/\\s+/).forEach(function(t){if(!t)return;const r=\"-\"===t[0]?-1:1;-1===r&&(t=t.substring(1)),e[t]=r})}return this.append({$sort:e})},Aggregate.prototype.read=function(t,e){return this.options||(this.options={}),read.call(this,t,e),this},Aggregate.prototype.readConcern=function(t){return this.options||(this.options={}),readConcern.call(this,t),this},Aggregate.prototype.redact=function(t,e,r){if(3===arguments.length){if(\"string\"==typeof e&&!e.startsWith(\"$$\")||\"string\"==typeof r&&!r.startsWith(\"$$\"))throw new Error(\"If thenExpr or elseExpr is string, it must start with $$. e.g. $$DESCEND, $$PRUNE, $$KEEP\");t={$cond:{if:t,then:e,else:r}}}else if(1!==arguments.length)throw new TypeError(\"Invalid arguments\");return this.append({$redact:t})},Aggregate.prototype.explain=function(t){return utils.promiseOrCallback(t,t=>{if(!this._pipeline.length){const e=new Error(\"Aggregate has empty pipeline\");return t(e)}prepareDiscriminatorPipeline(this),this._model.collection.aggregate(this._pipeline,this.options||{}).explain(function(e,r){if(e)return t(e);t(null,r)})},this._model.events)},Aggregate.prototype.allowDiskUse=function(t){return this.options.allowDiskUse=t,this},Aggregate.prototype.hint=function(t){return this.options.hint=t,this},Aggregate.prototype.session=function(t){return null==t?delete this.options.session:this.options.session=t,this},Aggregate.prototype.option=function(t){for(const e in t)this.options[e]=t[e];return this},Aggregate.prototype.cursor=function(t){return this.options||(this.options={}),this.options.cursor=t||{},this},Aggregate.prototype.addCursorFlag=util.deprecate(function(t,e){return this.options||(this.options={}),this.options[t]=e,this},\"Mongoose: `Aggregate#addCursorFlag()` is deprecated, use `option()` instead\"),Aggregate.prototype.collation=function(t){return this.options||(this.options={}),this.options.collation=t,this},Aggregate.prototype.facet=function(t){return this.append({$facet:t})},Aggregate.prototype.pipeline=function(){return this._pipeline},Aggregate.prototype.exec=function(t){if(!this._model)throw new Error(\"Aggregate not bound to any Model\");const e=this._model,r=this._model.collection;return applyGlobalMaxTimeMS(this.options,e),this.options&&this.options.cursor?new AggregationCursor(this):utils.promiseOrCallback(t,t=>{prepareDiscriminatorPipeline(this),e.hooks.execPre(\"aggregate\",this,o=>{if(o){const r={error:o};return e.hooks.execPost(\"aggregate\",this,[null],r,e=>{t(e)})}if(!this._pipeline.length)return t(new Error(\"Aggregate has empty pipeline\"));const n=utils.clone(this.options||{});r.aggregate(this._pipeline,n,(r,o)=>{if(r){const o={error:r};return e.hooks.execPost(\"aggregate\",this,[null],o,e=>t(e||null))}o.toArray((r,o)=>{const n={error:r};e.hooks.execPost(\"aggregate\",this,[o],n,(e,r)=>{if(e)return t(e);t(null,r)})})})})},e.events)},Aggregate.prototype.then=function(t,e){return this.exec().then(t,e)},Aggregate.prototype.catch=function(t){return this.exec().then(null,t)},null!=Symbol.asyncIterator&&(Aggregate.prototype[Symbol.asyncIterator]=function(){return this.cursor({useMongooseAggCursor:!0}).exec().transformNull().map(t=>null==t?{done:!0}:{value:t,done:!1})}),Aggregate._prepareDiscriminatorPipeline=prepareDiscriminatorPipeline,module.exports=Aggregate;","node_modules/mongoose/lib/promise_provider.js":"\"use strict\";const assert=require(\"assert\"),mquery=require(\"mquery\"),store={_promise:null,get:function(){return store._promise},set:function(e){assert.ok(\"function\"==typeof e,`mongoose.Promise must be a function, got ${e}`),store._promise=e,mquery.Promise=e}};store.set(global.Promise),module.exports=store;","node_modules/mongoose/lib/plugins/sharding.js":"\"use strict\";const objectIdSymbol=require(\"../helpers/symbols\").objectIdSymbol,utils=require(\"../utils\");function applyWhere(){let e,t;if(this.$__.shardval){t=(e=Object.keys(this.$__.shardval)).length,this.$where=this.$where||{};for(let s=0;s<t;++s)this.$where[e[s]]=this.$__.shardval[e[s]]}}function storeShard(){const e=this.schema.options.shardKey||this.schema.options.shardkey;if(!utils.isPOJO(e))return;const t=this.$__.shardval={},s=Object.keys(e),o=s.length;let i;for(let e=0;e<o;++e)null==(i=this.$__getValue(s[e]))?t[s[e]]=i:utils.isMongooseObject(i)?t[s[e]]=i.toObject({depopulate:!0,_isNested:!0}):i instanceof Date||i[objectIdSymbol]?t[s[e]]=i:\"function\"==typeof i.valueOf?t[s[e]]=i.valueOf():t[s[e]]=i}module.exports=function(e){e.post(\"init\",function(){return storeShard.call(this),this}),e.pre(\"save\",function(e){applyWhere.call(this),e()}),e.pre(\"remove\",function(e){applyWhere.call(this),e()}),e.post(\"save\",function(){storeShard.call(this)})},module.exports.storeShard=storeShard;","node_modules/mongoose/lib/helpers/printJestWarning.js":"\"use strict\";\"undefined\"!=typeof jest&&\"undefined\"!=typeof window&&console.warn(\"Mongoose: looks like you're trying to test a Mongoose app with Jest's default jsdom test environment. Please make sure you read Mongoose's docs on configuring Jest to test Node.js apps: http://mongoosejs.com/docs/jest.html\");","node_modules/mongoose/lib/drivers/node-mongodb-native/connection.js":"\"use strict\";const MongooseConnection=require(\"../../connection\"),STATES=require(\"../../connectionstate\");function NativeConnection(){MongooseConnection.apply(this,arguments),this._listening=!1}function listen(e){e.db._listening||(e.db._listening=!0,e.db.on(\"close\",function(t){if(!e._closeCalled)return e.db.serverConfig.autoReconnect?(e.readyState=STATES.disconnected,void e.emit(\"close\")):void e.onClose(t)}),e.db.on(\"error\",function(t){e.emit(\"error\",t)}),e.db.on(\"reconnect\",function(){e.readyState=STATES.connected,e.emit(\"reconnect\"),e.emit(\"reconnected\"),e.onOpen()}),e.db.on(\"timeout\",function(t){e.emit(\"timeout\",t)}),e.db.on(\"open\",function(t,n){STATES.disconnected===e.readyState&&n&&n.databaseName&&(e.readyState=STATES.connected,e.emit(\"reconnect\"),e.emit(\"reconnected\"))}),e.db.on(\"parseError\",function(t){e.emit(\"parseError\",t)}))}NativeConnection.STATES=STATES,NativeConnection.prototype.__proto__=MongooseConnection.prototype,NativeConnection.prototype.useDb=function(e,t){if(t&&t.useCache&&this.relatedDbs[e])return this.relatedDbs[e];const n=new this.constructor;n.name=e,n.base=this.base,n.collections={},n.models={},n.replica=this.replica,n.name=this.name,n.options=this.options,n._readyState=this._readyState,n._closeCalled=this._closeCalled,n._hasOpened=this._hasOpened,n._listening=!1,n.host=this.host,n.port=this.port,n.user=this.user,n.pass=this.pass;const o=this;function i(){n.client=o.client,n.db=o.client.db(e),n.onOpen(),listen(n)}return n.client=o.client,this.db&&this._readyState===STATES.connected?i():this.once(\"connected\",i),n.name=e,this.otherDbs.push(n),n.otherDbs.push(this),t&&t.useCache&&(this.relatedDbs[n.name]=n,n.relatedDbs=this.relatedDbs),n},NativeConnection.prototype.doClose=function(e,t){return this.client.close(e,(e,n)=>{setTimeout(()=>t(e,n),1)}),this},module.exports=NativeConnection;","node_modules/mongoose/lib/drivers/node-mongodb-native/collection.js":"\"use strict\";const MongooseCollection=require(\"../../collection\"),MongooseError=require(\"../../error/mongooseError\"),Collection=require(\"mongodb\").Collection,get=require(\"../../helpers/get\"),sliced=require(\"sliced\"),stream=require(\"stream\"),util=require(\"util\");function NativeCollection(t,o){this.collection=null,this.Promise=o.Promise||Promise,MongooseCollection.apply(this,arguments)}NativeCollection.prototype.__proto__=MongooseCollection.prototype,NativeCollection.prototype.onOpen=function(){const t=this;return t.opts.capped.size?t.conn.db.collection(t.name,function(e,n){if(e)return o(e);t.conn.db.listCollections({name:t.name}).toArray(function(e,i){if(e)return o(e);const c=i[0];if(!!c)if(c.options&&c.options.capped)o(null,n);else{const n=\"A non-capped collection exists with the name: \"+t.name+\"\\n\\n To use this collection as a capped collection, please first convert it.\\n http://www.mongodb.org/display/DOCS/Capped+Collections#CappedCollections-Convertingacollectiontocapped\";o(e=new Error(n))}else{const e=Object.assign({},t.opts.capped);e.capped=!0,t.conn.db.createCollection(t.name,e,o)}})}):(o(null,t.conn.db.collection(t.name)),t.collection);function o(o,e){o?t.conn.emit(\"error\",o):(t.collection=e,MongooseCollection.prototype.onOpen.call(t))}},NativeCollection.prototype.onClose=function(t){MongooseCollection.prototype.onClose.call(this,t)};const syncCollectionMethods={watch:!0};function iter(t){NativeCollection.prototype[t]=function(){const o=this.collection,e=Array.from(arguments),n=this,i=get(n,\"conn.base.options.debug\"),c=arguments[arguments.length-1];if(this.conn.$wasForceClosed){const t=new MongooseError(\"Connection was force closed\");if(e.length>0&&\"function\"==typeof e[e.length-1])return void e[e.length-1](t);throw t}if(this.buffer){if(syncCollectionMethods[t])throw new Error(\"Collection method \"+t+\" is synchronous\");return\"function\"==typeof c?void this.addQueue(t,e):new this.Promise((o,n)=>{this.addQueue(t,[].concat(e).concat([(t,e)=>{if(null!=t)return n(t);o(e)}]))})}i&&(\"function\"==typeof i?i.apply(n,[n.name,t].concat(sliced(e,0,e.length-1))):i instanceof stream.Writable?this.$printToStream(n.name,t,e,i):this.$print(n.name,t,e,void 0===i.color||i.color));try{return o[t].apply(o,e)}catch(t){if(!(e.length>0&&\"function\"==typeof e[e.length-1]))throw t;e[e.length-1](t)}}}for(const t in Collection.prototype){try{if(\"function\"!=typeof Collection.prototype[t])continue}catch(t){continue}iter(t)}function inspectable(t){const o={inspect:function(){return t}};return util.inspect.custom&&(o[util.inspect.custom]=o.inspect),o}function map(t){return format(t,!0)}function formatObjectId(t,o){t[o]=inspectable('ObjectId(\"'+t[o].toHexString()+'\")')}function formatDate(t,o){t[o]=inspectable('new Date(\"'+t[o].toUTCString()+'\")')}function format(t,o,e){if(t&&\"function\"==typeof t.toBSON&&(t=t.toBSON()),null==t)return t;let n=require(\"../../utils\").clone(t,{transform:!1});if(\"Binary\"===n.constructor.name)n=\"BinData(\"+n.sub_type+', \"'+n.toString(\"base64\")+'\")';else if(\"ObjectID\"===n.constructor.name)n=inspectable('ObjectId(\"'+n.toHexString()+'\")');else if(\"Date\"===n.constructor.name)n=inspectable('new Date(\"'+n.toUTCString()+'\")');else if(\"Object\"===n.constructor.name){const t=Object.keys(n),o=t.length;let e;for(let i=0;i<o;++i)if(n[e=t[i]]){let t;if(\"function\"==typeof n[e].toBSON)try{n[e]=n[e].toBSON()}catch(o){t=o}if(\"Binary\"===n[e].constructor.name)n[e]=\"BinData(\"+n[e].sub_type+', \"'+n[e].buffer.toString(\"base64\")+'\")';else if(\"Object\"===n[e].constructor.name)n[e]=format(n[e],!0);else if(\"ObjectID\"===n[e].constructor.name)formatObjectId(n,e);else if(\"Date\"===n[e].constructor.name)formatDate(n,e);else if(\"ClientSession\"===n[e].constructor.name)n[e]=inspectable('ClientSession(\"'+get(n[e],\"id.id.buffer\",\"\").toString(\"hex\")+'\")');else if(Array.isArray(n[e]))n[e]=n[e].map(map);else if(null!=t)throw t}}return o?n:util.inspect(n,!1,10,e).replace(/\\n/g,\"\").replace(/\\s{2,}/g,\" \")}NativeCollection.prototype.$print=function(t,o,e,n){const i=n?\"\u001b[0;36mMongoose:\u001b[0m \":\"Mongoose: \",c=[t,o].join(\".\"),r=[];for(let t=e.length-1;t>=0;--t)(this.$format(e[t])||r.length)&&r.unshift(this.$format(e[t],n));const l=\"(\"+r.join(\", \")+\")\";console.info(i+c+l)},NativeCollection.prototype.$printToStream=function(t,o,e,n){const i=[t,o].join(\".\"),c=[];for(let t=e.length-1;t>=0;--t)(this.$format(e[t])||c.length)&&c.unshift(this.$format(e[t]));const r=\"(\"+c.join(\", \")+\")\";n.write(i+r,\"utf8\")},NativeCollection.prototype.$format=function(t,o){const e=typeof t;return\"function\"===e||\"undefined\"===e?\"\":format(t,!1,o)},NativeCollection.prototype.getIndexes=NativeCollection.prototype.indexInformation,module.exports=NativeCollection;","node_modules/mongoose/lib/document_provider.js":"\"use strict\";const Document=require(\"./document.js\"),BrowserDocument=require(\"./browserDocument.js\");let isBrowser=!1;module.exports=function(){return isBrowser?BrowserDocument:Document},module.exports.setBrowser=function(e){isBrowser=e};","node_modules/mongoose/lib/error/index.js":"\"use strict\";const MongooseError=require(\"./mongooseError\");module.exports=exports=MongooseError,MongooseError.messages=require(\"./messages\"),MongooseError.Messages=MongooseError.messages,MongooseError.DocumentNotFoundError=require(\"./notFound\"),MongooseError.CastError=require(\"./cast\"),MongooseError.ValidationError=require(\"./validation\"),MongooseError.ValidatorError=require(\"./validator\"),MongooseError.VersionError=require(\"./version\"),MongooseError.ParallelSaveError=require(\"./parallelSave\"),MongooseError.OverwriteModelError=require(\"./overwriteModel\"),MongooseError.MissingSchemaError=require(\"./missingSchema\"),MongooseError.DivergentArrayError=require(\"./divergentArray\"),MongooseError.StrictModeError=require(\"./strict\");","node_modules/mongoose/lib/error/cast.js":"\"use strict\";const MongooseError=require(\"./mongooseError\"),util=require(\"util\");function CastError(r,t,o,e){let s=util.inspect(t);(s=s.replace(/^'/,'\"').replace(/'$/,'\"')).startsWith('\"')||(s='\"'+s+'\"'),MongooseError.call(this,\"Cast to \"+r+\" failed for value \"+s+' at path \"'+o+'\"'),this.name=\"CastError\",Error.captureStackTrace?Error.captureStackTrace(this):this.stack=(new Error).stack,this.stringValue=s,this.kind=r,this.value=t,this.path=o,this.reason=e}CastError.prototype=Object.create(MongooseError.prototype),CastError.prototype.constructor=MongooseError,CastError.prototype.setModel=function(r){this.model=r,this.message=\"Cast to \"+this.kind+\" failed for value \"+this.stringValue+' at path \"'+this.path+'\" for model \"'+r.modelName+'\"'},module.exports=CastError;","node_modules/mongoose/lib/options/SchemaTypeOptions.js":"\"use strict\";const utils=require(\"../utils\");class SchemaTypeOptions{constructor(e){if(null==e)return this;Object.assign(this,utils.clone(e))}}const opts=require(\"./propertyOptions\");Object.defineProperty(SchemaTypeOptions.prototype,\"type\",opts),Object.defineProperty(SchemaTypeOptions.prototype,\"validate\",opts),Object.defineProperty(SchemaTypeOptions.prototype,\"required\",opts),Object.defineProperty(SchemaTypeOptions.prototype,\"default\",opts),Object.defineProperty(SchemaTypeOptions.prototype,\"ref\",opts),Object.defineProperty(SchemaTypeOptions.prototype,\"select\",opts),Object.defineProperty(SchemaTypeOptions.prototype,\"index\",opts),Object.defineProperty(SchemaTypeOptions.prototype,\"unique\",opts),Object.defineProperty(SchemaTypeOptions.prototype,\"immutable\",opts),Object.defineProperty(SchemaTypeOptions.prototype,\"sparse\",opts),Object.defineProperty(SchemaTypeOptions.prototype,\"text\",opts),module.exports=SchemaTypeOptions;","node_modules/mongodb/index.js":"\"use strict\";const core=require(\"./lib/core\"),Instrumentation=require(\"./lib/apm\"),connect=require(\"./lib/mongo_client\").connect;connect.MongoError=core.MongoError,connect.MongoNetworkError=core.MongoNetworkError,connect.MongoTimeoutError=core.MongoTimeoutError,connect.MongoParseError=core.MongoParseError,connect.MongoWriteConcernError=core.MongoWriteConcernError,connect.MongoBulkWriteError=require(\"./lib/bulk/common\").BulkWriteError,connect.BulkWriteError=connect.MongoBulkWriteError,connect.Admin=require(\"./lib/admin\"),connect.MongoClient=require(\"./lib/mongo_client\"),connect.Db=require(\"./lib/db\"),connect.Collection=require(\"./lib/collection\"),connect.Server=require(\"./lib/topologies/server\"),connect.ReplSet=require(\"./lib/topologies/replset\"),connect.Mongos=require(\"./lib/topologies/mongos\"),connect.ReadPreference=core.ReadPreference,connect.GridStore=require(\"./lib/gridfs/grid_store\"),connect.Chunk=require(\"./lib/gridfs/chunk\"),connect.Logger=core.Logger,connect.AggregationCursor=require(\"./lib/aggregation_cursor\"),connect.CommandCursor=require(\"./lib/command_cursor\"),connect.Cursor=require(\"./lib/cursor\"),connect.GridFSBucket=require(\"./lib/gridfs-stream\"),connect.CoreServer=core.Server,connect.CoreConnection=core.Connection,connect.Binary=core.BSON.Binary,connect.Code=core.BSON.Code,connect.Map=core.BSON.Map,connect.DBRef=core.BSON.DBRef,connect.Double=core.BSON.Double,connect.Int32=core.BSON.Int32,connect.Long=core.BSON.Long,connect.MinKey=core.BSON.MinKey,connect.MaxKey=core.BSON.MaxKey,connect.ObjectID=core.BSON.ObjectID,connect.ObjectId=core.BSON.ObjectID,connect.Symbol=core.BSON.Symbol,connect.Timestamp=core.BSON.Timestamp,connect.BSONRegExp=core.BSON.BSONRegExp,connect.Decimal128=core.BSON.Decimal128,connect.connect=connect,connect.instrument=function(e,o){\"function\"==typeof e&&(o=e,e={});const n=new Instrumentation;return n.instrument(connect.MongoClient,o),n},module.exports=connect;","node_modules/mquery/lib/mquery.js":"\"use strict\";var slice=require(\"sliced\"),assert=require(\"assert\"),util=require(\"util\"),utils=require(\"./utils\"),debug=require(\"debug\")(\"mquery\");function Query(t,e){if(!(this instanceof Query))return new Query(t,e);var i=this.constructor.prototype;this.op=i.op||void 0,this.options=Object.assign({},i.options),this._conditions=i._conditions?utils.clone(i._conditions):{},this._fields=i._fields?utils.clone(i._fields):void 0,this._update=i._update?utils.clone(i._update):void 0,this._path=i._path||void 0,this._distinct=i._distinct||void 0,this._collection=i._collection||void 0,this._traceFunction=i._traceFunction||void 0,e&&this.setOptions(e),t&&(t.find&&t.remove&&t.update?this.collection(t):this.find(t))}var $withinCmd=\"$geoWithin\";Object.defineProperty(Query,\"use$geoWithin\",{get:function(){return\"$geoWithin\"==$withinCmd},set:function(t){$withinCmd=!0===t?\"$geoWithin\":\"$within\"}}),Query.prototype.toConstructor=function(){function t(e,i){if(!(this instanceof t))return new t(e,i);Query.call(this,e,i)}utils.inherits(t,Query);var e=t.prototype;return e.options={},e.setOptions(this.options),e.op=this.op,e._conditions=utils.clone(this._conditions),e._fields=utils.clone(this._fields),e._update=utils.clone(this._update),e._path=this._path,e._distinct=this._distinct,e._collection=this._collection,e._traceFunction=this._traceFunction,t},Query.prototype.setOptions=function(t){if(!t||!utils.isObject(t))return this;for(var e,i=utils.keys(t),o=0;o<i.length;++o)if(\"function\"==typeof this[e=i[o]]){var n=utils.isArray(t[e])?t[e]:[t[e]];this[e].apply(this,n)}else this.options[e]=t[e];return this},Query.prototype.collection=function(t){return this._collection=new Query.Collection(t),this},Query.prototype.collation=function(t){return this.options.collation=t,this},Query.prototype.$where=function(t){return this._conditions.$where=t,this},Query.prototype.where=function(){if(!arguments.length)return this;this.op||(this.op=\"find\");var t=typeof arguments[0];if(\"string\"==t)return this._path=arguments[0],2===arguments.length&&(this._conditions[this._path]=arguments[1]),this;if(\"object\"==t&&!Array.isArray(arguments[0]))return this.merge(arguments[0]);throw new TypeError(\"path must be a string or object\")},Query.prototype.equals=function(t){this._ensurePath(\"equals\");var e=this._path;return this._conditions[e]=t,this},Query.prototype.eq=function(t){this._ensurePath(\"eq\");var e=this._path;return this._conditions[e]=t,this},Query.prototype.or=function(t){var e=this._conditions.$or||(this._conditions.$or=[]);return utils.isArray(t)||(t=[t]),e.push.apply(e,t),this},Query.prototype.nor=function(t){var e=this._conditions.$nor||(this._conditions.$nor=[]);return utils.isArray(t)||(t=[t]),e.push.apply(e,t),this},Query.prototype.and=function(t){var e=this._conditions.$and||(this._conditions.$and=[]);return Array.isArray(t)||(t=[t]),e.push.apply(e,t),this},\"gt gte lt lte ne in nin all regex size maxDistance minDistance\".split(\" \").forEach(function(t){Query.prototype[t]=function(){var e,i;return 1===arguments.length?(this._ensurePath(t),i=arguments[0],e=this._path):(i=arguments[1],e=arguments[0]),(null===this._conditions[e]||\"object\"==typeof this._conditions[e]?this._conditions[e]:this._conditions[e]={})[\"$\"+t]=i,this}}),Query.prototype.mod=function(){var t,e;return 1===arguments.length?(this._ensurePath(\"mod\"),t=arguments[0],e=this._path):2!==arguments.length||utils.isArray(arguments[1])?3===arguments.length?(t=slice(arguments,1),e=arguments[0]):(t=arguments[1],e=arguments[0]):(this._ensurePath(\"mod\"),t=slice(arguments),e=this._path),(this._conditions[e]||(this._conditions[e]={})).$mod=t,this},Query.prototype.exists=function(){var t,e;return 0===arguments.length?(this._ensurePath(\"exists\"),t=this._path,e=!0):1===arguments.length?\"boolean\"==typeof arguments[0]?(this._ensurePath(\"exists\"),t=this._path,e=arguments[0]):(t=arguments[0],e=!0):2===arguments.length&&(t=arguments[0],e=arguments[1]),(this._conditions[t]||(this._conditions[t]={})).$exists=e,this},Query.prototype.elemMatch=function(){if(null==arguments[0])throw new TypeError(\"Invalid argument\");var t,e,i;if(\"function\"==typeof arguments[0])this._ensurePath(\"elemMatch\"),e=this._path,t=arguments[0];else if(utils.isObject(arguments[0]))this._ensurePath(\"elemMatch\"),e=this._path,i=arguments[0];else if(\"function\"==typeof arguments[1])e=arguments[0],t=arguments[1];else{if(!arguments[1]||!utils.isObject(arguments[1]))throw new TypeError(\"Invalid argument\");e=arguments[0],i=arguments[1]}return t&&(t(i=new Query),i=i._conditions),(this._conditions[e]||(this._conditions[e]={})).$elemMatch=i,this},Query.prototype.within=function(){if(this._ensurePath(\"within\"),this._geoComparison=$withinCmd,0===arguments.length)return this;if(2===arguments.length)return this.box.apply(this,arguments);if(2<arguments.length)return this.polygon.apply(this,arguments);var t=arguments[0];if(!t)throw new TypeError(\"Invalid argument\");if(t.center)return this.circle(t);if(t.box)return this.box.apply(this,t.box);if(t.polygon)return this.polygon.apply(this,t.polygon);if(t.type&&t.coordinates)return this.geometry(t);throw new TypeError(\"Invalid argument\")},Query.prototype.box=function(){var t,e;if(3===arguments.length)t=arguments[0],e=[arguments[1],arguments[2]];else{if(2!==arguments.length)throw new TypeError(\"Invalid argument\");this._ensurePath(\"box\"),t=this._path,e=[arguments[0],arguments[1]]}return(this._conditions[t]||(this._conditions[t]={}))[this._geoComparison||$withinCmd]={$box:e},this},Query.prototype.polygon=function(){var t,e;return\"string\"==typeof arguments[0]?(e=arguments[0],t=slice(arguments,1)):(this._ensurePath(\"polygon\"),e=this._path,t=slice(arguments)),(this._conditions[e]||(this._conditions[e]={}))[this._geoComparison||$withinCmd]={$polygon:t},this},Query.prototype.circle=function(){var t,e;if(1===arguments.length)this._ensurePath(\"circle\"),t=this._path,e=arguments[0];else{if(2!==arguments.length)throw new TypeError(\"Invalid argument\");t=arguments[0],e=arguments[1]}if(!(\"radius\"in e&&e.center))throw new Error(\"center and radius are required\");var i=this._conditions[t]||(this._conditions[t]={}),o=e.spherical?\"$centerSphere\":\"$center\",n=this._geoComparison||$withinCmd;return i[n]={},i[n][o]=[e.center,e.radius],\"unique\"in e&&(i[n].$uniqueDocs=!!e.unique),this},Query.prototype.near=function(){var t,e;if(this._geoComparison=\"$near\",0===arguments.length)return this;if(1===arguments.length)this._ensurePath(\"near\"),t=this._path,e=arguments[0];else{if(2!==arguments.length)throw new TypeError(\"Invalid argument\");t=arguments[0],e=arguments[1]}if(!e.center)throw new Error(\"center is required\");var i=this._conditions[t]||(this._conditions[t]={}),o=e.spherical?\"$nearSphere\":\"$near\";if(Array.isArray(e.center)){i[o]=e.center;var n=\"maxDistance\"in e?e.maxDistance:null;null!=n&&(i.$maxDistance=n),null!=e.minDistance&&(i.$minDistance=e.minDistance)}else{if(\"Point\"!=e.center.type||!Array.isArray(e.center.coordinates))throw new Error(util.format(\"Invalid GeoJSON specified for %s\",o));i[o]={$geometry:e.center},\"maxDistance\"in e&&(i[o].$maxDistance=e.maxDistance),\"minDistance\"in e&&(i[o].$minDistance=e.minDistance)}return this},Query.prototype.intersects=function(){if(this._ensurePath(\"intersects\"),this._geoComparison=\"$geoIntersects\",0===arguments.length)return this;var t=arguments[0];if(null!=t&&t.type&&t.coordinates)return this.geometry(t);throw new TypeError(\"Invalid argument\")},Query.prototype.geometry=function(){if(\"$within\"!=this._geoComparison&&\"$geoWithin\"!=this._geoComparison&&\"$near\"!=this._geoComparison&&\"$geoIntersects\"!=this._geoComparison)throw new Error(\"geometry() must come after `within()`, `intersects()`, or `near()\");var t,e;if(1!==arguments.length)throw new TypeError(\"Invalid argument\");if(this._ensurePath(\"geometry\"),e=this._path,!(t=arguments[0]).type||!Array.isArray(t.coordinates))throw new TypeError(\"Invalid argument\");return(this._conditions[e]||(this._conditions[e]={}))[this._geoComparison]={$geometry:t},this},Query.prototype.select=function(){var t=arguments[0];if(!t)return this;if(1!==arguments.length)throw new Error(\"Invalid select: select only takes 1 argument\");this._validate(\"select\");var e,i,o=this._fields||(this._fields={}),n=typeof t;if((\"string\"==n||utils.isArgumentsObject(t))&&\"number\"==typeof t.length||Array.isArray(t)){for(\"string\"==n&&(t=t.split(/\\s+/)),e=0,i=t.length;e<i;++e){var r=t[e];if(r){var s=\"-\"==r[0]?0:1;0===s&&(r=r.substring(1)),o[r]=s}}return this}if(utils.isObject(t)){var u=utils.keys(t);for(e=0;e<u.length;++e)o[u[e]]=t[u[e]];return this}throw new TypeError(\"Invalid select() argument. Must be string or object.\")},Query.prototype.slice=function(){if(0===arguments.length)return this;var t,e;if(this._validate(\"slice\"),1===arguments.length){var i=arguments[0];if(\"object\"==typeof i&&!Array.isArray(i)){for(var o=Object.keys(i),n=o.length,r=0;r<n;++r)this.slice(o[r],i[o[r]]);return this}this._ensurePath(\"slice\"),t=this._path,e=arguments[0]}else 2===arguments.length?\"number\"==typeof arguments[0]?(this._ensurePath(\"slice\"),t=this._path,e=slice(arguments)):(t=arguments[0],e=arguments[1]):3===arguments.length&&(t=arguments[0],e=slice(arguments,1));return(this._fields||(this._fields={}))[t]={$slice:e},this},Query.prototype.sort=function(t){if(!t)return this;var e,i,o;this._validate(\"sort\");var n=typeof t;if(Array.isArray(t)){for(i=t.length,e=0;e<t.length;++e){if(!Array.isArray(t[e]))throw new Error(\"Invalid sort() argument, must be array of arrays\");_pushArr(this.options,t[e][0],t[e][1])}return this}if(1===arguments.length&&\"string\"==n){for(i=(t=t.split(/\\s+/)).length,e=0;e<i;++e)if(o=t[e]){var r=\"-\"==o[0]?-1:1;-1===r&&(o=o.substring(1)),push(this.options,o,r)}return this}if(utils.isObject(t)){var s=utils.keys(t);for(e=0;e<s.length;++e)o=s[e],push(this.options,o,t[o]);return this}if(\"undefined\"!=typeof Map&&t instanceof Map)return _pushMap(this.options,t),this;throw new TypeError(\"Invalid sort() argument. Must be a string, object, or array.\")};var _validSortValue={1:1,\"-1\":-1,asc:1,ascending:1,desc:-1,descending:-1};function push(t,e,i){if(Array.isArray(t.sort))throw new TypeError(\"Can't mix sort syntaxes. Use either array or object:\\n- `.sort([['field', 1], ['test', -1]])`\\n- `.sort({ field: 1, test: -1 })`\");var o;if(i&&i.$meta)(o=t.sort||(t.sort={}))[e]={$meta:i.$meta};else{o=t.sort||(t.sort={});var n=String(i||1).toLowerCase();if(!(n=_validSortValue[n]))throw new TypeError(\"Invalid sort value: { \"+e+\": \"+i+\" }\");o[e]=n}}function _pushArr(t,e,i){if(t.sort=t.sort||[],!Array.isArray(t.sort))throw new TypeError(\"Can't mix sort syntaxes. Use either array or object:\\n- `.sort([['field', 1], ['test', -1]])`\\n- `.sort({ field: 1, test: -1 })`\");var o=String(i||1).toLowerCase();if(!(o=_validSortValue[o]))throw new TypeError(\"Invalid sort value: [ \"+e+\", \"+i+\" ]\");t.sort.push([e,o])}function _pushMap(t,e){if(t.sort=t.sort||new Map,!(t.sort instanceof Map))throw new TypeError(\"Can't mix sort syntaxes. Use either array or object or map consistently\");e.forEach(function(e,i){var o=String(e||1).toLowerCase();if(!(o=_validSortValue[o]))throw new TypeError(\"Invalid sort value: < \"+i+\": \"+e+\" >\");t.sort.set(i,o)})}function _update(t,e,i,o,n,r,s){return t.op=e,Query.canMerge(i)&&t.merge(i),o&&t._mergeUpdate(o),utils.isObject(n)&&t.setOptions(n),r||s?!t._update||!t.options.overwrite&&0===utils.keys(t._update).length?(s&&utils.soon(s.bind(null,null,0)),t):(n=t._optionsForExec(),s||(n.safe=!1),i=t._conditions,o=t._updateForExec(),debug(\"update\",t._collection.collectionName,i,o,n),s=t._wrapCallback(e,s,{conditions:i,doc:o,options:n}),t._collection[e](i,o,n,utils.tick(s)),t):t}[\"limit\",\"skip\",\"maxScan\",\"batchSize\",\"comment\"].forEach(function(t){Query.prototype[t]=function(e){return this._validate(t),this.options[t]=e,this}}),Query.prototype.maxTime=Query.prototype.maxTimeMS=function(t){return this._validate(\"maxTime\"),this.options.maxTimeMS=t,this},Query.prototype.snapshot=function(){return this._validate(\"snapshot\"),this.options.snapshot=!arguments.length||!!arguments[0],this},Query.prototype.hint=function(){if(0===arguments.length)return this;this._validate(\"hint\");var t=arguments[0];if(utils.isObject(t)){var e=this.options.hint||(this.options.hint={});for(var i in t)e[i]=t[i];return this}if(\"string\"==typeof t)return this.options.hint=t,this;throw new TypeError(\"Invalid hint. \"+t)},Query.prototype.j=function(t){return this.options.j=t,this},Query.prototype.slaveOk=function(t){return this.options.slaveOk=!arguments.length||!!t,this},Query.prototype.read=Query.prototype.setReadPreference=function(t){return arguments.length>1&&!Query.prototype.read.deprecationWarningIssued&&(console.error(\"Deprecation warning: 'tags' argument is not supported anymore in Query.read() method. Please use mongodb.ReadPreference object instead.\"),Query.prototype.read.deprecationWarningIssued=!0),this.options.readPreference=utils.readPref(t),this},Query.prototype.readConcern=Query.prototype.r=function(t){return this.options.readConcern=utils.readConcern(t),this},Query.prototype.tailable=function(){return this._validate(\"tailable\"),this.options.tailable=!arguments.length||!!arguments[0],this},Query.prototype.writeConcern=Query.prototype.w=function(t){return\"object\"==typeof t?(void 0!==t.j&&(this.options.j=t.j),void 0!==t.w&&(this.options.w=t.w),void 0!==t.wtimeout&&(this.options.wtimeout=t.wtimeout)):this.options.w=\"m\"===t?\"majority\":t,this},Query.prototype.wtimeout=Query.prototype.wTimeout=function(t){return this.options.wtimeout=t,this},Query.prototype.merge=function(t){if(!t)return this;if(!Query.canMerge(t))throw new TypeError(\"Invalid argument. Expected instanceof mquery or plain object\");return t instanceof Query?(t._conditions&&utils.merge(this._conditions,t._conditions),t._fields&&(this._fields||(this._fields={}),utils.merge(this._fields,t._fields)),t.options&&(this.options||(this.options={}),utils.merge(this.options,t.options)),t._update&&(this._update||(this._update={}),utils.mergeClone(this._update,t._update)),t._distinct&&(this._distinct=t._distinct),this):(utils.merge(this._conditions,t),this)},Query.prototype.find=function(t,e){if(this.op=\"find\",\"function\"==typeof t?(e=t,t=void 0):Query.canMerge(t)&&this.merge(t),!e)return this;var i=this._conditions,o=this._optionsForExec();return this.$useProjection?o.projection=this._fieldsForExec():o.fields=this._fieldsForExec(),debug(\"find\",this._collection.collectionName,i,o),e=this._wrapCallback(\"find\",e,{conditions:i,options:o}),this._collection.find(i,o,utils.tick(e)),this},Query.prototype.cursor=function(t){if(this.op){if(\"find\"!==this.op)throw new TypeError(\".cursor only support .find method\")}else this.find(t);var e=this._conditions,i=this._optionsForExec();return this.$useProjection?i.projection=this._fieldsForExec():i.fields=this._fieldsForExec(),debug(\"findCursor\",this._collection.collectionName,e,i),this._collection.findCursor(e,i)},Query.prototype.findOne=function(t,e){if(this.op=\"findOne\",\"function\"==typeof t?(e=t,t=void 0):Query.canMerge(t)&&this.merge(t),!e)return this;var i=this._conditions,o=this._optionsForExec();return this.$useProjection?o.projection=this._fieldsForExec():o.fields=this._fieldsForExec(),debug(\"findOne\",this._collection.collectionName,i,o),e=this._wrapCallback(\"findOne\",e,{conditions:i,options:o}),this._collection.findOne(i,o,utils.tick(e)),this},Query.prototype.count=function(t,e){if(this.op=\"count\",this._validate(),\"function\"==typeof t?(e=t,t=void 0):Query.canMerge(t)&&this.merge(t),!e)return this;var i=this._conditions,o=this._optionsForExec();return debug(\"count\",this._collection.collectionName,i,o),e=this._wrapCallback(\"count\",e,{conditions:i,options:o}),this._collection.count(i,o,utils.tick(e)),this},Query.prototype.distinct=function(t,e,i){if(this.op=\"distinct\",this._validate(),!i){switch(typeof e){case\"function\":i=e,\"string\"==typeof t&&(e=t,t=void 0);break;case\"undefined\":case\"string\":break;default:throw new TypeError(\"Invalid `field` argument. Must be string or function\")}switch(typeof t){case\"function\":i=t,t=e=void 0;break;case\"string\":e=t,t=void 0}}if(\"string\"==typeof e&&(this._distinct=e),Query.canMerge(t)&&this.merge(t),!i)return this;if(!this._distinct)throw new Error(\"No value for `distinct` has been declared\");var o=this._conditions,n=this._optionsForExec();return debug(\"distinct\",this._collection.collectionName,o,n),i=this._wrapCallback(\"distinct\",i,{conditions:o,options:n}),this._collection.distinct(this._distinct,o,n,utils.tick(i)),this},Query.prototype.update=function(t,e,i,o){var n;switch(arguments.length){case 3:\"function\"==typeof i&&(o=i,i=void 0);break;case 2:\"function\"==typeof e&&(o=e,e=t,t=void 0);break;case 1:switch(typeof t){case\"function\":o=t,t=i=e=void 0;break;case\"boolean\":n=t,t=void 0;break;default:e=t,t=i=void 0}}return _update(this,\"update\",t,e,i,n,o)},Query.prototype.updateMany=function(t,e,i,o){var n;switch(arguments.length){case 3:\"function\"==typeof i&&(o=i,i=void 0);break;case 2:\"function\"==typeof e&&(o=e,e=t,t=void 0);break;case 1:switch(typeof t){case\"function\":o=t,t=i=e=void 0;break;case\"boolean\":n=t,t=void 0;break;default:e=t,t=i=void 0}}return _update(this,\"updateMany\",t,e,i,n,o)},Query.prototype.updateOne=function(t,e,i,o){var n;switch(arguments.length){case 3:\"function\"==typeof i&&(o=i,i=void 0);break;case 2:\"function\"==typeof e&&(o=e,e=t,t=void 0);break;case 1:switch(typeof t){case\"function\":o=t,t=i=e=void 0;break;case\"boolean\":n=t,t=void 0;break;default:e=t,t=i=void 0}}return _update(this,\"updateOne\",t,e,i,n,o)},Query.prototype.replaceOne=function(t,e,i,o){var n;switch(arguments.length){case 3:\"function\"==typeof i&&(o=i,i=void 0);break;case 2:\"function\"==typeof e&&(o=e,e=t,t=void 0);break;case 1:switch(typeof t){case\"function\":o=t,t=i=e=void 0;break;case\"boolean\":n=t,t=void 0;break;default:e=t,t=i=void 0}}return this.setOptions({overwrite:!0}),_update(this,\"replaceOne\",t,e,i,n,o)},Query.prototype.remove=function(t,e){var i;if(this.op=\"remove\",\"function\"==typeof t?(e=t,t=void 0):Query.canMerge(t)?this.merge(t):!0===t&&(i=t,t=void 0),!i&&!e)return this;var o=this._optionsForExec();e||(o.safe=!1);var n=this._conditions;return debug(\"remove\",this._collection.collectionName,n,o),e=this._wrapCallback(\"remove\",e,{conditions:n,options:o}),this._collection.remove(n,o,utils.tick(e)),this},Query.prototype.deleteOne=function(t,e){var i;if(this.op=\"deleteOne\",\"function\"==typeof t?(e=t,t=void 0):Query.canMerge(t)?this.merge(t):!0===t&&(i=t,t=void 0),!i&&!e)return this;var o=this._optionsForExec();e||(o.safe=!1),delete o.justOne;var n=this._conditions;return debug(\"deleteOne\",this._collection.collectionName,n,o),e=this._wrapCallback(\"deleteOne\",e,{conditions:n,options:o}),this._collection.deleteOne(n,o,utils.tick(e)),this},Query.prototype.deleteMany=function(t,e){var i;if(this.op=\"deleteMany\",\"function\"==typeof t?(e=t,t=void 0):Query.canMerge(t)?this.merge(t):!0===t&&(i=t,t=void 0),!i&&!e)return this;var o=this._optionsForExec();e||(o.safe=!1),delete o.justOne;var n=this._conditions;return debug(\"deleteOne\",this._collection.collectionName,n,o),e=this._wrapCallback(\"deleteOne\",e,{conditions:n,options:o}),this._collection.deleteMany(n,o,utils.tick(e)),this},Query.prototype.findOneAndUpdate=function(t,e,i,o){switch(this.op=\"findOneAndUpdate\",this._validate(),arguments.length){case 3:\"function\"==typeof i&&(o=i,i={});break;case 2:\"function\"==typeof e&&(o=e,e=t,t=void 0),i=void 0;break;case 1:\"function\"==typeof t?(o=t,t=i=e=void 0):(e=t,t=i=void 0)}return Query.canMerge(t)&&this.merge(t),e&&this._mergeUpdate(e),i&&this.setOptions(i),o?this._findAndModify(\"update\",o):this},Query.prototype.findOneAndRemove=Query.prototype.findOneAndDelete=function(t,e,i){return this.op=\"findOneAndRemove\",this._validate(),\"function\"==typeof e?(i=e,e=void 0):\"function\"==typeof t&&(i=t,t=void 0),Query.canMerge(t)&&this.merge(t),e&&this.setOptions(e),i?this._findAndModify(\"remove\",i):this},Query.prototype._findAndModify=function(t,e){assert.equal(\"function\",typeof e);var i,o=this._optionsForExec();if(\"remove\"==t)o.remove=!0;else if(\"new\"in o||(o.new=!0),\"upsert\"in o||(o.upsert=!1),!(i=this._updateForExec())){if(!o.upsert)return this.findOne(e);i={$set:{}}}null!=this._fieldsForExec()&&(this.$useProjection?o.projection=this._fieldsForExec():o.fields=this._fieldsForExec());var n=this._conditions;return debug(\"findAndModify\",this._collection.collectionName,n,i,o),e=this._wrapCallback(\"findAndModify\",e,{conditions:n,doc:i,options:o}),this._collection.findAndModify(n,i,o,utils.tick(e)),this},Query.prototype._wrapCallback=function(t,e,i){var o=this._traceFunction||Query.traceFunction;if(o){i.collectionName=this._collection.collectionName;var n=o&&o.call(null,t,i,this),r=(new Date).getTime();return function(t,i){if(n){var o=(new Date).getTime()-r;n.call(null,t,i,o)}e&&e.apply(null,arguments)}}return e},Query.prototype.setTraceFunction=function(t){return this._traceFunction=t,this},Query.prototype.exec=function(t,e){switch(typeof t){case\"function\":e=t,t=null;break;case\"string\":this.op=t}assert.ok(this.op,\"Missing query type: (find, update, etc)\"),\"update\"!=this.op&&\"remove\"!=this.op||e||(e=!0);var i=this;if(\"function\"!=typeof e)return new Query.Promise(function(t,e){i[i.op](function(i,o){i?e(i):t(o),t=e=null})});this[this.op](e)},Query.prototype.thunk=function(){var t=this;return function(e){t.exec(e)}},Query.prototype.then=function(t,e){var i=this;return new Query.Promise(function(t,e){i.exec(function(i,o){i?e(i):t(o),t=e=null})}).then(t,e)},Query.prototype.stream=function(t){if(\"find\"!=this.op)throw new Error(\"stream() is only available for find\");var e=this._conditions,i=this._optionsForExec();return this.$useProjection?i.projection=this._fieldsForExec():i.fields=this._fieldsForExec(),debug(\"stream\",this._collection.collectionName,e,i,t),this._collection.findStream(e,i,t)},Query.prototype.selected=function(){return!!(this._fields&&Object.keys(this._fields).length>0)},Query.prototype.selectedInclusively=function(){if(!this._fields)return!1;var t=Object.keys(this._fields);if(0===t.length)return!1;for(var e=0;e<t.length;++e){var i=t[e];if(0===this._fields[i])return!1;if(this._fields[i]&&\"object\"==typeof this._fields[i]&&this._fields[i].$meta)return!1}return!0},Query.prototype.selectedExclusively=function(){if(!this._fields)return!1;var t=Object.keys(this._fields);if(0===t.length)return!1;for(var e=0;e<t.length;++e){var i=t[e];if(0===this._fields[i])return!0}return!1},Query.prototype._mergeUpdate=function(t){this._update||(this._update={}),t instanceof Query?t._update&&utils.mergeClone(this._update,t._update):utils.mergeClone(this._update,t)},Query.prototype._optionsForExec=function(){return utils.clone(this.options)},Query.prototype._fieldsForExec=function(){return utils.clone(this._fields)},Query.prototype._updateForExec=function(){for(var t=utils.clone(this._update),e=utils.keys(t),i=e.length,o={};i--;){var n=e[i];this.options.overwrite?o[n]=t[n]:\"$\"!==n[0]?(o.$set||(t.$set?o.$set=t.$set:o.$set={}),o.$set[n]=t[n],e.splice(i,1),~e.indexOf(\"$set\")||e.push(\"$set\")):\"$set\"===n&&o.$set||(o[n]=t[n])}return this._compiledUpdate=o,o},Query.prototype._ensurePath=function(t){if(!this._path)throw new Error(t+\"() must be used after where() when called with these arguments\")},Query.permissions=require(\"./permissions\"),Query._isPermitted=function(t,e){var i=Query.permissions[e];return!i||!0!==i[t]},Query.prototype._validate=function(t){var e,i;if(void 0===t){if(\"function\"!=typeof(i=Query.permissions[this.op]))return!0;e=i(this)}else Query._isPermitted(t,this.op)||(e=t);if(e)throw new Error(e+\" cannot be used with \"+this.op)},Query.canMerge=function(t){return t instanceof Query||utils.isObject(t)},Query.setGlobalTraceFunction=function(t){Query.traceFunction=t},Query.utils=utils,Query.env=require(\"./env\"),Query.Collection=require(\"./collection\"),Query.BaseCollection=require(\"./collection/collection\"),Query.Promise=require(\"bluebird\"),module.exports=exports=Query;","node_modules/mongoose/lib/drivers/node-mongodb-native/binary.js":"\"use strict\";const Binary=require(\"mongodb\").Binary;module.exports=exports=Binary;","node_modules/mongoose/lib/drivers/node-mongodb-native/decimal128.js":"\"use strict\";module.exports=require(\"mongodb\").Decimal128;","node_modules/mongoose/lib/drivers/node-mongodb-native/objectid.js":"\"use strict\";const ObjectId=require(\"mongodb\").ObjectId;module.exports=exports=ObjectId;","node_modules/mongoose/lib/drivers/node-mongodb-native/ReadPreference.js":"\"use strict\";const mongodb=require(\"mongodb\"),ReadPref=mongodb.ReadPreference;module.exports=function(e,r){if(Array.isArray(e)&&(r=e[1],e=e[0]),e instanceof ReadPref)return e;switch(e){case\"p\":e=\"primary\";break;case\"pp\":e=\"primaryPreferred\";break;case\"s\":e=\"secondary\";break;case\"sp\":e=\"secondaryPreferred\";break;case\"n\":e=\"nearest\"}return new ReadPref(e,r)};","node_modules/mongodb/lib/core/index.js":"\"use strict\";let BSON=require(\"bson\");const require_optional=require(\"require_optional\"),EJSON=require(\"./utils\").retrieveEJSON();try{const r=require_optional(\"bson-ext\");r&&(BSON=r)}catch(r){}module.exports={MongoError:require(\"./error\").MongoError,MongoNetworkError:require(\"./error\").MongoNetworkError,MongoParseError:require(\"./error\").MongoParseError,MongoTimeoutError:require(\"./error\").MongoTimeoutError,MongoWriteConcernError:require(\"./error\").MongoWriteConcernError,mongoErrorContextSymbol:require(\"./error\").mongoErrorContextSymbol,Connection:require(\"./connection/connection\"),Server:require(\"./topologies/server\"),ReplSet:require(\"./topologies/replset\"),Mongos:require(\"./topologies/mongos\"),Logger:require(\"./connection/logger\"),Cursor:require(\"./cursor\").CoreCursor,ReadPreference:require(\"./topologies/read_preference\"),Sessions:require(\"./sessions\"),BSON:BSON,EJSON:EJSON,Topology:require(\"./sdam/topology\").Topology,Query:require(\"./connection/commands\").Query,MongoCredentials:require(\"./auth/mongo_credentials\").MongoCredentials,defaultAuthProviders:require(\"./auth/defaultAuthProviders\").defaultAuthProviders,MongoCR:require(\"./auth/mongocr\"),X509:require(\"./auth/x509\"),Plain:require(\"./auth/plain\"),GSSAPI:require(\"./auth/gssapi\"),ScramSHA1:require(\"./auth/scram\").ScramSHA1,ScramSHA256:require(\"./auth/scram\").ScramSHA256,parseConnectionString:require(\"./uri_parser\")};","node_modules/mongodb/lib/apm.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter;class Instrumentation extends EventEmitter{constructor(){super()}instrument(t,n){this.$MongoClient=t;const e=this.$prototypeConnect=t.prototype.connect,o=this;t.prototype.connect=function(t){return this.s.options.monitorCommands=!0,this.on(\"commandStarted\",t=>o.emit(\"started\",t)),this.on(\"commandSucceeded\",t=>o.emit(\"succeeded\",t)),this.on(\"commandFailed\",t=>o.emit(\"failed\",t)),e.call(this,t)},\"function\"==typeof n&&n(null,this)}uninstrument(){this.$MongoClient.prototype.connect=this.$prototypeConnect}}module.exports=Instrumentation;","node_modules/mongodb/lib/mongo_client.js":"\"use strict\";const ChangeStream=require(\"./change_stream\"),Db=require(\"./db\"),EventEmitter=require(\"events\").EventEmitter,executeOperation=require(\"./operations/execute_operation\"),inherits=require(\"util\").inherits,MongoError=require(\"./core\").MongoError,deprecate=require(\"util\").deprecate,WriteConcern=require(\"./write_concern\"),MongoDBNamespace=require(\"./utils\").MongoDBNamespace,ReadPreference=require(\"./core/topologies/read_preference\"),ConnectOperation=require(\"./operations/connect\"),CloseOperation=require(\"./operations/close\");function MongoClient(e,t){if(!(this instanceof MongoClient))return new MongoClient(e,t);EventEmitter.call(this),this.s={url:e,options:t||{},promiseLibrary:null,dbCache:new Map,sessions:new Set,writeConcern:WriteConcern.fromOptions(t),namespace:new MongoDBNamespace(\"admin\")};const o=this.s.options.promiseLibrary||Promise;this.s.promiseLibrary=o}inherits(MongoClient,EventEmitter),Object.defineProperty(MongoClient.prototype,\"writeConcern\",{enumerable:!0,get:function(){return this.s.writeConcern}}),Object.defineProperty(MongoClient.prototype,\"readPreference\",{enumerable:!0,get:function(){return ReadPreference.primary}}),MongoClient.prototype.connect=function(e){if(\"string\"==typeof e)throw new TypeError(\"`connect` only accepts a callback\");const t=new ConnectOperation(this);return executeOperation(this,t,e)},MongoClient.prototype.logout=deprecate(function(e,t){\"function\"==typeof e&&(t=e,e={}),\"function\"==typeof t&&t(null,!0)},\"Multiple authentication is prohibited on a connected client, please only authenticate once per MongoClient\"),MongoClient.prototype.close=function(e,t){\"function\"==typeof e&&(t=e,e=!1);const o=new CloseOperation(this,e);return executeOperation(this,o,t)},MongoClient.prototype.db=function(e,t){t=t||{},e||(e=this.s.options.dbName);const o=Object.assign({},this.s.options,t);if(this.s.dbCache.has(e)&&!0!==o.returnNonCachedInstance)return this.s.dbCache.get(e);if(o.promiseLibrary=this.s.promiseLibrary,!this.topology)throw new MongoError(\"MongoClient must be connected before calling MongoClient.prototype.db\");const n=new Db(e,this.topology,o);return this.s.dbCache.set(e,n),n},MongoClient.prototype.isConnected=function(e){return e=e||{},!!this.topology&&this.topology.isConnected(e)},MongoClient.connect=function(e,t,o){const n=Array.prototype.slice.call(arguments,1);return o=\"function\"==typeof n[n.length-1]?n.pop():void 0,new MongoClient(e,(n.length?n.shift():null)||{}).connect(o)},MongoClient.prototype.startSession=function(e){if(e=Object.assign({explicit:!0},e),!this.topology)throw new MongoError(\"Must connect to a server before calling this method\");if(!this.topology.hasSessionSupport())throw new MongoError(\"Current topology does not support sessions\");return this.topology.startSession(e,this.s.options)},MongoClient.prototype.withSession=function(e,t){\"function\"==typeof e&&(t=e,e=void 0);const o=this.startSession(e);let n=(e,t,r)=>{if(n=(()=>{throw new ReferenceError(\"cleanupHandler was called too many times\")}),r=Object.assign({throw:!0},r),o.endSession(),e){if(r.throw)throw e;return Promise.reject(e)}};try{const e=t(o);return Promise.resolve(e).then(e=>n(null,e)).catch(e=>n(e,null,{throw:!0}))}catch(e){return n(e,null,{throw:!1})}},MongoClient.prototype.watch=function(e,t){return e=e||[],t=t||{},Array.isArray(e)||(t=e,e=[]),new ChangeStream(this,e,t)},MongoClient.prototype.getLogger=function(){return this.s.options.logger},module.exports=MongoClient;","node_modules/mongodb/lib/bulk/common.js":"\"use strict\";const Long=require(\"../core\").BSON.Long,MongoError=require(\"../core\").MongoError,ObjectID=require(\"../core\").BSON.ObjectID,BSON=require(\"../core\").BSON,MongoWriteConcernError=require(\"../core\").MongoWriteConcernError,toError=require(\"../utils\").toError,handleCallback=require(\"../utils\").handleCallback,applyRetryableWrites=require(\"../utils\").applyRetryableWrites,applyWriteConcern=require(\"../utils\").applyWriteConcern,executeLegacyOperation=require(\"../utils\").executeLegacyOperation,isPromiseLike=require(\"../utils\").isPromiseLike,WRITE_CONCERN_ERROR=64,INSERT=1,UPDATE=2,REMOVE=3,bson=new BSON([BSON.Binary,BSON.Code,BSON.DBRef,BSON.Decimal128,BSON.Double,BSON.Int32,BSON.Long,BSON.Map,BSON.MaxKey,BSON.MinKey,BSON.ObjectId,BSON.BSONRegExp,BSON.Symbol,BSON.Timestamp]);class Batch{constructor(e,r){this.originalZeroIndex=r,this.currentIndex=0,this.originalIndexes=[],this.batchType=e,this.operations=[],this.size=0,this.sizeBytes=0}}class BulkWriteResult{constructor(e){this.result=e}get ok(){return this.result.ok}get nInserted(){return this.result.nInserted}get nUpserted(){return this.result.nUpserted}get nMatched(){return this.result.nMatched}get nModified(){return this.result.nModified}get nRemoved(){return this.result.nRemoved}getInsertedIds(){return this.result.insertedIds}getUpsertedIds(){return this.result.upserted}getUpsertedIdAt(e){return this.result.upserted[e]}getRawResponse(){return this.result}hasWriteErrors(){return this.result.writeErrors.length>0}getWriteErrorCount(){return this.result.writeErrors.length}getWriteErrorAt(e){return e<this.result.writeErrors.length?this.result.writeErrors[e]:null}getWriteErrors(){return this.result.writeErrors}getLastOp(){return this.result.lastOp}getWriteConcernError(){if(0===this.result.writeConcernErrors.length)return null;if(1===this.result.writeConcernErrors.length)return this.result.writeConcernErrors[0];{let e=\"\";for(let r=0;r<this.result.writeConcernErrors.length;r++){e+=this.result.writeConcernErrors[r].errmsg,0===r&&(e+=\" and \")}return new WriteConcernError({errmsg:e,code:WRITE_CONCERN_ERROR})}}toJSON(){return this.result}toString(){return`BulkWriteResult(${this.toJSON(this.result)})`}isOk(){return 1===this.result.ok}}class WriteConcernError{constructor(e){this.err=e}get code(){return this.err.code}get errmsg(){return this.err.errmsg}toJSON(){return{code:this.err.code,errmsg:this.err.errmsg}}toString(){return`WriteConcernError(${this.err.errmsg})`}}class WriteError{constructor(e){this.err=e}get code(){return this.err.code}get index(){return this.err.index}get errmsg(){return this.err.errmsg}getOperation(){return this.err.op}toJSON(){return{code:this.err.code,index:this.err.index,errmsg:this.err.errmsg,op:this.err.op}}toString(){return`WriteError(${JSON.stringify(this.toJSON())})`}}function mergeBatchResults(e,r,t,s){if(t)s=t;else if(s&&s.result)s=s.result;else if(null==s)return;if(0===s.ok&&1===r.ok){r.ok=0;const t={index:0,code:s.code||0,errmsg:s.message,op:e.operations[0]};return void r.writeErrors.push(new WriteError(t))}if(0===s.ok&&0===r.ok)return;if(s.opTime||s.lastOp){const e=s.lastOp||s.opTime;let t=null,n=null;if(e&&\"Timestamp\"===e._bsontype)null==r.lastOp?r.lastOp=e:e.greaterThan(r.lastOp)&&(r.lastOp=e);else{r.lastOp&&(t=\"number\"==typeof r.lastOp.ts?Long.fromNumber(r.lastOp.ts):r.lastOp.ts,n=\"number\"==typeof r.lastOp.t?Long.fromNumber(r.lastOp.t):r.lastOp.t);const s=\"number\"==typeof e.ts?Long.fromNumber(e.ts):e.ts,i=\"number\"==typeof e.t?Long.fromNumber(e.t):e.t;null==r.lastOp?r.lastOp=e:s.greaterThan(t)?r.lastOp=e:s.equals(t)&&i.greaterThan(n)&&(r.lastOp=e)}}e.batchType===INSERT&&s.n&&(r.nInserted=r.nInserted+s.n),e.batchType===REMOVE&&s.n&&(r.nRemoved=r.nRemoved+s.n);let n=0;if(Array.isArray(s.upserted)){n=s.upserted.length;for(let t=0;t<s.upserted.length;t++)r.upserted.push({index:s.upserted[t].index+e.originalZeroIndex,_id:s.upserted[t]._id})}else s.upserted&&(n=1,r.upserted.push({index:e.originalZeroIndex,_id:s.upserted}));if(e.batchType===UPDATE&&s.n){const e=s.nModified;r.nUpserted=r.nUpserted+n,r.nMatched=r.nMatched+(s.n-n),r.nModified=\"number\"==typeof e?r.nModified+e:null}if(Array.isArray(s.writeErrors))for(let t=0;t<s.writeErrors.length;t++){const n={index:e.originalIndexes[t],code:s.writeErrors[t].code,errmsg:s.writeErrors[t].errmsg,op:e.operations[s.writeErrors[t].index]};r.writeErrors.push(new WriteError(n))}s.writeConcernError&&r.writeConcernErrors.push(new WriteConcernError(s.writeConcernError))}function executeCommands(e,r,t){if(0===e.s.batches.length)return handleCallback(t,null,new BulkWriteResult(e.s.bulkResult));const s=e.s.batches.shift();e.finalOptionsHandler({options:r,batch:s,resultHandler:function(n,i){if((n&&n.driver||n&&n.message)&&!(n instanceof MongoWriteConcernError))return handleCallback(t,n);if(n&&(n.ok=0),n instanceof MongoWriteConcernError)return handleMongoWriteConcernError(s,e.s.bulkResult,n,t);const o=new BulkWriteResult(e.s.bulkResult);if(null!=mergeBatchResults(s,e.s.bulkResult,n,i))return handleCallback(t,null,o);e.handleWriteError(t,o)||executeCommands(e,r,t)}},t)}function handleMongoWriteConcernError(e,r,t,s){mergeBatchResults(e,r,null,t.result);const n=new WriteConcernError({errmsg:t.result.writeConcernError.errmsg,code:t.result.writeConcernError.result});return handleCallback(s,new BulkWriteError(toError(n),new BulkWriteResult(r)),null)}class BulkWriteError extends MongoError{constructor(e,r){super(e.err||e.errmsg||e.errMessage||e),Object.assign(this,e),this.name=\"BulkWriteError\",this.result=r}}class FindOperators{constructor(e){this.s=e.s}update(e){const r=\"boolean\"==typeof this.s.currentOp.upsert&&this.s.currentOp.upsert,t={q:this.s.currentOp.selector,u:e,multi:!0,upsert:r};return e.hint&&(t.hint=e.hint),this.s.currentOp=null,this.s.options.addToOperationsList(this,UPDATE,t)}updateOne(e){const r=\"boolean\"==typeof this.s.currentOp.upsert&&this.s.currentOp.upsert,t={q:this.s.currentOp.selector,u:e,multi:!1,upsert:r};return e.hint&&(t.hint=e.hint),this.s.currentOp=null,this.s.options.addToOperationsList(this,UPDATE,t)}replaceOne(e){this.updateOne(e)}upsert(){return this.s.currentOp.upsert=!0,this}deleteOne(){const e={q:this.s.currentOp.selector,limit:1};return this.s.currentOp=null,this.s.options.addToOperationsList(this,REMOVE,e)}delete(){const e={q:this.s.currentOp.selector,limit:0};return this.s.currentOp=null,this.s.options.addToOperationsList(this,REMOVE,e)}removeOne(){return this.deleteOne()}remove(){return this.delete()}}class BulkOperationBase{constructor(e,r,t,s){this.isOrdered=s,t=null==t?{}:t;const n=r.s.namespace,i=e.bson,o=e.lastIsMaster(),l=o&&o.maxBsonObjectSize?o.maxBsonObjectSize:16777216,u=o&&o.maxWriteBatchSize?o.maxWriteBatchSize:1e3,a=(u-1).toString(10).length+2;let c=Object.assign({},t);c=applyRetryableWrites(c,r.s.db);const h=(c=applyWriteConcern(c,{collection:r},t)).writeConcern,d=t.promiseLibrary||Promise;this.s={bulkResult:{ok:1,writeErrors:[],writeConcernErrors:[],insertedIds:[],nInserted:0,nUpserted:0,nMatched:0,nModified:0,nRemoved:0,upserted:[]},currentBatch:null,currentIndex:0,currentBatchSize:0,currentBatchSizeBytes:0,currentInsertBatch:null,currentUpdateBatch:null,currentRemoveBatch:null,batches:[],writeConcern:h,maxBatchSizeBytes:l,maxWriteBatchSize:u,maxKeySize:a,namespace:n,bson:i,topology:e,options:c,currentOp:null,executed:!1,collection:r,promiseLibrary:d,err:null,checkKeys:\"boolean\"!=typeof t.checkKeys||t.checkKeys},!0===t.bypassDocumentValidation&&(this.s.bypassDocumentValidation=!0)}insert(e){return!0!==this.s.collection.s.db.options.forceServerObjectId&&null==e._id&&(e._id=new ObjectID),this.s.options.addToOperationsList(this,INSERT,e)}find(e){if(!e)throw toError(\"Bulk find operation must specify a selector\");return this.s.currentOp={selector:e},new FindOperators(this)}raw(e){const r=Object.keys(e)[0],t=\"boolean\"==typeof this.s.options.forceServerObjectId?this.s.options.forceServerObjectId:this.s.collection.s.db.options.forceServerObjectId;if(e.updateOne&&e.updateOne.q||e.updateMany&&e.updateMany.q||e.replaceOne&&e.replaceOne.q)return e[r].multi=!e.updateOne&&!e.replaceOne,this.s.options.addToOperationsList(this,UPDATE,e[r]);if(e.updateOne||e.updateMany||e.replaceOne){const t=!e.updateOne&&!e.replaceOne,s={q:e[r].filter,u:e[r].update||e[r].replacement,multi:t};return e[r].hint&&(s.hint=e[r].hint),this.isOrdered?(s.upsert=!!e[r].upsert,e.collation&&(s.collation=e.collation)):e[r].upsert&&(s.upsert=!0),e[r].arrayFilters&&(s.arrayFilters=e[r].arrayFilters),this.s.options.addToOperationsList(this,UPDATE,s)}if(e.removeOne||e.removeMany||e.deleteOne&&e.deleteOne.q||e.deleteMany&&e.deleteMany.q)return e[r].limit=e.removeOne?1:0,this.s.options.addToOperationsList(this,REMOVE,e[r]);if(e.deleteOne||e.deleteMany){const t=e.deleteOne?1:0,s={q:e[r].filter,limit:t};return this.isOrdered&&e.collation&&(s.collation=e.collation),this.s.options.addToOperationsList(this,REMOVE,s)}if(e.insertOne&&null==e.insertOne.document)return!0!==t&&null==e.insertOne._id&&(e.insertOne._id=new ObjectID),this.s.options.addToOperationsList(this,INSERT,e.insertOne);if(e.insertOne&&e.insertOne.document)return!0!==t&&null==e.insertOne.document._id&&(e.insertOne.document._id=new ObjectID),this.s.options.addToOperationsList(this,INSERT,e.insertOne.document);if(!e.insertMany)throw toError(\"bulkWrite only supports insertOne, insertMany, updateOne, updateMany, removeOne, removeMany, deleteOne, deleteMany\");for(let r=0;r<e.insertMany.length;r++)!0!==t&&null==e.insertMany[r]._id&&(e.insertMany[r]._id=new ObjectID),this.s.options.addToOperationsList(this,INSERT,e.insertMany[r])}_handleEarlyError(e,r){if(\"function\"!=typeof r)return this.s.promiseLibrary.reject(e);r(e,null)}bulkExecute(e,r,t){if(\"function\"==typeof r&&(t=r,r={}),r=r||{},\"function\"==typeof e?t=e:e&&\"object\"==typeof e&&(this.s.writeConcern=e),this.s.executed){const e=toError(\"batch cannot be re-executed\");return this._handleEarlyError(e,t)}if(this.isOrdered?this.s.currentBatch&&this.s.batches.push(this.s.currentBatch):(this.s.currentInsertBatch&&this.s.batches.push(this.s.currentInsertBatch),this.s.currentUpdateBatch&&this.s.batches.push(this.s.currentUpdateBatch),this.s.currentRemoveBatch&&this.s.batches.push(this.s.currentRemoveBatch)),0===this.s.batches.length){const e=toError(\"Invalid Operation, no operations specified\");return this._handleEarlyError(e,t)}return{options:r,callback:t}}execute(e,r,t){const s=this.bulkExecute(e,r,t);return!s||isPromiseLike(s)?s:(r=s.options,t=s.callback,executeLegacyOperation(this.s.topology,executeCommands,[this,r,t]))}finalOptionsHandler(e,r){const t=Object.assign({ordered:this.isOrdered},e.options);null!=this.s.writeConcern&&(t.writeConcern=this.s.writeConcern),!0!==t.bypassDocumentValidation&&delete t.bypassDocumentValidation,this.operationId&&(e.resultHandler.operationId=this.operationId),this.s.options.serializeFunctions&&(t.serializeFunctions=!0),this.s.options.ignoreUndefined&&(t.ignoreUndefined=!0),!0===this.s.bypassDocumentValidation&&(t.bypassDocumentValidation=!0),!1===this.s.checkKeys&&(t.checkKeys=!1),t.retryWrites&&(e.batch.batchType===UPDATE&&(t.retryWrites=t.retryWrites&&!e.batch.operations.some(e=>e.multi)),e.batch.batchType===REMOVE&&(t.retryWrites=t.retryWrites&&!e.batch.operations.some(e=>0===e.limit)));try{e.batch.batchType===INSERT?this.s.topology.insert(this.s.namespace,e.batch.operations,t,e.resultHandler):e.batch.batchType===UPDATE?this.s.topology.update(this.s.namespace,e.batch.operations,t,e.resultHandler):e.batch.batchType===REMOVE&&this.s.topology.remove(this.s.namespace,e.batch.operations,t,e.resultHandler)}catch(t){t.ok=0,handleCallback(r,null,mergeBatchResults(e.batch,this.s.bulkResult,t,null))}}handleWriteError(e,r){if(this.s.bulkResult.writeErrors.length>0){if(1===this.s.bulkResult.writeErrors.length)return handleCallback(e,new BulkWriteError(toError(this.s.bulkResult.writeErrors[0]),r),null),!0;const t=this.s.bulkResult.writeErrors[0].errmsg?this.s.bulkResult.writeErrors[0].errmsg:\"write operation failed\";return handleCallback(e,new BulkWriteError(toError({message:t,code:this.s.bulkResult.writeErrors[0].code,writeErrors:this.s.bulkResult.writeErrors}),r),null),!0}if(r.getWriteConcernError())return handleCallback(e,new BulkWriteError(toError(r.getWriteConcernError()),r),null),!0}}Object.defineProperty(BulkOperationBase.prototype,\"length\",{enumerable:!0,get:function(){return this.s.currentIndex}}),module.exports={Batch:Batch,BulkOperationBase:BulkOperationBase,bson:bson,INSERT:INSERT,UPDATE:UPDATE,REMOVE:REMOVE,BulkWriteError:BulkWriteError};","node_modules/mongodb/lib/admin.js":"\"use strict\";const applyWriteConcern=require(\"./utils\").applyWriteConcern,AddUserOperation=require(\"./operations/add_user\"),ExecuteDbAdminCommandOperation=require(\"./operations/execute_db_admin_command\"),RemoveUserOperation=require(\"./operations/remove_user\"),ValidateCollectionOperation=require(\"./operations/validate_collection\"),ListDatabasesOperation=require(\"./operations/list_databases\"),executeOperation=require(\"./operations/execute_operation\");function Admin(t,e,o){if(!(this instanceof Admin))return new Admin(t,e);this.s={db:t,topology:e,promiseLibrary:o}}Admin.prototype.command=function(t,e,o){const n=Array.prototype.slice.call(arguments,1);o=\"function\"==typeof n[n.length-1]?n.pop():void 0,e=n.length?n.shift():{};const i=new ExecuteDbAdminCommandOperation(this.s.db,t,e);return executeOperation(this.s.db.s.topology,i,o)},Admin.prototype.buildInfo=function(t,e){\"function\"==typeof t&&(e=t,t={}),t=t||{};const o=new ExecuteDbAdminCommandOperation(this.s.db,{buildinfo:1},t);return executeOperation(this.s.db.s.topology,o,e)},Admin.prototype.serverInfo=function(t,e){\"function\"==typeof t&&(e=t,t={}),t=t||{};const o=new ExecuteDbAdminCommandOperation(this.s.db,{buildinfo:1},t);return executeOperation(this.s.db.s.topology,o,e)},Admin.prototype.serverStatus=function(t,e){\"function\"==typeof t&&(e=t,t={}),t=t||{};const o=new ExecuteDbAdminCommandOperation(this.s.db,{serverStatus:1},t);return executeOperation(this.s.db.s.topology,o,e)},Admin.prototype.ping=function(t,e){\"function\"==typeof t&&(e=t,t={}),t=t||{};const o=new ExecuteDbAdminCommandOperation(this.s.db,{ping:1},t);return executeOperation(this.s.db.s.topology,o,e)},Admin.prototype.addUser=function(t,e,o,n){const i=Array.prototype.slice.call(arguments,2);n=\"function\"==typeof i[i.length-1]?i.pop():void 0,\"string\"==typeof t&&null!=e&&\"object\"==typeof e&&(o=e,e=null),o=i.length?i.shift():{},o=Object.assign({},o),(o=applyWriteConcern(o,{db:this.s.db})).dbName=\"admin\";const r=new AddUserOperation(this.s.db,t,e,o);return executeOperation(this.s.db.s.topology,r,n)},Admin.prototype.removeUser=function(t,e,o){const n=Array.prototype.slice.call(arguments,1);o=\"function\"==typeof n[n.length-1]?n.pop():void 0,e=n.length?n.shift():{},e=Object.assign({},e),(e=applyWriteConcern(e,{db:this.s.db})).dbName=\"admin\";const i=new RemoveUserOperation(this.s.db,t,e);return executeOperation(this.s.db.s.topology,i,o)},Admin.prototype.validateCollection=function(t,e,o){\"function\"==typeof e&&(o=e,e={});const n=new ValidateCollectionOperation(this,t,e=e||{});return executeOperation(this.s.db.s.topology,n,o)},Admin.prototype.listDatabases=function(t,e){return\"function\"==typeof t&&(e=t,t={}),t=t||{},executeOperation(this.s.db.s.topology,new ListDatabasesOperation(this.s.db,t),e)},Admin.prototype.replSetGetStatus=function(t,e){\"function\"==typeof t&&(e=t,t={}),t=t||{};const o=new ExecuteDbAdminCommandOperation(this.s.db,{replSetGetStatus:1},t);return executeOperation(this.s.db.s.topology,o,e)},module.exports=Admin;","node_modules/mongodb/lib/db.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter,inherits=require(\"util\").inherits,getSingleProperty=require(\"./utils\").getSingleProperty,CommandCursor=require(\"./command_cursor\"),handleCallback=require(\"./utils\").handleCallback,filterOptions=require(\"./utils\").filterOptions,toError=require(\"./utils\").toError,ReadPreference=require(\"./core\").ReadPreference,MongoError=require(\"./core\").MongoError,ObjectID=require(\"./core\").ObjectID,Logger=require(\"./core\").Logger,Collection=require(\"./collection\"),mergeOptionsAndWriteConcern=require(\"./utils\").mergeOptionsAndWriteConcern,executeLegacyOperation=require(\"./utils\").executeLegacyOperation,resolveReadPreference=require(\"./utils\").resolveReadPreference,ChangeStream=require(\"./change_stream\"),deprecate=require(\"util\").deprecate,deprecateOptions=require(\"./utils\").deprecateOptions,MongoDBNamespace=require(\"./utils\").MongoDBNamespace,CONSTANTS=require(\"./constants\"),WriteConcern=require(\"./write_concern\"),ReadConcern=require(\"./read_concern\"),AggregationCursor=require(\"./aggregation_cursor\"),createListener=require(\"./operations/db_ops\").createListener,ensureIndex=require(\"./operations/db_ops\").ensureIndex,evaluate=require(\"./operations/db_ops\").evaluate,profilingInfo=require(\"./operations/db_ops\").profilingInfo,validateDatabaseName=require(\"./operations/db_ops\").validateDatabaseName,AggregateOperation=require(\"./operations/aggregate\"),AddUserOperation=require(\"./operations/add_user\"),CollectionsOperation=require(\"./operations/collections\"),CommandOperation=require(\"./operations/command\"),CreateCollectionOperation=require(\"./operations/create_collection\"),CreateIndexOperation=require(\"./operations/create_index\"),DropCollectionOperation=require(\"./operations/drop\").DropCollectionOperation,DropDatabaseOperation=require(\"./operations/drop\").DropDatabaseOperation,ExecuteDbAdminCommandOperation=require(\"./operations/execute_db_admin_command\"),IndexInformationOperation=require(\"./operations/index_information\"),ListCollectionsOperation=require(\"./operations/list_collections\"),ProfilingLevelOperation=require(\"./operations/profiling_level\"),RemoveUserOperation=require(\"./operations/remove_user\"),RenameOperation=require(\"./operations/rename\"),SetProfilingLevelOperation=require(\"./operations/set_profiling_level\"),executeOperation=require(\"./operations/execute_operation\"),legalOptionNames=[\"w\",\"wtimeout\",\"fsync\",\"j\",\"readPreference\",\"readPreferenceTags\",\"native_parser\",\"forceServerObjectId\",\"pkFactory\",\"serializeFunctions\",\"raw\",\"bufferMaxEntries\",\"authSource\",\"ignoreUndefined\",\"promoteLongs\",\"promiseLibrary\",\"readConcern\",\"retryMiliSeconds\",\"numberOfRetries\",\"parentDb\",\"noListener\",\"loggerLevel\",\"logger\",\"promoteBuffers\",\"promoteLongs\",\"promoteValues\",\"compression\",\"retryWrites\"];function Db(e,t,r){if(r=r||{},!(this instanceof Db))return new Db(e,t,r);EventEmitter.call(this);const o=r.promiseLibrary||Promise;(r=filterOptions(r,legalOptionNames)).promiseLibrary=o,this.s={dbCache:{},children:[],topology:t,options:r,logger:Logger(\"Db\",r),bson:t?t.bson:null,readPreference:ReadPreference.fromOptions(r),bufferMaxEntries:\"number\"==typeof r.bufferMaxEntries?r.bufferMaxEntries:-1,parentDb:r.parentDb||null,pkFactory:r.pkFactory||ObjectID,nativeParser:r.nativeParser||r.native_parser,promiseLibrary:o,noListener:\"boolean\"==typeof r.noListener&&r.noListener,readConcern:ReadConcern.fromOptions(r),writeConcern:WriteConcern.fromOptions(r),namespace:new MongoDBNamespace(e)},validateDatabaseName(e),getSingleProperty(this,\"serverConfig\",this.s.topology),getSingleProperty(this,\"bufferMaxEntries\",this.s.bufferMaxEntries),getSingleProperty(this,\"databaseName\",this.s.namespace.db),r.parentDb||this.s.noListener||(t.on(\"error\",createListener(this,\"error\",this)),t.on(\"timeout\",createListener(this,\"timeout\",this)),t.on(\"close\",createListener(this,\"close\",this)),t.on(\"parseError\",createListener(this,\"parseError\",this)),t.once(\"open\",createListener(this,\"open\",this)),t.once(\"fullsetup\",createListener(this,\"fullsetup\",this)),t.once(\"all\",createListener(this,\"all\",this)),t.on(\"reconnect\",createListener(this,\"reconnect\",this)))}inherits(Db,EventEmitter),Object.defineProperty(Db.prototype,\"topology\",{enumerable:!0,get:function(){return this.s.topology}}),Object.defineProperty(Db.prototype,\"options\",{enumerable:!0,get:function(){return this.s.options}}),Object.defineProperty(Db.prototype,\"slaveOk\",{enumerable:!0,get:function(){return null!=this.s.options.readPreference&&(\"primary\"!==this.s.options.readPreference||\"primary\"!==this.s.options.readPreference.mode)}}),Object.defineProperty(Db.prototype,\"readConcern\",{enumerable:!0,get:function(){return this.s.readConcern}}),Object.defineProperty(Db.prototype,\"readPreference\",{enumerable:!0,get:function(){return null==this.s.readPreference?ReadPreference.primary:this.s.readPreference}}),Object.defineProperty(Db.prototype,\"writeConcern\",{enumerable:!0,get:function(){return this.s.writeConcern}}),Object.defineProperty(Db.prototype,\"namespace\",{enumerable:!0,get:function(){return this.s.namespace.toString()}}),Db.prototype.command=function(e,t,r){\"function\"==typeof t&&(r=t,t={}),t=Object.assign({},t);const o=new CommandOperation(this,t,null,e);return executeOperation(this.s.topology,o,r)},Db.prototype.aggregate=function(e,t,r){\"function\"==typeof t&&(r=t,t={}),null==t&&null==r&&(t={});const o=new AggregationCursor(this.s.topology,new AggregateOperation(this,e,t),t);if(\"function\"!=typeof r)return o;r(null,o)},Db.prototype.admin=function(){return new(require(\"./admin\"))(this,this.s.topology,this.s.promiseLibrary)};const collectionKeys=[\"pkFactory\",\"readPreference\",\"serializeFunctions\",\"strict\",\"readConcern\",\"ignoreUndefined\",\"promoteValues\",\"promoteBuffers\",\"promoteLongs\"];Db.prototype.collection=function(e,t,r){if(\"function\"==typeof t&&(r=t,t={}),t=t||{},(t=Object.assign({},t)).promiseLibrary=this.s.promiseLibrary,t.readConcern=t.readConcern?new ReadConcern(t.readConcern.level):this.readConcern,this.s.options.ignoreUndefined&&(t.ignoreUndefined=this.s.options.ignoreUndefined),null==(t=mergeOptionsAndWriteConcern(t,this.s.options,collectionKeys,!0))||!t.strict)try{const o=new Collection(this,this.s.topology,this.databaseName,e,this.s.pkFactory,t);return r&&r(null,o),o}catch(e){if(e instanceof MongoError&&r)return r(e);throw e}if(\"function\"!=typeof r)throw toError(`A callback is required in strict mode. While getting collection ${e}`);if(this.serverConfig&&this.serverConfig.isDestroyed())return r(new MongoError(\"topology was destroyed\"));const o=Object.assign({},t,{nameOnly:!0});this.listCollections({name:e},o).toArray((o,n)=>{if(null!=o)return handleCallback(r,o,null);if(0===n.length)return handleCallback(r,toError(`Collection ${e} does not exist. Currently in strict mode.`),null);try{return handleCallback(r,null,new Collection(this,this.s.topology,this.databaseName,e,this.s.pkFactory,t))}catch(o){return handleCallback(r,o,null)}})},Db.prototype.createCollection=deprecateOptions({name:\"Db.createCollection\",deprecatedOptions:[\"autoIndexId\"],optionsIndex:1},function(e,t,r){\"function\"==typeof t&&(r=t,t={}),(t=t||{}).promiseLibrary=t.promiseLibrary||this.s.promiseLibrary,t.readConcern=t.readConcern?new ReadConcern(t.readConcern.level):this.readConcern;const o=new CreateCollectionOperation(this,e,t);return executeOperation(this.s.topology,o,r)}),Db.prototype.stats=function(e,t){\"function\"==typeof e&&(t=e,e={});const r={dbStats:!0};null!=(e=e||{}).scale&&(r.scale=e.scale),null==e.readPreference&&this.s.readPreference&&(e.readPreference=this.s.readPreference);const o=new CommandOperation(this,e,null,r);return executeOperation(this.s.topology,o,t)},Db.prototype.listCollections=function(e,t){return e=e||{},t=t||{},new CommandCursor(this.s.topology,new ListCollectionsOperation(this,e,t),t)},Db.prototype.eval=deprecate(function(e,t,r,o){const n=Array.prototype.slice.call(arguments,1);return o=\"function\"==typeof n[n.length-1]?n.pop():void 0,t=n.length?n.shift():t,r=n.length&&n.shift()||{},executeLegacyOperation(this.s.topology,evaluate,[this,e,t,r,o])},\"Db.eval is deprecated as of MongoDB version 3.2\"),Db.prototype.renameCollection=function(e,t,r,o){\"function\"==typeof r&&(o=r,r={}),(r=Object.assign({},r,{readPreference:ReadPreference.PRIMARY})).new_collection=!0;const n=new RenameOperation(this.collection(e),t,r);return executeOperation(this.s.topology,n,o)},Db.prototype.dropCollection=function(e,t,r){\"function\"==typeof t&&(r=t,t={});const o=new DropCollectionOperation(this,e,t=t||{});return executeOperation(this.s.topology,o,r)},Db.prototype.dropDatabase=function(e,t){\"function\"==typeof e&&(t=e,e={});const r=new DropDatabaseOperation(this,e=e||{});return executeOperation(this.s.topology,r,t)},Db.prototype.collections=function(e,t){\"function\"==typeof e&&(t=e,e={});const r=new CollectionsOperation(this,e=e||{});return executeOperation(this.s.topology,r,t)},Db.prototype.executeDbAdminCommand=function(e,t,r){\"function\"==typeof t&&(r=t,t={}),(t=t||{}).readPreference=resolveReadPreference(this,t);const o=new ExecuteDbAdminCommandOperation(this,e,t);return executeOperation(this.s.topology,o,r)},Db.prototype.createIndex=function(e,t,r,o){\"function\"==typeof r&&(o=r,r={}),r=r?Object.assign({},r):{};const n=new CreateIndexOperation(this,e,t,r);return executeOperation(this.s.topology,n,o)},Db.prototype.ensureIndex=deprecate(function(e,t,r,o){return\"function\"==typeof r&&(o=r,r={}),r=r||{},executeLegacyOperation(this.s.topology,ensureIndex,[this,e,t,r,o])},\"Db.ensureIndex is deprecated as of MongoDB version 3.0 / driver version 2.0\"),Db.prototype.addChild=function(e){if(this.s.parentDb)return this.s.parentDb.addChild(e);this.s.children.push(e)},Db.prototype.addUser=function(e,t,r,o){\"function\"==typeof r&&(o=r,r={}),r=r||{},\"string\"==typeof e&&null!=t&&\"object\"==typeof t&&(r=t,t=null);const n=new AddUserOperation(this,e,t,r);return executeOperation(this.s.topology,n,o)},Db.prototype.removeUser=function(e,t,r){\"function\"==typeof t&&(r=t,t={});const o=new RemoveUserOperation(this,e,t=t||{});return executeOperation(this.s.topology,o,r)},Db.prototype.setProfilingLevel=function(e,t,r){\"function\"==typeof t&&(r=t,t={});const o=new SetProfilingLevelOperation(this,e,t=t||{});return executeOperation(this.s.topology,o,r)},Db.prototype.profilingInfo=deprecate(function(e,t){return\"function\"==typeof e&&(t=e,e={}),e=e||{},executeLegacyOperation(this.s.topology,profilingInfo,[this,e,t])},\"Db.profilingInfo is deprecated. Query the system.profile collection directly.\"),Db.prototype.profilingLevel=function(e,t){\"function\"==typeof e&&(t=e,e={});const r=new ProfilingLevelOperation(this,e=e||{});return executeOperation(this.s.topology,r,t)},Db.prototype.indexInformation=function(e,t,r){\"function\"==typeof t&&(r=t,t={});const o=new IndexInformationOperation(this,e,t=t||{});return executeOperation(this.s.topology,o,r)},Db.prototype.unref=function(){this.s.topology.unref()},Db.prototype.watch=function(e,t){return e=e||[],t=t||{},Array.isArray(e)||(t=e,e=[]),new ChangeStream(this,e,t)},Db.prototype.getLogger=function(){return this.s.logger},Db.SYSTEM_NAMESPACE_COLLECTION=CONSTANTS.SYSTEM_NAMESPACE_COLLECTION,Db.SYSTEM_INDEX_COLLECTION=CONSTANTS.SYSTEM_INDEX_COLLECTION,Db.SYSTEM_PROFILE_COLLECTION=CONSTANTS.SYSTEM_PROFILE_COLLECTION,Db.SYSTEM_USER_COLLECTION=CONSTANTS.SYSTEM_USER_COLLECTION,Db.SYSTEM_COMMAND_COLLECTION=CONSTANTS.SYSTEM_COMMAND_COLLECTION,Db.SYSTEM_JS_COLLECTION=CONSTANTS.SYSTEM_JS_COLLECTION,module.exports=Db;","node_modules/mongodb/lib/collection.js":"\"use strict\";const deprecate=require(\"util\").deprecate,deprecateOptions=require(\"./utils\").deprecateOptions,checkCollectionName=require(\"./utils\").checkCollectionName,ObjectID=require(\"./core\").BSON.ObjectID,MongoError=require(\"./core\").MongoError,toError=require(\"./utils\").toError,normalizeHintField=require(\"./utils\").normalizeHintField,decorateCommand=require(\"./utils\").decorateCommand,decorateWithCollation=require(\"./utils\").decorateWithCollation,decorateWithReadConcern=require(\"./utils\").decorateWithReadConcern,formattedOrderClause=require(\"./utils\").formattedOrderClause,ReadPreference=require(\"./core\").ReadPreference,unordered=require(\"./bulk/unordered\"),ordered=require(\"./bulk/ordered\"),ChangeStream=require(\"./change_stream\"),executeLegacyOperation=require(\"./utils\").executeLegacyOperation,resolveReadPreference=require(\"./utils\").resolveReadPreference,WriteConcern=require(\"./write_concern\"),ReadConcern=require(\"./read_concern\"),MongoDBNamespace=require(\"./utils\").MongoDBNamespace,AggregationCursor=require(\"./aggregation_cursor\"),CommandCursor=require(\"./command_cursor\"),checkForAtomicOperators=require(\"./operations/collection_ops\").checkForAtomicOperators,ensureIndex=require(\"./operations/collection_ops\").ensureIndex,group=require(\"./operations/collection_ops\").group,parallelCollectionScan=require(\"./operations/collection_ops\").parallelCollectionScan,removeDocuments=require(\"./operations/common_functions\").removeDocuments,save=require(\"./operations/collection_ops\").save,updateDocuments=require(\"./operations/common_functions\").updateDocuments,AggregateOperation=require(\"./operations/aggregate\"),BulkWriteOperation=require(\"./operations/bulk_write\"),CountDocumentsOperation=require(\"./operations/count_documents\"),CreateIndexOperation=require(\"./operations/create_index\"),CreateIndexesOperation=require(\"./operations/create_indexes\"),DeleteManyOperation=require(\"./operations/delete_many\"),DeleteOneOperation=require(\"./operations/delete_one\"),DistinctOperation=require(\"./operations/distinct\"),DropCollectionOperation=require(\"./operations/drop\").DropCollectionOperation,DropIndexOperation=require(\"./operations/drop_index\"),DropIndexesOperation=require(\"./operations/drop_indexes\"),EstimatedDocumentCountOperation=require(\"./operations/estimated_document_count\"),FindOperation=require(\"./operations/find\"),FindOneOperation=require(\"./operations/find_one\"),FindAndModifyOperation=require(\"./operations/find_and_modify\"),FindOneAndDeleteOperation=require(\"./operations/find_one_and_delete\"),FindOneAndReplaceOperation=require(\"./operations/find_one_and_replace\"),FindOneAndUpdateOperation=require(\"./operations/find_one_and_update\"),GeoHaystackSearchOperation=require(\"./operations/geo_haystack_search\"),IndexesOperation=require(\"./operations/indexes\"),IndexExistsOperation=require(\"./operations/index_exists\"),IndexInformationOperation=require(\"./operations/index_information\"),InsertManyOperation=require(\"./operations/insert_many\"),InsertOneOperation=require(\"./operations/insert_one\"),IsCappedOperation=require(\"./operations/is_capped\"),ListIndexesOperation=require(\"./operations/list_indexes\"),MapReduceOperation=require(\"./operations/map_reduce\"),OptionsOperation=require(\"./operations/options_operation\"),RenameOperation=require(\"./operations/rename\"),ReIndexOperation=require(\"./operations/re_index\"),ReplaceOneOperation=require(\"./operations/replace_one\"),StatsOperation=require(\"./operations/stats\"),UpdateManyOperation=require(\"./operations/update_many\"),UpdateOneOperation=require(\"./operations/update_one\"),executeOperation=require(\"./operations/execute_operation\"),mergeKeys=[\"ignoreUndefined\"];function Collection(e,t,o,n,r,i){checkCollectionName(n);const s=null==i||null==i.slaveOk?e.slaveOk:i.slaveOk,p=null==i||null==i.serializeFunctions?e.s.options.serializeFunctions:i.serializeFunctions,a=null==i||null==i.raw?e.s.options.raw:i.raw,c=null==i||null==i.promoteLongs?e.s.options.promoteLongs:i.promoteLongs,l=null==i||null==i.promoteValues?e.s.options.promoteValues:i.promoteValues,u=null==i||null==i.promoteBuffers?e.s.options.promoteBuffers:i.promoteBuffers,d=new MongoDBNamespace(o,n),f=i.promiseLibrary||Promise;r=null==r?ObjectID:r,this.s={pkFactory:r,db:e,topology:t,options:i,namespace:d,readPreference:ReadPreference.fromOptions(i),slaveOk:s,serializeFunctions:p,raw:a,promoteLongs:c,promoteValues:l,promoteBuffers:u,internalHint:null,collectionHint:null,promiseLibrary:f,readConcern:ReadConcern.fromOptions(i),writeConcern:WriteConcern.fromOptions(i)}}Object.defineProperty(Collection.prototype,\"dbName\",{enumerable:!0,get:function(){return this.s.namespace.db}}),Object.defineProperty(Collection.prototype,\"collectionName\",{enumerable:!0,get:function(){return this.s.namespace.collection}}),Object.defineProperty(Collection.prototype,\"namespace\",{enumerable:!0,get:function(){return this.s.namespace.toString()}}),Object.defineProperty(Collection.prototype,\"readConcern\",{enumerable:!0,get:function(){return null==this.s.readConcern?this.s.db.readConcern:this.s.readConcern}}),Object.defineProperty(Collection.prototype,\"readPreference\",{enumerable:!0,get:function(){return null==this.s.readPreference?this.s.db.readPreference:this.s.readPreference}}),Object.defineProperty(Collection.prototype,\"writeConcern\",{enumerable:!0,get:function(){return null==this.s.writeConcern?this.s.db.writeConcern:this.s.writeConcern}}),Object.defineProperty(Collection.prototype,\"hint\",{enumerable:!0,get:function(){return this.s.collectionHint},set:function(e){this.s.collectionHint=normalizeHintField(e)}});const DEPRECATED_FIND_OPTIONS=[\"maxScan\",\"fields\",\"snapshot\"];function _findAndModify(e,t,o,n,r){const i=Array.prototype.slice.call(arguments,1);return r=\"function\"==typeof i[i.length-1]?i.pop():void 0,t=i.length&&i.shift()||[],o=i.length?i.shift():null,n=i.length&&i.shift()||{},(n=Object.assign({},n)).readPreference=ReadPreference.PRIMARY,executeOperation(this.s.topology,new FindAndModifyOperation(this,e,t,o,n),r)}Collection.prototype.find=deprecateOptions({name:\"collection.find\",deprecatedOptions:DEPRECATED_FIND_OPTIONS,optionsIndex:1},function(e,t,o){\"object\"==typeof o&&console.warn(\"Third parameter to `find()` must be a callback or undefined\");let n=e;\"function\"!=typeof o&&(\"function\"==typeof t?(o=t,t=void 0):null==t&&(o=\"function\"==typeof n?n:void 0,n=\"object\"==typeof n?n:void 0));const r=n=null==n?{}:n;if(Buffer.isBuffer(r)){const e=r[0]|r[1]<<8|r[2]<<16|r[3]<<24;if(e!==r.length){const t=new Error(\"query selector raw message size does not match message header size [\"+r.length+\"] != [\"+e+\"]\");throw t.name=\"MongoError\",t}}null!=n&&\"ObjectID\"===n._bsontype&&(n={_id:n}),t||(t={});let i=t.projection||t.fields;i&&!Buffer.isBuffer(i)&&Array.isArray(i)&&(i=i.length?i.reduce((e,t)=>(e[t]=1,e),{}):{_id:1});let s=Object.assign({},t);for(let e in this.s.options)-1!==mergeKeys.indexOf(e)&&(s[e]=this.s.options[e]);if(s.skip=t.skip?t.skip:0,s.limit=t.limit?t.limit:0,s.raw=\"boolean\"==typeof t.raw?t.raw:this.s.raw,s.hint=null!=t.hint?normalizeHintField(t.hint):this.s.collectionHint,s.timeout=void 0===t.timeout?void 0:t.timeout,s.slaveOk=null!=t.slaveOk?t.slaveOk:this.s.db.slaveOk,s.readPreference=resolveReadPreference(this,s),null==s.readPreference||\"primary\"===s.readPreference&&\"primary\"===s.readPreference.mode||(s.slaveOk=!0),null!=n&&\"object\"!=typeof n)throw MongoError.create({message:\"query selector must be an object\",driver:!0});const p={find:this.s.namespace.toString(),limit:s.limit,skip:s.skip,query:n};\"boolean\"==typeof s.awaitdata&&(s.awaitData=s.awaitdata),\"boolean\"==typeof s.timeout&&(s.noCursorTimeout=s.timeout),decorateCommand(p,s,[\"session\",\"collation\"]),i&&(p.fields=i),s.db=this.s.db,s.promiseLibrary=this.s.promiseLibrary,null==s.raw&&\"boolean\"==typeof this.s.raw&&(s.raw=this.s.raw),null==s.promoteLongs&&\"boolean\"==typeof this.s.promoteLongs&&(s.promoteLongs=this.s.promoteLongs),null==s.promoteValues&&\"boolean\"==typeof this.s.promoteValues&&(s.promoteValues=this.s.promoteValues),null==s.promoteBuffers&&\"boolean\"==typeof this.s.promoteBuffers&&(s.promoteBuffers=this.s.promoteBuffers),p.sort&&(p.sort=formattedOrderClause(p.sort)),decorateWithReadConcern(p,this,t);try{decorateWithCollation(p,this,t)}catch(e){if(\"function\"==typeof o)return o(e,null);throw e}const a=this.s.topology.cursor(new FindOperation(this,this.s.namespace,p,s),s);if(\"function\"!=typeof o)return a;o(null,a)}),Collection.prototype.insertOne=function(e,t,o){\"function\"==typeof t&&(o=t,t={}),t=t||{},this.s.options.ignoreUndefined&&((t=Object.assign({},t)).ignoreUndefined=this.s.options.ignoreUndefined);const n=new InsertOneOperation(this,e,t);return executeOperation(this.s.topology,n,o)},Collection.prototype.insertMany=function(e,t,o){\"function\"==typeof t&&(o=t,t={}),t=t?Object.assign({},t):{ordered:!0};const n=new InsertManyOperation(this,e,t);return executeOperation(this.s.topology,n,o)},Collection.prototype.bulkWrite=function(e,t,o){if(\"function\"==typeof t&&(o=t,t={}),t=t||{ordered:!0},!Array.isArray(e))throw MongoError.create({message:\"operations must be an array of documents\",driver:!0});const n=new BulkWriteOperation(this,e,t);return executeOperation(this.s.topology,n,o)},Collection.prototype.insert=deprecate(function(e,t,o){return\"function\"==typeof t&&(o=t,t={}),t=t||{ordered:!1},e=Array.isArray(e)?e:[e],!0===t.keepGoing&&(t.ordered=!1),this.insertMany(e,t,o)},\"collection.insert is deprecated. Use insertOne, insertMany or bulkWrite instead.\"),Collection.prototype.updateOne=function(e,t,o,n){\"function\"==typeof o&&(n=o,o={}),o=o||{};const r=checkForAtomicOperators(t);if(r)return\"function\"==typeof n?n(r):this.s.promiseLibrary.reject(r);o=Object.assign({},o),this.s.options.ignoreUndefined&&((o=Object.assign({},o)).ignoreUndefined=this.s.options.ignoreUndefined);const i=new UpdateOneOperation(this,e,t,o);return executeOperation(this.s.topology,i,n)},Collection.prototype.replaceOne=function(e,t,o,n){\"function\"==typeof o&&(n=o,o={}),o=Object.assign({},o),this.s.options.ignoreUndefined&&((o=Object.assign({},o)).ignoreUndefined=this.s.options.ignoreUndefined);const r=new ReplaceOneOperation(this,e,t,o);return executeOperation(this.s.topology,r,n)},Collection.prototype.updateMany=function(e,t,o,n){\"function\"==typeof o&&(n=o,o={}),o=o||{};const r=checkForAtomicOperators(t);if(r)return\"function\"==typeof n?n(r):this.s.promiseLibrary.reject(r);o=Object.assign({},o),this.s.options.ignoreUndefined&&((o=Object.assign({},o)).ignoreUndefined=this.s.options.ignoreUndefined);const i=new UpdateManyOperation(this,e,t,o);return executeOperation(this.s.topology,i,n)},Collection.prototype.update=deprecate(function(e,t,o,n){return\"function\"==typeof o&&(n=o,o={}),o=o||{},this.s.options.ignoreUndefined&&((o=Object.assign({},o)).ignoreUndefined=this.s.options.ignoreUndefined),executeLegacyOperation(this.s.topology,updateDocuments,[this,e,t,o,n])},\"collection.update is deprecated. Use updateOne, updateMany, or bulkWrite instead.\"),Collection.prototype.deleteOne=function(e,t,o){\"function\"==typeof t&&(o=t,t={}),t=Object.assign({},t),this.s.options.ignoreUndefined&&((t=Object.assign({},t)).ignoreUndefined=this.s.options.ignoreUndefined);const n=new DeleteOneOperation(this,e,t);return executeOperation(this.s.topology,n,o)},Collection.prototype.removeOne=Collection.prototype.deleteOne,Collection.prototype.deleteMany=function(e,t,o){\"function\"==typeof t&&(o=t,t={}),t=Object.assign({},t),this.s.options.ignoreUndefined&&((t=Object.assign({},t)).ignoreUndefined=this.s.options.ignoreUndefined);const n=new DeleteManyOperation(this,e,t);return executeOperation(this.s.topology,n,o)},Collection.prototype.removeMany=Collection.prototype.deleteMany,Collection.prototype.remove=deprecate(function(e,t,o){return\"function\"==typeof t&&(o=t,t={}),t=t||{},this.s.options.ignoreUndefined&&((t=Object.assign({},t)).ignoreUndefined=this.s.options.ignoreUndefined),executeLegacyOperation(this.s.topology,removeDocuments,[this,e,t,o])},\"collection.remove is deprecated. Use deleteOne, deleteMany, or bulkWrite instead.\"),Collection.prototype.save=deprecate(function(e,t,o){return\"function\"==typeof t&&(o=t,t={}),t=t||{},this.s.options.ignoreUndefined&&((t=Object.assign({},t)).ignoreUndefined=this.s.options.ignoreUndefined),executeLegacyOperation(this.s.topology,save,[this,e,t,o])},\"collection.save is deprecated. Use insertOne, insertMany, updateOne, or updateMany instead.\"),Collection.prototype.findOne=deprecateOptions({name:\"collection.find\",deprecatedOptions:DEPRECATED_FIND_OPTIONS,optionsIndex:1},function(e,t,o){\"object\"==typeof o&&console.warn(\"Third parameter to `findOne()` must be a callback or undefined\"),\"function\"==typeof e&&(o=e,e={},t={}),\"function\"==typeof t&&(o=t,t={});const n=new FindOneOperation(this,e=e||{},t=t||{});return executeOperation(this.s.topology,n,o)}),Collection.prototype.rename=function(e,t,o){\"function\"==typeof t&&(o=t,t={}),t=Object.assign({},t,{readPreference:ReadPreference.PRIMARY});const n=new RenameOperation(this,e,t);return executeOperation(this.s.topology,n,o)},Collection.prototype.drop=function(e,t){\"function\"==typeof e&&(t=e,e={}),e=e||{};const o=new DropCollectionOperation(this.s.db,this.collectionName,e);return executeOperation(this.s.topology,o,t)},Collection.prototype.options=function(e,t){\"function\"==typeof e&&(t=e,e={});const o=new OptionsOperation(this,e=e||{});return executeOperation(this.s.topology,o,t)},Collection.prototype.isCapped=function(e,t){\"function\"==typeof e&&(t=e,e={});const o=new IsCappedOperation(this,e=e||{});return executeOperation(this.s.topology,o,t)},Collection.prototype.createIndex=function(e,t,o){\"function\"==typeof t&&(o=t,t={}),t=t||{};const n=new CreateIndexOperation(this.s.db,this.collectionName,e,t);return executeOperation(this.s.topology,n,o)},Collection.prototype.createIndexes=function(e,t,o){\"function\"==typeof t&&(o=t,t={}),\"number\"!=typeof(t=t?Object.assign({},t):{}).maxTimeMS&&delete t.maxTimeMS;const n=new CreateIndexesOperation(this,e,t);return executeOperation(this.s.topology,n,o)},Collection.prototype.dropIndex=function(e,t,o){const n=Array.prototype.slice.call(arguments,1);o=\"function\"==typeof n[n.length-1]?n.pop():void 0,(t=n.length&&n.shift()||{}).readPreference=ReadPreference.PRIMARY;const r=new DropIndexOperation(this,e,t);return executeOperation(this.s.topology,r,o)},Collection.prototype.dropIndexes=function(e,t){\"function\"==typeof e&&(t=e,e={}),\"number\"!=typeof(e=e?Object.assign({},e):{}).maxTimeMS&&delete e.maxTimeMS;const o=new DropIndexesOperation(this,e);return executeOperation(this.s.topology,o,t)},Collection.prototype.dropAllIndexes=deprecate(Collection.prototype.dropIndexes,\"collection.dropAllIndexes is deprecated. Use dropIndexes instead.\"),Collection.prototype.reIndex=function(e,t){\"function\"==typeof e&&(t=e,e={});const o=new ReIndexOperation(this,e=e||{});return executeOperation(this.s.topology,o,t)},Collection.prototype.listIndexes=function(e){return new CommandCursor(this.s.topology,new ListIndexesOperation(this,e),e)},Collection.prototype.ensureIndex=deprecate(function(e,t,o){return\"function\"==typeof t&&(o=t,t={}),t=t||{},executeLegacyOperation(this.s.topology,ensureIndex,[this,e,t,o])},\"collection.ensureIndex is deprecated. Use createIndexes instead.\"),Collection.prototype.indexExists=function(e,t,o){\"function\"==typeof t&&(o=t,t={});const n=new IndexExistsOperation(this,e,t=t||{});return executeOperation(this.s.topology,n,o)},Collection.prototype.indexInformation=function(e,t){const o=Array.prototype.slice.call(arguments,0);t=\"function\"==typeof o[o.length-1]?o.pop():void 0,e=o.length&&o.shift()||{};const n=new IndexInformationOperation(this.s.db,this.collectionName,e);return executeOperation(this.s.topology,n,t)},Collection.prototype.count=deprecate(function(e,t,o){const n=Array.prototype.slice.call(arguments,0);return o=\"function\"==typeof n[n.length-1]?n.pop():void 0,e=n.length&&n.shift()||{},\"function\"==typeof(t=n.length&&n.shift()||{})&&(o=t,t={}),t=t||{},executeOperation(this.s.topology,new EstimatedDocumentCountOperation(this,e,t),o)},\"collection.count is deprecated, and will be removed in a future version. Use Collection.countDocuments or Collection.estimatedDocumentCount instead\"),Collection.prototype.estimatedDocumentCount=function(e,t){\"function\"==typeof e&&(t=e,e={});const o=new EstimatedDocumentCountOperation(this,e=e||{});return executeOperation(this.s.topology,o,t)},Collection.prototype.countDocuments=function(e,t,o){const n=Array.prototype.slice.call(arguments,0);o=\"function\"==typeof n[n.length-1]?n.pop():void 0,e=n.length&&n.shift()||{},t=n.length&&n.shift()||{};const r=new CountDocumentsOperation(this,e,t);return executeOperation(this.s.topology,r,o)},Collection.prototype.distinct=function(e,t,o,n){const r=Array.prototype.slice.call(arguments,1);n=\"function\"==typeof r[r.length-1]?r.pop():void 0;const i=r.length&&r.shift()||{},s=r.length&&r.shift()||{},p=new DistinctOperation(this,e,i,s);return executeOperation(this.s.topology,p,n)},Collection.prototype.indexes=function(e,t){\"function\"==typeof e&&(t=e,e={});const o=new IndexesOperation(this,e=e||{});return executeOperation(this.s.topology,o,t)},Collection.prototype.stats=function(e,t){const o=Array.prototype.slice.call(arguments,0);t=\"function\"==typeof o[o.length-1]?o.pop():void 0,e=o.length&&o.shift()||{};const n=new StatsOperation(this,e);return executeOperation(this.s.topology,n,t)},Collection.prototype.findOneAndDelete=function(e,t,o){if(\"function\"==typeof t&&(o=t,t={}),t=t||{},null==e||\"object\"!=typeof e)throw toError(\"filter parameter must be an object\");const n=new FindOneAndDeleteOperation(this,e,t);return executeOperation(this.s.topology,n,o)},Collection.prototype.findOneAndReplace=function(e,t,o,n){if(\"function\"==typeof o&&(n=o,o={}),o=o||{},null==e||\"object\"!=typeof e)throw toError(\"filter parameter must be an object\");if(null==t||\"object\"!=typeof t)throw toError(\"replacement parameter must be an object\");const r=Object.keys(t);if(r[0]&&\"$\"===r[0][0])throw toError(\"The replacement document must not contain atomic operators.\");const i=new FindOneAndReplaceOperation(this,e,t,o);return executeOperation(this.s.topology,i,n)},Collection.prototype.findOneAndUpdate=function(e,t,o,n){if(\"function\"==typeof o&&(n=o,o={}),o=o||{},null==e||\"object\"!=typeof e)throw toError(\"filter parameter must be an object\");if(null==t||\"object\"!=typeof t)throw toError(\"update parameter must be an object\");const r=checkForAtomicOperators(t);if(r)return\"function\"==typeof n?n(r):this.s.promiseLibrary.reject(r);const i=new FindOneAndUpdateOperation(this,e,t,o);return executeOperation(this.s.topology,i,n)},Collection.prototype.findAndModify=deprecate(_findAndModify,\"collection.findAndModify is deprecated. Use findOneAndUpdate, findOneAndReplace or findOneAndDelete instead.\"),Collection.prototype._findAndModify=_findAndModify,Collection.prototype.findAndRemove=deprecate(function(e,t,o,n){const r=Array.prototype.slice.call(arguments,1);return n=\"function\"==typeof r[r.length-1]?r.pop():void 0,t=r.length&&r.shift()||[],(o=r.length&&r.shift()||{}).remove=!0,executeOperation(this.s.topology,new FindAndModifyOperation(this,e,t,null,o),n)},\"collection.findAndRemove is deprecated. Use findOneAndDelete instead.\"),Collection.prototype.aggregate=function(e,t,o){if(Array.isArray(e))\"function\"==typeof t&&(o=t,t={}),null==t&&null==o&&(t={});else{const n=Array.prototype.slice.call(arguments,0);o=n.pop();const r=n[n.length-1];t=r&&(r.readPreference||r.explain||r.cursor||r.out||r.maxTimeMS||r.hint||r.allowDiskUse)?n.pop():{},e=n}const n=new AggregationCursor(this.s.topology,new AggregateOperation(this,e,t),t);if(\"function\"!=typeof o)return n;o(null,n)},Collection.prototype.watch=function(e,t){return e=e||[],t=t||{},Array.isArray(e)||(t=e,e=[]),new ChangeStream(this,e,t)},Collection.prototype.parallelCollectionScan=deprecate(function(e,t){return\"function\"==typeof e&&(t=e,e={numCursors:1}),e.numCursors=e.numCursors||1,e.batchSize=e.batchSize||1e3,(e=Object.assign({},e)).readPreference=resolveReadPreference(this,e),e.promiseLibrary=this.s.promiseLibrary,e.session&&(e.session=void 0),executeLegacyOperation(this.s.topology,parallelCollectionScan,[this,e,t],{skipSessions:!0})},\"parallelCollectionScan is deprecated in MongoDB v4.1\"),Collection.prototype.geoHaystackSearch=function(e,t,o,n){const r=Array.prototype.slice.call(arguments,2);n=\"function\"==typeof r[r.length-1]?r.pop():void 0,o=r.length&&r.shift()||{};const i=new GeoHaystackSearchOperation(this,e,t,o);return executeOperation(this.s.topology,i,n)},Collection.prototype.group=deprecate(function(e,t,o,n,r,i,s,p){const a=Array.prototype.slice.call(arguments,3);return p=\"function\"==typeof a[a.length-1]?a.pop():void 0,n=a.length?a.shift():null,r=a.length?a.shift():null,i=a.length?a.shift():null,s=a.length&&a.shift()||{},\"function\"!=typeof r&&(i=r,r=null),!Array.isArray(e)&&e instanceof Object&&\"function\"!=typeof e&&\"Code\"!==e._bsontype&&(e=Object.keys(e)),\"function\"==typeof n&&(n=n.toString()),\"function\"==typeof r&&(r=r.toString()),i=null==i||i,executeLegacyOperation(this.s.topology,group,[this,e,t,o,n,r,i,s,p])},\"MongoDB 3.6 or higher no longer supports the group command. We recommend rewriting using the aggregation framework.\"),Collection.prototype.mapReduce=function(e,t,o,n){if(\"function\"==typeof o&&(n=o,o={}),null==o.out)throw new Error(\"the out option parameter must be defined, see mongodb docs for possible values\");\"function\"==typeof e&&(e=e.toString()),\"function\"==typeof t&&(t=t.toString()),\"function\"==typeof o.finalize&&(o.finalize=o.finalize.toString());const r=new MapReduceOperation(this,e,t,o);return executeOperation(this.s.topology,r,n)},Collection.prototype.initializeUnorderedBulkOp=function(e){return null==(e=e||{}).ignoreUndefined&&(e.ignoreUndefined=this.s.options.ignoreUndefined),e.promiseLibrary=this.s.promiseLibrary,unordered(this.s.topology,this,e)},Collection.prototype.initializeOrderedBulkOp=function(e){return null==(e=e||{}).ignoreUndefined&&(e.ignoreUndefined=this.s.options.ignoreUndefined),e.promiseLibrary=this.s.promiseLibrary,ordered(this.s.topology,this,e)},Collection.prototype.getLogger=function(){return this.s.db.s.logger},module.exports=Collection;","node_modules/mongodb/lib/topologies/server.js":"\"use strict\";const CServer=require(\"../core\").Server,Cursor=require(\"../cursor\"),TopologyBase=require(\"./topology_base\").TopologyBase,Store=require(\"./topology_base\").Store,MongoError=require(\"../core\").MongoError,MAX_JS_INT=require(\"../utils\").MAX_JS_INT,translateOptions=require(\"../utils\").translateOptions,filterOptions=require(\"../utils\").filterOptions,mergeOptions=require(\"../utils\").mergeOptions;var legalOptionNames=[\"ha\",\"haInterval\",\"acceptableLatencyMS\",\"poolSize\",\"ssl\",\"checkServerIdentity\",\"sslValidate\",\"sslCA\",\"sslCRL\",\"sslCert\",\"ciphers\",\"ecdhCurve\",\"sslKey\",\"sslPass\",\"socketOptions\",\"bufferMaxEntries\",\"store\",\"auto_reconnect\",\"autoReconnect\",\"emitError\",\"keepAlive\",\"keepAliveInitialDelay\",\"noDelay\",\"connectTimeoutMS\",\"socketTimeoutMS\",\"family\",\"loggerLevel\",\"logger\",\"reconnectTries\",\"reconnectInterval\",\"monitoring\",\"appname\",\"domainsEnabled\",\"servername\",\"promoteLongs\",\"promoteValues\",\"promoteBuffers\",\"compression\",\"promiseLibrary\",\"monitorCommands\"];class Server extends TopologyBase{constructor(e,o,r){super();const t=(r=filterOptions(r,legalOptionNames)).promiseLibrary;var n={force:!1,bufferMaxEntries:\"number\"==typeof r.bufferMaxEntries?r.bufferMaxEntries:MAX_JS_INT},s=r.store||new Store(this,n);if(-1!==e.indexOf(\"/\"))null!=o&&\"object\"==typeof o&&(r=o,o=null);else if(null==o)throw MongoError.create({message:\"port must be specified\",driver:!0});var c=\"boolean\"!=typeof r.auto_reconnect||r.auto_reconnect;c=\"boolean\"==typeof r.autoReconnect?r.autoReconnect:c;var i=mergeOptions({},{host:e,port:o,disconnectHandler:s,cursorFactory:Cursor,reconnect:c,emitError:\"boolean\"!=typeof r.emitError||r.emitError,size:\"number\"==typeof r.poolSize?r.poolSize:5,monitorCommands:\"boolean\"==typeof r.monitorCommands&&r.monitorCommands});i=translateOptions(i,r);var l=r.socketOptions&&Object.keys(r.socketOptions).length>0?r.socketOptions:r;(i=translateOptions(i,l)).clientInfo=this.clientInfo,r.appname&&(i.clientInfo.application={name:r.appname}),this.s={coreTopology:new CServer(i),sCapabilities:null,clonedOptions:i,reconnect:i.reconnect,emitError:i.emitError,poolSize:i.size,storeOptions:n,store:s,host:e,port:o,options:r,sessionPool:null,sessions:new Set,promiseLibrary:t||Promise}}connect(e,o){var r=this;\"function\"==typeof e&&(o=e,e={}),null==e&&(e=this.s.clonedOptions),\"function\"!=typeof o&&(o=null),e=Object.assign({},this.s.clonedOptions,e),r.s.options=e,r.s.storeOptions.bufferMaxEntries=\"number\"==typeof e.bufferMaxEntries?e.bufferMaxEntries:-1;var t=function(){return function(e){[\"timeout\",\"error\",\"close\"].forEach(function(e){r.s.coreTopology.removeListener(e,i[e])}),r.s.coreTopology.removeListener(\"connect\",t);try{o(e)}catch(e){process.nextTick(function(){throw e})}}},n=function(e){return function(o){\"error\"!==e&&r.emit(e,o)}},s=function(){r.s.store.flush()},c=function(e){return function(o,t){r.emit(e,o,t)}},i={timeout:t(\"timeout\"),error:t(\"error\"),close:t(\"close\")};[\"timeout\",\"error\",\"close\",\"serverOpening\",\"serverDescriptionChanged\",\"serverHeartbeatStarted\",\"serverHeartbeatSucceeded\",\"serverHeartbeatFailed\",\"serverClosed\",\"topologyOpening\",\"topologyClosed\",\"topologyDescriptionChanged\",\"commandStarted\",\"commandSucceeded\",\"commandFailed\"].forEach(function(e){r.s.coreTopology.removeAllListeners(e)}),r.s.coreTopology.once(\"timeout\",i.timeout),r.s.coreTopology.once(\"error\",i.error),r.s.coreTopology.once(\"close\",i.close),r.s.coreTopology.once(\"connect\",function(){[\"timeout\",\"error\",\"close\",\"destroy\"].forEach(function(e){r.s.coreTopology.removeAllListeners(e)}),r.s.coreTopology.on(\"timeout\",n(\"timeout\")),r.s.coreTopology.once(\"error\",n(\"error\")),r.s.coreTopology.on(\"close\",n(\"close\")),r.s.coreTopology.on(\"destroy\",s),r.emit(\"open\",null,r);try{o(null,r)}catch(e){process.nextTick(function(){throw e})}}),r.s.coreTopology.on(\"reconnect\",function(){r.emit(\"reconnect\",r),r.s.store.execute()}),r.s.coreTopology.on(\"reconnectFailed\",function(e){r.emit(\"reconnectFailed\",e),r.s.store.flush(e)}),r.s.coreTopology.on(\"serverDescriptionChanged\",c(\"serverDescriptionChanged\")),r.s.coreTopology.on(\"serverHeartbeatStarted\",c(\"serverHeartbeatStarted\")),r.s.coreTopology.on(\"serverHeartbeatSucceeded\",c(\"serverHeartbeatSucceeded\")),r.s.coreTopology.on(\"serverHeartbeatFailed\",c(\"serverHeartbeatFailed\")),r.s.coreTopology.on(\"serverOpening\",c(\"serverOpening\")),r.s.coreTopology.on(\"serverClosed\",c(\"serverClosed\")),r.s.coreTopology.on(\"topologyOpening\",c(\"topologyOpening\")),r.s.coreTopology.on(\"topologyClosed\",c(\"topologyClosed\")),r.s.coreTopology.on(\"topologyDescriptionChanged\",c(\"topologyDescriptionChanged\")),r.s.coreTopology.on(\"commandStarted\",c(\"commandStarted\")),r.s.coreTopology.on(\"commandSucceeded\",c(\"commandSucceeded\")),r.s.coreTopology.on(\"commandFailed\",c(\"commandFailed\")),r.s.coreTopology.on(\"attemptReconnect\",c(\"attemptReconnect\")),r.s.coreTopology.on(\"monitoring\",c(\"monitoring\")),r.s.coreTopology.connect(e)}}Object.defineProperty(Server.prototype,\"poolSize\",{enumerable:!0,get:function(){return this.s.coreTopology.connections().length}}),Object.defineProperty(Server.prototype,\"autoReconnect\",{enumerable:!0,get:function(){return this.s.reconnect}}),Object.defineProperty(Server.prototype,\"host\",{enumerable:!0,get:function(){return this.s.host}}),Object.defineProperty(Server.prototype,\"port\",{enumerable:!0,get:function(){return this.s.port}}),module.exports=Server;","node_modules/mongodb/lib/topologies/replset.js":"\"use strict\";const Server=require(\"./server\"),Cursor=require(\"../cursor\"),MongoError=require(\"../core\").MongoError,TopologyBase=require(\"./topology_base\").TopologyBase,Store=require(\"./topology_base\").Store,CReplSet=require(\"../core\").ReplSet,MAX_JS_INT=require(\"../utils\").MAX_JS_INT,translateOptions=require(\"../utils\").translateOptions,filterOptions=require(\"../utils\").filterOptions,mergeOptions=require(\"../utils\").mergeOptions;var legalOptionNames=[\"ha\",\"haInterval\",\"replicaSet\",\"rs_name\",\"secondaryAcceptableLatencyMS\",\"connectWithNoPrimary\",\"poolSize\",\"ssl\",\"checkServerIdentity\",\"sslValidate\",\"sslCA\",\"sslCert\",\"ciphers\",\"ecdhCurve\",\"sslCRL\",\"sslKey\",\"sslPass\",\"socketOptions\",\"bufferMaxEntries\",\"store\",\"auto_reconnect\",\"autoReconnect\",\"emitError\",\"keepAlive\",\"keepAliveInitialDelay\",\"noDelay\",\"connectTimeoutMS\",\"socketTimeoutMS\",\"strategy\",\"debug\",\"family\",\"loggerLevel\",\"logger\",\"reconnectTries\",\"appname\",\"domainsEnabled\",\"servername\",\"promoteLongs\",\"promoteValues\",\"promoteBuffers\",\"maxStalenessSeconds\",\"promiseLibrary\",\"minSize\",\"monitorCommands\"];class ReplSet extends TopologyBase{constructor(e,o){super();var r=this;o=filterOptions(o=o||{},legalOptionNames);for(var t=0;t<e.length;t++)if(!(e[t]instanceof Server))throw MongoError.create({message:\"all seed list instances must be of the Server type\",driver:!0});var n={force:!1,bufferMaxEntries:\"number\"==typeof o.bufferMaxEntries?o.bufferMaxEntries:MAX_JS_INT},s=o.store||new Store(r,n),i=e.map(function(e){return{host:e.host,port:e.port}}),c=mergeOptions({},{disconnectHandler:s,cursorFactory:Cursor,reconnect:!1,emitError:\"boolean\"!=typeof o.emitError||o.emitError,size:\"number\"==typeof o.poolSize?o.poolSize:5,monitorCommands:\"boolean\"==typeof o.monitorCommands&&o.monitorCommands});c=translateOptions(c,o);var l=o.socketOptions&&Object.keys(o.socketOptions).length>0?o.socketOptions:o;(c=translateOptions(c,l)).clientInfo=this.clientInfo,o.appname&&(c.clientInfo.application={name:o.appname});var a=new CReplSet(i,c);a.on(\"reconnect\",function(){r.emit(\"reconnect\"),s.execute()}),this.s={coreTopology:a,sCapabilities:null,tag:o.tag,storeOptions:n,clonedOptions:c,store:s,options:o,sessionPool:null,sessions:new Set,promiseLibrary:o.promiseLibrary||Promise},c.debug&&Object.defineProperty(this,\"replset\",{enumerable:!0,get:function(){return a}})}connect(e,o){var r=this;\"function\"==typeof e&&(o=e,e={}),null==e&&(e={}),\"function\"!=typeof o&&(o=null),e=Object.assign({},this.s.clonedOptions,e),r.s.options=e,r.s.storeOptions.bufferMaxEntries=\"number\"==typeof e.bufferMaxEntries?e.bufferMaxEntries:-1;var t=function(e){return function(o){\"error\"!==e&&r.emit(e,o)}};[\"timeout\",\"error\",\"close\",\"serverOpening\",\"serverDescriptionChanged\",\"serverHeartbeatStarted\",\"serverHeartbeatSucceeded\",\"serverHeartbeatFailed\",\"serverClosed\",\"topologyOpening\",\"topologyClosed\",\"topologyDescriptionChanged\",\"commandStarted\",\"commandSucceeded\",\"commandFailed\",\"joined\",\"left\",\"ping\",\"ha\"].forEach(function(e){r.s.coreTopology.removeAllListeners(e)});var n,s=function(e){return function(o,t){r.emit(e,o,t)}};r.s.coreTopology.on(\"joined\",(n=\"joined\",function(e,o){r.emit(n,e,o.lastIsMaster(),o)})),r.s.coreTopology.on(\"left\",s(\"left\")),r.s.coreTopology.on(\"ping\",s(\"ping\")),r.s.coreTopology.on(\"ha\",function(e,o){r.emit(\"ha\",e,o),\"start\"===e?r.emit(\"ha_connect\",e,o):\"end\"===e&&r.emit(\"ha_ismaster\",e,o)}),r.s.coreTopology.on(\"serverDescriptionChanged\",s(\"serverDescriptionChanged\")),r.s.coreTopology.on(\"serverHeartbeatStarted\",s(\"serverHeartbeatStarted\")),r.s.coreTopology.on(\"serverHeartbeatSucceeded\",s(\"serverHeartbeatSucceeded\")),r.s.coreTopology.on(\"serverHeartbeatFailed\",s(\"serverHeartbeatFailed\")),r.s.coreTopology.on(\"serverOpening\",s(\"serverOpening\")),r.s.coreTopology.on(\"serverClosed\",s(\"serverClosed\")),r.s.coreTopology.on(\"topologyOpening\",s(\"topologyOpening\")),r.s.coreTopology.on(\"topologyClosed\",s(\"topologyClosed\")),r.s.coreTopology.on(\"topologyDescriptionChanged\",s(\"topologyDescriptionChanged\")),r.s.coreTopology.on(\"commandStarted\",s(\"commandStarted\")),r.s.coreTopology.on(\"commandSucceeded\",s(\"commandSucceeded\")),r.s.coreTopology.on(\"commandFailed\",s(\"commandFailed\")),r.s.coreTopology.on(\"fullsetup\",function(){r.emit(\"fullsetup\",r,r)}),r.s.coreTopology.on(\"all\",function(){r.emit(\"all\",null,r)});var i=function(){return function(e){[\"timeout\",\"error\",\"close\"].forEach(function(e){r.s.coreTopology.removeListener(e,i)}),r.s.coreTopology.removeListener(\"connect\",i),r.s.coreTopology.destroy();try{o(e)}catch(e){r.s.coreTopology.isConnected()||process.nextTick(function(){throw e})}}};r.s.coreTopology.once(\"timeout\",i(\"timeout\")),r.s.coreTopology.once(\"error\",i(\"error\")),r.s.coreTopology.once(\"close\",i(\"close\")),r.s.coreTopology.once(\"connect\",function(){r.s.coreTopology.once(\"timeout\",t(\"timeout\")),r.s.coreTopology.once(\"error\",t(\"error\")),r.s.coreTopology.once(\"close\",t(\"close\")),r.emit(\"open\",null,r);try{o(null,r)}catch(e){process.nextTick(function(){throw e})}}),r.s.coreTopology.connect(e)}close(e,o){[\"timeout\",\"error\",\"close\",\"joined\",\"left\"].forEach(e=>this.removeAllListeners(e)),super.close(e,o)}}Object.defineProperty(ReplSet.prototype,\"haInterval\",{enumerable:!0,get:function(){return this.s.coreTopology.s.haInterval}}),module.exports=ReplSet;","node_modules/mongodb/lib/topologies/mongos.js":"\"use strict\";const TopologyBase=require(\"./topology_base\").TopologyBase,MongoError=require(\"../core\").MongoError,CMongos=require(\"../core\").Mongos,Cursor=require(\"../cursor\"),Server=require(\"./server\"),Store=require(\"./topology_base\").Store,MAX_JS_INT=require(\"../utils\").MAX_JS_INT,translateOptions=require(\"../utils\").translateOptions,filterOptions=require(\"../utils\").filterOptions,mergeOptions=require(\"../utils\").mergeOptions;var legalOptionNames=[\"ha\",\"haInterval\",\"acceptableLatencyMS\",\"poolSize\",\"ssl\",\"checkServerIdentity\",\"sslValidate\",\"sslCA\",\"sslCRL\",\"sslCert\",\"ciphers\",\"ecdhCurve\",\"sslKey\",\"sslPass\",\"socketOptions\",\"bufferMaxEntries\",\"store\",\"auto_reconnect\",\"autoReconnect\",\"emitError\",\"keepAlive\",\"keepAliveInitialDelay\",\"noDelay\",\"connectTimeoutMS\",\"socketTimeoutMS\",\"loggerLevel\",\"logger\",\"reconnectTries\",\"appname\",\"domainsEnabled\",\"servername\",\"promoteLongs\",\"promoteValues\",\"promoteBuffers\",\"promiseLibrary\",\"monitorCommands\"];class Mongos extends TopologyBase{constructor(e,o){super();o=filterOptions(o=o||{},legalOptionNames);for(var r=0;r<e.length;r++)if(!(e[r]instanceof Server))throw MongoError.create({message:\"all seed list instances must be of the Server type\",driver:!0});var t={force:!1,bufferMaxEntries:\"number\"==typeof o.bufferMaxEntries?o.bufferMaxEntries:MAX_JS_INT},n=o.store||new Store(this,t),s=e.map(function(e){return{host:e.host,port:e.port}}),c=\"boolean\"!=typeof o.auto_reconnect||o.auto_reconnect;c=\"boolean\"==typeof o.autoReconnect?o.autoReconnect:c;var i=mergeOptions({},{disconnectHandler:n,cursorFactory:Cursor,reconnect:c,emitError:\"boolean\"!=typeof o.emitError||o.emitError,size:\"number\"==typeof o.poolSize?o.poolSize:5,monitorCommands:\"boolean\"==typeof o.monitorCommands&&o.monitorCommands});i=translateOptions(i,o);var l=o.socketOptions&&Object.keys(o.socketOptions).length>0?o.socketOptions:o;(i=translateOptions(i,l)).clientInfo=this.clientInfo,o.appname&&(i.clientInfo.application={name:o.appname}),this.s={coreTopology:new CMongos(s,i),sCapabilities:null,debug:i.debug,storeOptions:t,clonedOptions:i,store:n,options:o,sessionPool:null,sessions:new Set,promiseLibrary:o.promiseLibrary||Promise}}connect(e,o){var r=this;\"function\"==typeof e&&(o=e,e={}),null==e&&(e={}),\"function\"!=typeof o&&(o=null),e=Object.assign({},this.s.clonedOptions,e),r.s.options=e,r.s.storeOptions.bufferMaxEntries=\"number\"==typeof e.bufferMaxEntries?e.bufferMaxEntries:-1;var t=function(){return function(e){[\"timeout\",\"error\",\"close\"].forEach(function(e){r.removeListener(e,t)}),r.s.coreTopology.removeListener(\"connect\",t),r.close(!0);try{o(e)}catch(e){process.nextTick(function(){throw e})}}},n=function(e){return function(o){\"error\"!==e&&r.emit(e,o)}},s=function(e){return function(o,t){r.emit(e,o,t)}};[\"timeout\",\"error\",\"close\",\"serverOpening\",\"serverDescriptionChanged\",\"serverHeartbeatStarted\",\"serverHeartbeatSucceeded\",\"serverHeartbeatFailed\",\"serverClosed\",\"topologyOpening\",\"topologyClosed\",\"topologyDescriptionChanged\",\"commandStarted\",\"commandSucceeded\",\"commandFailed\"].forEach(function(e){r.s.coreTopology.removeAllListeners(e)}),r.s.coreTopology.on(\"serverDescriptionChanged\",s(\"serverDescriptionChanged\")),r.s.coreTopology.on(\"serverHeartbeatStarted\",s(\"serverHeartbeatStarted\")),r.s.coreTopology.on(\"serverHeartbeatSucceeded\",s(\"serverHeartbeatSucceeded\")),r.s.coreTopology.on(\"serverHeartbeatFailed\",s(\"serverHeartbeatFailed\")),r.s.coreTopology.on(\"serverOpening\",s(\"serverOpening\")),r.s.coreTopology.on(\"serverClosed\",s(\"serverClosed\")),r.s.coreTopology.on(\"topologyOpening\",s(\"topologyOpening\")),r.s.coreTopology.on(\"topologyClosed\",s(\"topologyClosed\")),r.s.coreTopology.on(\"topologyDescriptionChanged\",s(\"topologyDescriptionChanged\")),r.s.coreTopology.on(\"commandStarted\",s(\"commandStarted\")),r.s.coreTopology.on(\"commandSucceeded\",s(\"commandSucceeded\")),r.s.coreTopology.on(\"commandFailed\",s(\"commandFailed\")),r.s.coreTopology.once(\"timeout\",t(\"timeout\")),r.s.coreTopology.once(\"error\",t(\"error\")),r.s.coreTopology.once(\"close\",t(\"close\")),r.s.coreTopology.once(\"connect\",function(){[\"timeout\",\"error\",\"close\",\"fullsetup\"].forEach(function(e){r.s.coreTopology.removeAllListeners(e)}),r.s.coreTopology.on(\"timeout\",n(\"timeout\")),r.s.coreTopology.on(\"error\",n(\"error\")),r.s.coreTopology.on(\"close\",n(\"close\")),r.s.coreTopology.on(\"fullsetup\",function(){r.emit(\"fullsetup\",r)}),r.emit(\"open\",null,r);try{o(null,r)}catch(e){process.nextTick(function(){throw e})}}),r.s.coreTopology.on(\"joined\",s(\"joined\")),r.s.coreTopology.on(\"left\",s(\"left\")),r.s.coreTopology.on(\"reconnect\",function(){r.emit(\"reconnect\"),r.s.store.execute()}),r.s.coreTopology.connect(e)}}Object.defineProperty(Mongos.prototype,\"haInterval\",{enumerable:!0,get:function(){return this.s.coreTopology.s.haInterval}}),module.exports=Mongos;","node_modules/mongodb/lib/gridfs/grid_store.js":"\"use strict\";const Chunk=require(\"./chunk\"),ObjectID=require(\"../core\").BSON.ObjectID,ReadPreference=require(\"../core\").ReadPreference,Buffer=require(\"safe-buffer\").Buffer,fs=require(\"fs\"),f=require(\"util\").format,util=require(\"util\"),MongoError=require(\"../core\").MongoError,inherits=util.inherits,Duplex=require(\"stream\").Duplex,shallowClone=require(\"../utils\").shallowClone,executeLegacyOperation=require(\"../utils\").executeLegacyOperation,deprecate=require(\"util\").deprecate;var REFERENCE_BY_FILENAME=0,REFERENCE_BY_ID=1;const deprecationFn=deprecate(()=>{},\"GridStore is deprecated, and will be removed in a future version. Please use GridFSBucket instead\");var GridStore=function e(n,t,i,o,r){if(deprecationFn(),!(this instanceof e))return new e(n,t,i,o,r);this.db=n,void 0===r&&(r={}),void 0===o?(o=i,i=void 0):\"object\"==typeof o&&(r=o,o=i,i=void 0),t&&\"ObjectID\"===t._bsontype?(this.referenceBy=REFERENCE_BY_ID,this.fileId=t,this.filename=i):void 0===i?(this.referenceBy=REFERENCE_BY_FILENAME,this.filename=t,null!=o.indexOf(\"w\")&&(this.fileId=new ObjectID)):(this.referenceBy=REFERENCE_BY_ID,this.fileId=t,this.filename=i),this.mode=null==o?\"r\":o,this.options=r||{},this.isOpen=!1,this.root=null==this.options.root?e.DEFAULT_ROOT_COLLECTION:this.options.root,this.position=0,this.readPreference=this.options.readPreference||n.options.readPreference||ReadPreference.primary,this.writeConcern=_getWriteConcern(n,this.options),this.internalChunkSize=null==this.options.chunkSize?Chunk.DEFAULT_CHUNK_SIZE:this.options.chunkSize;var u=this.options.promiseLibrary||Promise;this.promiseLibrary=u,Object.defineProperty(this,\"chunkSize\",{enumerable:!0,get:function(){return this.internalChunkSize},set:function(e){\"w\"!==this.mode[0]||0!==this.position||null!=this.uploadDate?this.internalChunkSize=this.internalChunkSize:this.internalChunkSize=e}}),Object.defineProperty(this,\"md5\",{enumerable:!0,get:function(){return this.internalMd5}}),Object.defineProperty(this,\"chunkNumber\",{enumerable:!0,get:function(){return this.currentChunk&&this.currentChunk.chunkNumber?this.currentChunk.chunkNumber:null}})};GridStore.prototype.open=function(e,n){if(\"function\"==typeof e&&(n=e,e={}),e=e||{},\"w\"!==this.mode&&\"w+\"!==this.mode&&\"r\"!==this.mode)throw MongoError.create({message:\"Illegal mode \"+this.mode,driver:!0});return executeLegacyOperation(this.db.s.topology,open,[this,e,n],{skipSessions:!0})};var open=function(e,n,t){var i=_getWriteConcern(e.db,e.options);\"w\"===e.mode||\"w+\"===e.mode?e.collection().ensureIndex([[\"filename\",1]],i,function(){var n=e.chunkCollection(),o=shallowClone(i);o.unique=!0,n.ensureIndex([[\"files_id\",1],[\"n\",1]],o,function(){_open(e,i,function(n,i){if(n)return t(n);e.isOpen=!0,t(n,i)})})}):_open(e,i,function(n,i){if(n)return t(n);e.isOpen=!0,t(n,i)})};GridStore.prototype.eof=function(){return this.position===this.length},GridStore.prototype.getc=function(e,n){return\"function\"==typeof e&&(n=e,e={}),e=e||{},executeLegacyOperation(this.db.s.topology,getc,[this,e,n],{skipSessions:!0})};var getc=function(e,n,t){e.eof()?t(null,null):e.currentChunk.eof()?nthChunk(e,e.currentChunk.chunkNumber+1,function(n,i){e.currentChunk=i,e.position=e.position+1,t(n,e.currentChunk.getc())}):(e.position=e.position+1,t(null,e.currentChunk.getc()))};GridStore.prototype.puts=function(e,n,t){\"function\"==typeof n&&(t=n,n={}),n=n||{};var i=null==e.match(/\\n$/)?e+\"\\n\":e;return executeLegacyOperation(this.db.s.topology,this.write.bind(this),[i,n,t],{skipSessions:!0})},GridStore.prototype.stream=function(){return new GridStoreStream(this)},GridStore.prototype.write=function(e,n,t,i){return\"function\"==typeof t&&(i=t,t={}),t=t||{},executeLegacyOperation(this.db.s.topology,_writeNormal,[this,e,n,t,i],{skipSessions:!0})},GridStore.prototype.destroy=function(){this.writable&&(this.readable=!1,this.writable&&(this.writable=!1,this._q.length=0,this.emit(\"close\")))},GridStore.prototype.writeFile=function(e,n,t){return\"function\"==typeof n&&(t=n,n={}),n=n||{},executeLegacyOperation(this.db.s.topology,writeFile,[this,e,n,t],{skipSessions:!0})};var writeFile=function(e,n,t,i){\"string\"!=typeof n?e.open(function(e,t){if(e)return i(e,t);fs.fstat(n,function(e,o){if(e)return i(e,t);var r=0,u=0,l=function(){var e=Buffer.alloc(t.chunkSize);fs.read(n,e,0,e.length,r,function(e,s,a){if(e)return i(e,t);r+=s,new Chunk(t,{n:u++},t.writeConcern).write(a.slice(0,s),function(e,u){if(e)return i(e,t);u.save({},function(e){return e?i(e,t):(t.position=t.position+s,t.currentChunk=u,r>=o.size?void fs.close(n,function(e){if(e)return i(e);t.close(function(e){return i(e||null,t)})}):process.nextTick(l))})})})};process.nextTick(l)})}):fs.open(n,\"r\",function(n,t){if(n)return i(n);e.writeFile(t,i)})};GridStore.prototype.close=function(e,n){return\"function\"==typeof e&&(n=e,e={}),e=e||{},executeLegacyOperation(this.db.s.topology,close,[this,e,n],{skipSessions:!0})};var close=function(e,n,t){\"w\"===e.mode[0]?(n=Object.assign({},e.writeConcern,n),null!=e.currentChunk&&e.currentChunk.position>0?e.currentChunk.save({},function(i){if(i&&\"function\"==typeof t)return t(i);e.collection(function(i,o){if(i&&\"function\"==typeof t)return t(i);null!=e.uploadDate?buildMongoObject(e,function(e,i){if(e){if(\"function\"==typeof t)return t(e);throw e}o.save(i,n,function(e){\"function\"==typeof t&&t(e,i)})}):(e.uploadDate=new Date,buildMongoObject(e,function(e,i){if(e){if(\"function\"==typeof t)return t(e);throw e}o.save(i,n,function(e){\"function\"==typeof t&&t(e,i)})}))})}):e.collection(function(i,o){if(i&&\"function\"==typeof t)return t(i);e.uploadDate=new Date,buildMongoObject(e,function(e,i){if(e){if(\"function\"==typeof t)return t(e);throw e}o.save(i,n,function(e){\"function\"==typeof t&&t(e,i)})})})):\"r\"===e.mode[0]?\"function\"==typeof t&&t(null,null):\"function\"==typeof t&&t(MongoError.create({message:f(\"Illegal mode %s\",e.mode),driver:!0}))};GridStore.prototype.chunkCollection=function(e){return\"function\"==typeof e?this.db.collection(this.root+\".chunks\",e):this.db.collection(this.root+\".chunks\")},GridStore.prototype.unlink=function(e,n){return\"function\"==typeof e&&(n=e,e={}),e=e||{},executeLegacyOperation(this.db.s.topology,unlink,[this,e,n],{skipSessions:!0})};var unlink=function(e,n,t){deleteChunks(e,function(n){if(null!==n)return n.message=\"at deleteChunks: \"+n.message,t(n);e.collection(function(n,i){if(null!==n)return n.message=\"at collection: \"+n.message,t(n);i.remove({_id:e.fileId},e.writeConcern,function(n){t(n,e)})})})};GridStore.prototype.collection=function(e){return\"function\"==typeof e&&this.db.collection(this.root+\".files\",e),this.db.collection(this.root+\".files\")},GridStore.prototype.readlines=function(e,n,t){var i=Array.prototype.slice.call(arguments,0);return t=\"function\"==typeof i[i.length-1]?i.pop():void 0,e=(e=i.length?i.shift():\"\\n\")||\"\\n\",n=i.length?i.shift():{},executeLegacyOperation(this.db.s.topology,readlines,[this,e,n,t],{skipSessions:!0})};var readlines=function(e,n,t,i){e.read(function(e,t){if(e)return i(e);var o=t.toString().split(n);o=o.length>0?o.splice(0,o.length-1):[];for(var r=0;r<o.length;r++)o[r]=o[r]+n;i(null,o)})};GridStore.prototype.rewind=function(e,n){return\"function\"==typeof e&&(n=e,e={}),e=e||{},executeLegacyOperation(this.db.s.topology,rewind,[this,e,n],{skipSessions:!0})};var rewind=function(e,n,t){0!==e.currentChunk.chunkNumber?\"w\"===e.mode[0]?deleteChunks(e,function(n){if(n)return t(n);e.currentChunk=new Chunk(e,{n:0},e.writeConcern),e.position=0,t(null,e)}):e.currentChunk(0,function(n,i){if(n)return t(n);e.currentChunk=i,e.currentChunk.rewind(),e.position=0,t(null,e)}):(e.currentChunk.rewind(),e.position=0,t(null,e))};GridStore.prototype.read=function(e,n,t,i){var o=Array.prototype.slice.call(arguments,0);return i=\"function\"==typeof o[o.length-1]?o.pop():void 0,e=o.length?o.shift():null,n=o.length?o.shift():null,t=o.length?o.shift():{},executeLegacyOperation(this.db.s.topology,read,[this,e,n,t,i],{skipSessions:!0})};var read=function(e,n,t,i,o){var r=null==n?e.length-e.position:n,u=null==t?Buffer.alloc(r):t;if(u._index=null!=t&&null!=t._index?t._index:0,e.currentChunk.length()-e.currentChunk.position+u._index>=r){var l=e.currentChunk.readSlice(r-u._index);return l.copy(u,u._index),e.position=e.position+u.length,0===r&&0===u.length?o(MongoError.create({message:\"File does not exist\",driver:!0}),null):o(null,u)}(l=e.currentChunk.readSlice(e.currentChunk.length()-e.currentChunk.position)).copy(u,u._index),u._index+=l.length,nthChunk(e,e.currentChunk.chunkNumber+1,function(t,i){if(t)return o(t);i.length()>0?(e.currentChunk=i,e.read(n,u,o)):u._index>0?o(null,u):o(MongoError.create({message:\"no chunks found for file, possibly corrupt\",driver:!0}),null)})};GridStore.prototype.tell=function(e){var n=this;return\"function\"==typeof e?e(null,this.position):new n.promiseLibrary(function(e){e(n.position)})},GridStore.prototype.seek=function(e,n,t,i){var o=Array.prototype.slice.call(arguments,1);return i=\"function\"==typeof o[o.length-1]?o.pop():void 0,n=o.length?o.shift():null,t=o.length?o.shift():{},executeLegacyOperation(this.db.s.topology,seek,[this,e,n,t,i],{skipSessions:!0})};var seek=function(e,n,t,i,o){if(\"r\"!==e.mode)return o(MongoError.create({message:\"seek is only supported for mode r\",driver:!0}));var r=null==t?GridStore.IO_SEEK_SET:t,u=n,l=0;l=r===GridStore.IO_SEEK_CUR?e.position+u:r===GridStore.IO_SEEK_END?e.length+u:u;var s=Math.floor(l/e.chunkSize);nthChunk(e,s,function(n,t){return n?o(n,null):null==t?o(new Error(\"no chunk found\")):(e.currentChunk=t,e.position=l,e.currentChunk.position=e.position%e.chunkSize,void o(n,e))})},_open=function(e,n,t){var i=e.collection(),o=e.referenceBy===REFERENCE_BY_ID?{_id:e.fileId}:{filename:e.filename};function r(e){r.err||t(r.err=e)}o=null==e.fileId&&null==e.filename?null:o,n.readPreference=e.readPreference,null!=o?i.findOne(o,n,function(i,o){if(i)return r(i);if(null!=o)e.fileId=o._id,e.filename=\"r\"===e.mode||void 0===e.filename?o.filename:e.filename,e.contentType=o.contentType,e.internalChunkSize=o.chunkSize,e.uploadDate=o.uploadDate,e.aliases=o.aliases,e.length=o.length,e.metadata=o.metadata,e.internalMd5=o.md5;else{if(\"r\"===e.mode){e.length=0;var u=\"ObjectID\"===e.fileId._bsontype?e.fileId.toHexString():e.fileId;return r(MongoError.create({message:f(\"file with id %s not opened for writing\",e.referenceBy===REFERENCE_BY_ID?u:e.filename),driver:!0}))}e.fileId=null==e.fileId?new ObjectID:e.fileId,e.contentType=GridStore.DEFAULT_CONTENT_TYPE,e.internalChunkSize=null==e.internalChunkSize?Chunk.DEFAULT_CHUNK_SIZE:e.internalChunkSize,e.length=0}\"r\"===e.mode?nthChunk(e,0,n,function(n,i){if(n)return r(n);e.currentChunk=i,e.position=0,t(null,e)}):\"w\"===e.mode&&o?deleteChunks(e,n,function(n){if(n)return r(n);e.currentChunk=new Chunk(e,{n:0},e.writeConcern),e.contentType=null==e.options.content_type?e.contentType:e.options.content_type,e.internalChunkSize=null==e.options.chunk_size?e.internalChunkSize:e.options.chunk_size,e.metadata=null==e.options.metadata?e.metadata:e.options.metadata,e.aliases=null==e.options.aliases?e.aliases:e.options.aliases,e.position=0,t(null,e)}):\"w\"===e.mode?(e.currentChunk=new Chunk(e,{n:0},e.writeConcern),e.contentType=null==e.options.content_type?e.contentType:e.options.content_type,e.internalChunkSize=null==e.options.chunk_size?e.internalChunkSize:e.options.chunk_size,e.metadata=null==e.options.metadata?e.metadata:e.options.metadata,e.aliases=null==e.options.aliases?e.aliases:e.options.aliases,e.position=0,t(null,e)):\"w+\"===e.mode&&nthChunk(e,lastChunkNumber(e),n,function(n,i){if(n)return r(n);e.currentChunk=null==i?new Chunk(e,{n:0},e.writeConcern):i,e.currentChunk.position=e.currentChunk.data.length(),e.metadata=null==e.options.metadata?e.metadata:e.options.metadata,e.aliases=null==e.options.aliases?e.aliases:e.options.aliases,e.position=e.length,t(null,e)})}):(e.fileId=null==e.fileId?new ObjectID:e.fileId,e.contentType=GridStore.DEFAULT_CONTENT_TYPE,e.internalChunkSize=null==e.internalChunkSize?Chunk.DEFAULT_CHUNK_SIZE:e.internalChunkSize,e.length=0,\"w\"===e.mode?deleteChunks(e,n,function(n){if(n)return r(n);e.currentChunk=new Chunk(e,{n:0},e.writeConcern),e.contentType=null==e.options.content_type?e.contentType:e.options.content_type,e.internalChunkSize=null==e.options.chunk_size?e.internalChunkSize:e.options.chunk_size,e.metadata=null==e.options.metadata?e.metadata:e.options.metadata,e.aliases=null==e.options.aliases?e.aliases:e.options.aliases,e.position=0,t(null,e)}):\"w+\"===e.mode&&nthChunk(e,lastChunkNumber(e),n,function(n,i){if(n)return r(n);e.currentChunk=null==i?new Chunk(e,{n:0},e.writeConcern):i,e.currentChunk.position=e.currentChunk.data.length(),e.metadata=null==e.options.metadata?e.metadata:e.options.metadata,e.aliases=null==e.options.aliases?e.aliases:e.options.aliases,e.position=e.length,t(null,e)}))},writeBuffer=function(e,n,t,i){\"function\"==typeof t&&(i=t,t=null);var o=\"boolean\"==typeof t&&t;if(\"w\"!==e.mode)i(MongoError.create({message:f(\"file with id %s not opened for writing\",e.referenceBy===REFERENCE_BY_ID?e.referenceBy:e.filename),driver:!0}),null);else{if(!(e.currentChunk.position+n.length>=e.chunkSize))return e.position=e.position+n.length,e.currentChunk.write(n),o?e.close(function(n){i(n,e)}):i(null,e);for(var r=e.currentChunk.chunkNumber,u=e.chunkSize-e.currentChunk.position,l=n.slice(0,u),s=n.slice(u),a=[e.currentChunk.write(l)];s.length>=e.chunkSize;){var c=new Chunk(e,{n:r+1},e.writeConcern);l=s.slice(0,e.chunkSize),s=s.slice(e.chunkSize),r+=1,c.write(l),a.push(c)}e.currentChunk=new Chunk(e,{n:r+1},e.writeConcern),s.length>0&&e.currentChunk.write(s),e.position=e.position+n.length;for(var p=a.length,h=0;h<a.length;h++)a[h].save({},function(n){return n?i(n):(p-=1)<=0?o?e.close(function(n){i(n,e)}):i(null,e):void 0})}},buildMongoObject=function(e,n){var t={_id:e.fileId,filename:e.filename,contentType:e.contentType,length:e.position?e.position:0,chunkSize:e.chunkSize,uploadDate:e.uploadDate,aliases:e.aliases,metadata:e.metadata},i={filemd5:e.fileId,root:e.root};e.db.command(i,function(e,i){if(e)return n(e);t.md5=i.md5,n(null,t)})},nthChunk=function(e,n,t,i){\"function\"==typeof t&&(i=t,t={}),(t=t||e.writeConcern).readPreference=e.readPreference,e.chunkCollection().findOne({files_id:e.fileId,n:n},t,function(n,t){if(n)return i(n);i(null,new Chunk(e,null==t?{}:t,e.writeConcern))})},lastChunkNumber=function(e){return Math.floor((e.length?e.length-1:0)/e.chunkSize)},deleteChunks=function(e,n,t){\"function\"==typeof n&&(t=n,n={}),n=n||e.writeConcern,null!=e.fileId?e.chunkCollection().remove({files_id:e.fileId},n,function(e){if(e)return t(e,!1);t(null,!0)}):t(null,!0)};GridStore.DEFAULT_ROOT_COLLECTION=\"fs\",GridStore.DEFAULT_CONTENT_TYPE=\"binary/octet-stream\",GridStore.IO_SEEK_SET=0,GridStore.IO_SEEK_CUR=1,GridStore.IO_SEEK_END=2,GridStore.exist=function(e,n,t,i,o){var r=Array.prototype.slice.call(arguments,2);return o=\"function\"==typeof r[r.length-1]?r.pop():void 0,t=r.length?r.shift():null,i=(i=r.length?r.shift():{})||{},executeLegacyOperation(e.s.topology,exists,[e,n,t,i,o],{skipSessions:!0})};var exists=function(e,n,t,i,o){var r=i.readPreference||ReadPreference.PRIMARY,u=null!=t?t:GridStore.DEFAULT_ROOT_COLLECTION;e.collection(u+\".files\",function(e,t){if(e)return o(e);var i=\"string\"==typeof n||\"[object RegExp]\"===Object.prototype.toString.call(n)?{filename:n}:{_id:n};null!=n&&\"object\"==typeof n&&\"[object RegExp]\"!==Object.prototype.toString.call(n)&&(i=n),t.findOne(i,{readPreference:r},function(e,n){if(e)return o(e);o(null,null!=n)})})};GridStore.list=function(e,n,t,i){var o=Array.prototype.slice.call(arguments,1);return i=\"function\"==typeof o[o.length-1]?o.pop():void 0,n=o.length?o.shift():null,t=(t=o.length?o.shift():{})||{},executeLegacyOperation(e.s.topology,list,[e,n,t,i],{skipSessions:!0})};var list=function(e,n,t,i){null!=n&&\"object\"==typeof n&&(t=n,n=null);var o=t.readPreference||ReadPreference.primary,r=null!=t.id&&t.id,u=null!=n?n:GridStore.DEFAULT_ROOT_COLLECTION,l=[];e.collection(u+\".files\",function(e,n){if(e)return i(e);n.find({},{readPreference:o},function(e,n){if(e)return i(e);n.each(function(e,n){null!=n?l.push(r?n._id:n.filename):i(e,l)})})})};GridStore.read=function(e,n,t,i,o,r){var u=Array.prototype.slice.call(arguments,2);return r=\"function\"==typeof u[u.length-1]?u.pop():void 0,t=u.length?u.shift():null,i=u.length?u.shift():null,o=(o=u.length?u.shift():null)||{},executeLegacyOperation(e.s.topology,readStatic,[e,n,t,i,o,r],{skipSessions:!0})};var readStatic=function(e,n,t,i,o,r){new GridStore(e,n,\"r\",o).open(function(e,n){return e?r(e):i&&i>=n.length?r(\"offset larger than size of file\",null):t&&t>n.length?r(\"length is larger than the size of the file\",null):i&&t&&i+t>n.length?r(\"offset and length is larger than the size of the file\",null):void(null!=i?n.seek(i,function(e,n){if(e)return r(e);n.read(t,r)}):n.read(t,r))})};GridStore.readlines=function(e,n,t,i,o){var r=Array.prototype.slice.call(arguments,2);return o=\"function\"==typeof r[r.length-1]?r.pop():void 0,t=r.length?r.shift():null,i=(i=r.length?r.shift():null)||{},executeLegacyOperation(e.s.topology,readlinesStatic,[e,n,t,i,o],{skipSessions:!0})};var readlinesStatic=function(e,n,t,i,o){var r=null==t?\"\\n\":t;new GridStore(e,n,\"r\",i).open(function(e,n){if(e)return o(e);n.readlines(r,o)})};GridStore.unlink=function(e,n,t,i){var o=Array.prototype.slice.call(arguments,2);return i=\"function\"==typeof o[o.length-1]?o.pop():void 0,t=(t=o.length?o.shift():{})||{},executeLegacyOperation(e.s.topology,unlinkStatic,[this,e,n,t,i],{skipSessions:!0})};var unlinkStatic=function(e,n,t,i,o){var r=_getWriteConcern(n,i);if(t.constructor===Array)for(var u=0,l=0;l<t.length;l++)++u,GridStore.unlink(n,t[l],i,function(){0==--u&&o(null,e)});else new GridStore(n,t,\"w\",i).open(function(n,t){if(n)return o(n);deleteChunks(t,function(n){if(n)return o(n);t.collection(function(n,i){if(n)return o(n);i.remove({_id:t.fileId},r,function(n){o(n,e)})})})})},_writeNormal=function(e,n,t,i,o){return Buffer.isBuffer(n)?writeBuffer(e,n,t,o):writeBuffer(e,Buffer.from(n,\"binary\"),t,o)},_setWriteConcernHash=function(e){var n={};return null!=e.w&&(n.w=e.w),!0===e.journal&&(n.j=e.journal),!0===e.j&&(n.j=e.j),!0===e.fsync&&(n.fsync=e.fsync),null!=e.wtimeout&&(n.wtimeout=e.wtimeout),n},_getWriteConcern=function(e,n){var t={w:1};if(null!=(n=n||{}).w||\"boolean\"==typeof n.j||\"boolean\"==typeof n.journal||\"boolean\"==typeof n.fsync?t=_setWriteConcernHash(n):null!=n.safe&&\"object\"==typeof n.safe?t=_setWriteConcernHash(n.safe):\"boolean\"==typeof n.safe?t={w:n.safe?1:0}:null!=e.options.w||\"boolean\"==typeof e.options.j||\"boolean\"==typeof e.options.journal||\"boolean\"==typeof e.options.fsync?t=_setWriteConcernHash(e.options):!e.safe||null==e.safe.w&&\"boolean\"!=typeof e.safe.j&&\"boolean\"!=typeof e.safe.journal&&\"boolean\"!=typeof e.safe.fsync?\"boolean\"==typeof e.safe&&(t={w:e.safe?1:0}):t=_setWriteConcernHash(e.safe),t.w<1&&(!0===t.journal||!0===t.j||!0===t.fsync))throw MongoError.create({message:\"No acknowledgement using w < 1 cannot be combined with journal:true or fsync:true\",driver:!0});return t},GridStoreStream=function(e){Duplex.call(this),this.gs=e,this.endCalled=!1,this.totalBytesToRead=this.gs.length-this.gs.position,this.seekPosition=this.gs.position};inherits(GridStoreStream,Duplex),GridStoreStream.prototype._pipe=GridStoreStream.prototype.pipe,GridStoreStream.prototype.pipe=function(e){var n=this;return n.gs.isOpen?(n.totalBytesToRead=n.gs.length-n.gs.position,n._pipe.apply(n,[e])):n.gs.open(function(t){if(t)return n.emit(\"error\",t);n.totalBytesToRead=n.gs.length-n.gs.position,n._pipe.apply(n,[e])}),e},GridStoreStream.prototype._read=function(){var e=this,n=function(){e.gs.read(t,function(n,t){return n&&!e.endCalled?e.emit(\"error\",n):e.endCalled||null==t?e.push(null):(t.length<=e.totalBytesToRead?(e.totalBytesToRead=e.totalBytesToRead-t.length,e.push(t)):t.length>e.totalBytesToRead&&(e.totalBytesToRead=e.totalBytesToRead-t._index,e.push(t.slice(0,t._index))),void(e.totalBytesToRead<=0&&(e.endCalled=!0)))})},t=e.gs.length<e.gs.chunkSize?e.gs.length-e.seekPosition:e.gs.chunkSize;e.gs.isOpen?n():e.gs.open(function(t){if(e.totalBytesToRead=e.gs.length-e.gs.position,t)return e.emit(\"error\",t);n()})},GridStoreStream.prototype.destroy=function(){this.pause(),this.endCalled=!0,this.gs.close(),this.emit(\"end\")},GridStoreStream.prototype.write=function(e){var n=this;return n.endCalled?n.emit(\"error\",MongoError.create({message:\"attempting to write to stream after end called\",driver:!0})):n.gs.isOpen?(n.gs.write(e,function(){n.emit(\"drain\")}),!0):(n.gs.open(function(){n.gs.isOpen=!0,n.gs.write(e,function(){process.nextTick(function(){n.emit(\"drain\")})})}),!1)},GridStoreStream.prototype.end=function(e,n,t){var i=this,o=Array.prototype.slice.call(arguments,0);t=\"function\"==typeof o[o.length-1]?o.pop():void 0,e=o.length?o.shift():null,o.length&&o.shift(),i.endCalled=!0,e&&i.gs.write(e,function(){i.gs.close(function(){\"function\"==typeof t&&t(),i.emit(\"end\")})}),i.gs.close(function(){\"function\"==typeof t&&t(),i.emit(\"end\")})},module.exports=GridStore;","node_modules/mongodb/lib/gridfs/chunk.js":"\"use strict\";var Binary=require(\"../core\").BSON.Binary,ObjectID=require(\"../core\").BSON.ObjectID,Buffer=require(\"safe-buffer\").Buffer,Chunk=function(t,n,i){if(!(this instanceof Chunk))return new Chunk(t,n);this.file=t;var e=null==n?{}:n;if(this.writeConcern=i||{w:1},this.objectId=null==e._id?new ObjectID:e._id,this.chunkNumber=null==e.n?0:e.n,this.data=new Binary,\"string\"==typeof e.data){var r=Buffer.alloc(e.data.length);r.write(e.data,0,e.data.length,\"binary\"),this.data=new Binary(r)}else if(Array.isArray(e.data)){r=Buffer.alloc(e.data.length);var a=e.data.join(\"\");r.write(a,0,a.length,\"binary\"),this.data=new Binary(r)}else if(e.data&&\"Binary\"===e.data._bsontype)this.data=e.data;else if(!Buffer.isBuffer(e.data)&&null!=e.data)throw Error(\"Illegal chunk format\");this.internalPosition=0};Chunk.prototype.write=function(t,n){return this.data.write(t,this.internalPosition,t.length,\"binary\"),this.internalPosition=this.data.length(),null!=n?n(null,this):this},Chunk.prototype.read=function(t){if(t=null==t||0===t?this.length():t,this.length()-this.internalPosition+1>=t){var n=this.data.read(this.internalPosition,t);return this.internalPosition=this.internalPosition+t,n}return\"\"},Chunk.prototype.readSlice=function(t){if(this.length()-this.internalPosition>=t){var n=null;return null!=this.data.buffer?n=this.data.buffer.slice(this.internalPosition,this.internalPosition+t):(n=Buffer.alloc(t),t=this.data.readInto(n,this.internalPosition)),this.internalPosition=this.internalPosition+t,n}return null},Chunk.prototype.eof=function(){return this.internalPosition===this.length()},Chunk.prototype.getc=function(){return this.read(1)},Chunk.prototype.rewind=function(){this.internalPosition=0,this.data=new Binary},Chunk.prototype.save=function(t,n){var i=this;\"function\"==typeof t&&(n=t,t={}),i.file.chunkCollection(function(e,r){if(e)return n(e);var a={upsert:!0};for(var o in t)a[o]=t[o];for(o in i.writeConcern)a[o]=i.writeConcern[o];i.data.length()>0?i.buildMongoObject(function(t){var e={forceServerObjectId:!0};for(var o in i.writeConcern)e[o]=i.writeConcern[o];r.replaceOne({_id:i.objectId},t,a,function(t){n(t,i)})}):n(null,i)})},Chunk.prototype.buildMongoObject=function(t){var n={files_id:this.file.fileId,n:this.chunkNumber,data:this.data};null!=this.objectId&&(n._id=this.objectId),t(n)},Chunk.prototype.length=function(){return this.data.length()},Object.defineProperty(Chunk.prototype,\"position\",{enumerable:!0,get:function(){return this.internalPosition},set:function(t){this.internalPosition=t}}),Chunk.DEFAULT_CHUNK_SIZE=261120,module.exports=Chunk;","node_modules/mongodb/lib/aggregation_cursor.js":"\"use strict\";const MongoError=require(\"./core\").MongoError,Cursor=require(\"./cursor\"),CursorState=require(\"./core/cursor\").CursorState,deprecate=require(\"util\").deprecate;class AggregationCursor extends Cursor{constructor(r,e,t){super(r,e,t)}batchSize(r){if(this.s.state===CursorState.CLOSED||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});if(\"number\"!=typeof r)throw MongoError.create({message:\"batchSize requires an integer\",driver:!0});return this.operation.options.batchSize=r,this.setCursorBatchSize(r),this}geoNear(r){return this.operation.addToPipeline({$geoNear:r}),this}group(r){return this.operation.addToPipeline({$group:r}),this}limit(r){return this.operation.addToPipeline({$limit:r}),this}match(r){return this.operation.addToPipeline({$match:r}),this}maxTimeMS(r){return this.operation.options.maxTimeMS=r,this}out(r){return this.operation.addToPipeline({$out:r}),this}project(r){return this.operation.addToPipeline({$project:r}),this}lookup(r){return this.operation.addToPipeline({$lookup:r}),this}redact(r){return this.operation.addToPipeline({$redact:r}),this}skip(r){return this.operation.addToPipeline({$skip:r}),this}sort(r){return this.operation.addToPipeline({$sort:r}),this}unwind(r){return this.operation.addToPipeline({$unwind:r}),this}getLogger(){return this.logger}}AggregationCursor.prototype.get=AggregationCursor.prototype.toArray,deprecate(AggregationCursor.prototype.geoNear,\"The `$geoNear` stage is deprecated in MongoDB 4.0, and removed in version 4.2.\"),module.exports=AggregationCursor;","node_modules/mongodb/lib/command_cursor.js":"\"use strict\";const ReadPreference=require(\"./core\").ReadPreference,MongoError=require(\"./core\").MongoError,Cursor=require(\"./cursor\"),CursorState=require(\"./core/cursor\").CursorState;class CommandCursor extends Cursor{constructor(r,e,s,o){super(r,e,s,o)}setReadPreference(r){if(this.s.state===CursorState.CLOSED||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});if(this.s.state!==CursorState.INIT)throw MongoError.create({message:\"cannot change cursor readPreference after cursor has been accessed\",driver:!0});if(r instanceof ReadPreference)this.options.readPreference=r;else{if(\"string\"!=typeof r)throw new TypeError(\"Invalid read preference: \"+r);this.options.readPreference=new ReadPreference(r)}return this}batchSize(r){if(this.s.state===CursorState.CLOSED||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});if(\"number\"!=typeof r)throw MongoError.create({message:\"batchSize requires an integer\",driver:!0});return this.cmd.cursor&&(this.cmd.cursor.batchSize=r),this.setCursorBatchSize(r),this}maxTimeMS(r){return this.topology.lastIsMaster().minWireVersion>2&&(this.cmd.maxTimeMS=r),this}getLogger(){return this.logger}}CommandCursor.prototype.get=CommandCursor.prototype.toArray,module.exports=CommandCursor;","node_modules/mongodb/lib/cursor.js":"\"use strict\";const Transform=require(\"stream\").Transform,PassThrough=require(\"stream\").PassThrough,deprecate=require(\"util\").deprecate,handleCallback=require(\"./utils\").handleCallback,ReadPreference=require(\"./core\").ReadPreference,MongoError=require(\"./core\").MongoError,CoreCursor=require(\"./core/cursor\").CoreCursor,CursorState=require(\"./core/cursor\").CursorState,Map=require(\"./core\").BSON.Map,each=require(\"./operations/cursor_ops\").each,CountOperation=require(\"./operations/count\"),ExplainOperation=require(\"./operations/explain\"),HasNextOperation=require(\"./operations/has_next\"),NextOperation=require(\"./operations/next\"),ToArrayOperation=require(\"./operations/to_array\"),executeOperation=require(\"./operations/execute_operation\"),flags=[\"tailable\",\"oplogReplay\",\"noCursorTimeout\",\"awaitData\",\"exhaust\",\"partial\"],fields=[\"numberOfRetries\",\"tailableRetryInterval\"];class Cursor extends CoreCursor{constructor(r,e,t,s){super(r,e,t,s),this.operation&&(s=this.operation.options);const o=s.numberOfRetries||5,i=s.tailableRetryInterval||500,a=o,n=s.promiseLibrary||Promise;this.s={numberOfRetries:o,tailableRetryInterval:i,currentNumberOfRetries:a,state:CursorState.INIT,promiseLibrary:n,currentDoc:null,explicitlyIgnoreSession:!!s.explicitlyIgnoreSession},!s.explicitlyIgnoreSession&&s.session&&(this.cursorState.session=s.session),!0===this.options.noCursorTimeout&&this.addCursorFlag(\"noCursorTimeout\",!0);let h=1e3;this.cmd.cursor&&this.cmd.cursor.batchSize?h=this.cmd.cursor.batchSize:s.cursor&&s.cursor.batchSize?h=s.cursor.batchSize:\"number\"==typeof s.batchSize&&(h=s.batchSize),this.setCursorBatchSize(h)}get readPreference(){return this.operation?this.operation.readPreference:this.options.readPreference}get sortValue(){return this.cmd.sort}_initializeCursor(r){this.operation&&null!=this.operation.session?this.cursorState.session=this.operation.session:this.s.explicitlyIgnoreSession||this.cursorState.session||!this.topology.hasSessionSupport()||(this.cursorState.session=this.topology.startSession({owner:this}),this.operation&&(this.operation.session=this.cursorState.session)),super._initializeCursor(r)}hasNext(r){const e=new HasNextOperation(this);return executeOperation(this.topology,e,r)}next(r){const e=new NextOperation(this);return executeOperation(this.topology,e,r)}filter(r){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});return this.cmd.query=r,this}maxScan(r){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});return this.cmd.maxScan=r,this}hint(r){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});return this.cmd.hint=r,this}min(r){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});return this.cmd.min=r,this}max(r){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});return this.cmd.max=r,this}returnKey(r){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});return this.cmd.returnKey=r,this}showRecordId(r){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});return this.cmd.showDiskLoc=r,this}snapshot(r){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});return this.cmd.snapshot=r,this}setCursorOption(r,e){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});if(-1===fields.indexOf(r))throw MongoError.create({message:`option ${r} is not a supported option ${fields}`,driver:!0});return this.s[r]=e,\"numberOfRetries\"===r&&(this.s.currentNumberOfRetries=e),this}addCursorFlag(r,e){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});if(-1===flags.indexOf(r))throw MongoError.create({message:`flag ${r} is not a supported flag ${flags}`,driver:!0});if(\"boolean\"!=typeof e)throw MongoError.create({message:`flag ${r} must be a boolean value`,driver:!0});return this.cmd[r]=e,this}addQueryModifier(r,e){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});if(\"$\"!==r[0])throw MongoError.create({message:`${r} is not a valid query modifier`,driver:!0});const t=r.substr(1);return this.cmd[t]=e,\"orderby\"===t&&(this.cmd.sort=this.cmd[t]),this}comment(r){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});return this.cmd.comment=r,this}maxAwaitTimeMS(r){if(\"number\"!=typeof r)throw MongoError.create({message:\"maxAwaitTimeMS must be a number\",driver:!0});if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});return this.cmd.maxAwaitTimeMS=r,this}maxTimeMS(r){if(\"number\"!=typeof r)throw MongoError.create({message:\"maxTimeMS must be a number\",driver:!0});if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});return this.cmd.maxTimeMS=r,this}project(r){if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});return this.cmd.fields=r,this}sort(r,e){if(this.options.tailable)throw MongoError.create({message:\"Tailable cursor doesn't support sorting\",driver:!0});if(this.s.state===CursorState.CLOSED||this.s.state===CursorState.OPEN||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});let t=r;return Array.isArray(t)&&Array.isArray(t[0])&&(t=new Map(t.map(r=>{const e=[r[0],null];if(\"asc\"===r[1])e[1]=1;else if(\"desc\"===r[1])e[1]=-1;else{if(1!==r[1]&&-1!==r[1]&&!r[1].$meta)throw new MongoError(\"Illegal sort clause, must be of the form [['field1', '(ascending|descending)'], ['field2', '(ascending|descending)']]\");e[1]=r[1]}return e}))),null!=e&&(t=[[r,e]]),this.cmd.sort=t,this}batchSize(r){if(this.options.tailable)throw MongoError.create({message:\"Tailable cursor doesn't support batchSize\",driver:!0});if(this.s.state===CursorState.CLOSED||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});if(\"number\"!=typeof r)throw MongoError.create({message:\"batchSize requires an integer\",driver:!0});return this.cmd.batchSize=r,this.setCursorBatchSize(r),this}collation(r){return this.cmd.collation=r,this}limit(r){if(this.options.tailable)throw MongoError.create({message:\"Tailable cursor doesn't support limit\",driver:!0});if(this.s.state===CursorState.OPEN||this.s.state===CursorState.CLOSED||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});if(\"number\"!=typeof r)throw MongoError.create({message:\"limit requires an integer\",driver:!0});return this.cmd.limit=r,this.setCursorLimit(r),this}skip(r){if(this.options.tailable)throw MongoError.create({message:\"Tailable cursor doesn't support skip\",driver:!0});if(this.s.state===CursorState.OPEN||this.s.state===CursorState.CLOSED||this.isDead())throw MongoError.create({message:\"Cursor is closed\",driver:!0});if(\"number\"!=typeof r)throw MongoError.create({message:\"skip requires an integer\",driver:!0});return this.cmd.skip=r,this.setCursorSkip(r),this}each(r){this.rewind(),this.s.state=CursorState.INIT,each(this,r)}forEach(r,e){if(this.rewind(),this.s.state=CursorState.INIT,\"function\"!=typeof e)return new this.s.promiseLibrary((e,t)=>{each(this,(s,o)=>s?(t(s),!1):null==o?(e(null),!1):(r(o),!0))});each(this,(t,s)=>{if(t)return e(t),!1;if(null!=s)return r(s),!0;if(null==s&&e){const r=e;return e=null,r(null),!1}})}setReadPreference(r){if(this.s.state!==CursorState.INIT)throw MongoError.create({message:\"cannot change cursor readPreference after cursor has been accessed\",driver:!0});if(r instanceof ReadPreference)this.options.readPreference=r;else{if(\"string\"!=typeof r)throw new TypeError(\"Invalid read preference: \"+r);this.options.readPreference=new ReadPreference(r)}return this}toArray(r){if(this.options.tailable)throw MongoError.create({message:\"Tailable cursor cannot be converted to array\",driver:!0});const e=new ToArrayOperation(this);return executeOperation(this.topology,e,r)}count(r,e,t){if(null==this.cmd.query)throw MongoError.create({message:\"count can only be used with find command\",driver:!0});\"function\"==typeof e&&(t=e,e={}),e=e||{},\"function\"==typeof r&&(t=r,r=!0),this.cursorState.session&&(e=Object.assign({},e,{session:this.cursorState.session}));const s=new CountOperation(this,r,e);return executeOperation(this.topology,s,t)}close(r,e){\"function\"==typeof r&&(e=r,r={}),r=Object.assign({},{skipKillCursors:!1},r),this.s.state=CursorState.CLOSED,r.skipKillCursors||this.kill();const t=()=>(this.emit(\"close\"),\"function\"==typeof e?handleCallback(e,null,this):new this.s.promiseLibrary(r=>{r()}));return this.cursorState.session?\"function\"==typeof e?this._endSession(()=>t()):new this.s.promiseLibrary(r=>{this._endSession(()=>t().then(r))}):t()}map(r){if(this.cursorState.transforms&&this.cursorState.transforms.doc){const e=this.cursorState.transforms.doc;this.cursorState.transforms.doc=(t=>r(e(t)))}else this.cursorState.transforms={doc:r};return this}isClosed(){return this.isDead()}destroy(r){r&&this.emit(\"error\",r),this.pause(),this.close()}stream(r){return this.cursorState.streamOptions=r||{},this}transformStream(r){const e=r||{};if(\"function\"==typeof e.transform){const r=new Transform({objectMode:!0,transform:function(r,t,s){this.push(e.transform(r)),s()}});return this.pipe(r)}return this.pipe(new PassThrough({objectMode:!0}))}explain(r){if(this.operation&&null==this.operation.cmd)return this.operation.options.explain=!0,this.operation.fullResponse=!1,executeOperation(this.topology,this.operation,r);this.cmd.explain=!0,this.cmd.readConcern&&delete this.cmd.readConcern;const e=new ExplainOperation(this);return executeOperation(this.topology,e,r)}getLogger(){return this.logger}}Cursor.prototype.maxTimeMs=Cursor.prototype.maxTimeMS,deprecate(Cursor.prototype.each,\"Cursor.each is deprecated. Use Cursor.forEach instead.\"),deprecate(Cursor.prototype.maxScan,\"Cursor.maxScan is deprecated, and will be removed in a later version\"),deprecate(Cursor.prototype.snapshot,\"Cursor Snapshot is deprecated, and will be removed in a later version\"),module.exports=Cursor;","node_modules/mongodb/lib/gridfs-stream/index.js":"\"use strict\";var Emitter=require(\"events\").EventEmitter,GridFSBucketReadStream=require(\"./download\"),GridFSBucketWriteStream=require(\"./upload\"),shallowClone=require(\"../utils\").shallowClone,toError=require(\"../utils\").toError,util=require(\"util\"),executeLegacyOperation=require(\"../utils\").executeLegacyOperation,DEFAULT_GRIDFS_BUCKET_OPTIONS={bucketName:\"fs\",chunkSizeBytes:261120};function GridFSBucket(e,t){if(Emitter.apply(this),this.setMaxListeners(0),t&&\"object\"==typeof t){t=shallowClone(t);for(var i=Object.keys(DEFAULT_GRIDFS_BUCKET_OPTIONS),o=0;o<i.length;++o)t[i[o]]||(t[i[o]]=DEFAULT_GRIDFS_BUCKET_OPTIONS[i[o]])}else t=DEFAULT_GRIDFS_BUCKET_OPTIONS;this.s={db:e,options:t,_chunksCollection:e.collection(t.bucketName+\".chunks\"),_filesCollection:e.collection(t.bucketName+\".files\"),checkedIndexes:!1,calledOpenUploadStream:!1,promiseLibrary:e.s.promiseLibrary||Promise}}function _delete(e,t,i){e.s._filesCollection.deleteOne({_id:t},function(o,r){if(o)return i(o);e.s._chunksCollection.deleteMany({files_id:t},function(e){return e?i(e):r.result.n?void i():i(new Error(\"FileNotFound: no file with id \"+t+\" found\"))})})}function _rename(e,t,i,o){var r={_id:t},n={$set:{filename:i}};e.s._filesCollection.updateOne(r,n,function(e,i){return e?o(e):i.result.n?void o():o(toError(\"File with id \"+t+\" not found\"))})}function _drop(e,t){e.s._filesCollection.drop(function(i){if(i)return t(i);e.s._chunksCollection.drop(function(e){return e?t(e):t()})})}module.exports=GridFSBucket,util.inherits(GridFSBucket,Emitter),GridFSBucket.prototype.openUploadStream=function(e,t){return(t=t?shallowClone(t):{}).chunkSizeBytes||(t.chunkSizeBytes=this.s.options.chunkSizeBytes),new GridFSBucketWriteStream(this,e,t)},GridFSBucket.prototype.openUploadStreamWithId=function(e,t,i){return(i=i?shallowClone(i):{}).chunkSizeBytes||(i.chunkSizeBytes=this.s.options.chunkSizeBytes),i.id=e,new GridFSBucketWriteStream(this,t,i)},GridFSBucket.prototype.openDownloadStream=function(e,t){var i={_id:e};return t={start:t&&t.start,end:t&&t.end},new GridFSBucketReadStream(this.s._chunksCollection,this.s._filesCollection,this.s.options.readPreference,i,t)},GridFSBucket.prototype.delete=function(e,t){return executeLegacyOperation(this.s.db.s.topology,_delete,[this,e,t],{skipSessions:!0})},GridFSBucket.prototype.find=function(e,t){e=e||{},t=t||{};var i=this.s._filesCollection.find(e);return null!=t.batchSize&&i.batchSize(t.batchSize),null!=t.limit&&i.limit(t.limit),null!=t.maxTimeMS&&i.maxTimeMS(t.maxTimeMS),null!=t.noCursorTimeout&&i.addCursorFlag(\"noCursorTimeout\",t.noCursorTimeout),null!=t.skip&&i.skip(t.skip),null!=t.sort&&i.sort(t.sort),i},GridFSBucket.prototype.openDownloadStreamByName=function(e,t){var i={uploadDate:-1},o=null;t&&null!=t.revision&&(t.revision>=0?(i={uploadDate:1},o=t.revision):o=-t.revision-1);var r={filename:e};return t={sort:i,skip:o,start:t&&t.start,end:t&&t.end},new GridFSBucketReadStream(this.s._chunksCollection,this.s._filesCollection,this.s.options.readPreference,r,t)},GridFSBucket.prototype.rename=function(e,t,i){return executeLegacyOperation(this.s.db.s.topology,_rename,[this,e,t,i],{skipSessions:!0})},GridFSBucket.prototype.drop=function(e){return executeLegacyOperation(this.s.db.s.topology,_drop,[this,e],{skipSessions:!0})},GridFSBucket.prototype.getLogger=function(){return this.s.db.s.logger};","node_modules/bson/index.js":"var BSON=require(\"./lib/bson/bson\"),Binary=require(\"./lib/bson/binary\"),Code=require(\"./lib/bson/code\"),DBRef=require(\"./lib/bson/db_ref\"),Decimal128=require(\"./lib/bson/decimal128\"),Double=require(\"./lib/bson/double\"),Int32=require(\"./lib/bson/int_32\"),Long=require(\"./lib/bson/long\"),Map=require(\"./lib/bson/map\"),MaxKey=require(\"./lib/bson/max_key\"),MinKey=require(\"./lib/bson/min_key\"),ObjectId=require(\"./lib/bson/objectid\"),BSONRegExp=require(\"./lib/bson/regexp\"),Symbol=require(\"./lib/bson/symbol\"),Timestamp=require(\"./lib/bson/timestamp\");BSON.BSON_INT32_MAX=2147483647,BSON.BSON_INT32_MIN=-2147483648,BSON.BSON_INT64_MAX=Math.pow(2,63)-1,BSON.BSON_INT64_MIN=-Math.pow(2,63),BSON.JS_INT_MAX=9007199254740992,BSON.JS_INT_MIN=-9007199254740992,BSON.Binary=Binary,BSON.Code=Code,BSON.DBRef=DBRef,BSON.Decimal128=Decimal128,BSON.Double=Double,BSON.Int32=Int32,BSON.Long=Long,BSON.Map=Map,BSON.MaxKey=MaxKey,BSON.MinKey=MinKey,BSON.ObjectId=ObjectId,BSON.ObjectID=ObjectId,BSON.BSONRegExp=BSONRegExp,BSON.Symbol=Symbol,BSON.Timestamp=Timestamp,module.exports=BSON;","node_modules/require_optional/index.js":"var path=require(\"path\"),fs=require(\"fs\"),f=require(\"util\").format,resolveFrom=require(\"resolve-from\"),semver=require(\"semver\"),exists=fs.existsSync||path.existsSync,find_package_json=function(e){for(var r=!1;!r;)if(exists(e+\"/package.json\"))r=e;else{if(\"/\"===e)return!1;e=path.dirname(e)}return e},find_package_json_with_name=function(e){for(var r=module,n=!1;r;){i=r.filename;var i=find_package_json(i);if(i){var t=JSON.parse(fs.readFileSync(f(\"%s/package.json\",i))),a=e.split(/\\//);if(t.peerOptionalDependencies&&(!t.peerOptionalDependencies||t.peerOptionalDependencies[a[0]])){n=!0;break}r=r.parent}else r=r.parent}if(!n)throw new Error(f(\"no optional dependency [%s] defined in peerOptionalDependencies in any package.json\",a[0]));return{object:t,parts:a}},require_optional=function(e,r){(r=r||{}).strict=\"boolean\"!=typeof r.strict||r.strict;var n=find_package_json_with_name(e),i=n.object,t=n.parts,a=i.peerOptionalDependencies[t[0]],o=void 0,s=e;try{o=require(s)}catch(r){try{if(null==(s=resolveFrom(process.cwd(),e)))return;o=require(s)}catch(e){if(\"MODULE_NOT_FOUND\"===e.code)return}}var p=find_package_json(require.resolve(s));if(!p)throw new Error(\"package.json can not be located\");var c=JSON.parse(fs.readFileSync(f(\"%s/package.json\",p))).version;if(0==semver.satisfies(c,a)&&r.strict){var d=new Error(f(\"optional dependency [%s] found but version [%s] did not satisfy constraint [%s]\",t[0],c,a));throw d.code=\"OPTIONAL_MODULE_NOT_FOUND\",d}return o};require_optional.exists=function(e){try{return void 0!==require_optional(e)}catch(e){return!1}},module.exports=require_optional;","node_modules/mongodb/lib/core/utils.js":"\"use strict\";const crypto=require(\"crypto\"),requireOptional=require(\"require_optional\"),uuidV4=()=>{const r=crypto.randomBytes(16);return r[6]=15&r[6]|64,r[8]=63&r[8]|128,r},calculateDurationInMs=r=>{const e=process.hrtime(r);return(1e9*e[0]+e[1])/1e6};function relayEvents(r,e,t){t.forEach(t=>r.on(t,r=>e.emit(t,r)))}function retrieveKerberos(){let r;try{r=requireOptional(\"kerberos\")}catch(r){if(\"MODULE_NOT_FOUND\"===r.code)throw new Error(\"The `kerberos` module was not found. Please install it and try again.\");throw r}return r}const noEJSONError=function(){throw new Error(\"The `mongodb-extjson` module was not found. Please install it and try again.\")};function retrieveEJSON(){let r=null;try{r=requireOptional(\"mongodb-extjson\")}catch(r){}return r||(r={parse:noEJSONError,deserialize:noEJSONError,serialize:noEJSONError,stringify:noEJSONError,setBSONModule:noEJSONError,BSON:noEJSONError}),r}function maxWireVersion(r){if(r.ismaster)return r.ismaster.maxWireVersion;if(\"function\"==typeof r.lastIsMaster){const e=r.lastIsMaster();if(e)return e.maxWireVersion}return r.description?r.description.maxWireVersion:null}function collationNotSupported(r,e){return e&&e.collation&&maxWireVersion(r)<5}function isPromiseLike(r){return r&&\"function\"==typeof r.then}function eachAsync(r,e,t){if(0===r.length)return void t(null);const n=r.length;let o=0;function i(r){r?t(r,null):++o===n&&t(null)}for(let o=0;o<n;++o)try{e(r[o],i)}catch(r){return void t(r)}}function isUnifiedTopology(r){return null!=r.description}function arrayStrictEqual(r,e){return!(!Array.isArray(r)||!Array.isArray(e))&&(r.length===e.length&&r.every((r,t)=>r===e[t]))}function tagsStrictEqual(r,e){const t=Object.keys(r),n=Object.keys(e);return t.length===n.length&&t.every(t=>e[t]===r[t])}function makeStateMachine(r){return function(e,t){const n=r[e.s.state];if(n&&n.indexOf(t)<0)throw new TypeError(`illegal state transition from [${e.s.state}] => [${t}], allowed: [${n}]`);e.emit(\"stateChanged\",e.s.state,t),e.s.state=t}}module.exports={uuidV4:uuidV4,calculateDurationInMs:calculateDurationInMs,relayEvents:relayEvents,collationNotSupported:collationNotSupported,retrieveEJSON:retrieveEJSON,retrieveKerberos:retrieveKerberos,maxWireVersion:maxWireVersion,isPromiseLike:isPromiseLike,eachAsync:eachAsync,isUnifiedTopology:isUnifiedTopology,arrayStrictEqual:arrayStrictEqual,tagsStrictEqual:tagsStrictEqual,makeStateMachine:makeStateMachine};","node_modules/mongodb/lib/core/error.js":"\"use strict\";const mongoErrorContextSymbol=Symbol(\"mongoErrorContextSymbol\"),maxWireVersion=require(\"./utils\").maxWireVersion;class MongoError extends Error{constructor(r){if(r instanceof Error)super(r.message),this.stack=r.stack;else{if(\"string\"==typeof r)super(r);else for(var o in super(r.message||r.errmsg||r.$err||\"n/a\"),r)this[o]=r[o];Error.captureStackTrace(this,this.constructor)}this.name=\"MongoError\",this[mongoErrorContextSymbol]=this[mongoErrorContextSymbol]||{}}static create(r){return new MongoError(r)}hasErrorLabel(r){return this.errorLabels&&-1!==this.errorLabels.indexOf(r)}}class MongoNetworkError extends MongoError{constructor(r){super(r),this.name=\"MongoNetworkError\"}}class MongoParseError extends MongoError{constructor(r){super(r),this.name=\"MongoParseError\"}}class MongoTimeoutError extends MongoError{constructor(r,o){super(r),this.name=\"MongoTimeoutError\",null!=o&&(this.reason=o)}}function makeWriteConcernResultObject(r){const o=Object.assign({},r);return 0===o.ok&&(o.ok=1,delete o.errmsg,delete o.code,delete o.codeName),o}class MongoWriteConcernError extends MongoError{constructor(r,o){super(r),this.name=\"MongoWriteConcernError\",null!=o&&(this.result=makeWriteConcernResultObject(o))}}const RETRYABLE_ERROR_CODES=new Set([6,7,89,91,189,9001,10107,11600,11602,13435,13436]);function isRetryableError(r){return RETRYABLE_ERROR_CODES.has(r.code)||r instanceof MongoNetworkError||r.message.match(/not master/)||r.message.match(/node is recovering/)}const SDAM_RECOVERING_CODES=new Set([91,189,11600,11602,13436]),SDAM_NOTMASTER_CODES=new Set([10107,13435]),SDAM_NODE_SHUTTING_DOWN_ERROR_CODES=new Set([11600,91]);function isRecoveringError(r){return!(!r.code||!SDAM_RECOVERING_CODES.has(r.code))||(r.message.match(/not master or secondary/)||r.message.match(/node is recovering/))}function isNotMasterError(r){return!(!r.code||!SDAM_NOTMASTER_CODES.has(r.code))||!isRecoveringError(r)&&r.message.match(/not master/)}function isNodeShuttingDownError(r){return r.code&&SDAM_NODE_SHUTTING_DOWN_ERROR_CODES.has(r.code)}function isSDAMUnrecoverableError(r,o){return r instanceof MongoParseError||null==r||!(!isRecoveringError(r)&&!isNotMasterError(r))&&!(maxWireVersion(o)>=8&&!isNodeShuttingDownError(r))}module.exports={MongoError:MongoError,MongoNetworkError:MongoNetworkError,MongoParseError:MongoParseError,MongoTimeoutError:MongoTimeoutError,MongoWriteConcernError:MongoWriteConcernError,mongoErrorContextSymbol:mongoErrorContextSymbol,isRetryableError:isRetryableError,isSDAMUnrecoverableError:isSDAMUnrecoverableError};","node_modules/mongodb/lib/core/connection/connection.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter,crypto=require(\"crypto\"),debugOptions=require(\"./utils\").debugOptions,parseHeader=require(\"../wireprotocol/shared\").parseHeader,decompress=require(\"../wireprotocol/compression\").decompress,Response=require(\"./commands\").Response,BinMsg=require(\"./msg\").BinMsg,MongoNetworkError=require(\"../error\").MongoNetworkError,MongoError=require(\"../error\").MongoError,Logger=require(\"./logger\"),OP_COMPRESSED=require(\"../wireprotocol/shared\").opcodes.OP_COMPRESSED,OP_MSG=require(\"../wireprotocol/shared\").opcodes.OP_MSG,MESSAGE_HEADER_SIZE=require(\"../wireprotocol/shared\").MESSAGE_HEADER_SIZE,Buffer=require(\"safe-buffer\").Buffer;let _id=0;const DEFAULT_MAX_BSON_MESSAGE_SIZE=67108864,DEBUG_FIELDS=[\"host\",\"port\",\"size\",\"keepAlive\",\"keepAliveInitialDelay\",\"noDelay\",\"connectionTimeout\",\"socketTimeout\",\"ssl\",\"ca\",\"crl\",\"cert\",\"rejectUnauthorized\",\"promoteLongs\",\"promoteValues\",\"promoteBuffers\",\"checkServerIdentity\"];let connectionAccountingSpy=void 0,connectionAccounting=!1,connections={};class Connection extends EventEmitter{constructor(e,t){if(super(),!(t=t||{}).bson)throw new TypeError(\"must pass in valid bson parser\");this.id=_id++,this.options=t,this.logger=Logger(\"Connection\",t),this.bson=t.bson,this.tag=t.tag,this.maxBsonMessageSize=t.maxBsonMessageSize||DEFAULT_MAX_BSON_MESSAGE_SIZE,this.port=t.port||27017,this.host=t.host||\"localhost\",this.socketTimeout=\"number\"==typeof t.socketTimeout?t.socketTimeout:36e4,this.keepAlive=\"boolean\"!=typeof t.keepAlive||t.keepAlive,this.keepAliveInitialDelay=\"number\"==typeof t.keepAliveInitialDelay?t.keepAliveInitialDelay:3e5,this.connectionTimeout=\"number\"==typeof t.connectionTimeout?t.connectionTimeout:3e4,this.keepAliveInitialDelay>this.socketTimeout&&(this.keepAliveInitialDelay=Math.round(this.socketTimeout/2)),this.logger.isDebug()&&this.logger.debug(`creating connection ${this.id} with options [${JSON.stringify(debugOptions(DEBUG_FIELDS,t))}]`),this.responseOptions={promoteLongs:\"boolean\"!=typeof t.promoteLongs||t.promoteLongs,promoteValues:\"boolean\"!=typeof t.promoteValues||t.promoteValues,promoteBuffers:\"boolean\"==typeof t.promoteBuffers&&t.promoteBuffers},this.flushing=!1,this.queue=[],this.writeStream=null,this.destroyed=!1;const o=crypto.createHash(\"sha1\");o.update(this.address),this.hashedName=o.digest(\"hex\"),this.workItems=[],this.socket=e,this.socket.once(\"error\",errorHandler(this)),this.socket.once(\"timeout\",timeoutHandler(this)),this.socket.once(\"close\",closeHandler(this)),this.socket.on(\"data\",dataHandler(this)),connectionAccounting&&addConnection(this.id,this)}setSocketTimeout(e){this.socket&&this.socket.setTimeout(e)}resetSocketTimeout(){this.socket&&this.socket.setTimeout(this.socketTimeout)}static enableConnectionAccounting(e){e&&(connectionAccountingSpy=e),connectionAccounting=!0,connections={}}static disableConnectionAccounting(){connectionAccounting=!1,connectionAccountingSpy=void 0}static connections(){return connections}get address(){return`${this.host}:${this.port}`}unref(){null!=this.socket?this.socket.unref():this.once(\"connect\",()=>this.socket.unref())}destroy(e,t){if(\"function\"==typeof e&&(t=e,e={}),e=Object.assign({force:!1},e),connectionAccounting&&deleteConnection(this.id),null!=this.socket)return e.force?(this.socket.destroy(),this.destroyed=!0,void(\"function\"==typeof t&&t(null,null))):void this.socket.end(e=>{this.destroyed=!0,\"function\"==typeof t&&t(e,null)});this.destroyed=!0}write(e){if(this.logger.isDebug())if(Array.isArray(e))for(let t=0;t<e.length;t++)this.logger.debug(`writing buffer [${e[t].toString(\"hex\")}] to ${this.address}`);else this.logger.debug(`writing buffer [${e.toString(\"hex\")}] to ${this.address}`);if(!1===this.socket.destroyed){if(!Array.isArray(e))return this.socket.write(e,\"binary\"),!0;for(let t=0;t<e.length;t++)this.socket.write(e[t],\"binary\");return!0}return!1}toString(){return\"\"+this.id}toJSON(){return{id:this.id,host:this.host,port:this.port}}isConnected(){return!this.destroyed&&(!this.socket.destroyed&&this.socket.writable)}}function deleteConnection(e){delete connections[e],connectionAccountingSpy&&connectionAccountingSpy.deleteConnection(e)}function addConnection(e,t){connections[e]=t,connectionAccountingSpy&&connectionAccountingSpy.addConnection(e,t)}function errorHandler(e){return function(t){connectionAccounting&&deleteConnection(e.id),e.logger.isDebug()&&e.logger.debug(`connection ${e.id} for [${e.address}] errored out with [${JSON.stringify(t)}]`),e.emit(\"error\",new MongoNetworkError(t),e)}}function timeoutHandler(e){return function(){connectionAccounting&&deleteConnection(e.id),e.logger.isDebug()&&e.logger.debug(`connection ${e.id} for [${e.address}] timed out`),e.emit(\"timeout\",new MongoNetworkError(`connection ${e.id} to ${e.address} timed out`),e)}}function closeHandler(e){return function(t){connectionAccounting&&deleteConnection(e.id),e.logger.isDebug()&&e.logger.debug(`connection ${e.id} with for [${e.address}] closed`),t||e.emit(\"close\",new MongoNetworkError(`connection ${e.id} to ${e.address} closed`),e)}}function processMessage(e,t){const o=parseHeader(t);if(o.opCode!==OP_COMPRESSED){const s=o.opCode===OP_MSG?BinMsg:Response;return void e.emit(\"message\",new s(e.bson,t,o,t.slice(MESSAGE_HEADER_SIZE),e.responseOptions),e)}o.fromCompressed=!0;let s=MESSAGE_HEADER_SIZE;o.opCode=t.readInt32LE(s),s+=4,o.length=t.readInt32LE(s);const n=t[s+=4];s++,decompress(n,t.slice(s),(s,n)=>{if(s)return void e.emit(\"error\",s);if(n.length!==o.length)return void e.emit(\"error\",new MongoError(\"Decompressing a compressed message from the server failed. The message is corrupt.\"));const r=o.opCode===OP_MSG?BinMsg:Response;e.emit(\"message\",new r(e.bson,t,o,n,e.responseOptions),e)})}function dataHandler(e){return function(t){for(;t.length>0;)if(e.bytesRead>0&&e.sizeOfMessage>0){const o=e.sizeOfMessage-e.bytesRead;if(o>t.length)t.copy(e.buffer,e.bytesRead),e.bytesRead=e.bytesRead+t.length,t=Buffer.alloc(0);else{t.copy(e.buffer,e.bytesRead,0,o),t=t.slice(o);const s=e.buffer;e.buffer=null,e.sizeOfMessage=0,e.bytesRead=0,e.stubBuffer=null,processMessage(e,s)}}else if(null!=e.stubBuffer&&e.stubBuffer.length>0)if(e.stubBuffer.length+t.length>4){const o=Buffer.alloc(e.stubBuffer.length+t.length);e.stubBuffer.copy(o,0),t.copy(o,e.stubBuffer.length),t=o,e.buffer=null,e.sizeOfMessage=0,e.bytesRead=0,e.stubBuffer=null}else{const o=Buffer.alloc(e.stubBuffer.length+t.length);e.stubBuffer.copy(o,0),t.copy(o,e.stubBuffer.length),t=Buffer.alloc(0)}else if(t.length>4){const o=t[0]|t[1]<<8|t[2]<<16|t[3]<<24;if(o<0||o>e.maxBsonMessageSize){const t={err:\"socketHandler\",trace:\"\",bin:e.buffer,parseState:{sizeOfMessage:o,bytesRead:e.bytesRead,stubBuffer:e.stubBuffer}};return void e.emit(\"parseError\",t,e)}if(o>4&&o<e.maxBsonMessageSize&&o>t.length)e.buffer=Buffer.alloc(o),t.copy(e.buffer,0),e.bytesRead=t.length,e.sizeOfMessage=o,e.stubBuffer=null,t=Buffer.alloc(0);else if(o>4&&o<e.maxBsonMessageSize&&o===t.length){const o=t;e.buffer=null,e.sizeOfMessage=0,e.bytesRead=0,e.stubBuffer=null,t=Buffer.alloc(0),processMessage(e,o)}else if(o<=4||o>e.maxBsonMessageSize){const s={err:\"socketHandler\",trace:null,bin:t,parseState:{sizeOfMessage:o,bytesRead:0,buffer:null,stubBuffer:null}};e.emit(\"parseError\",s,e),e.buffer=null,e.sizeOfMessage=0,e.bytesRead=0,e.stubBuffer=null,t=Buffer.alloc(0)}else{const s=t.slice(0,o);e.buffer=null,e.sizeOfMessage=0,e.bytesRead=0,e.stubBuffer=null,t=t.slice(o),processMessage(e,s)}}else e.stubBuffer=Buffer.alloc(t.length),t.copy(e.stubBuffer,0),t=Buffer.alloc(0)}}module.exports=Connection;","node_modules/mongodb/lib/core/topologies/server.js":"\"use strict\";var inherits=require(\"util\").inherits,f=require(\"util\").format,EventEmitter=require(\"events\").EventEmitter,ReadPreference=require(\"./read_preference\"),Logger=require(\"../connection/logger\"),debugOptions=require(\"../connection/utils\").debugOptions,retrieveBSON=require(\"../connection/utils\").retrieveBSON,Pool=require(\"../connection/pool\"),MongoError=require(\"../error\").MongoError,MongoNetworkError=require(\"../error\").MongoNetworkError,wireProtocol=require(\"../wireprotocol\"),CoreCursor=require(\"../cursor\").CoreCursor,sdam=require(\"./shared\"),createClientInfo=require(\"./shared\").createClientInfo,createCompressionInfo=require(\"./shared\").createCompressionInfo,resolveClusterTime=require(\"./shared\").resolveClusterTime,SessionMixins=require(\"./shared\").SessionMixins,relayEvents=require(\"../utils\").relayEvents;const collationNotSupported=require(\"../utils\").collationNotSupported;var debugFields=[\"reconnect\",\"reconnectTries\",\"reconnectInterval\",\"emitError\",\"cursorFactory\",\"host\",\"port\",\"size\",\"keepAlive\",\"keepAliveInitialDelay\",\"noDelay\",\"connectionTimeout\",\"checkServerIdentity\",\"socketTimeout\",\"ssl\",\"ca\",\"crl\",\"cert\",\"key\",\"rejectUnauthorized\",\"promoteLongs\",\"promoteValues\",\"promoteBuffers\",\"servername\"],id=0,serverAccounting=!1,servers={},BSON=retrieveBSON();function topologyId(e){return null==e.s.parent?e.id:e.s.parent.id}var Server=function(e){e=e||{},EventEmitter.call(this),this.id=id++,this.s={options:e,logger:Logger(\"Server\",e),Cursor:e.cursorFactory||CoreCursor,bson:e.bson||new BSON([BSON.Binary,BSON.Code,BSON.DBRef,BSON.Decimal128,BSON.Double,BSON.Int32,BSON.Long,BSON.Map,BSON.MaxKey,BSON.MinKey,BSON.ObjectId,BSON.BSONRegExp,BSON.Symbol,BSON.Timestamp]),pool:null,disconnectHandler:e.disconnectHandler,monitoring:\"boolean\"!=typeof e.monitoring||e.monitoring,inTopology:!!e.parent,monitoringInterval:\"number\"==typeof e.monitoringInterval?e.monitoringInterval:5e3,compression:{compressors:createCompressionInfo(e)},parent:e.parent},this.s.parent||(this.s.clusterTime=null),this.ismaster=null,this.lastIsMasterMS=-1,this.monitoringProcessId=null,this.initialConnect=!0,this._type=\"server\",this.clientInfo=createClientInfo(e),this.lastUpdateTime=0,this.lastWriteDate=0,this.staleness=0};function disconnectHandler(e,o,r,t,s,n){return e.s.pool.isConnected()||!e.s.options.reconnect||null==e.s.disconnectHandler||s.monitoring?e.s.pool.isConnected()?void 0:(n(new MongoError(f(\"no connection available to server %s\",e.name))),!0):(e.s.disconnectHandler.add(o,r,t,s,n),!0)}function monitoringProcess(e){return function(){if(!e.s.pool.isDestroyed()){e.emit(\"monitoring\",e);var o=(new Date).getTime();e.command(\"admin.$cmd\",{ismaster:!0},{socketTimeout:\"number\"!=typeof e.s.options.connectionTimeout?2e3:e.s.options.connectionTimeout,monitoring:!0},(r,t)=>{e.lastIsMasterMS=(new Date).getTime()-o,e.s.pool.isDestroyed()||(t&&(e.ismaster=t.result),e.monitoringProcessId=setTimeout(monitoringProcess(e),e.s.monitoringInterval))})}}}inherits(Server,EventEmitter),Object.assign(Server.prototype,SessionMixins),Object.defineProperty(Server.prototype,\"type\",{enumerable:!0,get:function(){return this._type}}),Object.defineProperty(Server.prototype,\"parserType\",{enumerable:!0,get:function(){return BSON.native?\"c++\":\"js\"}}),Object.defineProperty(Server.prototype,\"logicalSessionTimeoutMinutes\",{enumerable:!0,get:function(){return this.ismaster&&this.ismaster.logicalSessionTimeoutMinutes||null}}),Object.defineProperty(Server.prototype,\"clusterTime\",{enumerable:!0,set:function(e){const o=this.s.parent?this.s.parent:this.s;resolveClusterTime(o,e)},get:function(){return(this.s.parent?this.s.parent:this.s).clusterTime||null}}),Server.enableServerAccounting=function(){serverAccounting=!0,servers={}},Server.disableServerAccounting=function(){serverAccounting=!1},Server.servers=function(){return servers},Object.defineProperty(Server.prototype,\"name\",{enumerable:!0,get:function(){return this.s.options.host+\":\"+this.s.options.port}});var eventHandler=function(e,o){return function(r,t){if(e.s.logger.isInfo()){var s=r instanceof MongoError?JSON.stringify(r):{};e.s.logger.info(f(\"server %s fired event %s out with message %s\",e.name,o,s))}if(\"connect\"===o){if(e.initialConnect=!1,e.ismaster=t.ismaster,e.lastIsMasterMS=t.lastIsMasterMS,t.agreedCompressor&&(e.s.pool.options.agreedCompressor=t.agreedCompressor),t.zlibCompressionLevel&&(e.s.pool.options.zlibCompressionLevel=t.zlibCompressionLevel),t.ismaster.$clusterTime){const o=t.ismaster.$clusterTime;e.clusterTime=o}\"isdbgrid\"===e.ismaster.msg&&(e._type=\"mongos\"),e.s.monitoring&&(e.monitoringProcessId=setTimeout(monitoringProcess(e),e.s.monitoringInterval)),sdam.emitServerDescriptionChanged(e,{address:e.name,arbiters:[],hosts:[],passives:[],type:sdam.getTopologyType(e)}),e.s.inTopology||sdam.emitTopologyDescriptionChanged(e,{topologyType:\"Single\",servers:[{address:e.name,arbiters:[],hosts:[],passives:[],type:sdam.getTopologyType(e)}]}),e.s.logger.isInfo()&&e.s.logger.info(f(\"server %s connected with ismaster [%s]\",e.name,JSON.stringify(e.ismaster))),e.emit(\"connect\",e)}else{if(serverAccounting&&-1!==[\"close\",\"timeout\",\"error\",\"parseError\",\"reconnectFailed\"].indexOf(o)&&(e.s.inTopology||e.emit(\"topologyOpening\",{topologyId:e.id}),delete servers[e.id]),\"close\"===o&&sdam.emitServerDescriptionChanged(e,{address:e.name,arbiters:[],hosts:[],passives:[],type:\"Unknown\"}),\"reconnectFailed\"===o)return e.emit(\"reconnectFailed\",r),void(e.listeners(\"error\").length>0&&e.emit(\"error\",r));if(-1!==[\"disconnected\",\"connecting\"].indexOf(e.s.pool.state)&&e.initialConnect&&-1!==[\"close\",\"timeout\",\"error\",\"parseError\"].indexOf(o))return e.initialConnect=!1,e.emit(\"error\",new MongoNetworkError(f(\"failed to connect to server [%s] on first connect [%s]\",e.name,r)));if(\"reconnect\"===o)return sdam.emitServerDescriptionChanged(e,{address:e.name,arbiters:[],hosts:[],passives:[],type:sdam.getTopologyType(e)}),e.emit(o,e);e.emit(o,r)}}};function basicWriteValidations(e){return e.s.pool?e.s.pool.isDestroyed()?new MongoError(\"server instance pool was destroyed\"):void 0:new MongoError(\"server instance is not connected\")}function basicReadValidations(e,o){if(basicWriteValidations(e,o),o.readPreference&&!(o.readPreference instanceof ReadPreference))throw new Error(\"readPreference must be an instance of ReadPreference\")}Server.prototype.connect=function(e){if(e=e||{},serverAccounting&&(servers[this.id]=this),this.s.pool&&!this.s.pool.isDisconnected()&&!this.s.pool.isDestroyed())throw new MongoError(f(\"server instance in invalid state %s\",this.s.pool.state));this.s.pool=new Pool(this,Object.assign(this.s.options,e,{bson:this.s.bson})),this.s.pool.on(\"close\",eventHandler(this,\"close\")),this.s.pool.on(\"error\",eventHandler(this,\"error\")),this.s.pool.on(\"timeout\",eventHandler(this,\"timeout\")),this.s.pool.on(\"parseError\",eventHandler(this,\"parseError\")),this.s.pool.on(\"connect\",eventHandler(this,\"connect\")),this.s.pool.on(\"reconnect\",eventHandler(this,\"reconnect\")),this.s.pool.on(\"reconnectFailed\",eventHandler(this,\"reconnectFailed\")),relayEvents(this.s.pool,this,[\"commandStarted\",\"commandSucceeded\",\"commandFailed\"]),this.s.inTopology||this.emit(\"topologyOpening\",{topologyId:topologyId(this)}),this.emit(\"serverOpening\",{topologyId:topologyId(this),address:this.name}),this.s.pool.connect()},Server.prototype.auth=function(e,o){\"function\"==typeof o&&o(null,null)},Server.prototype.getDescription=function(){var e=this.ismaster||{},o={type:sdam.getTopologyType(this),address:this.name};return e.hosts&&(o.hosts=e.hosts),e.arbiters&&(o.arbiters=e.arbiters),e.passives&&(o.passives=e.passives),e.setName&&(o.setName=e.setName),o},Server.prototype.lastIsMaster=function(){return this.ismaster},Server.prototype.unref=function(){this.s.pool.unref()},Server.prototype.isConnected=function(){return!!this.s.pool&&this.s.pool.isConnected()},Server.prototype.isDestroyed=function(){return!!this.s.pool&&this.s.pool.isDestroyed()},Server.prototype.command=function(e,o,r,t){\"function\"==typeof r&&(t=r,r=(r={})||{});var s=basicReadValidations(this,r);return s?t(s):(r=Object.assign({},r,{wireProtocolCommand:!1}),this.s.logger.isDebug()&&this.s.logger.debug(f(\"executing command [%s] against %s\",JSON.stringify({ns:e,cmd:o,options:debugOptions(debugFields,r)}),this.name)),disconnectHandler(this,\"command\",e,o,r,t)?void 0:collationNotSupported(this,o)?t(new MongoError(`server ${this.name} does not support collation`)):void wireProtocol.command(this,e,o,r,t))},Server.prototype.query=function(e,o,r,t,s){wireProtocol.query(this,e,o,r,t,s)},Server.prototype.getMore=function(e,o,r,t,s){wireProtocol.getMore(this,e,o,r,t,s)},Server.prototype.killCursors=function(e,o,r){wireProtocol.killCursors(this,e,o,r)},Server.prototype.insert=function(e,o,r,t){\"function\"==typeof r&&(t=r,r=(r={})||{});var s=basicWriteValidations(this,r);return s?t(s):disconnectHandler(this,\"insert\",e,o,r,t)?void 0:(o=Array.isArray(o)?o:[o],wireProtocol.insert(this,e,o,r,t))},Server.prototype.update=function(e,o,r,t){\"function\"==typeof r&&(t=r,r=(r={})||{});var s=basicWriteValidations(this,r);return s?t(s):disconnectHandler(this,\"update\",e,o,r,t)?void 0:collationNotSupported(this,r)?t(new MongoError(`server ${this.name} does not support collation`)):(o=Array.isArray(o)?o:[o],wireProtocol.update(this,e,o,r,t))},Server.prototype.remove=function(e,o,r,t){\"function\"==typeof r&&(t=r,r=(r={})||{});var s=basicWriteValidations(this,r);return s?t(s):disconnectHandler(this,\"remove\",e,o,r,t)?void 0:collationNotSupported(this,r)?t(new MongoError(`server ${this.name} does not support collation`)):(o=Array.isArray(o)?o:[o],wireProtocol.remove(this,e,o,r,t))},Server.prototype.cursor=function(e,o,r){const t=(r=r||{}).topology||this;return new(r.cursorFactory||this.s.Cursor)(t,e,o,r)},Server.prototype.equals=function(e){return\"string\"==typeof e?this.name.toLowerCase()===e.toLowerCase():!!e.name&&this.name.toLowerCase()===e.name.toLowerCase()},Server.prototype.connections=function(){return this.s.pool.allConnections()},Server.prototype.selectServer=function(e,o,r){\"function\"==typeof e&&void 0===r&&(r=e,e=void 0,o={}),\"function\"==typeof o&&(r=o,o=e,e=void 0),r(null,this)};var listeners=[\"close\",\"error\",\"timeout\",\"parseError\",\"connect\"];Server.prototype.destroy=function(e,o){if(this._destroyed)\"function\"==typeof o&&o(null,null);else{\"function\"==typeof e&&(o=e,e={}),e=e||{};var r=this;if(serverAccounting&&delete servers[this.id],this.monitoringProcessId&&clearTimeout(this.monitoringProcessId),!r.s.pool)return this._destroyed=!0,void(\"function\"==typeof o&&o(null,null));e.emitClose&&r.emit(\"close\",r),e.emitDestroy&&r.emit(\"destroy\",r),listeners.forEach(function(e){r.s.pool.removeAllListeners(e)}),r.listeners(\"serverClosed\").length>0&&r.emit(\"serverClosed\",{topologyId:topologyId(r),address:r.name}),r.listeners(\"topologyClosed\").length>0&&!r.s.inTopology&&r.emit(\"topologyClosed\",{topologyId:topologyId(r)}),r.s.logger.isDebug()&&r.s.logger.debug(f(\"destroy called on server %s\",r.name)),this.s.pool.destroy(e.force,o),this._destroyed=!0}},module.exports=Server;","node_modules/mongodb/lib/core/topologies/replset.js":"\"use strict\";const inherits=require(\"util\").inherits,f=require(\"util\").format,EventEmitter=require(\"events\").EventEmitter,ReadPreference=require(\"./read_preference\"),CoreCursor=require(\"../cursor\").CoreCursor,retrieveBSON=require(\"../connection/utils\").retrieveBSON,Logger=require(\"../connection/logger\"),MongoError=require(\"../error\").MongoError,Server=require(\"./server\"),ReplSetState=require(\"./replset_state\"),clone=require(\"./shared\").clone,Timeout=require(\"./shared\").Timeout,Interval=require(\"./shared\").Interval,createClientInfo=require(\"./shared\").createClientInfo,SessionMixins=require(\"./shared\").SessionMixins,isRetryableWritesSupported=require(\"./shared\").isRetryableWritesSupported,relayEvents=require(\"../utils\").relayEvents,isRetryableError=require(\"../error\").isRetryableError,BSON=retrieveBSON(),calculateDurationInMs=require(\"../utils\").calculateDurationInMs,getMMAPError=require(\"./shared\").getMMAPError;var DISCONNECTED=\"disconnected\",CONNECTING=\"connecting\",CONNECTED=\"connected\",UNREFERENCED=\"unreferenced\",DESTROYED=\"destroyed\";function stateTransition(e,t){var r={disconnected:[CONNECTING,DESTROYED,DISCONNECTED],connecting:[CONNECTING,DESTROYED,CONNECTED,DISCONNECTED],connected:[CONNECTED,DISCONNECTED,DESTROYED,UNREFERENCED],unreferenced:[UNREFERENCED,DESTROYED],destroyed:[DESTROYED]}[e.state];r&&-1!==r.indexOf(t)?e.state=t:e.s.logger.error(f(\"Pool with id [%s] failed attempted illegal state transition from [%s] to [%s] only following state allowed [%s]\",e.id,e.state,t,r))}var id=1,handlers=[\"connect\",\"close\",\"error\",\"timeout\",\"parseError\"],ReplSet=function(e,t){var r=this;if(t=t||{},!Array.isArray(e))throw new MongoError(\"seedlist must be an array\");if(0===e.length)throw new MongoError(\"seedlist must contain at least one entry\");e.forEach(function(e){if(\"string\"!=typeof e.host||\"number\"!=typeof e.port)throw new MongoError(\"seedlist entry must contain a host and port\")}),EventEmitter.call(this),this.id=id++;var n=t.localThresholdMS||15;t.acceptableLatency&&(n=t.acceptableLatency);var s=Logger(\"ReplSet\",t);this.s={options:Object.assign({},t),bson:t.bson||new BSON([BSON.Binary,BSON.Code,BSON.DBRef,BSON.Decimal128,BSON.Double,BSON.Int32,BSON.Long,BSON.Map,BSON.MaxKey,BSON.MinKey,BSON.ObjectId,BSON.BSONRegExp,BSON.Symbol,BSON.Timestamp]),Cursor:t.cursorFactory||CoreCursor,logger:s,seedlist:e,replicaSetState:new ReplSetState({id:this.id,setName:t.setName,acceptableLatency:n,heartbeatFrequencyMS:t.haInterval?t.haInterval:1e4,logger:s}),connectingServers:[],haInterval:t.haInterval?t.haInterval:1e4,minHeartbeatFrequencyMS:500,disconnectHandler:t.disconnectHandler,index:0,connectOptions:{},debug:\"boolean\"==typeof t.debug&&t.debug,clientInfo:createClientInfo(t)},this.s.replicaSetState.on(\"topologyDescriptionChanged\",function(e){r.emit(\"topologyDescriptionChanged\",e)}),this.s.logger.isWarn()&&0!==this.s.options.socketTimeout&&this.s.options.socketTimeout<this.s.haInterval&&this.s.logger.warn(f(\"warning socketTimeout %s is less than haInterval %s. This might cause unnecessary server reconnections due to socket timeouts\",this.s.options.socketTimeout,this.s.haInterval));[\"joined\",\"left\"].forEach(function(e){r.s.replicaSetState.on(e,function(t,n){r.emit(e,t,n)})}),this.initialConnectState={connect:!1,fullsetup:!1,all:!1},this.state=DISCONNECTED,this.haTimeoutId=null,this.ismaster=null,this.intervalIds=[],this.clusterTime=null};function rexecuteOperations(e){e.s.replicaSetState.hasPrimaryAndSecondary()&&e.s.disconnectHandler?e.s.disconnectHandler.execute():e.s.replicaSetState.hasPrimary()&&e.s.disconnectHandler?e.s.disconnectHandler.execute({executePrimary:!0}):e.s.replicaSetState.hasSecondary()&&e.s.disconnectHandler&&e.s.disconnectHandler.execute({executeSecondary:!0})}function connectNewServers(e,t,r){if(0===t.length)return r();var n=t.length,s=null;function i(){0===(n-=1)&&r(s)}var o=function(e,t){return function(r){if(e.state===DESTROYED||e.state===UNREFERENCED)return this.destroy({force:!0}),i();if(\"connect\"===t)if(e.s.replicaSetState.update(this)){this.lastIsMaster()&&this.lastIsMaster().ismaster&&(e.ismaster=this.lastIsMaster());for(let e=0;e<handlers.length;e++)this.removeAllListeners(handlers[e]);this.on(\"error\",handleEvent(e,\"error\")),this.on(\"close\",handleEvent(e,\"close\")),this.on(\"timeout\",handleEvent(e,\"timeout\")),this.on(\"parseError\",handleEvent(e,\"parseError\")),monitorServer(this.lastIsMaster().me,e,{}),rexecuteOperations(e)}else this.destroy({force:!0});else\"error\"===t&&(s=r);rexecuteOperations(e),i()}};function a(t,r){setTimeout(function(){if(e.state===DESTROYED||e.state===UNREFERENCED)return;const r=e.s.connectingServers.findIndex(e=>e.name===t);if(r>=0){return e.s.connectingServers[r].destroy({force:!0}),e.s.connectingServers.splice(r,1),i()}var n=new Server(Object.assign({},e.s.options,{host:t.split(\":\")[0],port:parseInt(t.split(\":\")[1],10),reconnect:!1,monitoring:!1,parent:e,clientInfo:clone(e.s.clientInfo)}));n.once(\"connect\",o(e,\"connect\")),n.once(\"close\",o(e,\"close\")),n.once(\"timeout\",o(e,\"timeout\")),n.once(\"error\",o(e,\"error\")),n.once(\"parseError\",o(e,\"parseError\")),n.on(\"serverOpening\",t=>e.emit(\"serverOpening\",t)),n.on(\"serverDescriptionChanged\",t=>e.emit(\"serverDescriptionChanged\",t)),n.on(\"serverClosed\",t=>e.emit(\"serverClosed\",t)),relayEvents(n,e,[\"commandStarted\",\"commandSucceeded\",\"commandFailed\"]),e.s.connectingServers.push(n),n.connect(e.s.connectOptions)},r)}for(var c=0;c<t.length;c++)a(t[c],c)}inherits(ReplSet,EventEmitter),Object.assign(ReplSet.prototype,SessionMixins),Object.defineProperty(ReplSet.prototype,\"type\",{enumerable:!0,get:function(){return\"replset\"}}),Object.defineProperty(ReplSet.prototype,\"parserType\",{enumerable:!0,get:function(){return BSON.native?\"c++\":\"js\"}}),Object.defineProperty(ReplSet.prototype,\"logicalSessionTimeoutMinutes\",{enumerable:!0,get:function(){return this.s.replicaSetState.logicalSessionTimeoutMinutes||null}});var pingServer=function(e,t,r){var n=(new Date).getTime();emitSDAMEvent(e,\"serverHeartbeatStarted\",{connectionId:t.name}),t.command(\"admin.$cmd\",{ismaster:!0},{monitoring:!0,socketTimeout:e.s.options.connectionTimeout||2e3},function(s,i){if(e.state===DESTROYED||e.state===UNREFERENCED)return t.destroy({force:!0}),r(s,i);var o=(new Date).getTime()-n,a=process.hrtime();t.lastUpdateTime=(1e9*a[0]+a[1])/1e6,s?(emitSDAMEvent(e,\"serverHeartbeatFailed\",{durationMS:o,failure:s,connectionId:t.name}),e.s.replicaSetState.remove(t)):(t.ismaster=i.result,t.ismaster.lastWrite&&t.ismaster.lastWrite.lastWriteDate&&(t.lastWriteDate=t.ismaster.lastWrite.lastWriteDate.getTime()),-1===t.lastIsMasterMS?t.lastIsMasterMS=o:t.lastIsMasterMS&&(t.lastIsMasterMS=.2*o+.8*t.lastIsMasterMS),e.s.replicaSetState.update(t)&&t.lastIsMaster()&&t.lastIsMaster().ismaster&&(e.ismaster=t.lastIsMaster()),emitSDAMEvent(e,\"serverHeartbeatSucceeded\",{durationMS:o,reply:i.result,connectionId:t.name})),e.s.replicaSetState.updateServerMaxStaleness(t,e.s.haInterval),r(s,i)})},monitorServer=function(e,t,r){if(!r.haInterval)for(var n=0;n<t.intervalIds.length;n++)if(t.intervalIds[n].__host===e)return;var s=r.haInterval?Timeout:Interval,i=r.haInterval?r.haInterval:t.s.haInterval,o=new s(function(){if(t.state!==DESTROYED&&t.state!==UNREFERENCED){var r=t.s.replicaSetState.get(e);return r?pingServer(t,r,function(e){e||(t.state!==DESTROYED&&t.state!==UNREFERENCED?(t.intervalIds=t.intervalIds.filter(function(e){return e.isRunning()}),s===Timeout?t.state===CONNECTING&&(t.s.replicaSetState.hasSecondary()&&t.s.options.secondaryOnlyConnectionAllowed||t.s.replicaSetState.hasPrimary())&&(t.state=CONNECTED,process.nextTick(function(){t.emit(\"connect\",t)}),topologyMonitor(t,{})):t.state===DISCONNECTED&&(t.s.replicaSetState.hasSecondary()&&t.s.options.secondaryOnlyConnectionAllowed||t.s.replicaSetState.hasPrimary())&&(t.state=CONNECTED,rexecuteOperations(t),process.nextTick(function(){t.emit(\"reconnect\",t)})),t.initialConnectState.connect&&!t.initialConnectState.fullsetup&&t.s.replicaSetState.hasPrimaryAndSecondary()&&(t.initialConnectState.fullsetup=!0,t.initialConnectState.all=!0,process.nextTick(function(){t.emit(\"fullsetup\",t),t.emit(\"all\",t)}))):o.stop())}):void 0}o.stop()},i);o.start(),o.__host=e,t.intervalIds.push(o)};function topologyMonitor(e,t){if(e.state!==DESTROYED&&e.state!==UNREFERENCED){t=t||{};var r=Object.keys(e.s.replicaSetState.set),n=t.haInterval?Timeout:Interval,s=t.haInterval?t.haInterval:e.s.haInterval;if(n===Timeout)return connectNewServers(e,e.s.replicaSetState.unknownServers,function(n){if(e.state!==DESTROYED&&e.state!==UNREFERENCED){if(!e.s.replicaSetState.hasPrimary()&&!e.s.options.secondaryOnlyConnectionAllowed)return n?e.emit(\"error\",n):(e.emit(\"error\",new MongoError(\"no primary found in replicaset or invalid replica set name\")),e.destroy({force:!0}));if(!e.s.replicaSetState.hasSecondary()&&e.s.options.secondaryOnlyConnectionAllowed)return n?e.emit(\"error\",n):(e.emit(\"error\",new MongoError(\"no secondary found in replicaset or invalid replica set name\")),e.destroy({force:!0}));for(var s=0;s<r.length;s++)monitorServer(r[s],e,t)}});for(var i=0;i<r.length;i++)monitorServer(r[i],e,t);var o=e.s.replicaSetState.hasPrimary()?s:e.s.minHeartbeatFrequencyMS;e.intervalIds.push(new Timeout(function e(t){return function(){t.state!==DESTROYED&&t.state!==UNREFERENCED&&connectNewServers(t,t.s.replicaSetState.unknownServers,function(){var r=t.s.replicaSetState.hasPrimary()?s:t.s.minHeartbeatFrequencyMS;t.intervalIds.push(new Timeout(e(t),r).start())})}}(e),o).start())}}function addServerToList(e,t){for(var r=0;r<e.length;r++)if(e[r].name.toLowerCase()===t.name.toLowerCase())return!0;e.push(t)}function handleEvent(e,t){return function(){e.state!==DESTROYED&&e.state!==UNREFERENCED&&(e.s.logger.isDebug()&&e.s.logger.debug(f(\"handleEvent %s from server %s in replset with id %s\",t,this.name,e.id)),e.s.replicaSetState.remove(this),e.state!==DESTROYED&&e.state!==UNREFERENCED&&((e.s.replicaSetState.hasPrimary()||e.s.replicaSetState.hasSecondary()||!e.s.options.secondaryOnlyConnectionAllowed)&&e.s.replicaSetState.hasPrimary()||stateTransition(e,DISCONNECTED),addServerToList(e.s.connectingServers,this)))}}function shouldTriggerConnect(e){const t=e.state===CONNECTING,r=e.s.replicaSetState.hasPrimary(),n=e.s.replicaSetState.hasSecondary(),s=e.s.options.secondaryOnlyConnectionAllowed,i=e.s.connectOptions.readPreference&&e.s.connectOptions.readPreference.equals(ReadPreference.secondary);return t&&(i&&n||!i&&r)||n&&s}function handleInitialConnectEvent(e,t){return function(){if(e.s.logger.isDebug()&&e.s.logger.debug(f(\"handleInitialConnectEvent %s from server %s in replset with id %s\",t,this.name,e.id)),e.state===DESTROYED||e.state===UNREFERENCED)return this.destroy({force:!0});if(\"connect\"===t){var r=e.s.replicaSetState.update(this);if(!0===r){this.lastIsMaster()&&this.lastIsMaster().ismaster&&(e.ismaster=this.lastIsMaster()),e.s.logger.isDebug()&&e.s.logger.debug(f(\"handleInitialConnectEvent %s from server %s in replset with id %s has state [%s]\",t,this.name,e.id,JSON.stringify(e.s.replicaSetState.set)));for(let e=0;e<handlers.length;e++)this.removeAllListeners(handlers[e]);this.on(\"error\",handleEvent(e,\"error\")),this.on(\"close\",handleEvent(e,\"close\")),this.on(\"timeout\",handleEvent(e,\"timeout\")),this.on(\"parseError\",handleEvent(e,\"parseError\")),shouldTriggerConnect(e)&&(e.state=CONNECTED,e.initialConnectState.connect=!0,process.nextTick(function(){e.emit(\"connect\",e)}),topologyMonitor(e,{}))}else{if(r instanceof MongoError)return this.destroy({force:!0}),e.destroy({force:!0}),e.emit(\"error\",r);this.destroy({force:!0})}}else e.emit(\"failed\",this),addServerToList(e.s.connectingServers,this),e.s.replicaSetState.remove(this);e.initialConnectState.connect&&!e.initialConnectState.fullsetup&&e.s.replicaSetState.hasPrimaryAndSecondary()&&(e.initialConnectState.fullsetup=!0,e.initialConnectState.all=!0,process.nextTick(function(){e.emit(\"fullsetup\",e),e.emit(\"all\",e)}));for(var n=0;n<e.s.connectingServers.length;n++)e.s.connectingServers[n].equals(this)&&e.s.connectingServers.splice(n,1);0===e.s.connectingServers.length&&e.state===CONNECTING&&topologyMonitor(e,{haInterval:1})}}function connectServers(e,t){e.s.connectingServers=e.s.connectingServers.concat(t);var r=0;function n(t,r){setTimeout(function(){e.s.replicaSetState.update(t)&&t.lastIsMaster()&&t.lastIsMaster().ismaster&&(e.ismaster=t.lastIsMaster()),t.once(\"close\",handleInitialConnectEvent(e,\"close\")),t.once(\"timeout\",handleInitialConnectEvent(e,\"timeout\")),t.once(\"parseError\",handleInitialConnectEvent(e,\"parseError\")),t.once(\"error\",handleInitialConnectEvent(e,\"error\")),t.once(\"connect\",handleInitialConnectEvent(e,\"connect\")),t.on(\"serverOpening\",t=>e.emit(\"serverOpening\",t)),t.on(\"serverDescriptionChanged\",t=>e.emit(\"serverDescriptionChanged\",t)),t.on(\"serverClosed\",t=>e.emit(\"serverClosed\",t)),relayEvents(t,e,[\"commandStarted\",\"commandSucceeded\",\"commandFailed\"]),t.connect(e.s.connectOptions)},r)}for(;t.length>0;)n(t.shift(),r++)}function emitSDAMEvent(e,t,r){e.listeners(t).length>0&&e.emit(t,r)}ReplSet.prototype.connect=function(e){var t=this;this.s.connectOptions=e||{},stateTransition(this,CONNECTING);var r=this.s.seedlist.map(function(r){return new Server(Object.assign({},t.s.options,r,e,{reconnect:!1,monitoring:!1,parent:t,clientInfo:clone(t.s.clientInfo)}))});if(this.s.options.socketTimeout>0&&this.s.options.socketTimeout<=this.s.options.haInterval)return t.emit(\"error\",new MongoError(f(\"haInterval [%s] MS must be set to less than socketTimeout [%s] MS\",this.s.options.haInterval,this.s.options.socketTimeout)));emitSDAMEvent(this,\"topologyOpening\",{topologyId:this.id}),connectServers(t,r)},ReplSet.prototype.auth=function(e,t){\"function\"==typeof t&&t(null,null)},ReplSet.prototype.destroy=function(e,t){\"function\"==typeof e&&(t=e,e={}),e=e||{};let r=this.s.connectingServers.length+1;const n=()=>{--r>0||(emitSDAMEvent(this,\"topologyClosed\",{topologyId:this.id}),stateTransition(this,DESTROYED),\"function\"==typeof t&&t(null,null))};this.haTimeoutId&&clearTimeout(this.haTimeoutId);for(var s=0;s<this.intervalIds.length;s++)this.intervalIds[s].stop();this.intervalIds=[],0!==r?(this.s.replicaSetState.destroy(e,n),this.s.connectingServers.forEach(function(t){t.destroy(e,n)})):n()},ReplSet.prototype.unref=function(){stateTransition(this,UNREFERENCED),this.s.replicaSetState.allServers().forEach(function(e){e.unref()}),clearTimeout(this.haTimeoutId)},ReplSet.prototype.lastIsMaster=function(){return this.s.options.secondaryOnlyConnectionAllowed&&!this.s.replicaSetState.hasPrimary()&&this.s.replicaSetState.hasSecondary()?this.s.replicaSetState.secondaries[0].lastIsMaster():this.s.replicaSetState.primary?this.s.replicaSetState.primary.lastIsMaster():this.ismaster},ReplSet.prototype.connections=function(){for(var e=this.s.replicaSetState.allServers(),t=[],r=0;r<e.length;r++)t=t.concat(e[r].connections());return t},ReplSet.prototype.isConnected=function(e){return(e=e||{}).readPreference&&e.readPreference.equals(ReadPreference.secondary)?this.s.replicaSetState.hasSecondary():e.readPreference&&e.readPreference.equals(ReadPreference.primary)?this.s.replicaSetState.hasPrimary():e.readPreference&&e.readPreference.equals(ReadPreference.primaryPreferred)?this.s.replicaSetState.hasSecondary()||this.s.replicaSetState.hasPrimary():e.readPreference&&e.readPreference.equals(ReadPreference.secondaryPreferred)?this.s.replicaSetState.hasSecondary()||this.s.replicaSetState.hasPrimary():!(!this.s.options.secondaryOnlyConnectionAllowed||!this.s.replicaSetState.hasSecondary())||this.s.replicaSetState.hasPrimary()},ReplSet.prototype.isDestroyed=function(){return this.state===DESTROYED};const SERVER_SELECTION_TIMEOUT_MS=1e4,SERVER_SELECTION_INTERVAL_MS=1e3;function executeWriteOperation(e,t,r){\"function\"==typeof t&&(r=t,t={}),t=t||{};const n=e.self,s=e.op,i=e.ns,o=e.ops;if(n.state===DESTROYED)return r(new MongoError(f(\"topology was destroyed\")));const a=!e.retrying&&!!t.retryWrites&&t.session&&isRetryableWritesSupported(n)&&!t.session.inTransaction();if(!n.s.replicaSetState.hasPrimary()){if(n.s.disconnectHandler)return n.s.disconnectHandler.add(s,i,o,t,r);if(!a)return r(new MongoError(\"no primary server found\"))}const c=(s,i)=>{if(!s)return r(null,i);if(!isRetryableError(s))return s=getMMAPError(s),r(s);if(a){return executeWriteOperation(Object.assign({},e,{retrying:!0}),t,r)}return n.s.replicaSetState.primary&&(n.s.replicaSetState.primary.destroy(),n.s.replicaSetState.remove(n.s.replicaSetState.primary,{force:!0})),r(s)};r.operationId&&(c.operationId=r.operationId),a&&(t.session.incrementTransactionNumber(),t.willRetryWrite=a),n.s.replicaSetState.primary[s](i,o,t,c)}ReplSet.prototype.selectServer=function(e,t,r){let n,s;\"function\"==typeof e&&void 0===r&&(r=e,e=void 0,t={}),\"function\"==typeof t&&(r=t,t=e),t=t||{},n=e instanceof ReadPreference?e:t.readPreference||ReadPreference.primary;const i=process.hrtime(),o=()=>{if(calculateDurationInMs(i)>=1e4)return void(null!=s?r(s,null):r(new MongoError(\"Server selection timed out\")));const e=this.s.replicaSetState.pickServer(n);if(null!=e){if(!(e instanceof Server))return s=e,void setTimeout(o,1e3);this.s.debug&&this.emit(\"pickedServer\",t.readPreference,e),r(null,e)}else setTimeout(o,1e3)};o()},ReplSet.prototype.getServers=function(){return this.s.replicaSetState.allServers()},ReplSet.prototype.insert=function(e,t,r,n){executeWriteOperation({self:this,op:\"insert\",ns:e,ops:t},r,n)},ReplSet.prototype.update=function(e,t,r,n){executeWriteOperation({self:this,op:\"update\",ns:e,ops:t},r,n)},ReplSet.prototype.remove=function(e,t,r,n){executeWriteOperation({self:this,op:\"remove\",ns:e,ops:t},r,n)};const RETRYABLE_WRITE_OPERATIONS=[\"findAndModify\",\"insert\",\"update\",\"delete\"];function isWriteCommand(e){return RETRYABLE_WRITE_OPERATIONS.some(t=>e[t])}ReplSet.prototype.command=function(e,t,r,n){if(\"function\"==typeof r&&(n=r,r=(r={})||{}),this.state===DESTROYED)return n(new MongoError(f(\"topology was destroyed\")));var s=r.readPreference?r.readPreference:ReadPreference.primary;if(\"primary\"===s.preference&&!this.s.replicaSetState.hasPrimary()&&null!=this.s.disconnectHandler)return this.s.disconnectHandler.add(\"command\",e,t,r,n);if(\"secondary\"===s.preference&&!this.s.replicaSetState.hasSecondary()&&null!=this.s.disconnectHandler)return this.s.disconnectHandler.add(\"command\",e,t,r,n);if(\"primary\"!==s.preference&&!this.s.replicaSetState.hasSecondary()&&!this.s.replicaSetState.hasPrimary()&&null!=this.s.disconnectHandler)return this.s.disconnectHandler.add(\"command\",e,t,r,n);var i=this.s.replicaSetState.pickServer(s);if(!(i instanceof Server))return n(i);if(this.s.debug&&this.emit(\"pickedServer\",ReadPreference.primary,i),null==i)return n(new MongoError(f(\"no server found that matches the provided readPreference %s\",s)));const o=!r.retrying&&!!r.retryWrites&&r.session&&isRetryableWritesSupported(this)&&!r.session.inTransaction()&&isWriteCommand(t);o&&(r.session.incrementTransactionNumber(),r.willRetryWrite=o),i.command(e,t,r,(s,i)=>{if(!s)return n(null,i);if(!isRetryableError(s))return n(s);if(o){const s=Object.assign({},r,{retrying:!0});return this.command(e,t,s,n)}return this.s.replicaSetState.primary&&(this.s.replicaSetState.primary.destroy(),this.s.replicaSetState.remove(this.s.replicaSetState.primary,{force:!0})),n(s)})},ReplSet.prototype.cursor=function(e,t,r){const n=(r=r||{}).topology||this;return new(r.cursorFactory||this.s.Cursor)(n,e,t,r)},module.exports=ReplSet;","node_modules/mongodb/lib/core/topologies/mongos.js":"\"use strict\";const inherits=require(\"util\").inherits,f=require(\"util\").format,EventEmitter=require(\"events\").EventEmitter,CoreCursor=require(\"../cursor\").CoreCursor,Logger=require(\"../connection/logger\"),retrieveBSON=require(\"../connection/utils\").retrieveBSON,MongoError=require(\"../error\").MongoError,Server=require(\"./server\"),clone=require(\"./shared\").clone,diff=require(\"./shared\").diff,cloneOptions=require(\"./shared\").cloneOptions,createClientInfo=require(\"./shared\").createClientInfo,SessionMixins=require(\"./shared\").SessionMixins,isRetryableWritesSupported=require(\"./shared\").isRetryableWritesSupported,relayEvents=require(\"../utils\").relayEvents,isRetryableError=require(\"../error\").isRetryableError,BSON=retrieveBSON(),getMMAPError=require(\"./shared\").getMMAPError;var DISCONNECTED=\"disconnected\",CONNECTING=\"connecting\",CONNECTED=\"connected\",UNREFERENCED=\"unreferenced\",DESTROYING=\"destroying\",DESTROYED=\"destroyed\";function stateTransition(e,t){var o={disconnected:[CONNECTING,DESTROYING,DESTROYED,DISCONNECTED],connecting:[CONNECTING,DESTROYING,DESTROYED,CONNECTED,DISCONNECTED],connected:[CONNECTED,DISCONNECTED,DESTROYING,DESTROYED,UNREFERENCED],unreferenced:[UNREFERENCED,DESTROYING,DESTROYED],destroyed:[DESTROYED]}[e.state];o&&-1!==o.indexOf(t)?e.state=t:e.s.logger.error(f(\"Mongos with id [%s] failed attempted illegal state transition from [%s] to [%s] only following state allowed [%s]\",e.id,e.state,t,o))}var id=1,handlers=[\"connect\",\"close\",\"error\",\"timeout\",\"parseError\"],Mongos=function(e,t){t=t||{},this.id=id++,this.s={options:Object.assign({},t),bson:t.bson||new BSON([BSON.Binary,BSON.Code,BSON.DBRef,BSON.Decimal128,BSON.Double,BSON.Int32,BSON.Long,BSON.Map,BSON.MaxKey,BSON.MinKey,BSON.ObjectId,BSON.BSONRegExp,BSON.Symbol,BSON.Timestamp]),Cursor:t.cursorFactory||CoreCursor,logger:Logger(\"Mongos\",t),seedlist:e,haInterval:t.haInterval?t.haInterval:1e4,disconnectHandler:t.disconnectHandler,index:0,connectOptions:{},debug:\"boolean\"==typeof t.debug&&t.debug,localThresholdMS:t.localThresholdMS||15,clientInfo:createClientInfo(t)},this.s.options.clientInfo=createClientInfo(t),this.s.logger.isWarn()&&0!==this.s.options.socketTimeout&&this.s.options.socketTimeout<this.s.haInterval&&this.s.logger.warn(f(\"warning socketTimeout %s is less than haInterval %s. This might cause unnecessary server reconnections due to socket timeouts\",this.s.options.socketTimeout,this.s.haInterval)),this.state=DISCONNECTED,this.connectingProxies=[],this.connectedProxies=[],this.disconnectedProxies=[],this.index=0,this.haTimeoutId=null,this.ismaster=null,this.topologyDescription={topologyType:\"Unknown\",servers:[]},this.clusterTime=null,EventEmitter.call(this)};function emitSDAMEvent(e,t,o){e.listeners(t).length>0&&e.emit(t,o)}inherits(Mongos,EventEmitter),Object.assign(Mongos.prototype,SessionMixins),Object.defineProperty(Mongos.prototype,\"type\",{enumerable:!0,get:function(){return\"mongos\"}}),Object.defineProperty(Mongos.prototype,\"parserType\",{enumerable:!0,get:function(){return BSON.native?\"c++\":\"js\"}}),Object.defineProperty(Mongos.prototype,\"logicalSessionTimeoutMinutes\",{enumerable:!0,get:function(){return this.ismaster&&this.ismaster.logicalSessionTimeoutMinutes||null}});const SERVER_EVENTS=[\"serverDescriptionChanged\",\"error\",\"close\",\"timeout\",\"parseError\"];function destroyServer(e,t,o){t=t||{},SERVER_EVENTS.forEach(t=>e.removeAllListeners(t)),e.destroy(t,o)}function handleEvent(e){return function(){e.state!==DESTROYED&&e.state!==DESTROYING&&(moveServerFrom(e.connectedProxies,e.disconnectedProxies,this),emitTopologyDescriptionChanged(e),e.emit(\"left\",\"mongos\",this),e.emit(\"serverClosed\",{topologyId:e.id,address:this.name}))}}function handleInitialConnectEvent(e,t){return function(){if(e.state===DESTROYED)return emitTopologyDescriptionChanged(e),moveServerFrom(e.connectingProxies,e.disconnectedProxies,this),this.destroy();if(\"connect\"===t)if(e.ismaster=this.lastIsMaster(),\"isdbgrid\"===e.ismaster.msg){for(let t=0;t<e.connectedProxies.length;t++)if(e.connectedProxies[t].name===this.name)return moveServerFrom(e.connectingProxies,e.disconnectedProxies,this),emitTopologyDescriptionChanged(e),this.destroy(),e.emit(\"failed\",this);for(let e=0;e<handlers.length;e++)this.removeAllListeners(handlers[e]);this.on(\"error\",handleEvent(e,\"error\")),this.on(\"close\",handleEvent(e,\"close\")),this.on(\"timeout\",handleEvent(e,\"timeout\")),this.on(\"parseError\",handleEvent(e,\"parseError\")),moveServerFrom(e.connectingProxies,e.connectedProxies,this),e.emit(\"joined\",\"mongos\",this)}else{if(e.s.logger.isWarn()){var o=\"expected mongos proxy, but found replicaset member mongod for server %s\";e.ismaster.hosts||(o=\"expected mongos proxy, but found standalone mongod for server %s\"),e.s.logger.warn(f(o,this.name))}this.destroy(!0),removeProxyFrom(e.connectingProxies,this),e.emit(\"left\",\"server\",this),e.emit(\"failed\",this)}else moveServerFrom(e.connectingProxies,e.disconnectedProxies,this),e.emit(\"left\",\"mongos\",this),e.emit(\"failed\",this);if(emitTopologyDescriptionChanged(e),0===e.connectingProxies.length){if(e.connectedProxies.length>0&&e.state===CONNECTING)stateTransition(e,CONNECTED),e.emit(\"connect\",e),e.emit(\"fullsetup\",e),e.emit(\"all\",e);else if(0===e.disconnectedProxies.length)return e.s.logger.isWarn()&&e.s.logger.warn(f(\"no mongos proxies found in seed list, did you mean to connect to a replicaset\")),e.emit(\"error\",new MongoError(\"no mongos proxies found in seed list\"));topologyMonitor(e,{firstConnect:!0})}}}function connectProxies(e,t){e.connectingProxies=e.connectingProxies.concat(t);var o=0;t.forEach(t=>(function(t,o){setTimeout(function(){e.emit(\"serverOpening\",{topologyId:e.id,address:t.name}),emitTopologyDescriptionChanged(e),t.once(\"close\",handleInitialConnectEvent(e,\"close\")),t.once(\"timeout\",handleInitialConnectEvent(e,\"timeout\")),t.once(\"parseError\",handleInitialConnectEvent(e,\"parseError\")),t.once(\"error\",handleInitialConnectEvent(e,\"error\")),t.once(\"connect\",handleInitialConnectEvent(e,\"connect\")),relayEvents(t,e,[\"commandStarted\",\"commandSucceeded\",\"commandFailed\"]),t.connect(e.s.connectOptions)},o)})(t,o++))}function pickProxy(e,t){const o=t&&t.transaction;if(o&&o.server){if(o.server.isConnected())return o.server;o.unpinServer()}for(var n=e.connectedProxies.slice(0),r=Number.MAX_VALUE,s=0;s<n.length;s++)n[s].lastIsMasterMS<r&&(r=n[s].lastIsMasterMS);let i;return 0===(n=n.filter(function(t){if(t.lastIsMasterMS<=r+e.s.localThresholdMS&&t.isConnected())return!0})).length?i=e.connectedProxies[0]:(i=n[e.index%n.length],e.index=(e.index+1)%n.length),o&&o.isActive&&i&&i.isConnected()&&o.pinServer(i),i}function moveServerFrom(e,t,o){for(var n=0;n<e.length;n++)e[n].name===o.name&&e.splice(n,1);for(n=0;n<t.length;n++)t[n].name===o.name&&t.splice(n,1);t.push(o)}function removeProxyFrom(e,t){for(var o=0;o<e.length;o++)e[o].name===t.name&&e.splice(o,1)}function reconnectProxies(e,t,o){var n=t.length,r=function(e,t){return function(){if(n-=1,e.state===DESTROYED||e.state===DESTROYING||e.state===UNREFERENCED)return moveServerFrom(e.connectingProxies,e.disconnectedProxies,this),this.destroy();if(\"connect\"===t){if(e.state===DESTROYED||e.state===DESTROYING||e.state===UNREFERENCED)return moveServerFrom(e.connectingProxies,e.disconnectedProxies,this),this.destroy();for(var r=0;r<handlers.length;r++)this.removeAllListeners(handlers[r]);this.on(\"error\",handleEvent(e,\"error\")),this.on(\"close\",handleEvent(e,\"close\")),this.on(\"timeout\",handleEvent(e,\"timeout\")),this.on(\"parseError\",handleEvent(e,\"parseError\")),moveServerFrom(e.connectingProxies,e.connectedProxies,this),emitTopologyDescriptionChanged(e),e.emit(\"joined\",\"mongos\",this)}else moveServerFrom(e.connectingProxies,e.disconnectedProxies,this),this.destroy();0===n&&o()}};if(0===n)return o();function s(t,o){setTimeout(function(){if(e.state!==DESTROYED&&e.state!==DESTROYING&&e.state!==UNREFERENCED){var o=new Server(Object.assign({},e.s.options,{host:t.name.split(\":\")[0],port:parseInt(t.name.split(\":\")[1],10),reconnect:!1,monitoring:!1,parent:e,clientInfo:clone(e.s.clientInfo)}));destroyServer(t,{force:!0}),removeProxyFrom(e.disconnectedProxies,t),relayEvents(o,e,[\"serverDescriptionChanged\"]),e.emit(\"serverOpening\",{topologyId:-1!==o.s.topologyId?o.s.topologyId:e.id,address:o.name}),o.once(\"connect\",r(e,\"connect\")),o.once(\"close\",r(e,\"close\")),o.once(\"timeout\",r(e,\"timeout\")),o.once(\"error\",r(e,\"error\")),o.once(\"parseError\",r(e,\"parseError\")),relayEvents(o,e,[\"commandStarted\",\"commandSucceeded\",\"commandFailed\"]),e.connectingProxies.push(o),o.connect(e.s.connectOptions)}},o)}for(var i=0;i<t.length;i++)s(t[i],i)}function topologyMonitor(e,t){t=t||{},e.state!==DESTROYED&&e.state!==DESTROYING&&e.state!==UNREFERENCED&&(e.haTimeoutId=setTimeout(function(){if(e.state!==DESTROYED&&e.state!==DESTROYING&&e.state!==UNREFERENCED){e.isConnected()&&e.s.disconnectHandler&&e.s.disconnectHandler.execute();var o=e.connectedProxies.slice(0),n=o.length;if(0===o.length)return e.listeners(\"close\").length>0&&e.state===CONNECTING?e.emit(\"error\",new MongoError(\"no mongos proxy available\")):e.emit(\"close\",e),reconnectProxies(e,e.disconnectedProxies,function(){e.state!==DESTROYED&&e.state!==DESTROYING&&e.state!==UNREFERENCED&&(e.state===CONNECTING&&t.firstConnect?(e.emit(\"connect\",e),e.emit(\"fullsetup\",e),e.emit(\"all\",e)):e.isConnected()?e.emit(\"reconnect\",e):!e.isConnected()&&e.listeners(\"close\").length>0&&e.emit(\"close\",e),topologyMonitor(e))});for(var r=0;r<o.length;r++)s(0,o[r],function(){if(0===(n-=1)){if(e.state===DESTROYED||e.state===DESTROYING||e.state===UNREFERENCED)return;reconnectProxies(e,e.disconnectedProxies,function(){e.state!==DESTROYED&&e.state!==DESTROYING&&e.state!==UNREFERENCED&&topologyMonitor(e)})}})}function s(t,o,n){var r=(new Date).getTime();emitSDAMEvent(e,\"serverHeartbeatStarted\",{connectionId:o.name}),o.command(\"admin.$cmd\",{ismaster:!0},{monitoring:!0,socketTimeout:e.s.options.connectionTimeout||2e3},function(t,s){if(e.state===DESTROYED||e.state===DESTROYING||e.state===UNREFERENCED)return moveServerFrom(e.connectedProxies,e.disconnectedProxies,o),o.destroy(),n(t,s);var i=(new Date).getTime()-r;t?(emitSDAMEvent(e,\"serverHeartbeatFailed\",{durationMS:i,failure:t,connectionId:o.name}),moveServerFrom(e.connectedProxies,e.disconnectedProxies,o)):(o.ismaster=s.result,o.lastIsMasterMS=i,emitSDAMEvent(e,\"serverHeartbeatSucceeded\",{durationMS:i,reply:s.result,connectionId:o.name})),n(t,s)})}},e.s.haInterval))}function executeWriteOperation(e,t,o){\"function\"==typeof t&&(o=t,t={}),t=t||{};const n=e.self,r=e.op,s=e.ns,i=e.ops;let c=pickProxy(n,t.session);if(!c)return o(new MongoError(\"no mongos proxy available\"));const a=!e.retrying&&!!t.retryWrites&&t.session&&isRetryableWritesSupported(n)&&!t.session.inTransaction(),l=(r,s)=>{if(!r)return o(null,s);if(!isRetryableError(r)||!a)return r=getMMAPError(r),o(r);if(!(c=pickProxy(n,t.session)))return o(r);return executeWriteOperation(Object.assign({},e,{retrying:!0}),t,o)};o.operationId&&(l.operationId=o.operationId),a&&(t.session.incrementTransactionNumber(),t.willRetryWrite=a),c[r](s,i,t,l)}Mongos.prototype.connect=function(e){var t=this;this.s.connectOptions=e||{},stateTransition(this,CONNECTING);var o=this.s.seedlist.map(function(o){const n=new Server(Object.assign({},t.s.options,o,e,{reconnect:!1,monitoring:!1,parent:t,clientInfo:clone(t.s.clientInfo)}));return relayEvents(n,t,[\"serverDescriptionChanged\"]),n});emitSDAMEvent(this,\"topologyOpening\",{topologyId:this.id}),connectProxies(t,o)},Mongos.prototype.auth=function(e,t){\"function\"==typeof t&&t(null,null)},Mongos.prototype.lastIsMaster=function(){return this.ismaster},Mongos.prototype.unref=function(){stateTransition(this,UNREFERENCED),this.connectedProxies.concat(this.connectingProxies).forEach(function(e){e.unref()}),clearTimeout(this.haTimeoutId)},Mongos.prototype.destroy=function(e,t){\"function\"==typeof e&&(t=e,e={}),e=e||{},stateTransition(this,DESTROYING),this.haTimeoutId&&clearTimeout(this.haTimeoutId);const o=this.connectedProxies.concat(this.connectingProxies);let n=o.length;const r=()=>{--n>0||(emitTopologyDescriptionChanged(this),emitSDAMEvent(this,\"topologyClosed\",{topologyId:this.id}),stateTransition(this,DESTROYED),\"function\"==typeof t&&t(null,null))};0!==n?o.forEach(t=>{this.emit(\"serverClosed\",{topologyId:this.id,address:t.name}),destroyServer(t,e,r),moveServerFrom(this.connectedProxies,this.disconnectedProxies,t)}):r()},Mongos.prototype.isConnected=function(){return this.connectedProxies.length>0},Mongos.prototype.isDestroyed=function(){return this.state===DESTROYED},Mongos.prototype.insert=function(e,t,o,n){return\"function\"==typeof o&&(n=o,o=(o={})||{}),this.state===DESTROYED?n(new MongoError(f(\"topology was destroyed\"))):this.isConnected()||null==this.s.disconnectHandler?this.isConnected()?void executeWriteOperation({self:this,op:\"insert\",ns:e,ops:t},o,n):n(new MongoError(\"no mongos proxy available\")):this.s.disconnectHandler.add(\"insert\",e,t,o,n)},Mongos.prototype.update=function(e,t,o,n){return\"function\"==typeof o&&(n=o,o=(o={})||{}),this.state===DESTROYED?n(new MongoError(f(\"topology was destroyed\"))):this.isConnected()||null==this.s.disconnectHandler?this.isConnected()?void executeWriteOperation({self:this,op:\"update\",ns:e,ops:t},o,n):n(new MongoError(\"no mongos proxy available\")):this.s.disconnectHandler.add(\"update\",e,t,o,n)},Mongos.prototype.remove=function(e,t,o,n){return\"function\"==typeof o&&(n=o,o=(o={})||{}),this.state===DESTROYED?n(new MongoError(f(\"topology was destroyed\"))):this.isConnected()||null==this.s.disconnectHandler?this.isConnected()?void executeWriteOperation({self:this,op:\"remove\",ns:e,ops:t},o,n):n(new MongoError(\"no mongos proxy available\")):this.s.disconnectHandler.add(\"remove\",e,t,o,n)};const RETRYABLE_WRITE_OPERATIONS=[\"findAndModify\",\"insert\",\"update\",\"delete\"];function isWriteCommand(e){return RETRYABLE_WRITE_OPERATIONS.some(t=>e[t])}function emitTopologyDescriptionChanged(e){if(e.listeners(\"topologyDescriptionChanged\").length>0){var t=\"Unknown\";e.connectedProxies.length>0&&(t=\"Sharded\");var o={topologyType:t,servers:[]},n=e.disconnectedProxies.concat(e.connectingProxies);o.servers=o.servers.concat(n.map(function(e){var t=e.getDescription();return t.type=\"Unknown\",t})),o.servers=o.servers.concat(e.connectedProxies.map(function(e){var t=e.getDescription();return t.type=\"Mongos\",t}));var r=diff(e.topologyDescription,o),s={topologyId:e.id,previousDescription:e.topologyDescription,newDescription:o,diff:r};r.servers.length>0&&e.emit(\"topologyDescriptionChanged\",s),e.topologyDescription=o}}Mongos.prototype.command=function(e,t,o,n){if(\"function\"==typeof o&&(n=o,o=(o={})||{}),this.state===DESTROYED)return n(new MongoError(f(\"topology was destroyed\")));var r=pickProxy(this,o.session);if((null==r||!r.isConnected())&&null!=this.s.disconnectHandler)return this.s.disconnectHandler.add(\"command\",e,t,o,n);if(null==r)return n(new MongoError(\"no mongos proxy available\"));var s=cloneOptions(o);s.topology=this;const i=!o.retrying&&o.retryWrites&&o.session&&isRetryableWritesSupported(this)&&!o.session.inTransaction()&&isWriteCommand(t);i&&(o.session.incrementTransactionNumber(),o.willRetryWrite=i),r.command(e,t,s,(o,r)=>{if(!o)return n(null,r);if(!isRetryableError(o))return n(o);if(i){const o=Object.assign({},s,{retrying:!0});return this.command(e,t,o,n)}return n(o)})},Mongos.prototype.cursor=function(e,t,o){const n=(o=o||{}).topology||this;return new(o.cursorFactory||this.s.Cursor)(n,e,t,o)},Mongos.prototype.selectServer=function(e,t,o){\"function\"==typeof e&&void 0===o&&(o=e,e=void 0,t={}),\"function\"==typeof t&&(o=t,t=e,e=void 0);const n=pickProxy(this,(t=t||{}).session);null!=n?(this.s.debug&&this.emit(\"pickedServer\",null,n),o(null,n)):o(new MongoError(\"server selection failed\"))},Mongos.prototype.connections=function(){for(var e=[],t=0;t<this.connectedProxies.length;t++)e=e.concat(this.connectedProxies[t].connections());return e},module.exports=Mongos;","node_modules/mongodb/lib/core/connection/logger.js":"\"use strict\";var f=require(\"util\").format,MongoError=require(\"../error\").MongoError,classFilters={},filteredClasses={},level=null,pid=process.pid,currentLogger=null,Logger=function(e,s){if(!(this instanceof Logger))return new Logger(e,s);s=s||{},this.className=e,s.logger?currentLogger=s.logger:null==currentLogger&&(currentLogger=console.log),s.loggerLevel&&(level=s.loggerLevel||\"error\"),null==filteredClasses[this.className]&&(classFilters[this.className]=!0)};Logger.prototype.debug=function(e,s){if(this.isDebug()&&(Object.keys(filteredClasses).length>0&&filteredClasses[this.className]||0===Object.keys(filteredClasses).length&&classFilters[this.className])){var r=(new Date).getTime(),t=f(\"[%s-%s:%s] %s %s\",\"DEBUG\",this.className,pid,r,e),l={type:\"debug\",message:e,className:this.className,pid:pid,date:r};s&&(l.meta=s),currentLogger(t,l)}},Logger.prototype.warn=function(e,s){if(this.isWarn()&&(Object.keys(filteredClasses).length>0&&filteredClasses[this.className]||0===Object.keys(filteredClasses).length&&classFilters[this.className])){var r=(new Date).getTime(),t=f(\"[%s-%s:%s] %s %s\",\"WARN\",this.className,pid,r,e),l={type:\"warn\",message:e,className:this.className,pid:pid,date:r};s&&(l.meta=s),currentLogger(t,l)}},Logger.prototype.info=function(e,s){if(this.isInfo()&&(Object.keys(filteredClasses).length>0&&filteredClasses[this.className]||0===Object.keys(filteredClasses).length&&classFilters[this.className])){var r=(new Date).getTime(),t=f(\"[%s-%s:%s] %s %s\",\"INFO\",this.className,pid,r,e),l={type:\"info\",message:e,className:this.className,pid:pid,date:r};s&&(l.meta=s),currentLogger(t,l)}},Logger.prototype.error=function(e,s){if(this.isError()&&(Object.keys(filteredClasses).length>0&&filteredClasses[this.className]||0===Object.keys(filteredClasses).length&&classFilters[this.className])){var r=(new Date).getTime(),t=f(\"[%s-%s:%s] %s %s\",\"ERROR\",this.className,pid,r,e),l={type:\"error\",message:e,className:this.className,pid:pid,date:r};s&&(l.meta=s),currentLogger(t,l)}},Logger.prototype.isInfo=function(){return\"info\"===level||\"debug\"===level},Logger.prototype.isError=function(){return\"error\"===level||\"info\"===level||\"debug\"===level},Logger.prototype.isWarn=function(){return\"error\"===level||\"warn\"===level||\"info\"===level||\"debug\"===level},Logger.prototype.isDebug=function(){return\"debug\"===level},Logger.reset=function(){level=\"error\",filteredClasses={}},Logger.currentLogger=function(){return currentLogger},Logger.setCurrentLogger=function(e){if(\"function\"!=typeof e)throw new MongoError(\"current logger must be a function\");currentLogger=e},Logger.filter=function(e,s){\"class\"===e&&Array.isArray(s)&&(filteredClasses={},s.forEach(function(e){filteredClasses[e]=!0}))},Logger.setLevel=function(e){if(\"info\"!==e&&\"error\"!==e&&\"debug\"!==e&&\"warn\"!==e)throw new Error(f(\"%s is an illegal logging level\",e));level=e},module.exports=Logger;","node_modules/mongodb/lib/core/cursor.js":"\"use strict\";const Logger=require(\"./connection/logger\"),retrieveBSON=require(\"./connection/utils\").retrieveBSON,MongoError=require(\"./error\").MongoError,MongoNetworkError=require(\"./error\").MongoNetworkError,mongoErrorContextSymbol=require(\"./error\").mongoErrorContextSymbol,collationNotSupported=require(\"./utils\").collationNotSupported,ReadPreference=require(\"./topologies/read_preference\"),isUnifiedTopology=require(\"./utils\").isUnifiedTopology,executeOperation=require(\"../operations/execute_operation\"),Readable=require(\"stream\").Readable,SUPPORTS=require(\"../utils\").SUPPORTS,MongoDBNamespace=require(\"../utils\").MongoDBNamespace,OperationBase=require(\"../operations/operation\").OperationBase,BSON=retrieveBSON(),Long=BSON.Long,CursorState={INIT:0,OPEN:1,CLOSED:2,GET_MORE:3};function handleCallback(r,t,e){try{r(t,e)}catch(t){process.nextTick(function(){throw t})}}class CoreCursor extends Readable{constructor(r,t,e,o){super({objectMode:!0}),o=o||{},t instanceof OperationBase&&(this.operation=t,t=this.operation.ns.toString(),o=this.operation.options,e=this.operation.cmd?this.operation.cmd:{}),this.pool=null,this.server=null,this.disconnectHandler=o.disconnectHandler,this.bson=r.s.bson,this.ns=t,this.namespace=MongoDBNamespace.fromString(t),this.cmd=e,this.options=o,this.topology=r,this.cursorState={cursorId:null,cmd:e,documents:o.documents||[],cursorIndex:0,dead:!1,killed:!1,init:!1,notified:!1,limit:o.limit||e.limit||0,skip:o.skip||e.skip||0,batchSize:o.batchSize||e.batchSize||1e3,currentLimit:0,transforms:o.transforms,raw:o.raw||e&&e.raw},\"object\"==typeof o.session&&(this.cursorState.session=o.session);const s=r.s.options;\"boolean\"==typeof s.promoteLongs?this.cursorState.promoteLongs=s.promoteLongs:\"boolean\"==typeof o.promoteLongs&&(this.cursorState.promoteLongs=o.promoteLongs),\"boolean\"==typeof s.promoteValues?this.cursorState.promoteValues=s.promoteValues:\"boolean\"==typeof o.promoteValues&&(this.cursorState.promoteValues=o.promoteValues),\"boolean\"==typeof s.promoteBuffers?this.cursorState.promoteBuffers=s.promoteBuffers:\"boolean\"==typeof o.promoteBuffers&&(this.cursorState.promoteBuffers=o.promoteBuffers),s.reconnect&&(this.cursorState.reconnect=s.reconnect),this.logger=Logger(\"Cursor\",s),\"number\"==typeof e?(this.cursorState.cursorId=Long.fromNumber(e),this.cursorState.lastCursorId=this.cursorState.cursorId):e instanceof Long&&(this.cursorState.cursorId=e,this.cursorState.lastCursorId=e),this.operation&&(this.operation.cursorState=this.cursorState)}setCursorBatchSize(r){this.cursorState.batchSize=r}cursorBatchSize(){return this.cursorState.batchSize}setCursorLimit(r){this.cursorState.limit=r}cursorLimit(){return this.cursorState.limit}setCursorSkip(r){this.cursorState.skip=r}cursorSkip(){return this.cursorState.skip}_next(r){nextFunction(this,r)}clone(){return this.topology.cursor(this.ns,this.cmd,this.options)}isDead(){return!0===this.cursorState.dead}isKilled(){return!0===this.cursorState.killed}isNotified(){return!0===this.cursorState.notified}bufferedCount(){return this.cursorState.documents.length-this.cursorState.cursorIndex}readBufferedDocuments(r){const t=this.cursorState.documents.length-this.cursorState.cursorIndex,e=r<t?r:t;let o=this.cursorState.documents.slice(this.cursorState.cursorIndex,this.cursorState.cursorIndex+e);if(this.cursorState.transforms&&\"function\"==typeof this.cursorState.transforms.doc)for(let r=0;r<o.length;r++)o[r]=this.cursorState.transforms.doc(o[r]);return this.cursorState.limit>0&&this.cursorState.currentLimit+o.length>this.cursorState.limit&&(o=o.slice(0,this.cursorState.limit-this.cursorState.currentLimit),this.kill()),this.cursorState.currentLimit=this.cursorState.currentLimit+o.length,this.cursorState.cursorIndex=this.cursorState.cursorIndex+o.length,o}kill(r){this.cursorState.dead=!0,this.cursorState.killed=!0,this.cursorState.documents=[],null==this.cursorState.cursorId||this.cursorState.cursorId.isZero()||!1===this.cursorState.init?r&&r(null,null):this.server.killCursors(this.ns,this.cursorState,r)}rewind(){this.cursorState.init&&(this.cursorState.dead||this.kill(),this.cursorState.currentLimit=0,this.cursorState.init=!1,this.cursorState.dead=!1,this.cursorState.killed=!1,this.cursorState.notified=!1,this.cursorState.documents=[],this.cursorState.cursorId=null,this.cursorState.cursorIndex=0)}_read(){if(this.s&&this.s.state===CursorState.CLOSED||this.isDead())return this.push(null);this._next((r,t)=>r?(this.listeners(\"error\")&&this.listeners(\"error\").length>0&&this.emit(\"error\",r),this.isDead()||this.close(),this.emit(\"end\"),this.emit(\"finish\")):this.cursorState.streamOptions&&\"function\"==typeof this.cursorState.streamOptions.transform&&null!=t?this.push(this.cursorState.streamOptions.transform(t)):this.cursorState.transforms&&\"function\"==typeof this.cursorState.transforms.doc&&null!=t?this.push(this.cursorState.transforms.doc(t)):(this.push(t),void(null===t&&this.isDead()&&this.once(\"end\",()=>{this.close(),this.emit(\"finish\")}))))}_endSession(r,t){\"function\"==typeof r&&(t=r,r={}),r=r||{};const e=this.cursorState.session;return e&&(r.force||e.owner===this)?(this.cursorState.session=void 0,this.operation&&this.operation.clearSession(),e.endSession(t),!0):(t&&t(),!1)}_getMore(r){this.logger.isDebug()&&this.logger.debug(`schedule getMore call for query [${JSON.stringify(this.query)}]`);let t=this.cursorState.batchSize;this.cursorState.limit>0&&this.cursorState.currentLimit+t>this.cursorState.limit&&(t=this.cursorState.limit-this.cursorState.currentLimit),this.server.getMore(this.ns,this.cursorState,t,this.options,r)}_initializeCursor(r){const t=this;if(isUnifiedTopology(t.topology)&&t.topology.shouldCheckForSessionSupport())return void t.topology.selectServer(ReadPreference.primaryPreferred,t=>{t?r(t):this._initializeCursor(r)});function e(e,o){if(t.cursorState.cursorId&&t.cursorState.cursorId.isZero()&&t._endSession&&t._endSession(),0===t.cursorState.documents.length&&t.cursorState.cursorId&&t.cursorState.cursorId.isZero()&&!t.cmd.tailable&&!t.cmd.awaitData)return setCursorNotified(t,r);r(e,o)}const o=(r,o)=>{if(r)return e(r);const s=o.message;if(s.queryFailure)return e(new MongoError(s.documents[0]),null);if(Array.isArray(s.documents)&&1===s.documents.length&&(!t.cmd.find||t.cmd.find&&!1===t.cmd.virtual)&&(\"string\"!=typeof s.documents[0].cursor||s.documents[0].$err||s.documents[0].errmsg||Array.isArray(s.documents[0].result))){if(s.documents[0].$err||s.documents[0].errmsg)return e(new MongoError(s.documents[0]),null);if(null!=s.documents[0].cursor&&\"string\"!=typeof s.documents[0].cursor){const r=s.documents[0].cursor.id;return s.documents[0].cursor.ns&&(t.ns=s.documents[0].cursor.ns),t.cursorState.cursorId=\"number\"==typeof r?Long.fromNumber(r):r,t.cursorState.lastCursorId=t.cursorState.cursorId,t.cursorState.operationTime=s.documents[0].operationTime,Array.isArray(s.documents[0].cursor.firstBatch)&&(t.cursorState.documents=s.documents[0].cursor.firstBatch),e(null,s)}if(Array.isArray(s.documents[0].result))return t.cursorState.documents=s.documents[0].result,t.cursorState.cursorId=Long.ZERO,e(null,s)}const i=s.cursorId||0;t.cursorState.cursorId=i instanceof Long?i:Long.fromNumber(i),t.cursorState.documents=s.documents,t.cursorState.lastCursorId=s.cursorId,t.cursorState.transforms&&\"function\"==typeof t.cursorState.transforms.query&&(t.cursorState.documents=t.cursorState.transforms.query(s)),e(null,s)};if(t.operation)return t.logger.isDebug()&&t.logger.debug(`issue initial query [${JSON.stringify(t.cmd)}] with flags [${JSON.stringify(t.query)}]`),void executeOperation(t.topology,t.operation,(r,s)=>{if(r)e(r);else{if(t.server=t.operation.server,t.cursorState.init=!0,null!=t.cursorState.cursorId)return e();o(r,s)}});const s={};return t.cursorState.session&&(s.session=t.cursorState.session),t.operation?s.readPreference=t.operation.readPreference:t.options.readPreference&&(s.readPreference=t.options.readPreference),t.topology.selectServer(s,(s,i)=>{if(s){const e=t.disconnectHandler;return null!=e?e.addObjectAndMethod(\"cursor\",t,\"next\",[r],r):r(s)}if(t.server=i,t.cursorState.init=!0,collationNotSupported(t.server,t.cmd))return r(new MongoError(`server ${t.server.name} does not support collation`));if(null!=t.cursorState.cursorId)return e();if(t.logger.isDebug()&&t.logger.debug(`issue initial query [${JSON.stringify(t.cmd)}] with flags [${JSON.stringify(t.query)}]`),null!=t.cmd.find)return void i.query(t.ns,t.cmd,t.cursorState,t.options,o);const n=Object.assign({session:t.cursorState.session},t.options);i.command(t.ns,t.cmd,n,o)})}}function isConnectionDead(r,t){if(r.pool&&r.pool.isDestroyed()){r.cursorState.killed=!0;const e=new MongoNetworkError(`connection to host ${r.pool.host}:${r.pool.port} was destroyed`);return _setCursorNotifiedImpl(r,()=>t(e)),!0}return!1}function isCursorDeadButNotkilled(r,t){return!(!r.cursorState.dead||r.cursorState.killed)&&(r.cursorState.killed=!0,setCursorNotified(r,t),!0)}function isCursorDeadAndKilled(r,t){return!(!r.cursorState.dead||!r.cursorState.killed)&&(handleCallback(t,new MongoError(\"cursor is dead\")),!0)}function isCursorKilled(r,t){return!!r.cursorState.killed&&(setCursorNotified(r,t),!0)}function setCursorDeadAndNotified(r,t){r.cursorState.dead=!0,setCursorNotified(r,t)}function setCursorNotified(r,t){_setCursorNotifiedImpl(r,()=>handleCallback(t,null,null))}function _setCursorNotifiedImpl(r,t){if(r.cursorState.notified=!0,r.cursorState.documents=[],r.cursorState.cursorIndex=0,!r._endSession)return t();r._endSession(void 0,()=>t())}function nextFunction(r,t){if(r.cursorState.notified)return t(new Error(\"cursor is exhausted\"));if(!isCursorKilled(r,t)&&!isCursorDeadButNotkilled(r,t)&&!isCursorDeadAndKilled(r,t))if(r.cursorState.init){if(r.cursorState.limit>0&&r.cursorState.currentLimit>=r.cursorState.limit)return r.kill(),setCursorDeadAndNotified(r,t);if(r.cursorState.cursorIndex!==r.cursorState.documents.length||Long.ZERO.equals(r.cursorState.cursorId)){if(r.cursorState.documents.length===r.cursorState.cursorIndex&&r.cmd.tailable&&Long.ZERO.equals(r.cursorState.cursorId))return handleCallback(t,new MongoError({message:\"No more documents in tailed cursor\",tailable:r.cmd.tailable,awaitData:r.cmd.awaitData}));if(r.cursorState.documents.length===r.cursorState.cursorIndex&&Long.ZERO.equals(r.cursorState.cursorId))setCursorDeadAndNotified(r,t);else{if(r.cursorState.limit>0&&r.cursorState.currentLimit>=r.cursorState.limit)return r.kill(),setCursorDeadAndNotified(r,t);r.cursorState.currentLimit+=1;let e=r.cursorState.documents[r.cursorState.cursorIndex++];if(!e||e.$err)return r.kill(),setCursorDeadAndNotified(r,function(){handleCallback(t,new MongoError(e?e.$err:void 0))});r.cursorState.transforms&&\"function\"==typeof r.cursorState.transforms.doc&&(e=r.cursorState.transforms.doc(e)),handleCallback(t,null,e)}}else{if(r.cursorState.documents=[],r.cursorState.cursorIndex=0,r.topology.isDestroyed())return t(new MongoNetworkError(\"connection destroyed, not possible to instantiate cursor\"));if(isConnectionDead(r,t))return;r._getMore(function(e,o,s){return e?(e instanceof MongoError&&(e[mongoErrorContextSymbol].isGetMore=!0),handleCallback(t,e)):(r.cursorState.cursorId&&r.cursorState.cursorId.isZero()&&r._endSession&&r._endSession(),r.connection=s,0===r.cursorState.documents.length&&r.cmd.tailable&&Long.ZERO.equals(r.cursorState.cursorId)?handleCallback(t,new MongoError({message:\"No more documents in tailed cursor\",tailable:r.cmd.tailable,awaitData:r.cmd.awaitData})):0===r.cursorState.documents.length&&r.cmd.tailable&&!Long.ZERO.equals(r.cursorState.cursorId)?nextFunction(r,t):r.cursorState.limit>0&&r.cursorState.currentLimit>=r.cursorState.limit?setCursorDeadAndNotified(r,t):void nextFunction(r,t))})}}else{if(!r.topology.isConnected(r.options)){if(\"server\"===r.topology._type&&!r.topology.s.options.reconnect)return t(new MongoError(\"no connection available\"));if(null!=r.disconnectHandler)return r.topology.isDestroyed()?t(new MongoError(\"Topology was destroyed\")):void r.disconnectHandler.addObjectAndMethod(\"cursor\",r,\"next\",[t],t)}r._initializeCursor((e,o)=>{e||null===o?t(e,o):nextFunction(r,t)})}}SUPPORTS.ASYNC_ITERATOR&&(CoreCursor.prototype[Symbol.asyncIterator]=require(\"../async/async_iterator\").asyncIterator),module.exports={CursorState:CursorState,CoreCursor:CoreCursor};","node_modules/mongodb/lib/core/topologies/read_preference.js":"\"use strict\";const ReadPreference=function(e,r,n){if(!ReadPreference.isValid(e))throw new TypeError(`Invalid read preference mode ${e}`);if(r&&!Array.isArray(r)&&(console.warn(\"ReadPreference tags must be an array, this will change in the next major version\"),void 0!==r.maxStalenessSeconds?(n=r,r=void 0):r=[r]),this.mode=e,this.tags=r,null!=(n=n||{}).maxStalenessSeconds){if(n.maxStalenessSeconds<=0)throw new TypeError(\"maxStalenessSeconds must be a positive integer\");this.maxStalenessSeconds=n.maxStalenessSeconds,this.minWireVersion=5}if(this.mode===ReadPreference.PRIMARY){if(this.tags&&Array.isArray(this.tags)&&this.tags.length>0)throw new TypeError(\"Primary read preference cannot be combined with tags\");if(this.maxStalenessSeconds)throw new TypeError(\"Primary read preference cannot be combined with maxStalenessSeconds\")}};Object.defineProperty(ReadPreference.prototype,\"preference\",{enumerable:!0,get:function(){return this.mode}}),ReadPreference.PRIMARY=\"primary\",ReadPreference.PRIMARY_PREFERRED=\"primaryPreferred\",ReadPreference.SECONDARY=\"secondary\",ReadPreference.SECONDARY_PREFERRED=\"secondaryPreferred\",ReadPreference.NEAREST=\"nearest\";const VALID_MODES=[ReadPreference.PRIMARY,ReadPreference.PRIMARY_PREFERRED,ReadPreference.SECONDARY,ReadPreference.SECONDARY_PREFERRED,ReadPreference.NEAREST,null];ReadPreference.fromOptions=function(e){const r=e.readPreference,n=e.readPreferenceTags;if(null==r)return null;if(\"string\"==typeof r)return new ReadPreference(r,n);if(!(r instanceof ReadPreference)&&\"object\"==typeof r){const e=r.mode||r.preference;if(e&&\"string\"==typeof e)return new ReadPreference(e,r.tags,{maxStalenessSeconds:r.maxStalenessSeconds})}return r},ReadPreference.isValid=function(e){return-1!==VALID_MODES.indexOf(e)},ReadPreference.prototype.isValid=function(e){return ReadPreference.isValid(\"string\"==typeof e?e:this.mode)};const needSlaveOk=[\"primaryPreferred\",\"secondary\",\"secondaryPreferred\",\"nearest\"];ReadPreference.prototype.slaveOk=function(){return-1!==needSlaveOk.indexOf(this.mode)},ReadPreference.prototype.equals=function(e){return e.mode===this.mode},ReadPreference.prototype.toJSON=function(){const e={mode:this.mode};return Array.isArray(this.tags)&&(e.tags=this.tags),this.maxStalenessSeconds&&(e.maxStalenessSeconds=this.maxStalenessSeconds),e},ReadPreference.primary=new ReadPreference(\"primary\"),ReadPreference.primaryPreferred=new ReadPreference(\"primaryPreferred\"),ReadPreference.secondary=new ReadPreference(\"secondary\"),ReadPreference.secondaryPreferred=new ReadPreference(\"secondaryPreferred\"),ReadPreference.nearest=new ReadPreference(\"nearest\"),module.exports=ReadPreference;","node_modules/mongodb/lib/core/sessions.js":"\"use strict\";const retrieveBSON=require(\"./connection/utils\").retrieveBSON,EventEmitter=require(\"events\"),BSON=retrieveBSON(),Binary=BSON.Binary,uuidV4=require(\"./utils\").uuidV4,MongoError=require(\"./error\").MongoError,isRetryableError=require(\"././error\").isRetryableError,MongoNetworkError=require(\"./error\").MongoNetworkError,MongoWriteConcernError=require(\"./error\").MongoWriteConcernError,Transaction=require(\"./transactions\").Transaction,TxnState=require(\"./transactions\").TxnState,isPromiseLike=require(\"./utils\").isPromiseLike,ReadPreference=require(\"./topologies/read_preference\"),isTransactionCommand=require(\"./transactions\").isTransactionCommand,resolveClusterTime=require(\"./topologies/shared\").resolveClusterTime,isSharded=require(\"./wireprotocol/shared\").isSharded,maxWireVersion=require(\"./utils\").maxWireVersion,minWireVersionForShardedTransactions=8;function assertAlive(n,e){if(null==n.serverSession){const n=new MongoError(\"Cannot use a session that has ended\");if(\"function\"==typeof e)return e(n,null),!1;throw n}return!0}class ClientSession extends EventEmitter{constructor(n,e,r,t){if(super(),null==n)throw new Error(\"ClientSession requires a topology\");if(null==e||!(e instanceof ServerSessionPool))throw new Error(\"ClientSession requires a ServerSessionPool\");r=r||{},t=t||{},this.topology=n,this.sessionPool=e,this.hasEnded=!1,this.serverSession=e.acquire(),this.clientOptions=t,this.supports={causalConsistency:void 0===r.causalConsistency||r.causalConsistency},this.clusterTime=r.initialClusterTime,this.operationTime=null,this.explicit=!!r.explicit,this.owner=r.owner,this.defaultTransactionOptions=Object.assign({},r.defaultTransactionOptions),this.transaction=new Transaction}get id(){return this.serverSession.id}endSession(n,e){\"function\"==typeof n&&(e=n,n={}),n=n||{},this.hasEnded?\"function\"==typeof e&&e(null,null):(this.serverSession&&this.inTransaction()&&this.abortTransaction(),this.hasEnded=!0,this.emit(\"ended\",this),this.sessionPool.release(this.serverSession),this.serverSession=null,\"function\"==typeof e&&e(null,null))}advanceOperationTime(n){null!=this.operationTime?n.greaterThan(this.operationTime)&&(this.operationTime=n):this.operationTime=n}equals(n){return n instanceof ClientSession&&this.id.id.buffer.equals(n.id.id.buffer)}incrementTransactionNumber(){this.serverSession.txnNumber++}inTransaction(){return this.transaction.isActive}startTransaction(n){if(assertAlive(this),this.inTransaction())throw new MongoError(\"Transaction already in progress\");const e=maxWireVersion(this.topology);if(isSharded(this.topology)&&null!=e&&e<minWireVersionForShardedTransactions)throw new MongoError(\"Transactions are not supported on sharded clusters in MongoDB < 4.2.\");this.incrementTransactionNumber(),this.transaction=new Transaction(Object.assign({},this.clientOptions,n||this.defaultTransactionOptions)),this.transaction.transition(TxnState.STARTING_TRANSACTION)}commitTransaction(n){if(\"function\"!=typeof n)return new Promise((n,e)=>{endTransaction(this,\"commitTransaction\",(r,t)=>r?e(r):n(t))});endTransaction(this,\"commitTransaction\",n)}abortTransaction(n){if(\"function\"!=typeof n)return new Promise((n,e)=>{endTransaction(this,\"abortTransaction\",(r,t)=>r?e(r):n(t))});endTransaction(this,\"abortTransaction\",n)}toBSON(){throw new Error(\"ClientSession cannot be serialized to BSON.\")}withTransaction(n,e){return attemptTransaction(this,Date.now(),n,e)}}const MAX_WITH_TRANSACTION_TIMEOUT=12e4,UNSATISFIABLE_WRITE_CONCERN_CODE=100,UNKNOWN_REPL_WRITE_CONCERN_CODE=79,MAX_TIME_MS_EXPIRED_CODE=50,NON_DETERMINISTIC_WRITE_CONCERN_ERRORS=new Set([\"CannotSatisfyWriteConcern\",\"UnknownReplWriteConcern\",\"UnsatisfiableWriteConcern\"]);function hasNotTimedOut(n,e){return Date.now()-n<e}function isUnknownTransactionCommitResult(n){return isMaxTimeMSExpiredError(n)||!NON_DETERMINISTIC_WRITE_CONCERN_ERRORS.has(n.codeName)&&n.code!==UNSATISFIABLE_WRITE_CONCERN_CODE&&n.code!==UNKNOWN_REPL_WRITE_CONCERN_CODE}function isMaxTimeMSExpiredError(n){return n.code===MAX_TIME_MS_EXPIRED_CODE||n.writeConcernError&&n.writeConcernError.code===MAX_TIME_MS_EXPIRED_CODE}function attemptTransactionCommit(n,e,r,t){return n.commitTransaction().catch(o=>{if(o instanceof MongoError&&hasNotTimedOut(e,MAX_WITH_TRANSACTION_TIMEOUT)&&!isMaxTimeMSExpiredError(o)){if(o.hasErrorLabel(\"UnknownTransactionCommitResult\"))return attemptTransactionCommit(n,e,r,t);if(o.hasErrorLabel(\"TransientTransactionError\"))return attemptTransaction(n,e,r,t)}throw o})}const USER_EXPLICIT_TXN_END_STATES=new Set([TxnState.NO_TRANSACTION,TxnState.TRANSACTION_COMMITTED,TxnState.TRANSACTION_ABORTED]);function userExplicitlyEndedTransaction(n){return USER_EXPLICIT_TXN_END_STATES.has(n.transaction.state)}function attemptTransaction(n,e,r,t){let o;n.startTransaction(t);try{o=r(n)}catch(n){o=Promise.reject(n)}if(!isPromiseLike(o))throw n.abortTransaction(),new TypeError(\"Function provided to `withTransaction` must return a Promise\");return o.then(()=>{if(!userExplicitlyEndedTransaction(n))return attemptTransactionCommit(n,e,r,t)}).catch(o=>{function i(o){if(o instanceof MongoError&&o.hasErrorLabel(\"TransientTransactionError\")&&hasNotTimedOut(e,MAX_WITH_TRANSACTION_TIMEOUT))return attemptTransaction(n,e,r,t);throw isMaxTimeMSExpiredError(o)&&(null==o.errorLabels&&(o.errorLabels=[]),o.errorLabels.push(\"UnknownTransactionCommitResult\")),o}return n.transaction.isActive?n.abortTransaction().then(()=>i(o)):i(o)})}function endTransaction(n,e,r){if(!assertAlive(n,r))return;let t=n.transaction.state;if(t===TxnState.NO_TRANSACTION)return void r(new MongoError(\"No transaction started\"));if(\"commitTransaction\"===e){if(t===TxnState.STARTING_TRANSACTION||t===TxnState.TRANSACTION_COMMITTED_EMPTY)return n.transaction.transition(TxnState.TRANSACTION_COMMITTED_EMPTY),void r(null,null);if(t===TxnState.TRANSACTION_ABORTED)return void r(new MongoError(\"Cannot call commitTransaction after calling abortTransaction\"))}else{if(t===TxnState.STARTING_TRANSACTION)return n.transaction.transition(TxnState.TRANSACTION_ABORTED),void r(null,null);if(t===TxnState.TRANSACTION_ABORTED)return void r(new MongoError(\"Cannot call abortTransaction twice\"));if(t===TxnState.TRANSACTION_COMMITTED||t===TxnState.TRANSACTION_COMMITTED_EMPTY)return void r(new MongoError(\"Cannot call abortTransaction after calling commitTransaction\"))}const o={[e]:1};let i;function s(t,o){if(\"commitTransaction\"===e){if(n.transaction.transition(TxnState.TRANSACTION_COMMITTED),t&&(t instanceof MongoNetworkError||t instanceof MongoWriteConcernError||isRetryableError(t)||isMaxTimeMSExpiredError(t))){if(t.errorLabels){const n=t.errorLabels.indexOf(\"TransientTransactionError\");-1!==n&&t.errorLabels.splice(n,1)}else t.errorLabels=[];isUnknownTransactionCommitResult(t)&&(t.errorLabels.push(\"UnknownTransactionCommitResult\"),n.transaction.unpinServer())}}else n.transaction.transition(TxnState.TRANSACTION_ABORTED);r(t,o)}function a(n){return\"commitTransaction\"===e?n:null}n.transaction.options.writeConcern?i=Object.assign({},n.transaction.options.writeConcern):n.clientOptions&&n.clientOptions.w&&(i={w:n.clientOptions.w}),t===TxnState.TRANSACTION_COMMITTED&&(i=Object.assign({wtimeout:1e4},i,{w:\"majority\"})),i&&Object.assign(o,{writeConcern:i}),\"commitTransaction\"===e&&n.transaction.options.maxTimeMS&&Object.assign(o,{maxTimeMS:n.transaction.options.maxTimeMS}),n.transaction.recoveryToken&&supportsRecoveryToken(n)&&(o.recoveryToken=n.transaction.recoveryToken),n.topology.command(\"admin.$cmd\",o,{session:n},(e,r)=>{if(e&&isRetryableError(e))return o.commitTransaction&&(n.transaction.unpinServer(),o.writeConcern=Object.assign({wtimeout:1e4},o.writeConcern,{w:\"majority\"})),n.topology.command(\"admin.$cmd\",o,{session:n},(n,e)=>s(a(n),e));s(a(e),r)})}function supportsRecoveryToken(n){return!!n.topology.s.options.useRecoveryToken}class ServerSession{constructor(){this.id={id:new Binary(uuidV4(),Binary.SUBTYPE_UUID)},this.lastUse=Date.now(),this.txnNumber=0,this.isDirty=!1}hasTimedOut(n){return Math.round((Date.now()-this.lastUse)%864e5%36e5/6e4)>n-1}}class ServerSessionPool{constructor(n){if(null==n)throw new Error(\"ServerSessionPool requires a topology\");this.topology=n,this.sessions=[]}endAllPooledSessions(){this.sessions.length&&(this.topology.endSessions(this.sessions.map(n=>n.id)),this.sessions=[])}acquire(){const n=this.topology.logicalSessionTimeoutMinutes;for(;this.sessions.length;){const e=this.sessions.shift();if(!e.hasTimedOut(n))return e}return new ServerSession}release(n){const e=this.topology.logicalSessionTimeoutMinutes;for(;this.sessions.length;){if(!this.sessions[this.sessions.length-1].hasTimedOut(e))break;this.sessions.pop()}if(!n.hasTimedOut(e)){if(n.isDirty)return;this.sessions.unshift(n)}}}function commandSupportsReadConcern(n,e){return!!(n.aggregate||n.count||n.distinct||n.find||n.parallelCollectionScan||n.geoNear||n.geoSearch)||!(!n.mapReduce||!e.out||1!==e.out.inline&&\"inline\"!==e.out)}function applySession(n,e,r){const t=n.serverSession;if(null==t)return new MongoError(\"Cannot use a session that has ended\");t.lastUse=Date.now(),e.lsid=t.id;const o=n.inTransaction()||isTransactionCommand(e),i=r.willRetryWrite,s=commandSupportsReadConcern(e);if(t.txnNumber&&(i||o)&&(e.txnNumber=BSON.Long.fromNumber(t.txnNumber)),!o)return n.transaction.state!==TxnState.NO_TRANSACTION&&n.transaction.transition(TxnState.NO_TRANSACTION),void(n.supports.causalConsistency&&n.operationTime&&s&&(e.readConcern=e.readConcern||{},Object.assign(e.readConcern,{afterClusterTime:n.operationTime})));if(r.readPreference&&!r.readPreference.equals(ReadPreference.primary))return new MongoError(`Read preference in a transaction must be primary, not: ${r.readPreference.mode}`);if(e.autocommit=!1,n.transaction.state===TxnState.STARTING_TRANSACTION){n.transaction.transition(TxnState.TRANSACTION_IN_PROGRESS),e.startTransaction=!0;const r=n.transaction.options.readConcern||n.clientOptions.readConcern;r&&(e.readConcern=r),n.supports.causalConsistency&&n.operationTime&&(e.readConcern=e.readConcern||{},Object.assign(e.readConcern,{afterClusterTime:n.operationTime}))}}function updateSessionFromResponse(n,e){e.$clusterTime&&resolveClusterTime(n,e.$clusterTime),e.operationTime&&n&&n.supports.causalConsistency&&n.advanceOperationTime(e.operationTime),e.recoveryToken&&n&&n.inTransaction()&&(n.transaction._recoveryToken=e.recoveryToken)}module.exports={ClientSession:ClientSession,ServerSession:ServerSession,ServerSessionPool:ServerSessionPool,TxnState:TxnState,applySession:applySession,updateSessionFromResponse:updateSessionFromResponse,commandSupportsReadConcern:commandSupportsReadConcern};","node_modules/mongodb/lib/core/sdam/topology.js":"\"use strict\";const EventEmitter=require(\"events\"),ServerDescription=require(\"./server_description\").ServerDescription,ServerType=require(\"./common\").ServerType,TopologyDescription=require(\"./topology_description\").TopologyDescription,TopologyType=require(\"./common\").TopologyType,monitoring=require(\"./monitoring\"),Server=require(\"./server\").Server,relayEvents=require(\"../utils\").relayEvents,ReadPreference=require(\"../topologies/read_preference\"),isRetryableWritesSupported=require(\"../topologies/shared\").isRetryableWritesSupported,CoreCursor=require(\"../cursor\").CoreCursor,deprecate=require(\"util\").deprecate,BSON=require(\"../connection/utils\").retrieveBSON(),createCompressionInfo=require(\"../topologies/shared\").createCompressionInfo,isRetryableError=require(\"../error\").isRetryableError,isSDAMUnrecoverableError=require(\"../error\").isSDAMUnrecoverableError,ClientSession=require(\"../sessions\").ClientSession,createClientInfo=require(\"../topologies/shared\").createClientInfo,MongoError=require(\"../error\").MongoError,resolveClusterTime=require(\"../topologies/shared\").resolveClusterTime,SrvPoller=require(\"./srv_polling\").SrvPoller,getMMAPError=require(\"../topologies/shared\").getMMAPError,makeStateMachine=require(\"../utils\").makeStateMachine,eachAsync=require(\"../utils\").eachAsync,emitDeprecationWarning=require(\"../../utils\").emitDeprecationWarning,common=require(\"./common\"),drainTimerQueue=common.drainTimerQueue,clearAndRemoveTimerFrom=common.clearAndRemoveTimerFrom,serverSelection=require(\"./server_selection\"),readPreferenceServerSelector=serverSelection.readPreferenceServerSelector,writableServerSelector=serverSelection.writableServerSelector,selectServers=serverSelection.selectServers;let globalTopologyCounter=0;const SERVER_RELAY_EVENTS=[\"serverHeartbeatStarted\",\"serverHeartbeatSucceeded\",\"serverHeartbeatFailed\",\"commandStarted\",\"commandSucceeded\",\"commandFailed\",\"monitoring\"],LOCAL_SERVER_EVENTS=SERVER_RELAY_EVENTS.concat([\"error\",\"connect\",\"descriptionReceived\",\"close\",\"ended\"]),STATE_CLOSING=common.STATE_CLOSING,STATE_CLOSED=common.STATE_CLOSED,STATE_CONNECTING=common.STATE_CONNECTING,STATE_CONNECTED=common.STATE_CONNECTED,stateTransition=makeStateMachine({[STATE_CLOSED]:[STATE_CLOSED,STATE_CONNECTING],[STATE_CONNECTING]:[STATE_CONNECTING,STATE_CLOSING,STATE_CONNECTED,STATE_CLOSED],[STATE_CONNECTED]:[STATE_CONNECTED,STATE_CLOSING,STATE_CLOSED],[STATE_CLOSING]:[STATE_CLOSING,STATE_CLOSED]}),DEPRECATED_OPTIONS=new Set([\"autoReconnect\",\"reconnectTries\",\"reconnectInterval\",\"bufferMaxEntries\"]);class Topology extends EventEmitter{constructor(e,r){super(),void 0===r&&\"string\"!=typeof e&&(r=e,e=[],r.host&&e.push({host:r.host,port:r.port})),\"string\"==typeof(e=e||[])&&(e=parseStringSeedlist(e)),r=Object.assign({},common.TOPOLOGY_DEFAULTS,r),DEPRECATED_OPTIONS.forEach(e=>{r[e]&&emitDeprecationWarning(`The option \\`${e}\\` is incompatible with the unified topology, please read more by visiting http://bit.ly/2D8WfT6`,\"DeprecationWarning\")});const t=topologyTypeFromSeedlist(e,r),o=globalTopologyCounter++,s=e.reduce((e,r)=>{r.domain_socket&&(r.host=r.domain_socket);const t=r.port?`${r.host}:${r.port}`:`${r.host}:27017`;return e.set(t,new ServerDescription(t)),e},new Map);this.s={id:o,options:r,seedlist:e,state:STATE_CLOSED,description:new TopologyDescription(t,s,r.replicaSet,null,null,null,r),serverSelectionTimeoutMS:r.serverSelectionTimeoutMS,heartbeatFrequencyMS:r.heartbeatFrequencyMS,minHeartbeatFrequencyMS:r.minHeartbeatFrequencyMS,Cursor:r.cursorFactory||CoreCursor,bson:r.bson||new BSON([BSON.Binary,BSON.Code,BSON.DBRef,BSON.Decimal128,BSON.Double,BSON.Int32,BSON.Long,BSON.Map,BSON.MaxKey,BSON.MinKey,BSON.ObjectId,BSON.BSONRegExp,BSON.Symbol,BSON.Timestamp]),servers:new Map,sessionPool:null,sessions:new Set,promiseLibrary:r.promiseLibrary||Promise,credentials:r.credentials,clusterTime:null,iterationTimers:new Set,connectionTimers:new Set},this.s.options.compression={compressors:createCompressionInfo(r)},this.s.clientInfo=createClientInfo(r),r.srvHost&&(this.s.srvPoller=r.srvPoller||new SrvPoller({heartbeatFrequencyMS:this.s.heartbeatFrequencyMS,srvHost:r.srvHost,logger:r.logger,loggerLevel:r.loggerLevel}),this.s.detectTopologyDescriptionChange=(e=>{const r=e.previousDescription.type,t=e.newDescription.type;r!==TopologyType.Sharded&&t===TopologyType.Sharded&&(this.s.handleSrvPolling=srvPollingHandler(this),this.s.srvPoller.on(\"srvRecordDiscovery\",this.s.handleSrvPolling),this.s.srvPoller.start())}),this.on(\"topologyDescriptionChanged\",this.s.detectTopologyDescriptionChange)),this.setMaxListeners(1/0)}get description(){return this.s.description}get parserType(){return BSON.native?\"c++\":\"js\"}connections(){return Array.from(this.s.servers.values()).reduce((e,r)=>e.concat(r.s.pool.allConnections()),[])}connect(e,r){if(\"function\"==typeof e&&(r=e,e={}),e=e||{},this.s.state===STATE_CONNECTED)return void(\"function\"==typeof r&&r());stateTransition(this,STATE_CONNECTING),this.emit(\"topologyOpening\",new monitoring.TopologyOpeningEvent(this.s.id)),this.emit(\"topologyDescriptionChanged\",new monitoring.TopologyDescriptionChangedEvent(this.s.id,new TopologyDescription(TopologyType.Unknown),this.s.description)),connectServers(this,Array.from(this.s.description.servers.values())),translateReadPreference(e);const t=e.readPreference||ReadPreference.primary;this.selectServer(readPreferenceServerSelector(t),e,(e,t)=>{if(e)return stateTransition(this,STATE_CLOSED),void(\"function\"==typeof r?r(e,null):this.emit(\"error\",e));const o=e=>{stateTransition(this,STATE_CLOSED),t.removeListener(\"connect\",s),\"function\"==typeof r&&r(e,null)},s=(e,s)=>{stateTransition(this,STATE_CONNECTED),t.removeListener(\"error\",o),this.emit(\"open\",s,this),this.emit(\"connect\",this),\"function\"==typeof r&&r(s,this)};if(1===t.s.state)return t.once(\"error\",o),void t.once(\"connect\",s);s()})}close(e,r){\"function\"==typeof e&&(r=e,e={}),\"boolean\"==typeof e&&(e={force:e}),e=e||{},this.s.state!==STATE_CLOSED?(drainTimerQueue(this.s.iterationTimers),drainTimerQueue(this.s.connectionTimers),this.s.sessionPool&&(this.s.sessions.forEach(e=>e.endSession()),this.s.sessionPool.endAllPooledSessions()),this.s.srvPoller&&(this.s.srvPoller.stop(),this.s.handleSrvPolling&&(this.s.srvPoller.removeListener(\"srvRecordDiscovery\",this.s.handleSrvPolling),delete this.s.handleSrvPolling)),this.s.detectTopologyDescriptionChange&&(this.removeListener(\"topologyDescriptionChanged\",this.s.detectTopologyDescriptionChange),delete this.s.detectTopologyDescriptionChange),stateTransition(this,STATE_CLOSING),eachAsync(Array.from(this.s.servers.values()),(r,t)=>destroyServer(r,this,e,t),()=>{this.s.servers.clear(),this.emit(\"topologyClosed\",new monitoring.TopologyClosedEvent(this.s.id)),stateTransition(this,STATE_CLOSED),this.emit(\"close\"),\"function\"==typeof r&&r()})):\"function\"==typeof r&&r()}selectServer(e,r,t){if(\"function\"==typeof r)if(t=r,\"function\"!=typeof e){let t;r=e,e instanceof ReadPreference?t=e:(translateReadPreference(r),t=r.readPreference||ReadPreference.primary),e=readPreferenceServerSelector(t)}else r={};r=Object.assign({},{serverSelectionTimeoutMS:this.s.serverSelectionTimeoutMS},r);const o=this.description.type===TopologyType.Sharded,s=r.session,n=s&&s.transaction;o&&n&&n.server?t(null,n.server):selectServers(this,e,r.serverSelectionTimeoutMS,process.hrtime(),(e,r)=>{if(e)return t(e);const s=randomSelection(r);o&&n&&n.isActive&&n.pinServer(s),t(null,s)})}shouldCheckForSessionSupport(){return this.description.type===TopologyType.Single?!this.description.hasKnownServers:!this.description.hasDataBearingServers}hasSessionSupport(){return null!=this.description.logicalSessionTimeoutMinutes}startSession(e,r){const t=new ClientSession(this,this.s.sessionPool,e,r);return t.once(\"ended\",()=>{this.s.sessions.delete(t)}),this.s.sessions.add(t),t}endSessions(e,r){Array.isArray(e)||(e=[e]),this.command(\"admin.$cmd\",{endSessions:e},{readPreference:ReadPreference.primaryPreferred,noResponse:!0},()=>{\"function\"==typeof r&&r()})}serverUpdateHandler(e){if(!this.s.description.hasServer(e.address))return;const r=this.s.description,t=this.s.description.servers.get(e.address),o=e.$clusterTime;o&&resolveClusterTime(this,o),t&&t.equals(e)||(this.s.description=this.s.description.update(e),this.s.description.compatibilityError?this.emit(\"error\",new MongoError(this.s.description.compatibilityError)):(this.emit(\"serverDescriptionChanged\",new monitoring.ServerDescriptionChangedEvent(this.s.id,e.address,t,this.s.description.servers.get(e.address))),updateServers(this,e),this.emit(\"topologyDescriptionChanged\",new monitoring.TopologyDescriptionChangedEvent(this.s.id,r,this.s.description))))}auth(e,r){\"function\"==typeof e&&(r=e,e=null),\"function\"==typeof r&&r(null,!0)}logout(e){\"function\"==typeof e&&e(null,!0)}insert(e,r,t,o){executeWriteOperation({topology:this,op:\"insert\",ns:e,ops:r},t,o)}update(e,r,t,o){executeWriteOperation({topology:this,op:\"update\",ns:e,ops:r},t,o)}remove(e,r,t,o){executeWriteOperation({topology:this,op:\"remove\",ns:e,ops:r},t,o)}command(e,r,t,o){\"function\"==typeof t&&(o=t,t=(t={})||{}),translateReadPreference(t);const s=t.readPreference||ReadPreference.primary;this.selectServer(readPreferenceServerSelector(s),t,(s,n)=>{if(s)return void o(s);const i=!t.retrying&&!!t.retryWrites&&t.session&&isRetryableWritesSupported(this)&&!t.session.inTransaction()&&isWriteCommand(r);i&&(t.session.incrementTransactionNumber(),t.willRetryWrite=i),n.command(e,r,t,(s,n)=>{if(!s)return o(null,n);if(!isRetryableError(s))return o(s);if(i){const s=Object.assign({},t,{retrying:!0});return this.command(e,r,s,o)}return o(s)})})}cursor(e,r,t){const o=(t=t||{}).topology||this,s=t.cursorFactory||this.s.Cursor;return translateReadPreference(t),new s(o,e,r,t)}get clientInfo(){return this.s.clientInfo}isConnected(){return this.s.state===STATE_CONNECTED}isDestroyed(){return this.s.state===STATE_CLOSED}unref(){console.log(\"not implemented: `unref`\")}lastIsMaster(){const e=Array.from(this.description.servers.values());return 0===e.length?{}:e.filter(e=>e.type!==ServerType.Unknown)[0]||{maxWireVersion:this.description.commonWireVersion}}get logicalSessionTimeoutMinutes(){return this.description.logicalSessionTimeoutMinutes}get bson(){return this.s.bson}}Object.defineProperty(Topology.prototype,\"clusterTime\",{enumerable:!0,get:function(){return this.s.clusterTime},set:function(e){this.s.clusterTime=e}}),Topology.prototype.destroy=deprecate(Topology.prototype.close,\"destroy() is deprecated, please use close() instead\");const RETRYABLE_WRITE_OPERATIONS=[\"findAndModify\",\"insert\",\"update\",\"delete\"];function isWriteCommand(e){return RETRYABLE_WRITE_OPERATIONS.some(r=>e[r])}function destroyServer(e,r,t,o){t=t||{},LOCAL_SERVER_EVENTS.forEach(r=>e.removeAllListeners(r)),e.destroy(t,()=>{r.emit(\"serverClosed\",new monitoring.ServerClosedEvent(r.s.id,e.description.address)),\"function\"==typeof o&&o(null,null)})}function parseStringSeedlist(e){return e.split(\",\").map(e=>({host:e.split(\":\")[0],port:e.split(\":\")[1]||27017}))}function topologyTypeFromSeedlist(e,r){const t=r.replicaSet||r.setName||r.rs_name;return 1!==e.length||t?t?TopologyType.ReplicaSetNoPrimary:TopologyType.Unknown:TopologyType.Single}function randomSelection(e){return e[Math.floor(Math.random()*e.length)]}function createAndConnectServer(e,r,t){e.emit(\"serverOpening\",new monitoring.ServerOpeningEvent(e.s.id,r.address));const o=new Server(r,e.s.options,e);if(relayEvents(o,e,SERVER_RELAY_EVENTS),o.once(\"connect\",serverConnectEventHandler(o,e)),o.on(\"descriptionReceived\",e.serverUpdateHandler.bind(e)),o.on(\"error\",serverErrorEventHandler(o,e)),t){const r=setTimeout(()=>{clearAndRemoveTimerFrom(r,e.s.connectionTimers),o.connect()},t);return e.s.connectionTimers.add(r),o}return o.connect(),o}function resetServer(e,r){if(!e.s.servers.has(r.address))return;destroyServer(e.s.servers.get(r.address),e);const t=createAndConnectServer(e,r,e.s.minHeartbeatFrequencyMS);e.s.servers.set(r.address,t)}function connectServers(e,r){e.s.servers=r.reduce((r,t)=>{const o=createAndConnectServer(e,t);return r.set(t.address,o),r},new Map)}function updateServers(e,r){if(r&&r.error)resetServer(e,r);else{if(r&&e.s.servers.has(r.address)){e.s.servers.get(r.address).s.description=r}for(const r of e.description.servers.values())if(!e.s.servers.has(r.address)){const t=createAndConnectServer(e,r);e.s.servers.set(r.address,t)}for(const r of e.s.servers){const t=r[0];if(e.description.hasServer(t))continue;const o=e.s.servers.get(t);e.s.servers.delete(t),destroyServer(o,e)}}}function serverConnectEventHandler(e,r){return function(){e.monitor({initial:!0,heartbeatFrequencyMS:r.description.heartbeatFrequencyMS})}}function serverErrorEventHandler(e,r){return function(t){r.s.state!==STATE_CLOSING&&r.s.state!==STATE_CLOSED&&(isSDAMUnrecoverableError(t,e),resetServerState(e,t))}}function executeWriteOperation(e,r,t){\"function\"==typeof r&&(t=r,r={}),r=r||{};const o=e.topology,s=e.op,n=e.ns,i=e.ops,c=!e.retrying&&!!r.retryWrites&&r.session&&isRetryableWritesSupported(o)&&!r.session.inTransaction();o.selectServer(writableServerSelector(),r,(o,a)=>{if(o)return void t(o,null);const l=(o,s)=>{if(!o)return t(null,s);if(!isRetryableError(o))return o=getMMAPError(o),t(o);if(c){return executeWriteOperation(Object.assign({},e,{retrying:!0}),r,t)}return t(o)};t.operationId&&(l.operationId=t.operationId),c&&(r.session.incrementTransactionNumber(),r.willRetryWrite=c),a[s](n,i,r,l)})}function resetServerState(e,r,t){function o(){e.emit(\"descriptionReceived\",new ServerDescription(e.description.address,null,{error:r})),process.nextTick(()=>e.monitor())}(t=Object.assign({},{clearPool:!1},t)).clearPool&&e.s.pool?e.s.pool.reset(()=>o()):o()}function translateReadPreference(e){if(null==e.readPreference)return;let r=e.readPreference;if(\"string\"==typeof r)e.readPreference=new ReadPreference(r);else if(!r||r instanceof ReadPreference||\"object\"!=typeof r){if(!(r instanceof ReadPreference))throw new TypeError(\"Invalid read preference: \"+r)}else{const t=r.mode||r.preference;t&&\"string\"==typeof t&&(e.readPreference=new ReadPreference(t,r.tags,{maxStalenessSeconds:r.maxStalenessSeconds}))}return e}function srvPollingHandler(e){return function(r){const t=e.s.description;e.s.description=e.s.description.updateFromSrvPollingEvent(r),e.s.description!==t&&(updateServers(e),e.emit(\"topologyDescriptionChanged\",new monitoring.TopologyDescriptionChangedEvent(e.s.id,t,e.s.description)))}}module.exports={Topology:Topology};","node_modules/mongodb/lib/core/connection/commands.js":"\"use strict\";var retrieveBSON=require(\"./utils\").retrieveBSON,BSON=retrieveBSON(),Long=BSON.Long;const Buffer=require(\"safe-buffer\").Buffer;var _requestId=0,opcodes=require(\"../wireprotocol/shared\").opcodes,OPTS_TAILABLE_CURSOR=2,OPTS_SLAVE=4,OPTS_OPLOG_REPLAY=8,OPTS_NO_CURSOR_TIMEOUT=16,OPTS_AWAIT_DATA=32,OPTS_EXHAUST=64,OPTS_PARTIAL=128,CURSOR_NOT_FOUND=1,QUERY_FAILURE=2,SHARD_CONFIG_STALE=4,AWAIT_CAPABLE=8,Query=function(e,t,s,r){if(null==t)throw new Error(\"ns must be specified for query\");if(null==s)throw new Error(\"query must be specified for query\");if(-1!==t.indexOf(\"\\0\"))throw new Error(\"namespace cannot contain a null character\");this.bson=e,this.ns=t,this.query=s,this.numberToSkip=r.numberToSkip||0,this.numberToReturn=r.numberToReturn||0,this.returnFieldSelector=r.returnFieldSelector||null,this.requestId=Query.getRequestId(),this.pre32Limit=r.pre32Limit,this.serializeFunctions=\"boolean\"==typeof r.serializeFunctions&&r.serializeFunctions,this.ignoreUndefined=\"boolean\"==typeof r.ignoreUndefined&&r.ignoreUndefined,this.maxBsonSize=r.maxBsonSize||16777216,this.checkKeys=\"boolean\"!=typeof r.checkKeys||r.checkKeys,this.batchSize=this.numberToReturn,this.tailable=!1,this.slaveOk=\"boolean\"==typeof r.slaveOk&&r.slaveOk,this.oplogReplay=!1,this.noCursorTimeout=!1,this.awaitData=!1,this.exhaust=!1,this.partial=!1};Query.prototype.incRequestId=function(){this.requestId=_requestId++},Query.nextRequestId=function(){return _requestId+1},Query.prototype.toBin=function(){var e=[],t=null,s=0;this.tailable&&(s|=OPTS_TAILABLE_CURSOR),this.slaveOk&&(s|=OPTS_SLAVE),this.oplogReplay&&(s|=OPTS_OPLOG_REPLAY),this.noCursorTimeout&&(s|=OPTS_NO_CURSOR_TIMEOUT),this.awaitData&&(s|=OPTS_AWAIT_DATA),this.exhaust&&(s|=OPTS_EXHAUST),this.partial&&(s|=OPTS_PARTIAL),this.batchSize!==this.numberToReturn&&(this.numberToReturn=this.batchSize);var r=Buffer.alloc(20+Buffer.byteLength(this.ns)+1+4+4);e.push(r);var i=this.bson.serialize(this.query,{checkKeys:this.checkKeys,serializeFunctions:this.serializeFunctions,ignoreUndefined:this.ignoreUndefined});e.push(i),this.returnFieldSelector&&Object.keys(this.returnFieldSelector).length>0&&(t=this.bson.serialize(this.returnFieldSelector,{checkKeys:this.checkKeys,serializeFunctions:this.serializeFunctions,ignoreUndefined:this.ignoreUndefined}),e.push(t));var o=r.length+i.length+(t?t.length:0),n=4;return r[3]=o>>24&255,r[2]=o>>16&255,r[1]=o>>8&255,r[0]=255&o,r[n+3]=this.requestId>>24&255,r[n+2]=this.requestId>>16&255,r[n+1]=this.requestId>>8&255,r[n]=255&this.requestId,r[(n+=4)+3]=0,r[n+2]=0,r[n+1]=0,r[n]=0,r[(n+=4)+3]=opcodes.OP_QUERY>>24&255,r[n+2]=opcodes.OP_QUERY>>16&255,r[n+1]=opcodes.OP_QUERY>>8&255,r[n]=255&opcodes.OP_QUERY,r[(n+=4)+3]=s>>24&255,r[n+2]=s>>16&255,r[n+1]=s>>8&255,r[n]=255&s,r[(n=(n+=4)+r.write(this.ns,n,\"utf8\")+1)-1]=0,r[n+3]=this.numberToSkip>>24&255,r[n+2]=this.numberToSkip>>16&255,r[n+1]=this.numberToSkip>>8&255,r[n]=255&this.numberToSkip,r[(n+=4)+3]=this.numberToReturn>>24&255,r[n+2]=this.numberToReturn>>16&255,r[n+1]=this.numberToReturn>>8&255,r[n]=255&this.numberToReturn,n+=4,e},Query.getRequestId=function(){return++_requestId};var GetMore=function(e,t,s,r){r=r||{},this.numberToReturn=r.numberToReturn||0,this.requestId=_requestId++,this.bson=e,this.ns=t,this.cursorId=s};GetMore.prototype.toBin=function(){var e=4+Buffer.byteLength(this.ns)+1+4+8+16,t=0,s=Buffer.alloc(e);return s[t+3]=e>>24&255,s[t+2]=e>>16&255,s[t+1]=e>>8&255,s[t]=255&e,s[(t+=4)+3]=this.requestId>>24&255,s[t+2]=this.requestId>>16&255,s[t+1]=this.requestId>>8&255,s[t]=255&this.requestId,s[(t+=4)+3]=0,s[t+2]=0,s[t+1]=0,s[t]=0,s[(t+=4)+3]=opcodes.OP_GETMORE>>24&255,s[t+2]=opcodes.OP_GETMORE>>16&255,s[t+1]=opcodes.OP_GETMORE>>8&255,s[t]=255&opcodes.OP_GETMORE,s[(t+=4)+3]=0,s[t+2]=0,s[t+1]=0,s[t]=0,s[(t=(t+=4)+s.write(this.ns,t,\"utf8\")+1)-1]=0,s[t+3]=this.numberToReturn>>24&255,s[t+2]=this.numberToReturn>>16&255,s[t+1]=this.numberToReturn>>8&255,s[t]=255&this.numberToReturn,s[(t+=4)+3]=this.cursorId.getLowBits()>>24&255,s[t+2]=this.cursorId.getLowBits()>>16&255,s[t+1]=this.cursorId.getLowBits()>>8&255,s[t]=255&this.cursorId.getLowBits(),s[(t+=4)+3]=this.cursorId.getHighBits()>>24&255,s[t+2]=this.cursorId.getHighBits()>>16&255,s[t+1]=this.cursorId.getHighBits()>>8&255,s[t]=255&this.cursorId.getHighBits(),t+=4,s};var KillCursor=function(e,t,s){this.ns=t,this.requestId=_requestId++,this.cursorIds=s};KillCursor.prototype.toBin=function(){var e=24+8*this.cursorIds.length,t=0,s=Buffer.alloc(e);s[t+3]=e>>24&255,s[t+2]=e>>16&255,s[t+1]=e>>8&255,s[t]=255&e,s[(t+=4)+3]=this.requestId>>24&255,s[t+2]=this.requestId>>16&255,s[t+1]=this.requestId>>8&255,s[t]=255&this.requestId,s[(t+=4)+3]=0,s[t+2]=0,s[t+1]=0,s[t]=0,s[(t+=4)+3]=opcodes.OP_KILL_CURSORS>>24&255,s[t+2]=opcodes.OP_KILL_CURSORS>>16&255,s[t+1]=opcodes.OP_KILL_CURSORS>>8&255,s[t]=255&opcodes.OP_KILL_CURSORS,s[(t+=4)+3]=0,s[t+2]=0,s[t+1]=0,s[t]=0,s[(t+=4)+3]=this.cursorIds.length>>24&255,s[t+2]=this.cursorIds.length>>16&255,s[t+1]=this.cursorIds.length>>8&255,s[t]=255&this.cursorIds.length,t+=4;for(var r=0;r<this.cursorIds.length;r++)s[t+3]=this.cursorIds[r].getLowBits()>>24&255,s[t+2]=this.cursorIds[r].getLowBits()>>16&255,s[t+1]=this.cursorIds[r].getLowBits()>>8&255,s[t]=255&this.cursorIds[r].getLowBits(),s[(t+=4)+3]=this.cursorIds[r].getHighBits()>>24&255,s[t+2]=this.cursorIds[r].getHighBits()>>16&255,s[t+1]=this.cursorIds[r].getHighBits()>>8&255,s[t]=255&this.cursorIds[r].getHighBits(),t+=4;return s};var Response=function(e,t,s,r,i){i=i||{promoteLongs:!0,promoteValues:!0,promoteBuffers:!1},this.parsed=!1,this.raw=t,this.data=r,this.bson=e,this.opts=i,this.length=s.length,this.requestId=s.requestId,this.responseTo=s.responseTo,this.opCode=s.opCode,this.fromCompressed=s.fromCompressed,this.responseFlags=r.readInt32LE(0),this.cursorId=new Long(r.readInt32LE(4),r.readInt32LE(8)),this.startingFrom=r.readInt32LE(12),this.numberReturned=r.readInt32LE(16),this.documents=new Array(this.numberReturned),this.cursorNotFound=0!=(this.responseFlags&CURSOR_NOT_FOUND),this.queryFailure=0!=(this.responseFlags&QUERY_FAILURE),this.shardConfigStale=0!=(this.responseFlags&SHARD_CONFIG_STALE),this.awaitCapable=0!=(this.responseFlags&AWAIT_CAPABLE),this.promoteLongs=\"boolean\"!=typeof i.promoteLongs||i.promoteLongs,this.promoteValues=\"boolean\"!=typeof i.promoteValues||i.promoteValues,this.promoteBuffers=\"boolean\"==typeof i.promoteBuffers&&i.promoteBuffers};Response.prototype.isParsed=function(){return this.parsed},Response.prototype.parse=function(e){if(!this.parsed){var t,s,r=(e=e||{}).raw||!1,i=e.documentsReturnedIn||null;s={promoteLongs:\"boolean\"==typeof e.promoteLongs?e.promoteLongs:this.opts.promoteLongs,promoteValues:\"boolean\"==typeof e.promoteValues?e.promoteValues:this.opts.promoteValues,promoteBuffers:\"boolean\"==typeof e.promoteBuffers?e.promoteBuffers:this.opts.promoteBuffers},this.index=20;for(var o=0;o<this.numberReturned;o++)t=this.data[this.index]|this.data[this.index+1]<<8|this.data[this.index+2]<<16|this.data[this.index+3]<<24,this.documents[o]=r?this.data.slice(this.index,this.index+t):this.bson.deserialize(this.data.slice(this.index,this.index+t),s),this.index=this.index+t;if(1===this.documents.length&&null!=i&&r){const e={};e[i]=!0,s.fieldsAsRaw=e;const t=this.bson.deserialize(this.documents[0],s);this.documents=[t]}this.parsed=!0}},module.exports={Query:Query,GetMore:GetMore,Response:Response,KillCursor:KillCursor};","node_modules/mongodb/lib/core/auth/mongo_credentials.js":"\"use strict\";function getDefaultAuthMechanism(s){if(s){if(Array.isArray(s.saslSupportedMechs))return s.saslSupportedMechs.indexOf(\"SCRAM-SHA-256\")>=0?\"scram-sha-256\":\"scram-sha-1\";if(s.maxWireVersion>=3)return\"scram-sha-1\"}return\"mongocr\"}class MongoCredentials{constructor(s){s=s||{},this.username=s.username,this.password=s.password,this.source=s.source||s.db,this.mechanism=s.mechanism||\"default\",this.mechanismProperties=s.mechanismProperties}equals(s){return this.mechanism===s.mechanism&&this.username===s.username&&this.password===s.password&&this.source===s.source}resolveAuthMechanism(s){\"default\"===this.mechanism.toLowerCase()&&(this.mechanism=getDefaultAuthMechanism(s))}}module.exports={MongoCredentials:MongoCredentials};","node_modules/mongodb/lib/core/auth/defaultAuthProviders.js":"\"use strict\";const MongoCR=require(\"./mongocr\"),X509=require(\"./x509\"),Plain=require(\"./plain\"),GSSAPI=require(\"./gssapi\"),SSPI=require(\"./sspi\"),ScramSHA1=require(\"./scram\").ScramSHA1,ScramSHA256=require(\"./scram\").ScramSHA256;function defaultAuthProviders(r){return{mongocr:new MongoCR(r),x509:new X509(r),plain:new Plain(r),gssapi:new GSSAPI(r),sspi:new SSPI(r),\"scram-sha-1\":new ScramSHA1(r),\"scram-sha-256\":new ScramSHA256(r)}}module.exports={defaultAuthProviders:defaultAuthProviders};","node_modules/mongodb/lib/core/auth/mongocr.js":"\"use strict\";const crypto=require(\"crypto\"),AuthProvider=require(\"./auth_provider\").AuthProvider;class MongoCR extends AuthProvider{_authenticateSingleConnection(e,t,o,r){const n=o.username,c=o.password,u=o.source;e(t,`${u}.$cmd`,{getnonce:1},(o,s)=>{let d=null,a=null;if(null==o){d=s.nonce;let e=crypto.createHash(\"md5\");e.update(n+\":mongo:\"+c,\"utf8\");const t=e.digest(\"hex\");(e=crypto.createHash(\"md5\")).update(d+n+t,\"utf8\"),a=e.digest(\"hex\")}e(t,`${u}.$cmd`,{authenticate:1,user:n,nonce:d,key:a},r)})}}module.exports=MongoCR;","node_modules/mongodb/lib/core/auth/x509.js":"\"use strict\";const AuthProvider=require(\"./auth_provider\").AuthProvider;class X509 extends AuthProvider{_authenticateSingleConnection(e,t,r,n){const i=r.username,s={authenticate:1,mechanism:\"MONGODB-X509\"};i&&(s.user=i),e(t,\"$external.$cmd\",s,n)}}module.exports=X509;","node_modules/mongodb/lib/core/auth/plain.js":"\"use strict\";const retrieveBSON=require(\"../connection/utils\").retrieveBSON,AuthProvider=require(\"./auth_provider\").AuthProvider,BSON=retrieveBSON(),Binary=BSON.Binary;class Plain extends AuthProvider{_authenticateSingleConnection(e,r,t,i){const n=t.username,a=t.password;e(r,\"$external.$cmd\",{saslStart:1,mechanism:\"PLAIN\",payload:new Binary(`\\0${n}\\0${a}`),autoAuthorize:1},i)}}module.exports=Plain;","node_modules/mongodb/lib/core/auth/gssapi.js":"\"use strict\";const AuthProvider=require(\"./auth_provider\").AuthProvider,retrieveKerberos=require(\"../utils\").retrieveKerberos;let kerberos;class GSSAPI extends AuthProvider{_authenticateSingleConnection(e,r,n,t){const o=n.source,i=n.username,s=n.password,a=n.mechanismProperties,u=a.gssapiservicename||a.gssapiServiceName||\"mongodb\";GSSAPIInitialize(this,kerberos.processes.MongoAuthProcess,o,i,s,o,u,e,r,a,t)}auth(e,r,n,t){if(null==kerberos)try{kerberos=retrieveKerberos()}catch(e){return t(e,null)}super.auth(e,r,n,t)}}var GSSAPIInitialize=function(e,r,n,t,o,i,s,a,u,c,S){var l=new r(u.host,u.port,s,c);l.init(t,o,function(r){if(r)return S(r,!1);l.transition(\"\",function(r,s){if(r)return S(r,!1);MongoDBGSSAPIFirstStep(e,l,s,n,t,o,i,a,u,S)})})},MongoDBGSSAPIFirstStep=function(e,r,n,t,o,i,s,a,u,c){a(u,\"$external.$cmd\",{saslStart:1,mechanism:\"GSSAPI\",payload:n,autoAuthorize:1},(n,S)=>{if(n)return c(n,!1);r.transition(S.payload,function(n,l){if(n)return c(n,!1);MongoDBGSSAPISecondStep(e,r,l,S,t,o,i,s,a,u,c)})})},MongoDBGSSAPISecondStep=function(e,r,n,t,o,i,s,a,u,c,S){var l={saslContinue:1,conversationId:t.conversationId,payload:n};u(c,\"$external.$cmd\",l,(n,t)=>{if(n)return S(n,!1);r.transition(t.payload,function(n,l){if(n)return S(n,!1);MongoDBGSSAPIThirdStep(e,r,l,t,o,i,s,a,u,c,S)})})},MongoDBGSSAPIThirdStep=function(e,r,n,t,o,i,s,a,u,c,S){u(c,\"$external.$cmd\",{saslContinue:1,conversationId:t.conversationId,payload:n},(e,n)=>{if(e)return S(e,!1);r.transition(null,function(e){if(e)return S(e,null);S(null,n)})})};module.exports=GSSAPI;","node_modules/mongodb/lib/core/auth/scram.js":"\"use strict\";const crypto=require(\"crypto\"),Buffer=require(\"safe-buffer\").Buffer,retrieveBSON=require(\"../connection/utils\").retrieveBSON,MongoError=require(\"../error\").MongoError,AuthProvider=require(\"./auth_provider\").AuthProvider,BSON=retrieveBSON(),Binary=BSON.Binary;let saslprep;try{saslprep=require(\"saslprep\")}catch(r){}var parsePayload=function(r){for(var e={},t=r.split(\",\"),o=0;o<t.length;o++){var a=t[o].split(\"=\");e[a[0]]=a[1]}return e},passwordDigest=function(r,e){if(\"string\"!=typeof r)throw new MongoError(\"username must be a string\");if(\"string\"!=typeof e)throw new MongoError(\"password must be a string\");if(0===e.length)throw new MongoError(\"password cannot be empty\");var t=crypto.createHash(\"md5\");return t.update(r+\":mongo:\"+e,\"utf8\"),t.digest(\"hex\")};function xor(r,e){Buffer.isBuffer(r)||(r=Buffer.from(r)),Buffer.isBuffer(e)||(e=Buffer.from(e));const t=Math.max(r.length,e.length),o=[];for(let a=0;a<t;a+=1)o.push(r[a]^e[a]);return Buffer.from(o).toString(\"base64\")}function H(r,e){return crypto.createHash(r).update(e).digest()}function HMAC(r,e,t){return crypto.createHmac(r,e).update(t).digest()}var _hiCache={},_hiCacheCount=0,_hiCachePurge=function(){_hiCache={},_hiCacheCount=0};const hiLengthMap={sha256:32,sha1:20};function HI(r,e,t,o){const a=[r,e.toString(\"base64\"),t].join(\"_\");if(void 0!==_hiCache[a])return _hiCache[a];const n=crypto.pbkdf2Sync(r,e,t,hiLengthMap[o],o);return _hiCacheCount>=200&&_hiCachePurge(),_hiCache[a]=n,_hiCacheCount+=1,n}class ScramSHA extends AuthProvider{constructor(r,e){super(r),this.cryptoMethod=e||\"sha1\"}static _getError(r,e){return r||(e.$err||e.errmsg?new MongoError(e):void 0)}_executeScram(r,e,t,o,a){let n=t.username;const s=t.password,i=t.source,c=this.cryptoMethod;let u,f=\"SCRAM-SHA-1\";if(\"sha256\"===c)f=\"SCRAM-SHA-256\",u=saslprep?saslprep(s):s;else try{u=passwordDigest(n,s)}catch(r){return a(r)}n=n.replace(\"=\",\"=3D\").replace(\",\",\"=2C\");const h=Buffer.concat([Buffer.from(\"n=\",\"utf8\"),Buffer.from(n,\"utf8\"),Buffer.from(\",r=\",\"utf8\"),Buffer.from(o,\"utf8\")]),p={saslStart:1,mechanism:f,payload:new Binary(Buffer.concat([Buffer.from(\"n,,\",\"utf8\"),h])),autoAuthorize:1};r(e,`${i}.$cmd`,p,(t,o)=>{let n=ScramSHA._getError(t,o);if(n)return a(n,null);const s=Buffer.isBuffer(o.payload)?new Binary(o.payload):o.payload,f=parsePayload(s.value()),p=parseInt(f.i,10),l=f.s,d=`c=biws,r=${f.r}`,S=HI(u,Buffer.from(l,\"base64\"),p,c);if(p&&p<4096){const r=new MongoError(`Server returned an invalid iteration count ${p}`);return a(r,!1)}const m=HMAC(c,S,\"Client Key\"),g=H(c,m),y=[h,s.value().toString(\"base64\"),d].join(\",\"),B=[d,`p=${xor(m,HMAC(c,g,y))}`].join(\",\"),C={saslContinue:1,conversationId:o.conversationId,payload:new Binary(Buffer.from(B))};r(e,`${i}.$cmd`,C,(t,o)=>{if(!o||!1!==o.done)return a(t,o);const n={saslContinue:1,conversationId:o.conversationId,payload:Buffer.alloc(0)};r(e,`${i}.$cmd`,n,a)})})}_authenticateSingleConnection(r,e,t,o){crypto.randomBytes(24,(a,n)=>a?o(a,null):this._executeScram(r,e,t,n.toString(\"base64\"),o))}auth(r,e,t,o){this._checkSaslprep(),super.auth(r,e,t,o)}_checkSaslprep(){\"sha256\"===this.cryptoMethod&&(saslprep||console.warn(\"Warning: no saslprep library specified. Passwords will not be sanitized\"))}}class ScramSHA1 extends ScramSHA{constructor(r){super(r,\"sha1\")}}class ScramSHA256 extends ScramSHA{constructor(r){super(r,\"sha256\")}}module.exports={ScramSHA1:ScramSHA1,ScramSHA256:ScramSHA256};","node_modules/mongodb/lib/core/uri_parser.js":"\"use strict\";const URL=require(\"url\"),qs=require(\"querystring\"),dns=require(\"dns\"),MongoParseError=require(\"./error\").MongoParseError,ReadPreference=require(\"./topologies/read_preference\"),HOSTS_RX=/(mongodb(?:\\+srv|)):\\/\\/(?: (?:[^:]*) (?: : ([^@]*) )? @ )?([^/?]*)(?:\\/|)(.*)/;function matchesParentDomain(e,r){const n=/^.*?\\./,t=`.${e.replace(n,\"\")}`,s=`.${r.replace(n,\"\")}`;return t.endsWith(s)}function parseSrvConnectionString(e,r,n){const t=URL.parse(e,!0);if(t.hostname.split(\".\").length<3)return n(new MongoParseError(\"URI does not have hostname, domain name and tld\"));if(t.domainLength=t.hostname.split(\".\").length,t.pathname&&t.pathname.match(\",\"))return n(new MongoParseError(\"Invalid URI, cannot contain multiple hostnames\"));if(t.port)return n(new MongoParseError(`Ports not accepted with '${PROTOCOL_MONGODB_SRV}' URIs`));const s=t.host;dns.resolveSrv(`_mongodb._tcp.${s}`,(e,o)=>{if(e)return n(e);if(0===o.length)return n(new MongoParseError(\"No addresses found at host\"));for(let e=0;e<o.length;e++)if(!matchesParentDomain(o[e].name,t.hostname,t.domainLength))return n(new MongoParseError(\"Server record does not share hostname with parent URI\"));t.protocol=\"mongodb\",t.host=o.map(e=>`${e.name}:${e.port}`).join(\",\"),\"ssl\"in r||t.search&&\"ssl\"in t.query&&null!==t.query.ssl||(t.query.ssl=!0),dns.resolveTxt(s,(e,o)=>{if(e){if(\"ENODATA\"!==e.code)return n(e);o=null}if(o){if(o.length>1)return n(new MongoParseError(\"Multiple text records not allowed\"));if(o=qs.parse(o[0].join(\"\")),Object.keys(o).some(e=>\"authSource\"!==e&&\"replicaSet\"!==e))return n(new MongoParseError(\"Text record must only set `authSource` or `replicaSet`\"));t.query=Object.assign({},o,t.query)}t.search=qs.stringify(t.query),parseConnectionString(URL.format(t),r,(e,r)=>{e?n(e):n(null,Object.assign({},r,{srvHost:s}))})})})}function parseQueryStringItemValue(e,r){if(Array.isArray(r))1===(r=r.filter((e,n)=>r.indexOf(e)===n)).length&&(r=r[0]);else if(r.indexOf(\":\")>0)r=r.split(\",\").reduce((r,n)=>{const t=n.split(\":\");return r[t[0]]=parseQueryStringItemValue(e,t[1]),r},{});else if(r.indexOf(\",\")>0)r=r.split(\",\").map(r=>parseQueryStringItemValue(e,r));else if(\"true\"===r.toLowerCase()||\"false\"===r.toLowerCase())r=\"true\"===r.toLowerCase();else if(!Number.isNaN(r)&&!STRING_OPTIONS.has(e)){const e=parseFloat(r);Number.isNaN(e)||(r=parseFloat(r))}return r}const BOOLEAN_OPTIONS=new Set([\"slaveok\",\"slave_ok\",\"sslvalidate\",\"fsync\",\"safe\",\"retrywrites\",\"j\"]),STRING_OPTIONS=new Set([\"authsource\",\"replicaset\"]),AUTH_MECHANISMS=new Set([\"GSSAPI\",\"MONGODB-X509\",\"MONGODB-CR\",\"DEFAULT\",\"SCRAM-SHA-1\",\"SCRAM-SHA-256\",\"PLAIN\"]),CASE_TRANSLATION={replicaset:\"replicaSet\",connecttimeoutms:\"connectTimeoutMS\",sockettimeoutms:\"socketTimeoutMS\",maxpoolsize:\"maxPoolSize\",minpoolsize:\"minPoolSize\",maxidletimems:\"maxIdleTimeMS\",waitqueuemultiple:\"waitQueueMultiple\",waitqueuetimeoutms:\"waitQueueTimeoutMS\",wtimeoutms:\"wtimeoutMS\",readconcern:\"readConcern\",readconcernlevel:\"readConcernLevel\",readpreference:\"readPreference\",maxstalenessseconds:\"maxStalenessSeconds\",readpreferencetags:\"readPreferenceTags\",authsource:\"authSource\",authmechanism:\"authMechanism\",authmechanismproperties:\"authMechanismProperties\",gssapiservicename:\"gssapiServiceName\",localthresholdms:\"localThresholdMS\",serverselectiontimeoutms:\"serverSelectionTimeoutMS\",serverselectiontryonce:\"serverSelectionTryOnce\",heartbeatfrequencyms:\"heartbeatFrequencyMS\",retrywrites:\"retryWrites\",uuidrepresentation:\"uuidRepresentation\",zlibcompressionlevel:\"zlibCompressionLevel\",tlsallowinvalidcertificates:\"tlsAllowInvalidCertificates\",tlsallowinvalidhostnames:\"tlsAllowInvalidHostnames\",tlsinsecure:\"tlsInsecure\",tlscafile:\"tlsCAFile\",tlscertificatekeyfile:\"tlsCertificateKeyFile\",tlscertificatekeyfilepassword:\"tlsCertificateKeyFilePassword\",wtimeout:\"wTimeoutMS\",j:\"journal\"};function applyConnectionStringOption(e,r,n,t){if(\"journal\"===r?r=\"j\":\"wtimeoutms\"===r&&(r=\"wtimeout\"),BOOLEAN_OPTIONS.has(r)?n=\"true\"===n||!0===n:\"appname\"===r?n=decodeURIComponent(n):\"readconcernlevel\"===r&&(e.readConcernLevel=n,r=\"readconcern\",n={level:n}),\"compressors\"===r&&!(n=Array.isArray(n)?n:[n]).every(e=>\"snappy\"===e||\"zlib\"===e))throw new MongoParseError(\"Value for `compressors` must be at least one of: `snappy`, `zlib`\");if(\"authmechanism\"===r&&!AUTH_MECHANISMS.has(n))throw new MongoParseError(\"Value for `authMechanism` must be one of: `DEFAULT`, `GSSAPI`, `PLAIN`, `MONGODB-X509`, `SCRAM-SHA-1`, `SCRAM-SHA-256`\");if(\"readpreference\"===r&&!ReadPreference.isValid(n))throw new MongoParseError(\"Value for `readPreference` must be one of: `primary`, `primaryPreferred`, `secondary`, `secondaryPreferred`, `nearest`\");if(\"zlibcompressionlevel\"===r&&(n<-1||n>9))throw new MongoParseError(\"zlibCompressionLevel must be an integer between -1 and 9\");\"compressors\"!==r&&\"zlibcompressionlevel\"!==r||(e.compression=e.compression||{},e=e.compression),\"authmechanismproperties\"===r&&(\"string\"==typeof n.SERVICE_NAME&&(e.gssapiServiceName=n.SERVICE_NAME),\"string\"==typeof n.SERVICE_REALM&&(e.gssapiServiceRealm=n.SERVICE_REALM),void 0!==n.CANONICALIZE_HOST_NAME&&(e.gssapiCanonicalizeHostName=n.CANONICALIZE_HOST_NAME)),\"readpreferencetags\"===r&&Array.isArray(n)&&(n=splitArrayOfMultipleReadPreferenceTags(n)),t.caseTranslate&&CASE_TRANSLATION[r]?e[CASE_TRANSLATION[r]]=n:e[r]=n}const USERNAME_REQUIRED_MECHANISMS=new Set([\"GSSAPI\",\"MONGODB-CR\",\"PLAIN\",\"SCRAM-SHA-1\",\"SCRAM-SHA-256\"]);function splitArrayOfMultipleReadPreferenceTags(e){const r=[];for(let n=0;n<e.length;n++)r[n]={},e[n].split(\",\").forEach(e=>{const t=e.split(\":\");r[n][t[0]]=t[1]});return r}function applyAuthExpectations(e){if(null==e.options)return;const r=e.options,n=r.authsource||r.authSource;null!=n&&(e.auth=Object.assign({},e.auth,{db:n}));const t=r.authmechanism||r.authMechanism;if(null!=t){if(USERNAME_REQUIRED_MECHANISMS.has(t)&&(!e.auth||null==e.auth.username))throw new MongoParseError(`Username required for mechanism \\`${t}\\``);if(\"GSSAPI\"===t){if(null!=n&&\"$external\"!==n)throw new MongoParseError(`Invalid source \\`${n}\\` for mechanism \\`${t}\\` specified.`);e.auth=Object.assign({},e.auth,{db:\"$external\"})}if(\"MONGODB-X509\"===t){if(e.auth&&null!=e.auth.password)throw new MongoParseError(`Password not allowed for mechanism \\`${t}\\``);if(null!=n&&\"$external\"!==n)throw new MongoParseError(`Invalid source \\`${n}\\` for mechanism \\`${t}\\` specified.`);e.auth=Object.assign({},e.auth,{db:\"$external\"})}\"PLAIN\"===t&&e.auth&&null==e.auth.db&&(e.auth=Object.assign({},e.auth,{db:\"$external\"}))}return e.auth&&null==e.auth.db&&(e.auth=Object.assign({},e.auth,{db:\"admin\"})),e}function parseQueryString(e,r){const n={};let t=qs.parse(e);checkTLSOptions(t);for(const e in t){const s=t[e];if(\"\"===s||null==s)throw new MongoParseError(\"Incomplete key value pair for option\");const o=e.toLowerCase();applyConnectionStringOption(n,o,parseQueryStringItemValue(o,s),r)}return n.wtimeout&&n.wtimeoutms&&(delete n.wtimeout,console.warn(\"Unsupported option `wtimeout` specified\")),Object.keys(n).length?n:null}function checkTLSOptions(e){const r=Object.keys(e);if(-1!==r.indexOf(\"tlsInsecure\")&&(-1!==r.indexOf(\"tlsAllowInvalidCertificates\")||-1!==r.indexOf(\"tlsAllowInvalidHostnames\")))throw new MongoParseError(\"The `tlsInsecure` option cannot be used with `tlsAllowInvalidCertificates` or `tlsAllowInvalidHostnames`.\");const n=assertTlsOptionsAreEqual(\"tls\",e,r),t=assertTlsOptionsAreEqual(\"ssl\",e,r);if(null!=n&&null!=t&&n!==t)throw new MongoParseError(\"All values of `tls` and `ssl` must be the same.\")}function assertTlsOptionsAreEqual(e,r,n){const t=-1!==n.indexOf(e);let s;if(s=Array.isArray(r[e])?r[e][0]:r[e],t&&Array.isArray(r[e])){const n=r[e][0];r[e].forEach(e=>{if(e!==n)throw new MongoParseError(\"All values of ${optionName} must be the same.\")})}return s}const PROTOCOL_MONGODB=\"mongodb\",PROTOCOL_MONGODB_SRV=\"mongodb+srv\",SUPPORTED_PROTOCOLS=[\"mongodb\",PROTOCOL_MONGODB_SRV];function parseConnectionString(e,r,n){\"function\"==typeof r&&(n=r,r={}),r=Object.assign({},{caseTranslate:!0},r);try{URL.parse(e)}catch(e){return n(new MongoParseError(\"URI malformed, cannot be parsed\"))}const t=e.match(HOSTS_RX);if(!t)return n(new MongoParseError(\"Invalid connection string\"));const s=t[1];if(-1===SUPPORTED_PROTOCOLS.indexOf(s))return n(new MongoParseError(\"Invalid protocol provided\"));if(s===PROTOCOL_MONGODB_SRV)return parseSrvConnectionString(e,r,n);const o=t[4].split(\"?\"),a=o.length>0?o[0]:null,i=o.length>1?o[1]:null;let l;try{l=parseQueryString(i,r)}catch(e){return n(e)}l=Object.assign({},l,r);const u={username:null,password:null,db:a&&\"\"!==a?qs.unescape(a):null};if(l.auth?(l.auth.username&&(u.username=l.auth.username),l.auth.user&&(u.username=l.auth.user),l.auth.password&&(u.password=l.auth.password)):(l.username&&(u.username=l.username),l.user&&(u.username=l.user),l.password&&(u.password=l.password)),-1!==t[4].split(\"?\")[0].indexOf(\"@\"))return n(new MongoParseError(\"Unescaped slash in userinfo section\"));const c=t[3].split(\"@\");if(c.length>2)return n(new MongoParseError(\"Unescaped at-sign in authority section\"));if(c.length>1){const e=c.shift().split(\":\");if(e.length>2)return n(new MongoParseError(\"Unescaped colon in authority section\"));u.username||(u.username=qs.unescape(e[0])),u.password||(u.password=e[1]?qs.unescape(e[1]):null)}let p=null;const m=c.shift().split(\",\").map(e=>{let r=URL.parse(`mongodb://${e}`);if(\"/:\"===r.path)return p=new MongoParseError(\"Double colon in host identifier\"),null;if(e.match(/\\.sock/)&&(r.hostname=qs.unescape(e),r.port=null),Number.isNaN(r.port))return void(p=new MongoParseError(\"Invalid port (non-numeric string)\"));const n={host:r.hostname,port:r.port?parseInt(r.port):27017};if(0!==n.port)if(n.port>65535)p=new MongoParseError(\"Invalid port (larger than 65535) with hostname\");else{if(!(n.port<0))return n;p=new MongoParseError(\"Invalid port (negative number)\")}else p=new MongoParseError(\"Invalid port (zero) with hostname\")}).filter(e=>!!e);if(p)return n(p);if(0===m.length||\"\"===m[0].host||null===m[0].host)return n(new MongoParseError(\"No hostname or hostnames provided in connection string\"));const h={hosts:m,auth:u.db||u.username?u:null,options:Object.keys(l).length?l:null};h.auth&&h.auth.db?h.defaultDatabase=h.auth.db:h.defaultDatabase=\"test\";try{applyAuthExpectations(h)}catch(e){return n(e)}n(null,h)}module.exports=parseConnectionString;","node_modules/bson/lib/bson/bson.js":"\"use strict\";var Map=require(\"./map\"),Long=require(\"./long\"),Double=require(\"./double\"),Timestamp=require(\"./timestamp\"),ObjectID=require(\"./objectid\"),BSONRegExp=require(\"./regexp\"),Symbol=require(\"./symbol\"),Int32=require(\"./int_32\"),Code=require(\"./code\"),Decimal128=require(\"./decimal128\"),MinKey=require(\"./min_key\"),MaxKey=require(\"./max_key\"),DBRef=require(\"./db_ref\"),Binary=require(\"./binary\"),deserialize=require(\"./parser/deserializer\"),serializer=require(\"./parser/serializer\"),calculateObjectSize=require(\"./parser/calculate_size\"),utils=require(\"./parser/utils\"),MAXSIZE=17825792,buffer=utils.allocBuffer(MAXSIZE),BSON=function(){};BSON.prototype.serialize=function(e,r){var i=\"boolean\"==typeof(r=r||{}).checkKeys&&r.checkKeys,o=\"boolean\"==typeof r.serializeFunctions&&r.serializeFunctions,B=\"boolean\"!=typeof r.ignoreUndefined||r.ignoreUndefined,N=\"number\"==typeof r.minInternalBufferSize?r.minInternalBufferSize:MAXSIZE;buffer.length<N&&(buffer=utils.allocBuffer(N));var S=serializer(buffer,e,i,0,0,o,B,[]),t=utils.allocBuffer(S);return buffer.copy(t,0,0,t.length),t},BSON.prototype.serializeWithBufferAndIndex=function(e,r,i){var o=\"boolean\"==typeof(i=i||{}).checkKeys&&i.checkKeys,B=\"boolean\"==typeof i.serializeFunctions&&i.serializeFunctions,N=\"boolean\"!=typeof i.ignoreUndefined||i.ignoreUndefined,S=\"number\"==typeof i.index?i.index:0;return serializer(r,e,o,S||0,0,B,N)-1},BSON.prototype.deserialize=function(e,r){return deserialize(e,r)},BSON.prototype.calculateObjectSize=function(e,r){var i=\"boolean\"==typeof(r=r||{}).serializeFunctions&&r.serializeFunctions,o=\"boolean\"!=typeof r.ignoreUndefined||r.ignoreUndefined;return calculateObjectSize(e,i,o)},BSON.prototype.deserializeStream=function(e,r,i,o,B,N){N=null!=N?N:{};for(var S=r,t=0;t<i;t++){var n=e[S]|e[S+1]<<8|e[S+2]<<16|e[S+3]<<24;N.index=S,o[B+t]=this.deserialize(e,N),S+=n}return S},BSON.BSON_INT32_MAX=2147483647,BSON.BSON_INT32_MIN=-2147483648,BSON.BSON_INT64_MAX=Math.pow(2,63)-1,BSON.BSON_INT64_MIN=-Math.pow(2,63),BSON.JS_INT_MAX=9007199254740992,BSON.JS_INT_MIN=-9007199254740992,BSON.BSON_DATA_NUMBER=1,BSON.BSON_DATA_STRING=2,BSON.BSON_DATA_OBJECT=3,BSON.BSON_DATA_ARRAY=4,BSON.BSON_DATA_BINARY=5,BSON.BSON_DATA_OID=7,BSON.BSON_DATA_BOOLEAN=8,BSON.BSON_DATA_DATE=9,BSON.BSON_DATA_NULL=10,BSON.BSON_DATA_REGEXP=11,BSON.BSON_DATA_CODE=13,BSON.BSON_DATA_SYMBOL=14,BSON.BSON_DATA_CODE_W_SCOPE=15,BSON.BSON_DATA_INT=16,BSON.BSON_DATA_TIMESTAMP=17,BSON.BSON_DATA_LONG=18,BSON.BSON_DATA_MIN_KEY=255,BSON.BSON_DATA_MAX_KEY=127,BSON.BSON_BINARY_SUBTYPE_DEFAULT=0,BSON.BSON_BINARY_SUBTYPE_FUNCTION=1,BSON.BSON_BINARY_SUBTYPE_BYTE_ARRAY=2,BSON.BSON_BINARY_SUBTYPE_UUID=3,BSON.BSON_BINARY_SUBTYPE_MD5=4,BSON.BSON_BINARY_SUBTYPE_USER_DEFINED=128,module.exports=BSON,module.exports.Code=Code,module.exports.Map=Map,module.exports.Symbol=Symbol,module.exports.BSON=BSON,module.exports.DBRef=DBRef,module.exports.Binary=Binary,module.exports.ObjectID=ObjectID,module.exports.Long=Long,module.exports.Timestamp=Timestamp,module.exports.Double=Double,module.exports.Int32=Int32,module.exports.MinKey=MinKey,module.exports.MaxKey=MaxKey,module.exports.BSONRegExp=BSONRegExp,module.exports.Decimal128=Decimal128;","node_modules/bson/lib/bson/binary.js":"if(\"undefined\"!=typeof global)var Buffer=require(\"buffer\").Buffer;var utils=require(\"./parser/utils\");function Binary(r,t){if(!(this instanceof Binary))return new Binary(r,t);if(!(null==r||\"string\"==typeof r||Buffer.isBuffer(r)||r instanceof Uint8Array||Array.isArray(r)))throw new Error(\"only String, Buffer, Uint8Array or Array accepted\");if(this._bsontype=\"Binary\",r instanceof Number?(this.sub_type=r,this.position=0):(this.sub_type=null==t?BSON_BINARY_SUBTYPE_DEFAULT:t,this.position=0),null==r||r instanceof Number)void 0!==Buffer?this.buffer=utils.allocBuffer(Binary.BUFFER_SIZE):\"undefined\"!=typeof Uint8Array?this.buffer=new Uint8Array(new ArrayBuffer(Binary.BUFFER_SIZE)):this.buffer=new Array(Binary.BUFFER_SIZE),this.position=0;else{if(\"string\"==typeof r)if(void 0!==Buffer)this.buffer=utils.toBuffer(r);else{if(\"undefined\"==typeof Uint8Array&&\"[object Array]\"!==Object.prototype.toString.call(r))throw new Error(\"only String, Buffer, Uint8Array or Array accepted\");this.buffer=writeStringToArray(r)}else this.buffer=r;this.position=r.length}}Binary.prototype.put=function(r){if(null!=r.length&&\"number\"!=typeof r&&1!==r.length)throw new Error(\"only accepts single character String, Uint8Array or Array\");if(\"number\"!=typeof r&&r<0||r>255)throw new Error(\"only accepts number in a valid unsigned byte range 0-255\");var t=null;if(t=\"string\"==typeof r?r.charCodeAt(0):null!=r.length?r[0]:r,this.buffer.length>this.position)this.buffer[this.position++]=t;else if(void 0!==Buffer&&Buffer.isBuffer(this.buffer)){var i=utils.allocBuffer(Binary.BUFFER_SIZE+this.buffer.length);this.buffer.copy(i,0,0,this.buffer.length),this.buffer=i,this.buffer[this.position++]=t}else{i=null,i=\"[object Uint8Array]\"===Object.prototype.toString.call(this.buffer)?new Uint8Array(new ArrayBuffer(Binary.BUFFER_SIZE+this.buffer.length)):new Array(Binary.BUFFER_SIZE+this.buffer.length);for(var e=0;e<this.buffer.length;e++)i[e]=this.buffer[e];this.buffer=i,this.buffer[this.position++]=t}},Binary.prototype.write=function(r,t){if(t=\"number\"==typeof t?t:this.position,this.buffer.length<t+r.length){var i=null;if(void 0!==Buffer&&Buffer.isBuffer(this.buffer))i=utils.allocBuffer(this.buffer.length+r.length),this.buffer.copy(i,0,0,this.buffer.length);else if(\"[object Uint8Array]\"===Object.prototype.toString.call(this.buffer)){i=new Uint8Array(new ArrayBuffer(this.buffer.length+r.length));for(var e=0;e<this.position;e++)i[e]=this.buffer[e]}this.buffer=i}if(void 0!==Buffer&&Buffer.isBuffer(r)&&Buffer.isBuffer(this.buffer))r.copy(this.buffer,t,0,r.length),this.position=t+r.length>this.position?t+r.length:this.position;else if(void 0!==Buffer&&\"string\"==typeof r&&Buffer.isBuffer(this.buffer))this.buffer.write(r,t,\"binary\"),this.position=t+r.length>this.position?t+r.length:this.position;else if(\"[object Uint8Array]\"===Object.prototype.toString.call(r)||\"[object Array]\"===Object.prototype.toString.call(r)&&\"string\"!=typeof r){for(e=0;e<r.length;e++)this.buffer[t++]=r[e];this.position=t>this.position?t:this.position}else if(\"string\"==typeof r){for(e=0;e<r.length;e++)this.buffer[t++]=r.charCodeAt(e);this.position=t>this.position?t:this.position}},Binary.prototype.read=function(r,t){if(t=t&&t>0?t:this.position,this.buffer.slice)return this.buffer.slice(r,r+t);for(var i=\"undefined\"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(t)):new Array(t),e=0;e<t;e++)i[e]=this.buffer[r++];return i},Binary.prototype.value=function(r){if((r=null!=r&&r)&&void 0!==Buffer&&Buffer.isBuffer(this.buffer)&&this.buffer.length===this.position)return this.buffer;if(void 0!==Buffer&&Buffer.isBuffer(this.buffer))return r?this.buffer.slice(0,this.position):this.buffer.toString(\"binary\",0,this.position);if(r){if(null!=this.buffer.slice)return this.buffer.slice(0,this.position);for(var t=\"[object Uint8Array]\"===Object.prototype.toString.call(this.buffer)?new Uint8Array(new ArrayBuffer(this.position)):new Array(this.position),i=0;i<this.position;i++)t[i]=this.buffer[i];return t}return convertArraytoUtf8BinaryString(this.buffer,0,this.position)},Binary.prototype.length=function(){return this.position},Binary.prototype.toJSON=function(){return null!=this.buffer?this.buffer.toString(\"base64\"):\"\"},Binary.prototype.toString=function(r){return null!=this.buffer?this.buffer.slice(0,this.position).toString(r):\"\"};var BSON_BINARY_SUBTYPE_DEFAULT=0,writeStringToArray=function(r){for(var t=\"undefined\"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(r.length)):new Array(r.length),i=0;i<r.length;i++)t[i]=r.charCodeAt(i);return t},convertArraytoUtf8BinaryString=function(r,t,i){for(var e=\"\",f=t;f<i;f++)e+=String.fromCharCode(r[f]);return e};Binary.BUFFER_SIZE=256,Binary.SUBTYPE_DEFAULT=0,Binary.SUBTYPE_FUNCTION=1,Binary.SUBTYPE_BYTE_ARRAY=2,Binary.SUBTYPE_UUID_OLD=3,Binary.SUBTYPE_UUID=4,Binary.SUBTYPE_MD5=5,Binary.SUBTYPE_USER_DEFINED=128,module.exports=Binary,module.exports.Binary=Binary;","node_modules/bson/lib/bson/code.js":"var Code=function o(e,t){if(!(this instanceof o))return new o(e,t);this._bsontype=\"Code\",this.code=e,this.scope=t};Code.prototype.toJSON=function(){return{scope:this.scope,code:this.code}},module.exports=Code,module.exports.Code=Code;","node_modules/bson/lib/bson/db_ref.js":"function DBRef(e,t,i){if(!(this instanceof DBRef))return new DBRef(e,t,i);this._bsontype=\"DBRef\",this.namespace=e,this.oid=t,this.db=i}DBRef.prototype.toJSON=function(){return{$ref:this.namespace,$id:this.oid,$db:null==this.db?\"\":this.db}},module.exports=DBRef,module.exports.DBRef=DBRef;","node_modules/bson/lib/bson/decimal128.js":"\"use strict\";var Long=require(\"./long\"),PARSE_STRING_REGEXP=/^(\\+|-)?(\\d+|(\\d*\\.\\d*))?(E|e)?([-+])?(\\d+)?$/,PARSE_INF_REGEXP=/^(\\+|-)?(Infinity|inf)$/i,PARSE_NAN_REGEXP=/^(\\+|-)?NaN$/i,EXPONENT_MAX=6111,EXPONENT_MIN=-6176,EXPONENT_BIAS=6176,MAX_DIGITS=34,NAN_BUFFER=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),INF_NEGATIVE_BUFFER=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),INF_POSITIVE_BUFFER=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),EXPONENT_REGEX=/^([-+])?(\\d+)?$/,utils=require(\"./parser/utils\"),isDigit=function(r){return!isNaN(parseInt(r,10))},divideu128=function(r){var i=Long.fromNumber(1e9),e=Long.fromNumber(0),o=0;if(!(r.parts[0]||r.parts[1]||r.parts[2]||r.parts[3]))return{quotient:r,rem:e};for(o=0;o<=3;o++)e=(e=e.shiftLeft(32)).add(new Long(r.parts[o],0)),r.parts[o]=e.div(i).low_,e=e.modulo(i);return{quotient:r,rem:e}},multiply64x2=function(r,i){if(!r&&!i)return{high:Long.fromNumber(0),low:Long.fromNumber(0)};var e=r.shiftRightUnsigned(32),o=new Long(r.getLowBits(),0),t=i.shiftRightUnsigned(32),n=new Long(i.getLowBits(),0),f=e.multiply(t),N=e.multiply(n),h=o.multiply(t),g=o.multiply(n);return f=f.add(N.shiftRightUnsigned(32)),N=new Long(N.getLowBits(),0).add(h).add(g.shiftRightUnsigned(32)),{high:f=f.add(N.shiftRightUnsigned(32)),low:g=N.shiftLeft(32).add(new Long(g.getLowBits(),0))}},lessThan=function(r,i){var e=r.high_>>>0,o=i.high_>>>0;return e<o||e===o&&r.low_>>>0<i.low_>>>0},Decimal128=function(r){this._bsontype=\"Decimal128\",this.bytes=r};Decimal128.fromString=function(r){var i,e=!1,o=!1,t=!1,n=0,f=0,N=0,h=0,g=0,u=[0],a=0,l=0,s=0,m=0,E=0,_=0,I=[0,0],w=[0,0],d=0;if((r=r.trim()).length>=7e3)throw new Error(r+\" not a valid Decimal128 string\");var p=r.match(PARSE_STRING_REGEXP),L=r.match(PARSE_INF_REGEXP),A=r.match(PARSE_NAN_REGEXP);if(!p&&!L&&!A||0===r.length)throw new Error(r+\" not a valid Decimal128 string\");if(p&&p[4]&&void 0===p[2])throw new Error(r+\" not a valid Decimal128 string\");if(\"+\"!==r[d]&&\"-\"!==r[d]||(e=\"-\"===r[d++]),!isDigit(r[d])&&\".\"!==r[d]){if(\"i\"===r[d]||\"I\"===r[d])return new Decimal128(utils.toBuffer(e?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER));if(\"N\"===r[d])return new Decimal128(utils.toBuffer(NAN_BUFFER))}for(;isDigit(r[d])||\".\"===r[d];)if(\".\"!==r[d])a<34&&(\"0\"!==r[d]||t)&&(t||(g=f),t=!0,u[l++]=parseInt(r[d],10),a+=1),t&&(N+=1),o&&(h+=1),f+=1,d+=1;else{if(o)return new Decimal128(utils.toBuffer(NAN_BUFFER));o=!0,d+=1}if(o&&!f)throw new Error(r+\" not a valid Decimal128 string\");if(\"e\"===r[d]||\"E\"===r[d]){var T=r.substr(++d).match(EXPONENT_REGEX);if(!T||!T[2])return new Decimal128(utils.toBuffer(NAN_BUFFER));E=parseInt(T[0],10),d+=T[0].length}if(r[d])return new Decimal128(utils.toBuffer(NAN_BUFFER));if(s=0,a){if(m=a-1,n=N,0!==E&&1!==n)for(;\"0\"===r[g+n-1];)n-=1}else s=0,m=0,u[0]=0,N=1,a=1,n=0;for(E<=h&&h-E>16384?E=EXPONENT_MIN:E-=h;E>EXPONENT_MAX;){if((m+=1)-s>MAX_DIGITS){var F=u.join(\"\");if(F.match(/^0+$/)){E=EXPONENT_MAX;break}return new Decimal128(utils.toBuffer(e?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER))}E-=1}for(;E<EXPONENT_MIN||a<N;){if(0===m){E=EXPONENT_MIN,n=0;break}if(a<N?N-=1:m-=1,!(E<EXPONENT_MAX)){if((F=u.join(\"\")).match(/^0+$/)){E=EXPONENT_MAX;break}return new Decimal128(utils.toBuffer(e?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER))}E+=1}if(m-s+1<n&&\"0\"!==r[n]){var O=f;o&&E===EXPONENT_MIN&&(g+=1,O+=1);var c=parseInt(r[g+m+1],10),B=0;if(c>=5&&(B=1,5===c))for(B=u[m]%2==1,_=g+m+2;_<O;_++)if(parseInt(r[_],10)){B=1;break}if(B)for(var R=m;R>=0&&++u[R]>9;R--)if(u[R]=0,0===R){if(!(E<EXPONENT_MAX))return new Decimal128(utils.toBuffer(e?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER));E+=1,u[R]=1}}if(I=Long.fromNumber(0),w=Long.fromNumber(0),0===n)I=Long.fromNumber(0),w=Long.fromNumber(0);else if(m-s<17)for(R=s,w=Long.fromNumber(u[R++]),I=new Long(0,0);R<=m;R++)w=(w=w.multiply(Long.fromNumber(10))).add(Long.fromNumber(u[R]));else{for(R=s,I=Long.fromNumber(u[R++]);R<=m-17;R++)I=(I=I.multiply(Long.fromNumber(10))).add(Long.fromNumber(u[R]));for(w=Long.fromNumber(u[R++]);R<=m;R++)w=(w=w.multiply(Long.fromNumber(10))).add(Long.fromNumber(u[R]))}var b=multiply64x2(I,Long.fromString(\"100000000000000000\"));b.low=b.low.add(w),lessThan(b.low,w)&&(b.high=b.high.add(Long.fromNumber(1))),i=E+EXPONENT_BIAS;var P={low:Long.fromNumber(0),high:Long.fromNumber(0)};b.high.shiftRightUnsigned(49).and(Long.fromNumber(1)).equals(Long.fromNumber)?(P.high=P.high.or(Long.fromNumber(3).shiftLeft(61)),P.high=P.high.or(Long.fromNumber(i).and(Long.fromNumber(16383).shiftLeft(47))),P.high=P.high.or(b.high.and(Long.fromNumber(0x7fffffffffff)))):(P.high=P.high.or(Long.fromNumber(16383&i).shiftLeft(49)),P.high=P.high.or(b.high.and(Long.fromNumber(562949953421311)))),P.low=b.low,e&&(P.high=P.high.or(Long.fromString(\"9223372036854775808\")));var X=utils.allocBuffer(16);return d=0,X[d++]=255&P.low.low_,X[d++]=P.low.low_>>8&255,X[d++]=P.low.low_>>16&255,X[d++]=P.low.low_>>24&255,X[d++]=255&P.low.high_,X[d++]=P.low.high_>>8&255,X[d++]=P.low.high_>>16&255,X[d++]=P.low.high_>>24&255,X[d++]=255&P.high.low_,X[d++]=P.high.low_>>8&255,X[d++]=P.high.low_>>16&255,X[d++]=P.high.low_>>24&255,X[d++]=255&P.high.high_,X[d++]=P.high.high_>>8&255,X[d++]=P.high.high_>>16&255,X[d++]=P.high.high_>>24&255,new Decimal128(X)};var COMBINATION_MASK=31,EXPONENT_MASK=16383,COMBINATION_INFINITY=30,COMBINATION_NAN=31;EXPONENT_BIAS=6176,Decimal128.prototype.toString=function(){for(var r,i,e,o,t,n,f=0,N=new Array(36),h=0;h<N.length;h++)N[h]=0;var g,u,a,l,s,m=0,E=!1,_={parts:new Array(4)},I=[];m=0;var w=this.bytes;if(o=w[m++]|w[m++]<<8|w[m++]<<16|w[m++]<<24,e=w[m++]|w[m++]<<8|w[m++]<<16|w[m++]<<24,i=w[m++]|w[m++]<<8|w[m++]<<16|w[m++]<<24,r=w[m++]|w[m++]<<8|w[m++]<<16|w[m++]<<24,m=0,{low:new Long(o,e),high:new Long(i,r)}.high.lessThan(Long.ZERO)&&I.push(\"-\"),(t=r>>26&COMBINATION_MASK)>>3==3){if(t===COMBINATION_INFINITY)return I.join(\"\")+\"Infinity\";if(t===COMBINATION_NAN)return\"NaN\";n=r>>15&EXPONENT_MASK,a=8+(r>>14&1)}else a=r>>14&7,n=r>>17&EXPONENT_MASK;if(g=n-EXPONENT_BIAS,_.parts[0]=(16383&r)+((15&a)<<14),_.parts[1]=i,_.parts[2]=e,_.parts[3]=o,0===_.parts[0]&&0===_.parts[1]&&0===_.parts[2]&&0===_.parts[3])E=!0;else for(s=3;s>=0;s--){var d=0,p=divideu128(_);if(_=p.quotient,d=p.rem.low_)for(l=8;l>=0;l--)N[9*s+l]=d%10,d=Math.floor(d/10)}if(E)f=1,N[m]=0;else for(f=36,h=0;!N[m];)h++,f-=1,m+=1;if((u=f-1+g)>=34||u<=-7||g>0){for(I.push(N[m++]),(f-=1)&&I.push(\".\"),h=0;h<f;h++)I.push(N[m++]);I.push(\"E\"),u>0?I.push(\"+\"+u):I.push(u)}else if(g>=0)for(h=0;h<f;h++)I.push(N[m++]);else{var L=f+g;if(L>0)for(h=0;h<L;h++)I.push(N[m++]);else I.push(\"0\");for(I.push(\".\");L++<0;)I.push(\"0\");for(h=0;h<f-Math.max(L-1,0);h++)I.push(N[m++])}return I.join(\"\")},Decimal128.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},module.exports=Decimal128,module.exports.Decimal128=Decimal128;","node_modules/bson/lib/bson/double.js":"function Double(e){if(!(this instanceof Double))return new Double(e);this._bsontype=\"Double\",this.value=e}Double.prototype.valueOf=function(){return this.value},Double.prototype.toJSON=function(){return this.value},module.exports=Double,module.exports.Double=Double;","node_modules/bson/lib/bson/int_32.js":"var Int32=function(t){if(!(this instanceof Int32))return new Int32(t);this._bsontype=\"Int32\",this.value=t};Int32.prototype.valueOf=function(){return this.value},Int32.prototype.toJSON=function(){return this.value},module.exports=Int32,module.exports.Int32=Int32;","node_modules/bson/lib/bson/long.js":"function Long(t,o){if(!(this instanceof Long))return new Long(t,o);this._bsontype=\"Long\",this.low_=0|t,this.high_=0|o}Long.prototype.toInt=function(){return this.low_},Long.prototype.toNumber=function(){return this.high_*Long.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},Long.prototype.toJSON=function(){return this.toString()},Long.prototype.toString=function(t){var o=t||10;if(o<2||36<o)throw Error(\"radix out of range: \"+o);if(this.isZero())return\"0\";if(this.isNegative()){if(this.equals(Long.MIN_VALUE)){var n=Long.fromNumber(o),r=this.div(n),i=r.multiply(n).subtract(this);return r.toString(o)+i.toInt().toString(o)}return\"-\"+this.negate().toString(o)}var e=Long.fromNumber(Math.pow(o,6));i=this;for(var g=\"\";!i.isZero();){var s=i.div(e),h=i.subtract(s.multiply(e)).toInt().toString(o);if((i=s).isZero())return h+g;for(;h.length<6;)h=\"0\"+h;g=\"\"+h+g}},Long.prototype.getHighBits=function(){return this.high_},Long.prototype.getLowBits=function(){return this.low_},Long.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:Long.TWO_PWR_32_DBL_+this.low_},Long.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(Long.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var t=0!==this.high_?this.high_:this.low_,o=31;o>0&&0==(t&1<<o);o--);return 0!==this.high_?o+33:o+1},Long.prototype.isZero=function(){return 0===this.high_&&0===this.low_},Long.prototype.isNegative=function(){return this.high_<0},Long.prototype.isOdd=function(){return 1==(1&this.low_)},Long.prototype.equals=function(t){return this.high_===t.high_&&this.low_===t.low_},Long.prototype.notEquals=function(t){return this.high_!==t.high_||this.low_!==t.low_},Long.prototype.lessThan=function(t){return this.compare(t)<0},Long.prototype.lessThanOrEqual=function(t){return this.compare(t)<=0},Long.prototype.greaterThan=function(t){return this.compare(t)>0},Long.prototype.greaterThanOrEqual=function(t){return this.compare(t)>=0},Long.prototype.compare=function(t){if(this.equals(t))return 0;var o=this.isNegative(),n=t.isNegative();return o&&!n?-1:!o&&n?1:this.subtract(t).isNegative()?-1:1},Long.prototype.negate=function(){return this.equals(Long.MIN_VALUE)?Long.MIN_VALUE:this.not().add(Long.ONE)},Long.prototype.add=function(t){var o=this.high_>>>16,n=65535&this.high_,r=this.low_>>>16,i=65535&this.low_,e=t.high_>>>16,g=65535&t.high_,s=t.low_>>>16,h=0,L=0,_=0,u=0;return _+=(u+=i+(65535&t.low_))>>>16,u&=65535,L+=(_+=r+s)>>>16,_&=65535,h+=(L+=n+g)>>>16,L&=65535,h+=o+e,h&=65535,Long.fromBits(_<<16|u,h<<16|L)},Long.prototype.subtract=function(t){return this.add(t.negate())},Long.prototype.multiply=function(t){if(this.isZero())return Long.ZERO;if(t.isZero())return Long.ZERO;if(this.equals(Long.MIN_VALUE))return t.isOdd()?Long.MIN_VALUE:Long.ZERO;if(t.equals(Long.MIN_VALUE))return this.isOdd()?Long.MIN_VALUE:Long.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(Long.TWO_PWR_24_)&&t.lessThan(Long.TWO_PWR_24_))return Long.fromNumber(this.toNumber()*t.toNumber());var o=this.high_>>>16,n=65535&this.high_,r=this.low_>>>16,i=65535&this.low_,e=t.high_>>>16,g=65535&t.high_,s=t.low_>>>16,h=65535&t.low_,L=0,_=0,u=0,a=0;return u+=(a+=i*h)>>>16,a&=65535,_+=(u+=r*h)>>>16,u&=65535,_+=(u+=i*s)>>>16,u&=65535,L+=(_+=n*h)>>>16,_&=65535,L+=(_+=r*s)>>>16,_&=65535,L+=(_+=i*g)>>>16,_&=65535,L+=o*h+n*s+r*g+i*e,L&=65535,Long.fromBits(u<<16|a,L<<16|_)},Long.prototype.div=function(t){if(t.isZero())throw Error(\"division by zero\");if(this.isZero())return Long.ZERO;if(this.equals(Long.MIN_VALUE)){if(t.equals(Long.ONE)||t.equals(Long.NEG_ONE))return Long.MIN_VALUE;if(t.equals(Long.MIN_VALUE))return Long.ONE;var o=this.shiftRight(1).div(t).shiftLeft(1);if(o.equals(Long.ZERO))return t.isNegative()?Long.ONE:Long.NEG_ONE;var n=this.subtract(t.multiply(o));return o.add(n.div(t))}if(t.equals(Long.MIN_VALUE))return Long.ZERO;if(this.isNegative())return t.isNegative()?this.negate().div(t.negate()):this.negate().div(t).negate();if(t.isNegative())return this.div(t.negate()).negate();var r=Long.ZERO;for(n=this;n.greaterThanOrEqual(t);){o=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var i=Math.ceil(Math.log(o)/Math.LN2),e=i<=48?1:Math.pow(2,i-48),g=Long.fromNumber(o),s=g.multiply(t);s.isNegative()||s.greaterThan(n);)o-=e,s=(g=Long.fromNumber(o)).multiply(t);g.isZero()&&(g=Long.ONE),r=r.add(g),n=n.subtract(s)}return r},Long.prototype.modulo=function(t){return this.subtract(this.div(t).multiply(t))},Long.prototype.not=function(){return Long.fromBits(~this.low_,~this.high_)},Long.prototype.and=function(t){return Long.fromBits(this.low_&t.low_,this.high_&t.high_)},Long.prototype.or=function(t){return Long.fromBits(this.low_|t.low_,this.high_|t.high_)},Long.prototype.xor=function(t){return Long.fromBits(this.low_^t.low_,this.high_^t.high_)},Long.prototype.shiftLeft=function(t){if(0===(t&=63))return this;var o=this.low_;if(t<32){var n=this.high_;return Long.fromBits(o<<t,n<<t|o>>>32-t)}return Long.fromBits(0,o<<t-32)},Long.prototype.shiftRight=function(t){if(0===(t&=63))return this;var o=this.high_;if(t<32){var n=this.low_;return Long.fromBits(n>>>t|o<<32-t,o>>t)}return Long.fromBits(o>>t-32,o>=0?0:-1)},Long.prototype.shiftRightUnsigned=function(t){if(0===(t&=63))return this;var o=this.high_;if(t<32){var n=this.low_;return Long.fromBits(n>>>t|o<<32-t,o>>>t)}return 32===t?Long.fromBits(o,0):Long.fromBits(o>>>t-32,0)},Long.fromInt=function(t){if(-128<=t&&t<128){var o=Long.INT_CACHE_[t];if(o)return o}var n=new Long(0|t,t<0?-1:0);return-128<=t&&t<128&&(Long.INT_CACHE_[t]=n),n},Long.fromNumber=function(t){return isNaN(t)||!isFinite(t)?Long.ZERO:t<=-Long.TWO_PWR_63_DBL_?Long.MIN_VALUE:t+1>=Long.TWO_PWR_63_DBL_?Long.MAX_VALUE:t<0?Long.fromNumber(-t).negate():new Long(t%Long.TWO_PWR_32_DBL_|0,t/Long.TWO_PWR_32_DBL_|0)},Long.fromBits=function(t,o){return new Long(t,o)},Long.fromString=function(t,o){if(0===t.length)throw Error(\"number format error: empty string\");var n=o||10;if(n<2||36<n)throw Error(\"radix out of range: \"+n);if(\"-\"===t.charAt(0))return Long.fromString(t.substring(1),n).negate();if(t.indexOf(\"-\")>=0)throw Error('number format error: interior \"-\" character: '+t);for(var r=Long.fromNumber(Math.pow(n,8)),i=Long.ZERO,e=0;e<t.length;e+=8){var g=Math.min(8,t.length-e),s=parseInt(t.substring(e,e+g),n);if(g<8){var h=Long.fromNumber(Math.pow(n,g));i=i.multiply(h).add(Long.fromNumber(s))}else i=(i=i.multiply(r)).add(Long.fromNumber(s))}return i},Long.INT_CACHE_={},Long.TWO_PWR_16_DBL_=65536,Long.TWO_PWR_24_DBL_=1<<24,Long.TWO_PWR_32_DBL_=Long.TWO_PWR_16_DBL_*Long.TWO_PWR_16_DBL_,Long.TWO_PWR_31_DBL_=Long.TWO_PWR_32_DBL_/2,Long.TWO_PWR_48_DBL_=Long.TWO_PWR_32_DBL_*Long.TWO_PWR_16_DBL_,Long.TWO_PWR_64_DBL_=Long.TWO_PWR_32_DBL_*Long.TWO_PWR_32_DBL_,Long.TWO_PWR_63_DBL_=Long.TWO_PWR_64_DBL_/2,Long.ZERO=Long.fromInt(0),Long.ONE=Long.fromInt(1),Long.NEG_ONE=Long.fromInt(-1),Long.MAX_VALUE=Long.fromBits(-1,2147483647),Long.MIN_VALUE=Long.fromBits(0,-2147483648),Long.TWO_PWR_24_=Long.fromInt(1<<24),module.exports=Long,module.exports.Long=Long;","node_modules/bson/lib/bson/map.js":"\"use strict\";if(void 0!==global.Map)module.exports=global.Map,module.exports.Map=global.Map;else{var Map=function(e){this._keys=[],this._values={};for(var t=0;t<e.length;t++)if(null!=e[t]){var s=e[t],i=s[0],o=s[1];this._keys.push(i),this._values[i]={v:o,i:this._keys.length-1}}};Map.prototype.clear=function(){this._keys=[],this._values={}},Map.prototype.delete=function(e){var t=this._values[e];return null!=t&&(delete this._values[e],this._keys.splice(t.i,1),!0)},Map.prototype.entries=function(){var e=this,t=0;return{next:function(){var s=e._keys[t++];return{value:void 0!==s?[s,e._values[s].v]:void 0,done:void 0===s}}}},Map.prototype.forEach=function(e,t){t=t||this;for(var s=0;s<this._keys.length;s++){var i=this._keys[s];e.call(t,this._values[i].v,i,t)}},Map.prototype.get=function(e){return this._values[e]?this._values[e].v:void 0},Map.prototype.has=function(e){return null!=this._values[e]},Map.prototype.keys=function(){var e=this,t=0;return{next:function(){var s=e._keys[t++];return{value:void 0!==s?s:void 0,done:void 0===s}}}},Map.prototype.set=function(e,t){return this._values[e]?(this._values[e].v=t,this):(this._keys.push(e),this._values[e]={v:t,i:this._keys.length-1},this)},Map.prototype.values=function(){var e=this,t=0;return{next:function(){var s=e._keys[t++];return{value:void 0!==s?e._values[s].v:void 0,done:void 0===s}}}},Object.defineProperty(Map.prototype,\"size\",{enumerable:!0,get:function(){return this._keys.length}}),module.exports=Map,module.exports.Map=Map}","node_modules/bson/lib/bson/max_key.js":"function MaxKey(){if(!(this instanceof MaxKey))return new MaxKey;this._bsontype=\"MaxKey\"}module.exports=MaxKey,module.exports.MaxKey=MaxKey;","node_modules/bson/lib/bson/min_key.js":"function MinKey(){if(!(this instanceof MinKey))return new MinKey;this._bsontype=\"MinKey\"}module.exports=MinKey,module.exports.MinKey=MinKey;","node_modules/bson/lib/bson/objectid.js":"var inspect=\"inspect\",utils=require(\"./parser/utils\"),MACHINE_ID=parseInt(16777215*Math.random(),10),checkForHexRegExp=new RegExp(\"^[0-9a-fA-F]{24}$\");try{if(Buffer&&Buffer.from){var hasBufferType=!0;inspect=require(\"util\").inspect.custom||\"inspect\"}}catch(t){hasBufferType=!1}for(var ObjectID=function t(e){if(e instanceof t)return e;if(!(this instanceof t))return new t(e);if(this._bsontype=\"ObjectID\",null==e||\"number\"==typeof e)return this.id=this.generate(e),void(t.cacheHexString&&(this.__id=this.toString(\"hex\")));var i=t.isValid(e);if(!i&&null!=e)throw new Error(\"Argument passed in must be a single String of 12 bytes or a string of 24 hex characters\");if(i&&\"string\"==typeof e&&24===e.length&&hasBufferType)return new t(utils.toBuffer(e,\"hex\"));if(i&&\"string\"==typeof e&&24===e.length)return t.createFromHexString(e);if(null==e||12!==e.length){if(null!=e&&e.toHexString)return e;throw new Error(\"Argument passed in must be a single String of 12 bytes or a string of 24 hex characters\")}this.id=e,t.cacheHexString&&(this.__id=this.toString(\"hex\"))},hexTable=[],i=0;i<256;i++)hexTable[i]=(i<=15?\"0\":\"\")+i.toString(16);ObjectID.prototype.toHexString=function(){if(ObjectID.cacheHexString&&this.__id)return this.__id;var t=\"\";if(!this.id||!this.id.length)throw new Error(\"invalid ObjectId, ObjectId.id must be either a string or a Buffer, but is [\"+JSON.stringify(this.id)+\"]\");if(this.id instanceof _Buffer)return t=convertToHex(this.id),ObjectID.cacheHexString&&(this.__id=t),t;for(var e=0;e<this.id.length;e++)t+=hexTable[this.id.charCodeAt(e)];return ObjectID.cacheHexString&&(this.__id=t),t},ObjectID.prototype.get_inc=function(){return ObjectID.index=(ObjectID.index+1)%16777215},ObjectID.prototype.getInc=function(){return this.get_inc()},ObjectID.prototype.generate=function(t){\"number\"!=typeof t&&(t=~~(Date.now()/1e3));var e=(\"undefined\"==typeof process||1===process.pid?Math.floor(1e5*Math.random()):process.pid)%65535,i=this.get_inc(),r=utils.allocBuffer(12);return r[3]=255&t,r[2]=t>>8&255,r[1]=t>>16&255,r[0]=t>>24&255,r[6]=255&MACHINE_ID,r[5]=MACHINE_ID>>8&255,r[4]=MACHINE_ID>>16&255,r[8]=255&e,r[7]=e>>8&255,r[11]=255&i,r[10]=i>>8&255,r[9]=i>>16&255,r},ObjectID.prototype.toString=function(t){return this.id&&this.id.copy?this.id.toString(\"string\"==typeof t?t:\"hex\"):this.toHexString()},ObjectID.prototype[inspect]=ObjectID.prototype.toString,ObjectID.prototype.toJSON=function(){return this.toHexString()},ObjectID.prototype.equals=function(t){return t instanceof ObjectID?this.toString()===t.toString():\"string\"==typeof t&&ObjectID.isValid(t)&&12===t.length&&this.id instanceof _Buffer?t===this.id.toString(\"binary\"):\"string\"==typeof t&&ObjectID.isValid(t)&&24===t.length?t.toLowerCase()===this.toHexString():\"string\"==typeof t&&ObjectID.isValid(t)&&12===t.length?t===this.id:!(null==t||!(t instanceof ObjectID||t.toHexString))&&t.toHexString()===this.toHexString()},ObjectID.prototype.getTimestamp=function(){var t=new Date,e=this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24;return t.setTime(1e3*Math.floor(e)),t},ObjectID.index=~~(16777215*Math.random()),ObjectID.createPk=function(){return new ObjectID},ObjectID.createFromTime=function(t){var e=utils.toBuffer([0,0,0,0,0,0,0,0,0,0,0,0]);return e[3]=255&t,e[2]=t>>8&255,e[1]=t>>16&255,e[0]=t>>24&255,new ObjectID(e)};var decodeLookup=[];for(i=0;i<10;)decodeLookup[48+i]=i++;for(;i<16;)decodeLookup[55+i]=decodeLookup[87+i]=i++;var _Buffer=Buffer,convertToHex=function(t){return t.toString(\"hex\")};ObjectID.createFromHexString=function(t){if(void 0===t||null!=t&&24!==t.length)throw new Error(\"Argument passed in must be a single String of 12 bytes or a string of 24 hex characters\");if(hasBufferType)return new ObjectID(utils.toBuffer(t,\"hex\"));for(var e=new _Buffer(12),i=0,r=0;r<24;)e[i++]=decodeLookup[t.charCodeAt(r++)]<<4|decodeLookup[t.charCodeAt(r++)];return new ObjectID(e)},ObjectID.isValid=function(t){return null!=t&&(\"number\"==typeof t||(\"string\"==typeof t?12===t.length||24===t.length&&checkForHexRegExp.test(t):t instanceof ObjectID||(t instanceof _Buffer||!!t.toHexString&&(12===t.id.length||24===t.id.length&&checkForHexRegExp.test(t.id)))))},Object.defineProperty(ObjectID.prototype,\"generationTime\",{enumerable:!0,get:function(){return this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24},set:function(t){this.id[3]=255&t,this.id[2]=t>>8&255,this.id[1]=t>>16&255,this.id[0]=t>>24&255}}),module.exports=ObjectID,module.exports.ObjectID=ObjectID,module.exports.ObjectId=ObjectID;","node_modules/bson/lib/bson/regexp.js":"function BSONRegExp(t,o){if(!(this instanceof BSONRegExp))return new BSONRegExp;this._bsontype=\"BSONRegExp\",this.pattern=t||\"\",this.options=o||\"\";for(var s=0;s<this.options.length;s++)if(\"i\"!==this.options[s]&&\"m\"!==this.options[s]&&\"x\"!==this.options[s]&&\"l\"!==this.options[s]&&\"s\"!==this.options[s]&&\"u\"!==this.options[s])throw new Error(\"the regular expression options [\"+this.options[s]+\"] is not supported\")}module.exports=BSONRegExp,module.exports.BSONRegExp=BSONRegExp;","node_modules/bson/lib/bson/symbol.js":"var inspect=Buffer&&require(\"util\").inspect.custom||\"inspect\";function Symbol(t){if(!(this instanceof Symbol))return new Symbol(t);this._bsontype=\"Symbol\",this.value=t}Symbol.prototype.valueOf=function(){return this.value},Symbol.prototype.toString=function(){return this.value},Symbol.prototype[inspect]=function(){return this.value},Symbol.prototype.toJSON=function(){return this.value},module.exports=Symbol,module.exports.Symbol=Symbol;","node_modules/bson/lib/bson/timestamp.js":"function Timestamp(t,i){if(!(this instanceof Timestamp))return new Timestamp(t,i);this._bsontype=\"Timestamp\",this.low_=0|t,this.high_=0|i}Timestamp.prototype.toInt=function(){return this.low_},Timestamp.prototype.toNumber=function(){return this.high_*Timestamp.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},Timestamp.prototype.toJSON=function(){return this.toString()},Timestamp.prototype.toString=function(t){var i=t||10;if(i<2||36<i)throw Error(\"radix out of range: \"+i);if(this.isZero())return\"0\";if(this.isNegative()){if(this.equals(Timestamp.MIN_VALUE)){var e=Timestamp.fromNumber(i),m=this.div(e),r=m.multiply(e).subtract(this);return m.toString(i)+r.toInt().toString(i)}return\"-\"+this.negate().toString(i)}var s=Timestamp.fromNumber(Math.pow(i,6));r=this;for(var a=\"\";!r.isZero();){var o=r.div(s),p=r.subtract(o.multiply(s)).toInt().toString(i);if((r=o).isZero())return p+a;for(;p.length<6;)p=\"0\"+p;a=\"\"+p+a}},Timestamp.prototype.getHighBits=function(){return this.high_},Timestamp.prototype.getLowBits=function(){return this.low_},Timestamp.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:Timestamp.TWO_PWR_32_DBL_+this.low_},Timestamp.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(Timestamp.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var t=0!==this.high_?this.high_:this.low_,i=31;i>0&&0==(t&1<<i);i--);return 0!==this.high_?i+33:i+1},Timestamp.prototype.isZero=function(){return 0===this.high_&&0===this.low_},Timestamp.prototype.isNegative=function(){return this.high_<0},Timestamp.prototype.isOdd=function(){return 1==(1&this.low_)},Timestamp.prototype.equals=function(t){return this.high_===t.high_&&this.low_===t.low_},Timestamp.prototype.notEquals=function(t){return this.high_!==t.high_||this.low_!==t.low_},Timestamp.prototype.lessThan=function(t){return this.compare(t)<0},Timestamp.prototype.lessThanOrEqual=function(t){return this.compare(t)<=0},Timestamp.prototype.greaterThan=function(t){return this.compare(t)>0},Timestamp.prototype.greaterThanOrEqual=function(t){return this.compare(t)>=0},Timestamp.prototype.compare=function(t){if(this.equals(t))return 0;var i=this.isNegative(),e=t.isNegative();return i&&!e?-1:!i&&e?1:this.subtract(t).isNegative()?-1:1},Timestamp.prototype.negate=function(){return this.equals(Timestamp.MIN_VALUE)?Timestamp.MIN_VALUE:this.not().add(Timestamp.ONE)},Timestamp.prototype.add=function(t){var i=this.high_>>>16,e=65535&this.high_,m=this.low_>>>16,r=65535&this.low_,s=t.high_>>>16,a=65535&t.high_,o=t.low_>>>16,p=0,n=0,h=0,_=0;return h+=(_+=r+(65535&t.low_))>>>16,_&=65535,n+=(h+=m+o)>>>16,h&=65535,p+=(n+=e+a)>>>16,n&=65535,p+=i+s,p&=65535,Timestamp.fromBits(h<<16|_,p<<16|n)},Timestamp.prototype.subtract=function(t){return this.add(t.negate())},Timestamp.prototype.multiply=function(t){if(this.isZero())return Timestamp.ZERO;if(t.isZero())return Timestamp.ZERO;if(this.equals(Timestamp.MIN_VALUE))return t.isOdd()?Timestamp.MIN_VALUE:Timestamp.ZERO;if(t.equals(Timestamp.MIN_VALUE))return this.isOdd()?Timestamp.MIN_VALUE:Timestamp.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(Timestamp.TWO_PWR_24_)&&t.lessThan(Timestamp.TWO_PWR_24_))return Timestamp.fromNumber(this.toNumber()*t.toNumber());var i=this.high_>>>16,e=65535&this.high_,m=this.low_>>>16,r=65535&this.low_,s=t.high_>>>16,a=65535&t.high_,o=t.low_>>>16,p=65535&t.low_,n=0,h=0,_=0,T=0;return _+=(T+=r*p)>>>16,T&=65535,h+=(_+=m*p)>>>16,_&=65535,h+=(_+=r*o)>>>16,_&=65535,n+=(h+=e*p)>>>16,h&=65535,n+=(h+=m*o)>>>16,h&=65535,n+=(h+=r*a)>>>16,h&=65535,n+=i*p+e*o+m*a+r*s,n&=65535,Timestamp.fromBits(_<<16|T,n<<16|h)},Timestamp.prototype.div=function(t){if(t.isZero())throw Error(\"division by zero\");if(this.isZero())return Timestamp.ZERO;if(this.equals(Timestamp.MIN_VALUE)){if(t.equals(Timestamp.ONE)||t.equals(Timestamp.NEG_ONE))return Timestamp.MIN_VALUE;if(t.equals(Timestamp.MIN_VALUE))return Timestamp.ONE;var i=this.shiftRight(1).div(t).shiftLeft(1);if(i.equals(Timestamp.ZERO))return t.isNegative()?Timestamp.ONE:Timestamp.NEG_ONE;var e=this.subtract(t.multiply(i));return i.add(e.div(t))}if(t.equals(Timestamp.MIN_VALUE))return Timestamp.ZERO;if(this.isNegative())return t.isNegative()?this.negate().div(t.negate()):this.negate().div(t).negate();if(t.isNegative())return this.div(t.negate()).negate();var m=Timestamp.ZERO;for(e=this;e.greaterThanOrEqual(t);){i=Math.max(1,Math.floor(e.toNumber()/t.toNumber()));for(var r=Math.ceil(Math.log(i)/Math.LN2),s=r<=48?1:Math.pow(2,r-48),a=Timestamp.fromNumber(i),o=a.multiply(t);o.isNegative()||o.greaterThan(e);)i-=s,o=(a=Timestamp.fromNumber(i)).multiply(t);a.isZero()&&(a=Timestamp.ONE),m=m.add(a),e=e.subtract(o)}return m},Timestamp.prototype.modulo=function(t){return this.subtract(this.div(t).multiply(t))},Timestamp.prototype.not=function(){return Timestamp.fromBits(~this.low_,~this.high_)},Timestamp.prototype.and=function(t){return Timestamp.fromBits(this.low_&t.low_,this.high_&t.high_)},Timestamp.prototype.or=function(t){return Timestamp.fromBits(this.low_|t.low_,this.high_|t.high_)},Timestamp.prototype.xor=function(t){return Timestamp.fromBits(this.low_^t.low_,this.high_^t.high_)},Timestamp.prototype.shiftLeft=function(t){if(0===(t&=63))return this;var i=this.low_;if(t<32){var e=this.high_;return Timestamp.fromBits(i<<t,e<<t|i>>>32-t)}return Timestamp.fromBits(0,i<<t-32)},Timestamp.prototype.shiftRight=function(t){if(0===(t&=63))return this;var i=this.high_;if(t<32){var e=this.low_;return Timestamp.fromBits(e>>>t|i<<32-t,i>>t)}return Timestamp.fromBits(i>>t-32,i>=0?0:-1)},Timestamp.prototype.shiftRightUnsigned=function(t){if(0===(t&=63))return this;var i=this.high_;if(t<32){var e=this.low_;return Timestamp.fromBits(e>>>t|i<<32-t,i>>>t)}return 32===t?Timestamp.fromBits(i,0):Timestamp.fromBits(i>>>t-32,0)},Timestamp.fromInt=function(t){if(-128<=t&&t<128){var i=Timestamp.INT_CACHE_[t];if(i)return i}var e=new Timestamp(0|t,t<0?-1:0);return-128<=t&&t<128&&(Timestamp.INT_CACHE_[t]=e),e},Timestamp.fromNumber=function(t){return isNaN(t)||!isFinite(t)?Timestamp.ZERO:t<=-Timestamp.TWO_PWR_63_DBL_?Timestamp.MIN_VALUE:t+1>=Timestamp.TWO_PWR_63_DBL_?Timestamp.MAX_VALUE:t<0?Timestamp.fromNumber(-t).negate():new Timestamp(t%Timestamp.TWO_PWR_32_DBL_|0,t/Timestamp.TWO_PWR_32_DBL_|0)},Timestamp.fromBits=function(t,i){return new Timestamp(t,i)},Timestamp.fromString=function(t,i){if(0===t.length)throw Error(\"number format error: empty string\");var e=i||10;if(e<2||36<e)throw Error(\"radix out of range: \"+e);if(\"-\"===t.charAt(0))return Timestamp.fromString(t.substring(1),e).negate();if(t.indexOf(\"-\")>=0)throw Error('number format error: interior \"-\" character: '+t);for(var m=Timestamp.fromNumber(Math.pow(e,8)),r=Timestamp.ZERO,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+a),e);if(a<8){var p=Timestamp.fromNumber(Math.pow(e,a));r=r.multiply(p).add(Timestamp.fromNumber(o))}else r=(r=r.multiply(m)).add(Timestamp.fromNumber(o))}return r},Timestamp.INT_CACHE_={},Timestamp.TWO_PWR_16_DBL_=65536,Timestamp.TWO_PWR_24_DBL_=1<<24,Timestamp.TWO_PWR_32_DBL_=Timestamp.TWO_PWR_16_DBL_*Timestamp.TWO_PWR_16_DBL_,Timestamp.TWO_PWR_31_DBL_=Timestamp.TWO_PWR_32_DBL_/2,Timestamp.TWO_PWR_48_DBL_=Timestamp.TWO_PWR_32_DBL_*Timestamp.TWO_PWR_16_DBL_,Timestamp.TWO_PWR_64_DBL_=Timestamp.TWO_PWR_32_DBL_*Timestamp.TWO_PWR_32_DBL_,Timestamp.TWO_PWR_63_DBL_=Timestamp.TWO_PWR_64_DBL_/2,Timestamp.ZERO=Timestamp.fromInt(0),Timestamp.ONE=Timestamp.fromInt(1),Timestamp.NEG_ONE=Timestamp.fromInt(-1),Timestamp.MAX_VALUE=Timestamp.fromBits(-1,2147483647),Timestamp.MIN_VALUE=Timestamp.fromBits(0,-2147483648),Timestamp.TWO_PWR_24_=Timestamp.fromInt(1<<24),module.exports=Timestamp,module.exports.Timestamp=Timestamp;","node_modules/bson/lib/bson/parser/deserializer.js":"\"use strict\";var Long=require(\"../long\").Long,Double=require(\"../double\").Double,Timestamp=require(\"../timestamp\").Timestamp,ObjectID=require(\"../objectid\").ObjectID,Symbol=require(\"../symbol\").Symbol,Code=require(\"../code\").Code,MinKey=require(\"../min_key\").MinKey,MaxKey=require(\"../max_key\").MaxKey,Decimal128=require(\"../decimal128\"),Int32=require(\"../int_32\"),DBRef=require(\"../db_ref\").DBRef,BSONRegExp=require(\"../regexp\").BSONRegExp,Binary=require(\"../binary\").Binary,utils=require(\"./utils\"),deserialize=function(e,r,n){var t=(r=null==r?{}:r)&&r.index?r.index:0,i=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24;if(i<5||e.length<i||i+t>e.length)throw new Error(\"corrupt bson message\");if(0!==e[t+i-1])throw new Error(\"One object, sized correctly, with a spot for an EOO, but the EOO isn't 0x00\");return deserializeObject(e,t,r,n)},deserializeObject=function(e,r,n,t){var i=null!=n.evalFunctions&&n.evalFunctions,o=null!=n.cacheFunctions&&n.cacheFunctions,l=null!=n.cacheFunctionsCrc32&&n.cacheFunctionsCrc32;if(!l)var a=null;var N=null==n.fieldsAsRaw?null:n.fieldsAsRaw,B=null!=n.raw&&n.raw,S=\"boolean\"==typeof n.bsonRegExp&&n.bsonRegExp,O=null!=n.promoteBuffers&&n.promoteBuffers,_=null==n.promoteLongs||n.promoteLongs,s=null==n.promoteValues||n.promoteValues,f=r;if(e.length<5)throw new Error(\"corrupt bson message < 5 bytes long\");var u=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24;if(u<5||u>e.length)throw new Error(\"corrupt bson message\");for(var A=t?[]:{},c=0;;){var h=e[r++];if(0===h)break;for(var w=r;0!==e[w]&&w<e.length;)w++;if(w>=e.length)throw new Error(\"Bad BSON Document: illegal CString\");var E=t?c++:e.toString(\"utf8\",r,w);if(r=w+1,h===BSON.BSON_DATA_STRING){var g=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24;if(g<=0||g>e.length-r||0!==e[r+g-1])throw new Error(\"bad string length in bson\");A[E]=e.toString(\"utf8\",r,r+g-1),r+=g}else if(h===BSON.BSON_DATA_OID){var D=utils.allocBuffer(12);e.copy(D,0,r,r+12),A[E]=new ObjectID(D),r+=12}else if(h===BSON.BSON_DATA_INT&&!1===s)A[E]=new Int32(e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24);else if(h===BSON.BSON_DATA_INT)A[E]=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24;else if(h===BSON.BSON_DATA_NUMBER&&!1===s)A[E]=new Double(e.readDoubleLE(r)),r+=8;else if(h===BSON.BSON_DATA_NUMBER)A[E]=e.readDoubleLE(r),r+=8;else if(h===BSON.BSON_DATA_DATE){var T=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24,b=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24;A[E]=new Date(new Long(T,b).toNumber())}else if(h===BSON.BSON_DATA_BOOLEAN){if(0!==e[r]&&1!==e[r])throw new Error(\"illegal boolean type value\");A[E]=1===e[r++]}else if(h===BSON.BSON_DATA_OBJECT){var y=r,d=e[r]|e[r+1]<<8|e[r+2]<<16|e[r+3]<<24;if(d<=0||d>e.length-r)throw new Error(\"bad embedded document length in bson\");A[E]=B?e.slice(r,r+d):deserializeObject(e,y,n,!1),r+=d}else if(h===BSON.BSON_DATA_ARRAY){y=r;var p=n,v=r+(d=e[r]|e[r+1]<<8|e[r+2]<<16|e[r+3]<<24);if(N&&N[E]){for(var m in p={},n)p[m]=n[m];p.raw=!0}if(A[E]=deserializeObject(e,y,p,!0),0!==e[(r+=d)-1])throw new Error(\"invalid array terminator byte\");if(r!==v)throw new Error(\"corrupted array bson\")}else if(h===BSON.BSON_DATA_UNDEFINED)A[E]=void 0;else if(h===BSON.BSON_DATA_NULL)A[E]=null;else if(h===BSON.BSON_DATA_LONG){T=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24,b=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24;var I=new Long(T,b);A[E]=_&&!0===s&&I.lessThanOrEqual(JS_INT_MAX_LONG)&&I.greaterThanOrEqual(JS_INT_MIN_LONG)?I.toNumber():I}else if(h===BSON.BSON_DATA_DECIMAL128){var R=utils.allocBuffer(16);e.copy(R,0,r,r+16),r+=16;var M=new Decimal128(R);A[E]=M.toObject?M.toObject():M}else if(h===BSON.BSON_DATA_BINARY){var C=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24,Y=C,L=e[r++];if(C<0)throw new Error(\"Negative binary type element size found\");if(C>e.length)throw new Error(\"Binary type size larger than document size\");if(null!=e.slice){if(L===Binary.SUBTYPE_BYTE_ARRAY){if((C=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)<0)throw new Error(\"Negative binary type element size found for subtype 0x02\");if(C>Y-4)throw new Error(\"Binary type with subtype 0x02 contains to long binary size\");if(C<Y-4)throw new Error(\"Binary type with subtype 0x02 contains to short binary size\")}A[E]=O&&s?e.slice(r,r+C):new Binary(e.slice(r,r+C),L)}else{var x=\"undefined\"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(C)):new Array(C);if(L===Binary.SUBTYPE_BYTE_ARRAY){if((C=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)<0)throw new Error(\"Negative binary type element size found for subtype 0x02\");if(C>Y-4)throw new Error(\"Binary type with subtype 0x02 contains to long binary size\");if(C<Y-4)throw new Error(\"Binary type with subtype 0x02 contains to short binary size\")}for(w=0;w<C;w++)x[w]=e[r+w];A[E]=O&&s?x:new Binary(x,L)}r+=C}else if(h===BSON.BSON_DATA_REGEXP&&!1===S){for(w=r;0!==e[w]&&w<e.length;)w++;if(w>=e.length)throw new Error(\"Bad BSON Document: illegal CString\");var U=e.toString(\"utf8\",r,w);for(w=r=w+1;0!==e[w]&&w<e.length;)w++;if(w>=e.length)throw new Error(\"Bad BSON Document: illegal CString\");var z=e.toString(\"utf8\",r,w);r=w+1;var j=new Array(z.length);for(w=0;w<z.length;w++)switch(z[w]){case\"m\":j[w]=\"m\";break;case\"s\":j[w]=\"g\";break;case\"i\":j[w]=\"i\"}A[E]=new RegExp(U,j.join(\"\"))}else if(h===BSON.BSON_DATA_REGEXP&&!0===S){for(w=r;0!==e[w]&&w<e.length;)w++;if(w>=e.length)throw new Error(\"Bad BSON Document: illegal CString\");for(U=e.toString(\"utf8\",r,w),w=r=w+1;0!==e[w]&&w<e.length;)w++;if(w>=e.length)throw new Error(\"Bad BSON Document: illegal CString\");z=e.toString(\"utf8\",r,w),r=w+1,A[E]=new BSONRegExp(U,z)}else if(h===BSON.BSON_DATA_SYMBOL){if((g=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)<=0||g>e.length-r||0!==e[r+g-1])throw new Error(\"bad string length in bson\");A[E]=new Symbol(e.toString(\"utf8\",r,r+g-1)),r+=g}else if(h===BSON.BSON_DATA_TIMESTAMP)T=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24,b=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24,A[E]=new Timestamp(T,b);else if(h===BSON.BSON_DATA_MIN_KEY)A[E]=new MinKey;else if(h===BSON.BSON_DATA_MAX_KEY)A[E]=new MaxKey;else if(h===BSON.BSON_DATA_CODE){if((g=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)<=0||g>e.length-r||0!==e[r+g-1])throw new Error(\"bad string length in bson\");var P=e.toString(\"utf8\",r,r+g-1);if(i)if(o){var q=l?a(P):P;A[E]=isolateEvalWithHash(functionCache,q,P,A)}else A[E]=isolateEval(P);else A[E]=new Code(P);r+=g}else if(h===BSON.BSON_DATA_CODE_W_SCOPE){var F=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24;if(F<13)throw new Error(\"code_w_scope total size shorter minimum expected length\");if((g=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)<=0||g>e.length-r||0!==e[r+g-1])throw new Error(\"bad string length in bson\");P=e.toString(\"utf8\",r,r+g-1),y=r+=g,d=e[r]|e[r+1]<<8|e[r+2]<<16|e[r+3]<<24;var G=deserializeObject(e,y,n,!1);if(r+=d,F<8+d+g)throw new Error(\"code_w_scope total size is to short, truncating scope\");if(F>8+d+g)throw new Error(\"code_w_scope total size is to long, clips outer document\");i?(o?(q=l?a(P):P,A[E]=isolateEvalWithHash(functionCache,q,P,A)):A[E]=isolateEval(P),A[E].scope=G):A[E]=new Code(P,G)}else{if(h!==BSON.BSON_DATA_DBPOINTER)throw new Error(\"Detected unknown BSON type \"+h.toString(16)+' for fieldname \"'+E+'\", are you using the latest BSON parser');if((g=e[r++]|e[r++]<<8|e[r++]<<16|e[r++]<<24)<=0||g>e.length-r||0!==e[r+g-1])throw new Error(\"bad string length in bson\");var K=e.toString(\"utf8\",r,r+g-1);r+=g;var X=utils.allocBuffer(12);e.copy(X,0,r,r+12),D=new ObjectID(X),r+=12;var J=K.split(\".\"),k=J.shift(),W=J.join(\".\");A[E]=new DBRef(W,D,k)}}if(u!==r-f){if(t)throw new Error(\"corrupt array bson\");throw new Error(\"corrupt object bson\")}return null!=A.$id&&(A=new DBRef(A.$ref,A.$id,A.$db)),A},isolateEvalWithHash=function(functionCache,hash,functionString,object){var value=null;return null==functionCache[hash]&&(eval(\"value = \"+functionString),functionCache[hash]=value),functionCache[hash].bind(object)},isolateEval=function(functionString){var value=null;return eval(\"value = \"+functionString),value},BSON={},functionCache=BSON.functionCache={};BSON.BSON_DATA_NUMBER=1,BSON.BSON_DATA_STRING=2,BSON.BSON_DATA_OBJECT=3,BSON.BSON_DATA_ARRAY=4,BSON.BSON_DATA_BINARY=5,BSON.BSON_DATA_UNDEFINED=6,BSON.BSON_DATA_OID=7,BSON.BSON_DATA_BOOLEAN=8,BSON.BSON_DATA_DATE=9,BSON.BSON_DATA_NULL=10,BSON.BSON_DATA_REGEXP=11,BSON.BSON_DATA_DBPOINTER=12,BSON.BSON_DATA_CODE=13,BSON.BSON_DATA_SYMBOL=14,BSON.BSON_DATA_CODE_W_SCOPE=15,BSON.BSON_DATA_INT=16,BSON.BSON_DATA_TIMESTAMP=17,BSON.BSON_DATA_LONG=18,BSON.BSON_DATA_DECIMAL128=19,BSON.BSON_DATA_MIN_KEY=255,BSON.BSON_DATA_MAX_KEY=127,BSON.BSON_BINARY_SUBTYPE_DEFAULT=0,BSON.BSON_BINARY_SUBTYPE_FUNCTION=1,BSON.BSON_BINARY_SUBTYPE_BYTE_ARRAY=2,BSON.BSON_BINARY_SUBTYPE_UUID=3,BSON.BSON_BINARY_SUBTYPE_MD5=4,BSON.BSON_BINARY_SUBTYPE_USER_DEFINED=128,BSON.BSON_INT32_MAX=2147483647,BSON.BSON_INT32_MIN=-2147483648,BSON.BSON_INT64_MAX=Math.pow(2,63)-1,BSON.BSON_INT64_MIN=-Math.pow(2,63),BSON.JS_INT_MAX=9007199254740992,BSON.JS_INT_MIN=-9007199254740992;var JS_INT_MAX_LONG=Long.fromNumber(9007199254740992),JS_INT_MIN_LONG=Long.fromNumber(-9007199254740992);module.exports=deserialize;","node_modules/bson/lib/bson/parser/serializer.js":"\"use strict\";var writeIEEE754=require(\"../float_parser\").writeIEEE754,Long=require(\"../long\").Long,Map=require(\"../map\"),Binary=require(\"../binary\").Binary,normalizedFunctionString=require(\"./utils\").normalizedFunctionString,regexp=/\\x00/,ignoreKeys=[\"$db\",\"$ref\",\"$id\",\"$clusterTime\"],isDate=function(e){return\"object\"==typeof e&&\"[object Date]\"===Object.prototype.toString.call(e)},isRegExp=function(e){return\"[object RegExp]\"===Object.prototype.toString.call(e)},serializeString=function(e,i,t,r,n){e[r++]=BSON.BSON_DATA_STRING,e[(r=r+(n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"))+1)-1]=0;var o=e.write(t,r+4,\"utf8\");return e[r+3]=o+1>>24&255,e[r+2]=o+1>>16&255,e[r+1]=o+1>>8&255,e[r]=o+1&255,r=r+4+o,e[r++]=0,r},serializeNumber=function(e,i,t,r,n){if(Math.floor(t)===t&&t>=BSON.JS_INT_MIN&&t<=BSON.JS_INT_MAX)if(t>=BSON.BSON_INT32_MIN&&t<=BSON.BSON_INT32_MAX){e[r++]=BSON.BSON_DATA_INT;var o=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\");r+=o,e[r++]=0,e[r++]=255&t,e[r++]=t>>8&255,e[r++]=t>>16&255,e[r++]=t>>24&255}else if(t>=BSON.JS_INT_MIN&&t<=BSON.JS_INT_MAX)e[r++]=BSON.BSON_DATA_NUMBER,r+=o=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0,writeIEEE754(e,t,r,\"little\",52,8),r+=8;else{e[r++]=BSON.BSON_DATA_LONG,r+=o=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0;var s=Long.fromNumber(t),a=s.getLowBits(),_=s.getHighBits();e[r++]=255&a,e[r++]=a>>8&255,e[r++]=a>>16&255,e[r++]=a>>24&255,e[r++]=255&_,e[r++]=_>>8&255,e[r++]=_>>16&255,e[r++]=_>>24&255}else e[r++]=BSON.BSON_DATA_NUMBER,r+=o=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0,writeIEEE754(e,t,r,\"little\",52,8),r+=8;return r},serializeNull=function(e,i,t,r,n){return e[r++]=BSON.BSON_DATA_NULL,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0,r},serializeBoolean=function(e,i,t,r,n){return e[r++]=BSON.BSON_DATA_BOOLEAN,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0,e[r++]=t?1:0,r},serializeDate=function(e,i,t,r,n){e[r++]=BSON.BSON_DATA_DATE,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0;var o=Long.fromNumber(t.getTime()),s=o.getLowBits(),a=o.getHighBits();return e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,e[r++]=255&a,e[r++]=a>>8&255,e[r++]=a>>16&255,e[r++]=a>>24&255,r},serializeRegExp=function(e,i,t,r,n){if(e[r++]=BSON.BSON_DATA_REGEXP,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0,t.source&&null!=t.source.match(regexp))throw Error(\"value \"+t.source+\" must not contain null bytes\");return r+=e.write(t.source,r,\"utf8\"),e[r++]=0,t.global&&(e[r++]=115),t.ignoreCase&&(e[r++]=105),t.multiline&&(e[r++]=109),e[r++]=0,r},serializeBSONRegExp=function(e,i,t,r,n){if(e[r++]=BSON.BSON_DATA_REGEXP,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0,null!=t.pattern.match(regexp))throw Error(\"pattern \"+t.pattern+\" must not contain null bytes\");return r+=e.write(t.pattern,r,\"utf8\"),e[r++]=0,r+=e.write(t.options.split(\"\").sort().join(\"\"),r,\"utf8\"),e[r++]=0,r},serializeMinMax=function(e,i,t,r,n){return null===t?e[r++]=BSON.BSON_DATA_NULL:\"MinKey\"===t._bsontype?e[r++]=BSON.BSON_DATA_MIN_KEY:e[r++]=BSON.BSON_DATA_MAX_KEY,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0,r},serializeObjectId=function(e,i,t,r,n){if(e[r++]=BSON.BSON_DATA_OID,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0,\"string\"==typeof t.id)e.write(t.id,r,\"binary\");else{if(!t.id||!t.id.copy)throw new Error(\"object [\"+JSON.stringify(t)+\"] is not a valid ObjectId\");t.id.copy(e,r,0,12)}return r+12},serializeBuffer=function(e,i,t,r,n){e[r++]=BSON.BSON_DATA_BINARY,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0;var o=t.length;return e[r++]=255&o,e[r++]=o>>8&255,e[r++]=o>>16&255,e[r++]=o>>24&255,e[r++]=BSON.BSON_BINARY_SUBTYPE_DEFAULT,t.copy(e,r,0,o),r+=o},serializeObject=function(e,i,t,r,n,o,s,a,_,l){for(var B=0;B<l.length;B++)if(l[B]===t)throw new Error(\"cyclic dependency detected\");l.push(t),e[r++]=Array.isArray(t)?BSON.BSON_DATA_ARRAY:BSON.BSON_DATA_OBJECT,r+=_?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0;var N=serializeInto(e,t,n,r,o+1,s,a,l);return l.pop(),N},serializeDecimal128=function(e,i,t,r,n){return e[r++]=BSON.BSON_DATA_DECIMAL128,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0,t.bytes.copy(e,r,0,16),r+16},serializeLong=function(e,i,t,r,n){e[r++]=\"Long\"===t._bsontype?BSON.BSON_DATA_LONG:BSON.BSON_DATA_TIMESTAMP,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0;var o=t.getLowBits(),s=t.getHighBits();return e[r++]=255&o,e[r++]=o>>8&255,e[r++]=o>>16&255,e[r++]=o>>24&255,e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,r},serializeInt32=function(e,i,t,r,n){return e[r++]=BSON.BSON_DATA_INT,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0,e[r++]=255&t,e[r++]=t>>8&255,e[r++]=t>>16&255,e[r++]=t>>24&255,r},serializeDouble=function(e,i,t,r,n){return e[r++]=BSON.BSON_DATA_NUMBER,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0,writeIEEE754(e,t,r,\"little\",52,8),r+=8},serializeFunction=function(e,i,t,r,n,o,s){e[r++]=BSON.BSON_DATA_CODE,r+=s?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0;var a=normalizedFunctionString(t),_=e.write(a,r+4,\"utf8\")+1;return e[r]=255&_,e[r+1]=_>>8&255,e[r+2]=_>>16&255,e[r+3]=_>>24&255,r=r+4+_-1,e[r++]=0,r},serializeCode=function(e,i,t,r,n,o,s,a,_){if(t.scope&&\"object\"==typeof t.scope){e[r++]=BSON.BSON_DATA_CODE_W_SCOPE;var l=_?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\");r+=l,e[r++]=0;var B=r,N=\"string\"==typeof t.code?t.code:t.code.toString();r+=4;var u=e.write(N,r+4,\"utf8\")+1;e[r]=255&u,e[r+1]=u>>8&255,e[r+2]=u>>16&255,e[r+3]=u>>24&255,e[r+4+u-1]=0,r=r+u+4;var O=serializeInto(e,t.scope,n,r,o+1,s,a);r=O-1;var S=O-B;e[B++]=255&S,e[B++]=S>>8&255,e[B++]=S>>16&255,e[B++]=S>>24&255,e[r++]=0}else{e[r++]=BSON.BSON_DATA_CODE,r+=l=_?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0,N=t.code.toString();var f=e.write(N,r+4,\"utf8\")+1;e[r]=255&f,e[r+1]=f>>8&255,e[r+2]=f>>16&255,e[r+3]=f>>24&255,r=r+4+f-1,e[r++]=0}return r},serializeBinary=function(e,i,t,r,n){e[r++]=BSON.BSON_DATA_BINARY,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0;var o=t.value(!0),s=t.position;return t.sub_type===Binary.SUBTYPE_BYTE_ARRAY&&(s+=4),e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,e[r++]=t.sub_type,t.sub_type===Binary.SUBTYPE_BYTE_ARRAY&&(s-=4,e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255),o.copy(e,r,0,t.position),r+=t.position},serializeSymbol=function(e,i,t,r,n){e[r++]=BSON.BSON_DATA_SYMBOL,r+=n?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0;var o=e.write(t.value,r+4,\"utf8\")+1;return e[r]=255&o,e[r+1]=o>>8&255,e[r+2]=o>>16&255,e[r+3]=o>>24&255,r=r+4+o-1,e[r++]=0,r},serializeDBRef=function(e,i,t,r,n,o,s){e[r++]=BSON.BSON_DATA_OBJECT,r+=s?e.write(i,r,\"ascii\"):e.write(i,r,\"utf8\"),e[r++]=0;var a,_=r,l=(a=null!=t.db?serializeInto(e,{$ref:t.namespace,$id:t.oid,$db:t.db},!1,r,n+1,o):serializeInto(e,{$ref:t.namespace,$id:t.oid},!1,r,n+1,o))-_;return e[_++]=255&l,e[_++]=l>>8&255,e[_++]=l>>16&255,e[_++]=l>>24&255,a},serializeInto=function(e,i,t,r,n,o,s,a){r=r||0,(a=a||[]).push(i);var _=r+4;if(Array.isArray(i))for(var l=0;l<i.length;l++){var B=\"\"+l,N=i[l];if(N&&N.toBSON){if(\"function\"!=typeof N.toBSON)throw new Error(\"toBSON is not a function\");N=N.toBSON()}var u=typeof N;\"string\"===u?_=serializeString(e,B,N,_,!0):\"number\"===u?_=serializeNumber(e,B,N,_,!0):\"boolean\"===u?_=serializeBoolean(e,B,N,_,!0):N instanceof Date||isDate(N)?_=serializeDate(e,B,N,_,!0):void 0===N?_=serializeNull(e,B,N,_,!0):null===N?_=serializeNull(e,B,N,_,!0):\"ObjectID\"===N._bsontype||\"ObjectId\"===N._bsontype?_=serializeObjectId(e,B,N,_,!0):Buffer.isBuffer(N)?_=serializeBuffer(e,B,N,_,!0):N instanceof RegExp||isRegExp(N)?_=serializeRegExp(e,B,N,_,!0):\"object\"===u&&null==N._bsontype?_=serializeObject(e,B,N,_,t,n,o,s,!0,a):\"object\"===u&&\"Decimal128\"===N._bsontype?_=serializeDecimal128(e,B,N,_,!0):\"Long\"===N._bsontype||\"Timestamp\"===N._bsontype?_=serializeLong(e,B,N,_,!0):\"Double\"===N._bsontype?_=serializeDouble(e,B,N,_,!0):\"function\"==typeof N&&o?_=serializeFunction(e,B,N,_,t,n,o,!0):\"Code\"===N._bsontype?_=serializeCode(e,B,N,_,t,n,o,s,!0):\"Binary\"===N._bsontype?_=serializeBinary(e,B,N,_,!0):\"Symbol\"===N._bsontype?_=serializeSymbol(e,B,N,_,!0):\"DBRef\"===N._bsontype?_=serializeDBRef(e,B,N,_,n,o,!0):\"BSONRegExp\"===N._bsontype?_=serializeBSONRegExp(e,B,N,_,!0):\"Int32\"===N._bsontype?_=serializeInt32(e,B,N,_,!0):\"MinKey\"!==N._bsontype&&\"MaxKey\"!==N._bsontype||(_=serializeMinMax(e,B,N,_,!0))}else if(i instanceof Map)for(var O=i.entries(),S=!1;!S;){var f=O.next();if(!(S=f.done)){if(B=f.value[0],u=typeof(N=f.value[1]),\"string\"==typeof B&&-1===ignoreKeys.indexOf(B)){if(null!=B.match(regexp))throw Error(\"key \"+B+\" must not contain null bytes\");if(t){if(\"$\"===B[0])throw Error(\"key \"+B+\" must not start with '$'\");if(~B.indexOf(\".\"))throw Error(\"key \"+B+\" must not contain '.'\")}}\"string\"===u?_=serializeString(e,B,N,_):\"number\"===u?_=serializeNumber(e,B,N,_):\"boolean\"===u?_=serializeBoolean(e,B,N,_):N instanceof Date||isDate(N)?_=serializeDate(e,B,N,_):null===N||void 0===N&&!1===s?_=serializeNull(e,B,N,_):\"ObjectID\"===N._bsontype||\"ObjectId\"===N._bsontype?_=serializeObjectId(e,B,N,_):Buffer.isBuffer(N)?_=serializeBuffer(e,B,N,_):N instanceof RegExp||isRegExp(N)?_=serializeRegExp(e,B,N,_):\"object\"===u&&null==N._bsontype?_=serializeObject(e,B,N,_,t,n,o,s,!1,a):\"object\"===u&&\"Decimal128\"===N._bsontype?_=serializeDecimal128(e,B,N,_):\"Long\"===N._bsontype||\"Timestamp\"===N._bsontype?_=serializeLong(e,B,N,_):\"Double\"===N._bsontype?_=serializeDouble(e,B,N,_):\"Code\"===N._bsontype?_=serializeCode(e,B,N,_,t,n,o,s):\"function\"==typeof N&&o?_=serializeFunction(e,B,N,_,t,n,o):\"Binary\"===N._bsontype?_=serializeBinary(e,B,N,_):\"Symbol\"===N._bsontype?_=serializeSymbol(e,B,N,_):\"DBRef\"===N._bsontype?_=serializeDBRef(e,B,N,_,n,o):\"BSONRegExp\"===N._bsontype?_=serializeBSONRegExp(e,B,N,_):\"Int32\"===N._bsontype?_=serializeInt32(e,B,N,_):\"MinKey\"!==N._bsontype&&\"MaxKey\"!==N._bsontype||(_=serializeMinMax(e,B,N,_))}}else{if(i.toBSON){if(\"function\"!=typeof i.toBSON)throw new Error(\"toBSON is not a function\");if(null!=(i=i.toBSON())&&\"object\"!=typeof i)throw new Error(\"toBSON function did not return an object\")}for(B in i){if((N=i[B])&&N.toBSON){if(\"function\"!=typeof N.toBSON)throw new Error(\"toBSON is not a function\");N=N.toBSON()}if(u=typeof N,\"string\"==typeof B&&-1===ignoreKeys.indexOf(B)){if(null!=B.match(regexp))throw Error(\"key \"+B+\" must not contain null bytes\");if(t){if(\"$\"===B[0])throw Error(\"key \"+B+\" must not start with '$'\");if(~B.indexOf(\".\"))throw Error(\"key \"+B+\" must not contain '.'\")}}\"string\"===u?_=serializeString(e,B,N,_):\"number\"===u?_=serializeNumber(e,B,N,_):\"boolean\"===u?_=serializeBoolean(e,B,N,_):N instanceof Date||isDate(N)?_=serializeDate(e,B,N,_):void 0===N?!1===s&&(_=serializeNull(e,B,N,_)):null===N?_=serializeNull(e,B,N,_):\"ObjectID\"===N._bsontype||\"ObjectId\"===N._bsontype?_=serializeObjectId(e,B,N,_):Buffer.isBuffer(N)?_=serializeBuffer(e,B,N,_):N instanceof RegExp||isRegExp(N)?_=serializeRegExp(e,B,N,_):\"object\"===u&&null==N._bsontype?_=serializeObject(e,B,N,_,t,n,o,s,!1,a):\"object\"===u&&\"Decimal128\"===N._bsontype?_=serializeDecimal128(e,B,N,_):\"Long\"===N._bsontype||\"Timestamp\"===N._bsontype?_=serializeLong(e,B,N,_):\"Double\"===N._bsontype?_=serializeDouble(e,B,N,_):\"Code\"===N._bsontype?_=serializeCode(e,B,N,_,t,n,o,s):\"function\"==typeof N&&o?_=serializeFunction(e,B,N,_,t,n,o):\"Binary\"===N._bsontype?_=serializeBinary(e,B,N,_):\"Symbol\"===N._bsontype?_=serializeSymbol(e,B,N,_):\"DBRef\"===N._bsontype?_=serializeDBRef(e,B,N,_,n,o):\"BSONRegExp\"===N._bsontype?_=serializeBSONRegExp(e,B,N,_):\"Int32\"===N._bsontype?_=serializeInt32(e,B,N,_):\"MinKey\"!==N._bsontype&&\"MaxKey\"!==N._bsontype||(_=serializeMinMax(e,B,N,_))}}a.pop(),e[_++]=0;var c=_-r;return e[r++]=255&c,e[r++]=c>>8&255,e[r++]=c>>16&255,e[r++]=c>>24&255,_},BSON={BSON_DATA_NUMBER:1,BSON_DATA_STRING:2,BSON_DATA_OBJECT:3,BSON_DATA_ARRAY:4,BSON_DATA_BINARY:5,BSON_DATA_UNDEFINED:6,BSON_DATA_OID:7,BSON_DATA_BOOLEAN:8,BSON_DATA_DATE:9,BSON_DATA_NULL:10,BSON_DATA_REGEXP:11,BSON_DATA_CODE:13,BSON_DATA_SYMBOL:14,BSON_DATA_CODE_W_SCOPE:15,BSON_DATA_INT:16,BSON_DATA_TIMESTAMP:17,BSON_DATA_LONG:18,BSON_DATA_DECIMAL128:19,BSON_DATA_MIN_KEY:255,BSON_DATA_MAX_KEY:127,BSON_BINARY_SUBTYPE_DEFAULT:0,BSON_BINARY_SUBTYPE_FUNCTION:1,BSON_BINARY_SUBTYPE_BYTE_ARRAY:2,BSON_BINARY_SUBTYPE_UUID:3,BSON_BINARY_SUBTYPE_MD5:4,BSON_BINARY_SUBTYPE_USER_DEFINED:128,BSON_INT32_MAX:2147483647,BSON_INT32_MIN:-2147483648};BSON.BSON_INT64_MAX=Math.pow(2,63)-1,BSON.BSON_INT64_MIN=-Math.pow(2,63),BSON.JS_INT_MAX=9007199254740992,BSON.JS_INT_MIN=-9007199254740992,module.exports=serializeInto;","node_modules/bson/lib/bson/parser/calculate_size.js":"\"use strict\";var Long=require(\"../long\").Long,Double=require(\"../double\").Double,Timestamp=require(\"../timestamp\").Timestamp,ObjectID=require(\"../objectid\").ObjectID,Symbol=require(\"../symbol\").Symbol,BSONRegExp=require(\"../regexp\").BSONRegExp,Code=require(\"../code\").Code,Decimal128=require(\"../decimal128\"),MinKey=require(\"../min_key\").MinKey,MaxKey=require(\"../max_key\").MaxKey,DBRef=require(\"../db_ref\").DBRef,Binary=require(\"../binary\").Binary,normalizedFunctionString=require(\"./utils\").normalizedFunctionString,isDate=function(e){return\"object\"==typeof e&&\"[object Date]\"===Object.prototype.toString.call(e)},calculateObjectSize=function(e,t,n){var u=5;if(Array.isArray(e))for(var r=0;r<e.length;r++)u+=calculateElement(r.toString(),e[r],t,!0,n);else for(var f in e.toBSON&&(e=e.toBSON()),e)u+=calculateElement(f,e[f],t,!1,n);return u};function calculateElement(e,t,n,u,r){switch(t&&t.toBSON&&(t=t.toBSON()),typeof t){case\"string\":return 1+Buffer.byteLength(e,\"utf8\")+1+4+Buffer.byteLength(t,\"utf8\")+1;case\"number\":return Math.floor(t)===t&&t>=BSON.JS_INT_MIN&&t<=BSON.JS_INT_MAX&&t>=BSON.BSON_INT32_MIN&&t<=BSON.BSON_INT32_MAX?(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+5:(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+9;case\"undefined\":return u||!r?(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+1:0;case\"boolean\":return(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+2;case\"object\":if(null==t||t instanceof MinKey||t instanceof MaxKey||\"MinKey\"===t._bsontype||\"MaxKey\"===t._bsontype)return(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+1;if(t instanceof ObjectID||\"ObjectID\"===t._bsontype||\"ObjectId\"===t._bsontype)return(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+13;if(t instanceof Date||isDate(t))return(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+9;if(\"undefined\"!=typeof Buffer&&Buffer.isBuffer(t))return(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+6+t.length;if(t instanceof Long||t instanceof Double||t instanceof Timestamp||\"Long\"===t._bsontype||\"Double\"===t._bsontype||\"Timestamp\"===t._bsontype)return(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+9;if(t instanceof Decimal128||\"Decimal128\"===t._bsontype)return(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+17;if(t instanceof Code||\"Code\"===t._bsontype)return null!=t.scope&&Object.keys(t.scope).length>0?(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+1+4+4+Buffer.byteLength(t.code.toString(),\"utf8\")+1+calculateObjectSize(t.scope,n,r):(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+1+4+Buffer.byteLength(t.code.toString(),\"utf8\")+1;if(t instanceof Binary||\"Binary\"===t._bsontype)return t.sub_type===Binary.SUBTYPE_BYTE_ARRAY?(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+(t.position+1+4+1+4):(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+(t.position+1+4+1);if(t instanceof Symbol||\"Symbol\"===t._bsontype)return(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+Buffer.byteLength(t.value,\"utf8\")+4+1+1;if(t instanceof DBRef||\"DBRef\"===t._bsontype){var f={$ref:t.namespace,$id:t.oid};return null!=t.db&&(f.$db=t.db),(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+1+calculateObjectSize(f,n,r)}return t instanceof RegExp||\"[object RegExp]\"===Object.prototype.toString.call(t)?(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+1+Buffer.byteLength(t.source,\"utf8\")+1+(t.global?1:0)+(t.ignoreCase?1:0)+(t.multiline?1:0)+1:t instanceof BSONRegExp||\"BSONRegExp\"===t._bsontype?(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+1+Buffer.byteLength(t.pattern,\"utf8\")+1+Buffer.byteLength(t.options,\"utf8\")+1:(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+calculateObjectSize(t,n,r)+1;case\"function\":if(t instanceof RegExp||\"[object RegExp]\"===Object.prototype.toString.call(t)||\"[object RegExp]\"===String.call(t))return(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+1+Buffer.byteLength(t.source,\"utf8\")+1+(t.global?1:0)+(t.ignoreCase?1:0)+(t.multiline?1:0)+1;if(n&&null!=t.scope&&Object.keys(t.scope).length>0)return(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+1+4+4+Buffer.byteLength(normalizedFunctionString(t),\"utf8\")+1+calculateObjectSize(t.scope,n,r);if(n)return(null!=e?Buffer.byteLength(e,\"utf8\")+1:0)+1+4+Buffer.byteLength(normalizedFunctionString(t),\"utf8\")+1}return 0}var BSON={BSON_INT32_MAX:2147483647,BSON_INT32_MIN:-2147483648,JS_INT_MAX:9007199254740992,JS_INT_MIN:-9007199254740992};module.exports=calculateObjectSize;","node_modules/bson/lib/bson/parser/utils.js":"\"use strict\";function normalizedFunctionString(f){return f.toString().replace(/function *\\(/,\"function (\")}function newBuffer(f,n){return new Buffer(f,n)}function allocBuffer(){return Buffer.alloc.apply(Buffer,arguments)}function toBuffer(){return Buffer.from.apply(Buffer,arguments)}module.exports={normalizedFunctionString:normalizedFunctionString,allocBuffer:\"function\"==typeof Buffer.alloc?allocBuffer:newBuffer,toBuffer:\"function\"==typeof Buffer.from?toBuffer:newBuffer};","node_modules/bson/lib/bson/float_parser.js":"var readIEEE754=function(a,t,o,r,E){var h,M,e=\"big\"===o,w=8*E-r-1,i=(1<<w)-1,p=i>>1,f=-7,N=e?0:E-1,n=e?1:-1,s=a[t+N];for(N+=n,h=s&(1<<-f)-1,s>>=-f,f+=w;f>0;h=256*h+a[t+N],N+=n,f-=8);for(M=h&(1<<-f)-1,h>>=-f,f+=r;f>0;M=256*M+a[t+N],N+=n,f-=8);if(0===h)h=1-p;else{if(h===i)return M?NaN:1/0*(s?-1:1);M+=Math.pow(2,r),h-=p}return(s?-1:1)*M*Math.pow(2,h-r)},writeIEEE754=function(a,t,o,r,E,h){var M,e,w,i=\"big\"===r,p=8*h-E-1,f=(1<<p)-1,N=f>>1,n=23===E?Math.pow(2,-24)-Math.pow(2,-77):0,s=i?h-1:0,I=i?-1:1,u=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(e=isNaN(t)?1:0,M=f):(M=Math.floor(Math.log(t)/Math.LN2),t*(w=Math.pow(2,-M))<1&&(M--,w*=2),(t+=M+N>=1?n/w:n*Math.pow(2,1-N))*w>=2&&(M++,w/=2),M+N>=f?(e=0,M=f):M+N>=1?(e=(t*w-1)*Math.pow(2,E),M+=N):(e=t*Math.pow(2,N-1)*Math.pow(2,E),M=0));E>=8;a[o+s]=255&e,s+=I,e/=256,E-=8);for(M=M<<E|e,p+=E;p>0;a[o+s]=255&M,s+=I,M/=256,p-=8);a[o+s-I]|=128*u};exports.readIEEE754=readIEEE754,exports.writeIEEE754=writeIEEE754;","node_modules/resolve-from/index.js":"\"use strict\";var path=require(\"path\"),Module=require(\"module\");module.exports=function(e,r){if(\"string\"!=typeof e||\"string\"!=typeof r)throw new TypeError(\"Expected `fromDir` and `moduleId` to be a string\");e=path.resolve(e);var t=path.join(e,\"noop.js\");try{return Module._resolveFilename(r,{id:t,filename:t,paths:Module._nodeModulePaths(e)})}catch(e){return null}};","node_modules/semver/semver.js":"var debug;exports=module.exports=SemVer,debug=\"object\"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\\bsemver\\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift(\"SEMVER\"),console.log.apply(console,e)}:function(){},exports.SEMVER_SPEC_VERSION=\"2.0.0\";var MAX_LENGTH=256,MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH=16,re=exports.re=[],src=exports.src=[],R=0,NUMERICIDENTIFIER=R++;src[NUMERICIDENTIFIER]=\"0|[1-9]\\\\d*\";var NUMERICIDENTIFIERLOOSE=R++;src[NUMERICIDENTIFIERLOOSE]=\"[0-9]+\";var NONNUMERICIDENTIFIER=R++;src[NONNUMERICIDENTIFIER]=\"\\\\d*[a-zA-Z-][a-zA-Z0-9-]*\";var MAINVERSION=R++;src[MAINVERSION]=\"(\"+src[NUMERICIDENTIFIER]+\")\\\\.(\"+src[NUMERICIDENTIFIER]+\")\\\\.(\"+src[NUMERICIDENTIFIER]+\")\";var MAINVERSIONLOOSE=R++;src[MAINVERSIONLOOSE]=\"(\"+src[NUMERICIDENTIFIERLOOSE]+\")\\\\.(\"+src[NUMERICIDENTIFIERLOOSE]+\")\\\\.(\"+src[NUMERICIDENTIFIERLOOSE]+\")\";var PRERELEASEIDENTIFIER=R++;src[PRERELEASEIDENTIFIER]=\"(?:\"+src[NUMERICIDENTIFIER]+\"|\"+src[NONNUMERICIDENTIFIER]+\")\";var PRERELEASEIDENTIFIERLOOSE=R++;src[PRERELEASEIDENTIFIERLOOSE]=\"(?:\"+src[NUMERICIDENTIFIERLOOSE]+\"|\"+src[NONNUMERICIDENTIFIER]+\")\";var PRERELEASE=R++;src[PRERELEASE]=\"(?:-(\"+src[PRERELEASEIDENTIFIER]+\"(?:\\\\.\"+src[PRERELEASEIDENTIFIER]+\")*))\";var PRERELEASELOOSE=R++;src[PRERELEASELOOSE]=\"(?:-?(\"+src[PRERELEASEIDENTIFIERLOOSE]+\"(?:\\\\.\"+src[PRERELEASEIDENTIFIERLOOSE]+\")*))\";var BUILDIDENTIFIER=R++;src[BUILDIDENTIFIER]=\"[0-9A-Za-z-]+\";var BUILD=R++;src[BUILD]=\"(?:\\\\+(\"+src[BUILDIDENTIFIER]+\"(?:\\\\.\"+src[BUILDIDENTIFIER]+\")*))\";var FULL=R++,FULLPLAIN=\"v?\"+src[MAINVERSION]+src[PRERELEASE]+\"?\"+src[BUILD]+\"?\";src[FULL]=\"^\"+FULLPLAIN+\"$\";var LOOSEPLAIN=\"[v=\\\\s]*\"+src[MAINVERSIONLOOSE]+src[PRERELEASELOOSE]+\"?\"+src[BUILD]+\"?\",LOOSE=R++;src[LOOSE]=\"^\"+LOOSEPLAIN+\"$\";var GTLT=R++;src[GTLT]=\"((?:<|>)?=?)\";var XRANGEIDENTIFIERLOOSE=R++;src[XRANGEIDENTIFIERLOOSE]=src[NUMERICIDENTIFIERLOOSE]+\"|x|X|\\\\*\";var XRANGEIDENTIFIER=R++;src[XRANGEIDENTIFIER]=src[NUMERICIDENTIFIER]+\"|x|X|\\\\*\";var XRANGEPLAIN=R++;src[XRANGEPLAIN]=\"[v=\\\\s]*(\"+src[XRANGEIDENTIFIER]+\")(?:\\\\.(\"+src[XRANGEIDENTIFIER]+\")(?:\\\\.(\"+src[XRANGEIDENTIFIER]+\")(?:\"+src[PRERELEASE]+\")?\"+src[BUILD]+\"?)?)?\";var XRANGEPLAINLOOSE=R++;src[XRANGEPLAINLOOSE]=\"[v=\\\\s]*(\"+src[XRANGEIDENTIFIERLOOSE]+\")(?:\\\\.(\"+src[XRANGEIDENTIFIERLOOSE]+\")(?:\\\\.(\"+src[XRANGEIDENTIFIERLOOSE]+\")(?:\"+src[PRERELEASELOOSE]+\")?\"+src[BUILD]+\"?)?)?\";var XRANGE=R++;src[XRANGE]=\"^\"+src[GTLT]+\"\\\\s*\"+src[XRANGEPLAIN]+\"$\";var XRANGELOOSE=R++;src[XRANGELOOSE]=\"^\"+src[GTLT]+\"\\\\s*\"+src[XRANGEPLAINLOOSE]+\"$\";var COERCE=R++;src[COERCE]=\"(?:^|[^\\\\d])(\\\\d{1,\"+MAX_SAFE_COMPONENT_LENGTH+\"})(?:\\\\.(\\\\d{1,\"+MAX_SAFE_COMPONENT_LENGTH+\"}))?(?:\\\\.(\\\\d{1,\"+MAX_SAFE_COMPONENT_LENGTH+\"}))?(?:$|[^\\\\d])\";var LONETILDE=R++;src[LONETILDE]=\"(?:~>?)\";var TILDETRIM=R++;src[TILDETRIM]=\"(\\\\s*)\"+src[LONETILDE]+\"\\\\s+\",re[TILDETRIM]=new RegExp(src[TILDETRIM],\"g\");var tildeTrimReplace=\"$1~\",TILDE=R++;src[TILDE]=\"^\"+src[LONETILDE]+src[XRANGEPLAIN]+\"$\";var TILDELOOSE=R++;src[TILDELOOSE]=\"^\"+src[LONETILDE]+src[XRANGEPLAINLOOSE]+\"$\";var LONECARET=R++;src[LONECARET]=\"(?:\\\\^)\";var CARETTRIM=R++;src[CARETTRIM]=\"(\\\\s*)\"+src[LONECARET]+\"\\\\s+\",re[CARETTRIM]=new RegExp(src[CARETTRIM],\"g\");var caretTrimReplace=\"$1^\",CARET=R++;src[CARET]=\"^\"+src[LONECARET]+src[XRANGEPLAIN]+\"$\";var CARETLOOSE=R++;src[CARETLOOSE]=\"^\"+src[LONECARET]+src[XRANGEPLAINLOOSE]+\"$\";var COMPARATORLOOSE=R++;src[COMPARATORLOOSE]=\"^\"+src[GTLT]+\"\\\\s*(\"+LOOSEPLAIN+\")$|^$\";var COMPARATOR=R++;src[COMPARATOR]=\"^\"+src[GTLT]+\"\\\\s*(\"+FULLPLAIN+\")$|^$\";var COMPARATORTRIM=R++;src[COMPARATORTRIM]=\"(\\\\s*)\"+src[GTLT]+\"\\\\s*(\"+LOOSEPLAIN+\"|\"+src[XRANGEPLAIN]+\")\",re[COMPARATORTRIM]=new RegExp(src[COMPARATORTRIM],\"g\");var comparatorTrimReplace=\"$1$2$3\",HYPHENRANGE=R++;src[HYPHENRANGE]=\"^\\\\s*(\"+src[XRANGEPLAIN]+\")\\\\s+-\\\\s+(\"+src[XRANGEPLAIN]+\")\\\\s*$\";var HYPHENRANGELOOSE=R++;src[HYPHENRANGELOOSE]=\"^\\\\s*(\"+src[XRANGEPLAINLOOSE]+\")\\\\s+-\\\\s+(\"+src[XRANGEPLAINLOOSE]+\")\\\\s*$\";var STAR=R++;src[STAR]=\"(<|>)?=?\\\\s*\\\\*\";for(var i=0;i<R;i++)debug(i,src[i]),re[i]||(re[i]=new RegExp(src[i]));function parse(e,r){if(r&&\"object\"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof SemVer)return e;if(\"string\"!=typeof e)return null;if(e.length>MAX_LENGTH)return null;if(!(r.loose?re[LOOSE]:re[FULL]).test(e))return null;try{return new SemVer(e,r)}catch(e){return null}}function valid(e,r){var t=parse(e,r);return t?t.version:null}function clean(e,r){var t=parse(e.trim().replace(/^[=v]+/,\"\"),r);return t?t.version:null}function SemVer(e,r){if(r&&\"object\"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof SemVer){if(e.loose===r.loose)return e;e=e.version}else if(\"string\"!=typeof e)throw new TypeError(\"Invalid Version: \"+e);if(e.length>MAX_LENGTH)throw new TypeError(\"version is longer than \"+MAX_LENGTH+\" characters\");if(!(this instanceof SemVer))return new SemVer(e,r);debug(\"SemVer\",e,r),this.options=r,this.loose=!!r.loose;var t=e.trim().match(r.loose?re[LOOSE]:re[FULL]);if(!t)throw new TypeError(\"Invalid Version: \"+e);if(this.raw=e,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>MAX_SAFE_INTEGER||this.major<0)throw new TypeError(\"Invalid major version\");if(this.minor>MAX_SAFE_INTEGER||this.minor<0)throw new TypeError(\"Invalid minor version\");if(this.patch>MAX_SAFE_INTEGER||this.patch<0)throw new TypeError(\"Invalid patch version\");t[4]?this.prerelease=t[4].split(\".\").map(function(e){if(/^[0-9]+$/.test(e)){var r=+e;if(r>=0&&r<MAX_SAFE_INTEGER)return r}return e}):this.prerelease=[],this.build=t[5]?t[5].split(\".\"):[],this.format()}function inc(e,r,t,s){\"string\"==typeof t&&(s=t,t=void 0);try{return new SemVer(e,t).inc(r,s).version}catch(e){return null}}function diff(e,r){if(eq(e,r))return null;var t=parse(e),s=parse(r),n=\"\";if(t.prerelease.length||s.prerelease.length){n=\"pre\";var o=\"prerelease\"}for(var i in t)if((\"major\"===i||\"minor\"===i||\"patch\"===i)&&t[i]!==s[i])return n+i;return o}exports.parse=parse,exports.valid=valid,exports.clean=clean,exports.SemVer=SemVer,SemVer.prototype.format=function(){return this.version=this.major+\".\"+this.minor+\".\"+this.patch,this.prerelease.length&&(this.version+=\"-\"+this.prerelease.join(\".\")),this.version},SemVer.prototype.toString=function(){return this.version},SemVer.prototype.compare=function(e){return debug(\"SemVer.compare\",this.version,this.options,e),e instanceof SemVer||(e=new SemVer(e,this.options)),this.compareMain(e)||this.comparePre(e)},SemVer.prototype.compareMain=function(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),compareIdentifiers(this.major,e.major)||compareIdentifiers(this.minor,e.minor)||compareIdentifiers(this.patch,e.patch)},SemVer.prototype.comparePre=function(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var r=0;do{var t=this.prerelease[r],s=e.prerelease[r];if(debug(\"prerelease compare\",r,t,s),void 0===t&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===t)return-1;if(t!==s)return compareIdentifiers(t,s)}while(++r)},SemVer.prototype.inc=function(e,r){switch(e){case\"premajor\":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc(\"pre\",r);break;case\"preminor\":this.prerelease.length=0,this.patch=0,this.minor++,this.inc(\"pre\",r);break;case\"prepatch\":this.prerelease.length=0,this.inc(\"patch\",r),this.inc(\"pre\",r);break;case\"prerelease\":0===this.prerelease.length&&this.inc(\"patch\",r),this.inc(\"pre\",r);break;case\"major\":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case\"minor\":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case\"patch\":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case\"pre\":if(0===this.prerelease.length)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)\"number\"==typeof this.prerelease[t]&&(this.prerelease[t]++,t=-2);-1===t&&this.prerelease.push(0)}r&&(this.prerelease[0]===r?isNaN(this.prerelease[1])&&(this.prerelease=[r,0]):this.prerelease=[r,0]);break;default:throw new Error(\"invalid increment argument: \"+e)}return this.format(),this.raw=this.version,this},exports.inc=inc,exports.diff=diff,exports.compareIdentifiers=compareIdentifiers;var numeric=/^[0-9]+$/;function compareIdentifiers(e,r){var t=numeric.test(e),s=numeric.test(r);return t&&s&&(e=+e,r=+r),e===r?0:t&&!s?-1:s&&!t?1:e<r?-1:1}function rcompareIdentifiers(e,r){return compareIdentifiers(r,e)}function major(e,r){return new SemVer(e,r).major}function minor(e,r){return new SemVer(e,r).minor}function patch(e,r){return new SemVer(e,r).patch}function compare(e,r,t){return new SemVer(e,t).compare(new SemVer(r,t))}function compareLoose(e,r){return compare(e,r,!0)}function rcompare(e,r,t){return compare(r,e,t)}function sort(e,r){return e.sort(function(e,t){return exports.compare(e,t,r)})}function rsort(e,r){return e.sort(function(e,t){return exports.rcompare(e,t,r)})}function gt(e,r,t){return compare(e,r,t)>0}function lt(e,r,t){return compare(e,r,t)<0}function eq(e,r,t){return 0===compare(e,r,t)}function neq(e,r,t){return 0!==compare(e,r,t)}function gte(e,r,t){return compare(e,r,t)>=0}function lte(e,r,t){return compare(e,r,t)<=0}function cmp(e,r,t,s){switch(r){case\"===\":return\"object\"==typeof e&&(e=e.version),\"object\"==typeof t&&(t=t.version),e===t;case\"!==\":return\"object\"==typeof e&&(e=e.version),\"object\"==typeof t&&(t=t.version),e!==t;case\"\":case\"=\":case\"==\":return eq(e,t,s);case\"!=\":return neq(e,t,s);case\">\":return gt(e,t,s);case\">=\":return gte(e,t,s);case\"<\":return lt(e,t,s);case\"<=\":return lte(e,t,s);default:throw new TypeError(\"Invalid operator: \"+r)}}function Comparator(e,r){if(r&&\"object\"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof Comparator){if(e.loose===!!r.loose)return e;e=e.value}if(!(this instanceof Comparator))return new Comparator(e,r);debug(\"comparator\",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===ANY?this.value=\"\":this.value=this.operator+this.semver.version,debug(\"comp\",this)}exports.rcompareIdentifiers=rcompareIdentifiers,exports.major=major,exports.minor=minor,exports.patch=patch,exports.compare=compare,exports.compareLoose=compareLoose,exports.rcompare=rcompare,exports.sort=sort,exports.rsort=rsort,exports.gt=gt,exports.lt=lt,exports.eq=eq,exports.neq=neq,exports.gte=gte,exports.lte=lte,exports.cmp=cmp,exports.Comparator=Comparator;var ANY={};function Range(e,r){if(r&&\"object\"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof Range)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new Range(e.raw,r);if(e instanceof Comparator)return new Range(e.value,r);if(!(this instanceof Range))return new Range(e,r);if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e,this.set=e.split(/\\s*\\|\\|\\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError(\"Invalid SemVer Range: \"+e);this.format()}function toComparators(e,r){return new Range(e,r).set.map(function(e){return e.map(function(e){return e.value}).join(\" \").trim().split(\" \")})}function parseComparator(e,r){return debug(\"comp\",e,r),e=replaceCarets(e,r),debug(\"caret\",e),e=replaceTildes(e,r),debug(\"tildes\",e),e=replaceXRanges(e,r),debug(\"xrange\",e),e=replaceStars(e,r),debug(\"stars\",e),e}function isX(e){return!e||\"x\"===e.toLowerCase()||\"*\"===e}function replaceTildes(e,r){return e.trim().split(/\\s+/).map(function(e){return replaceTilde(e,r)}).join(\" \")}function replaceTilde(e,r){var t=r.loose?re[TILDELOOSE]:re[TILDE];return e.replace(t,function(r,t,s,n,o){var i;return debug(\"tilde\",e,r,t,s,n,o),isX(t)?i=\"\":isX(s)?i=\">=\"+t+\".0.0 <\"+(+t+1)+\".0.0\":isX(n)?i=\">=\"+t+\".\"+s+\".0 <\"+t+\".\"+(+s+1)+\".0\":o?(debug(\"replaceTilde pr\",o),i=\">=\"+t+\".\"+s+\".\"+n+\"-\"+o+\" <\"+t+\".\"+(+s+1)+\".0\"):i=\">=\"+t+\".\"+s+\".\"+n+\" <\"+t+\".\"+(+s+1)+\".0\",debug(\"tilde return\",i),i})}function replaceCarets(e,r){return e.trim().split(/\\s+/).map(function(e){return replaceCaret(e,r)}).join(\" \")}function replaceCaret(e,r){debug(\"caret\",e,r);var t=r.loose?re[CARETLOOSE]:re[CARET];return e.replace(t,function(r,t,s,n,o){var i;return debug(\"caret\",e,r,t,s,n,o),isX(t)?i=\"\":isX(s)?i=\">=\"+t+\".0.0 <\"+(+t+1)+\".0.0\":isX(n)?i=\"0\"===t?\">=\"+t+\".\"+s+\".0 <\"+t+\".\"+(+s+1)+\".0\":\">=\"+t+\".\"+s+\".0 <\"+(+t+1)+\".0.0\":o?(debug(\"replaceCaret pr\",o),i=\"0\"===t?\"0\"===s?\">=\"+t+\".\"+s+\".\"+n+\"-\"+o+\" <\"+t+\".\"+s+\".\"+(+n+1):\">=\"+t+\".\"+s+\".\"+n+\"-\"+o+\" <\"+t+\".\"+(+s+1)+\".0\":\">=\"+t+\".\"+s+\".\"+n+\"-\"+o+\" <\"+(+t+1)+\".0.0\"):(debug(\"no pr\"),i=\"0\"===t?\"0\"===s?\">=\"+t+\".\"+s+\".\"+n+\" <\"+t+\".\"+s+\".\"+(+n+1):\">=\"+t+\".\"+s+\".\"+n+\" <\"+t+\".\"+(+s+1)+\".0\":\">=\"+t+\".\"+s+\".\"+n+\" <\"+(+t+1)+\".0.0\"),debug(\"caret return\",i),i})}function replaceXRanges(e,r){return debug(\"replaceXRanges\",e,r),e.split(/\\s+/).map(function(e){return replaceXRange(e,r)}).join(\" \")}function replaceXRange(e,r){e=e.trim();var t=r.loose?re[XRANGELOOSE]:re[XRANGE];return e.replace(t,function(r,t,s,n,o,i){debug(\"xRange\",e,r,t,s,n,o,i);var a=isX(s),c=a||isX(n),p=c||isX(o);return\"=\"===t&&p&&(t=\"\"),a?r=\">\"===t||\"<\"===t?\"<0.0.0\":\"*\":t&&p?(c&&(n=0),o=0,\">\"===t?(t=\">=\",c?(s=+s+1,n=0,o=0):(n=+n+1,o=0)):\"<=\"===t&&(t=\"<\",c?s=+s+1:n=+n+1),r=t+s+\".\"+n+\".\"+o):c?r=\">=\"+s+\".0.0 <\"+(+s+1)+\".0.0\":p&&(r=\">=\"+s+\".\"+n+\".0 <\"+s+\".\"+(+n+1)+\".0\"),debug(\"xRange return\",r),r})}function replaceStars(e,r){return debug(\"replaceStars\",e,r),e.trim().replace(re[STAR],\"\")}function hyphenReplace(e,r,t,s,n,o,i,a,c,p,E,u,R){return((r=isX(t)?\"\":isX(s)?\">=\"+t+\".0.0\":isX(n)?\">=\"+t+\".\"+s+\".0\":\">=\"+r)+\" \"+(a=isX(c)?\"\":isX(p)?\"<\"+(+c+1)+\".0.0\":isX(E)?\"<\"+c+\".\"+(+p+1)+\".0\":u?\"<=\"+c+\".\"+p+\".\"+E+\"-\"+u:\"<=\"+a)).trim()}function testSet(e,r,t){for(var s=0;s<e.length;s++)if(!e[s].test(r))return!1;if(r.prerelease.length&&!t.includePrerelease){for(s=0;s<e.length;s++)if(debug(e[s].semver),e[s].semver!==ANY&&e[s].semver.prerelease.length>0){var n=e[s].semver;if(n.major===r.major&&n.minor===r.minor&&n.patch===r.patch)return!0}return!1}return!0}function satisfies(e,r,t){try{r=new Range(r,t)}catch(e){return!1}return r.test(e)}function maxSatisfying(e,r,t){var s=null,n=null;try{var o=new Range(r,t)}catch(e){return null}return e.forEach(function(e){o.test(e)&&(s&&-1!==n.compare(e)||(n=new SemVer(s=e,t)))}),s}function minSatisfying(e,r,t){var s=null,n=null;try{var o=new Range(r,t)}catch(e){return null}return e.forEach(function(e){o.test(e)&&(s&&1!==n.compare(e)||(n=new SemVer(s=e,t)))}),s}function minVersion(e,r){e=new Range(e,r);var t=new SemVer(\"0.0.0\");if(e.test(t))return t;if(t=new SemVer(\"0.0.0-0\"),e.test(t))return t;t=null;for(var s=0;s<e.set.length;++s){e.set[s].forEach(function(e){var r=new SemVer(e.semver.version);switch(e.operator){case\">\":0===r.prerelease.length?r.patch++:r.prerelease.push(0),r.raw=r.format();case\"\":case\">=\":t&&!gt(t,r)||(t=r);break;case\"<\":case\"<=\":break;default:throw new Error(\"Unexpected operation: \"+e.operator)}})}return t&&e.test(t)?t:null}function validRange(e,r){try{return new Range(e,r).range||\"*\"}catch(e){return null}}function ltr(e,r,t){return outside(e,r,\"<\",t)}function gtr(e,r,t){return outside(e,r,\">\",t)}function outside(e,r,t,s){var n,o,i,a,c;switch(e=new SemVer(e,s),r=new Range(r,s),t){case\">\":n=gt,o=lte,i=lt,a=\">\",c=\">=\";break;case\"<\":n=lt,o=gte,i=gt,a=\"<\",c=\"<=\";break;default:throw new TypeError('Must provide a hilo val of \"<\" or \">\"')}if(satisfies(e,r,s))return!1;for(var p=0;p<r.set.length;++p){var E=null,u=null;if(r.set[p].forEach(function(e){e.semver===ANY&&(e=new Comparator(\">=0.0.0\")),E=E||e,u=u||e,n(e.semver,E.semver,s)?E=e:i(e.semver,u.semver,s)&&(u=e)}),E.operator===a||E.operator===c)return!1;if((!u.operator||u.operator===a)&&o(e,u.semver))return!1;if(u.operator===c&&i(e,u.semver))return!1}return!0}function prerelease(e,r){var t=parse(e,r);return t&&t.prerelease.length?t.prerelease:null}function intersects(e,r,t){return e=new Range(e,t),r=new Range(r,t),e.intersects(r)}function coerce(e){if(e instanceof SemVer)return e;if(\"string\"!=typeof e)return null;var r=e.match(re[COERCE]);return null==r?null:parse(r[1]+\".\"+(r[2]||\"0\")+\".\"+(r[3]||\"0\"))}Comparator.prototype.parse=function(e){var r=this.options.loose?re[COMPARATORLOOSE]:re[COMPARATOR],t=e.match(r);if(!t)throw new TypeError(\"Invalid comparator: \"+e);this.operator=t[1],\"=\"===this.operator&&(this.operator=\"\"),t[2]?this.semver=new SemVer(t[2],this.options.loose):this.semver=ANY},Comparator.prototype.toString=function(){return this.value},Comparator.prototype.test=function(e){return debug(\"Comparator.test\",e,this.options.loose),this.semver===ANY||(\"string\"==typeof e&&(e=new SemVer(e,this.options)),cmp(e,this.operator,this.semver,this.options))},Comparator.prototype.intersects=function(e,r){if(!(e instanceof Comparator))throw new TypeError(\"a Comparator is required\");var t;if(r&&\"object\"==typeof r||(r={loose:!!r,includePrerelease:!1}),\"\"===this.operator)return t=new Range(e.value,r),satisfies(this.value,t,r);if(\"\"===e.operator)return t=new Range(this.value,r),satisfies(e.semver,t,r);var s=!(\">=\"!==this.operator&&\">\"!==this.operator||\">=\"!==e.operator&&\">\"!==e.operator),n=!(\"<=\"!==this.operator&&\"<\"!==this.operator||\"<=\"!==e.operator&&\"<\"!==e.operator),o=this.semver.version===e.semver.version,i=!(\">=\"!==this.operator&&\"<=\"!==this.operator||\">=\"!==e.operator&&\"<=\"!==e.operator),a=cmp(this.semver,\"<\",e.semver,r)&&(\">=\"===this.operator||\">\"===this.operator)&&(\"<=\"===e.operator||\"<\"===e.operator),c=cmp(this.semver,\">\",e.semver,r)&&(\"<=\"===this.operator||\"<\"===this.operator)&&(\">=\"===e.operator||\">\"===e.operator);return s||n||o&&i||a||c},exports.Range=Range,Range.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(\" \").trim()}).join(\"||\").trim(),this.range},Range.prototype.toString=function(){return this.range},Range.prototype.parseRange=function(e){var r=this.options.loose;e=e.trim();var t=r?re[HYPHENRANGELOOSE]:re[HYPHENRANGE];e=e.replace(t,hyphenReplace),debug(\"hyphen replace\",e),e=e.replace(re[COMPARATORTRIM],comparatorTrimReplace),debug(\"comparator trim\",e,re[COMPARATORTRIM]),e=(e=(e=e.replace(re[TILDETRIM],tildeTrimReplace)).replace(re[CARETTRIM],caretTrimReplace)).split(/\\s+/).join(\" \");var s=r?re[COMPARATORLOOSE]:re[COMPARATOR],n=e.split(\" \").map(function(e){return parseComparator(e,this.options)},this).join(\" \").split(/\\s+/);return this.options.loose&&(n=n.filter(function(e){return!!e.match(s)})),n=n.map(function(e){return new Comparator(e,this.options)},this)},Range.prototype.intersects=function(e,r){if(!(e instanceof Range))throw new TypeError(\"a Range is required\");return this.set.some(function(t){return t.every(function(t){return e.set.some(function(e){return e.every(function(e){return t.intersects(e,r)})})})})},exports.toComparators=toComparators,Range.prototype.test=function(e){if(!e)return!1;\"string\"==typeof e&&(e=new SemVer(e,this.options));for(var r=0;r<this.set.length;r++)if(testSet(this.set[r],e,this.options))return!0;return!1},exports.satisfies=satisfies,exports.maxSatisfying=maxSatisfying,exports.minSatisfying=minSatisfying,exports.minVersion=minVersion,exports.validRange=validRange,exports.ltr=ltr,exports.gtr=gtr,exports.outside=outside,exports.prerelease=prerelease,exports.intersects=intersects,exports.coerce=coerce;","node_modules/mongodb/lib/core/connection/utils.js":"\"use strict\";const require_optional=require(\"require_optional\");function debugOptions(n,r){var e={};return n.forEach(function(n){e[n]=r[n]}),e}function retrieveBSON(){var n=require(\"bson\");n.native=!1;try{var r=require_optional(\"bson-ext\");if(r)return r.native=!0,r}catch(n){}return n}function noSnappyWarning(){throw new Error(\"Attempted to use Snappy compression, but Snappy is not installed. Install or disable Snappy compression and try again.\")}function retrieveSnappy(){var n=null;try{n=require_optional(\"snappy\")}catch(n){}return n||(n={compress:noSnappyWarning,uncompress:noSnappyWarning,compressSync:noSnappyWarning,uncompressSync:noSnappyWarning}),n}module.exports={debugOptions:debugOptions,retrieveBSON:retrieveBSON,retrieveSnappy:retrieveSnappy};","node_modules/mongodb/lib/core/wireprotocol/shared.js":"\"use strict\";const ReadPreference=require(\"../topologies/read_preference\"),MongoError=require(\"../error\").MongoError,ServerType=require(\"../sdam/common\").ServerType,TopologyDescription=require(\"../sdam/topology_description\").TopologyDescription,MESSAGE_HEADER_SIZE=16,COMPRESSION_DETAILS_SIZE=9;var opcodes={OP_REPLY:1,OP_UPDATE:2001,OP_INSERT:2002,OP_QUERY:2004,OP_GETMORE:2005,OP_DELETE:2006,OP_KILL_CURSORS:2007,OP_COMPRESSED:2012,OP_MSG:2013},getReadPreference=function(e,o){var r=e.readPreference||new ReadPreference(\"primary\");if(o.readPreference&&(r=o.readPreference),\"string\"==typeof r&&(r=new ReadPreference(r)),!(r instanceof ReadPreference))throw new MongoError(\"read preference must be a ReadPreference instance\");return r},parseHeader=function(e){return{length:e.readInt32LE(0),requestId:e.readInt32LE(4),responseTo:e.readInt32LE(8),opCode:e.readInt32LE(12)}};function applyCommonQueryOptions(e,o){return Object.assign(e,{raw:\"boolean\"==typeof o.raw&&o.raw,promoteLongs:\"boolean\"!=typeof o.promoteLongs||o.promoteLongs,promoteValues:\"boolean\"!=typeof o.promoteValues||o.promoteValues,promoteBuffers:\"boolean\"==typeof o.promoteBuffers&&o.promoteBuffers,monitoring:\"boolean\"==typeof o.monitoring&&o.monitoring,fullResult:\"boolean\"==typeof o.fullResult&&o.fullResult}),\"number\"==typeof o.socketTimeout&&(e.socketTimeout=o.socketTimeout),o.session&&(e.session=o.session),\"string\"==typeof o.documentsReturnedIn&&(e.documentsReturnedIn=o.documentsReturnedIn),e}function isSharded(e){if(\"mongos\"===e.type)return!0;if(e.description&&e.description.type===ServerType.Mongos)return!0;if(e.description&&e.description instanceof TopologyDescription){return Array.from(e.description.servers.values()).some(e=>e.type===ServerType.Mongos)}return!1}function databaseNamespace(e){return e.split(\".\")[0]}function collectionNamespace(e){return e.split(\".\").slice(1).join(\".\")}module.exports={getReadPreference:getReadPreference,MESSAGE_HEADER_SIZE:16,COMPRESSION_DETAILS_SIZE:9,opcodes:opcodes,parseHeader:parseHeader,applyCommonQueryOptions:applyCommonQueryOptions,isSharded:isSharded,databaseNamespace:databaseNamespace,collectionNamespace:collectionNamespace};","node_modules/mongodb/lib/core/wireprotocol/compression.js":"\"use strict\";var Snappy=require(\"../connection/utils\").retrieveSnappy(),zlib=require(\"zlib\"),compressorIDs={snappy:1,zlib:2},uncompressibleCommands=[\"ismaster\",\"saslStart\",\"saslContinue\",\"getnonce\",\"authenticate\",\"createUser\",\"updateUser\",\"copydbSaslStart\",\"copydbgetnonce\",\"copydb\"],compress=function(e,s,r){switch(e.options.agreedCompressor){case\"snappy\":Snappy.compress(s,r);break;case\"zlib\":var o={};e.options.zlibCompressionLevel&&(o.level=e.options.zlibCompressionLevel),zlib.deflate(s,o,r);break;default:throw new Error('Attempt to compress message using unknown compressor \"'+e.options.agreedCompressor+'\".')}},decompress=function(e,s,r){if(e<0||e>compressorIDs.length)throw new Error(\"Server sent message compressed using an unsupported compressor. (Received compressor ID \"+e+\")\");switch(e){case compressorIDs.snappy:Snappy.uncompress(s,r);break;case compressorIDs.zlib:zlib.inflate(s,r);break;default:r(null,s)}};module.exports={compressorIDs:compressorIDs,uncompressibleCommands:uncompressibleCommands,compress:compress,decompress:decompress};","node_modules/mongodb/lib/core/connection/msg.js":"\"use strict\";const Buffer=require(\"safe-buffer\").Buffer,opcodes=require(\"../wireprotocol/shared\").opcodes,databaseNamespace=require(\"../wireprotocol/shared\").databaseNamespace,ReadPreference=require(\"../topologies/read_preference\");let _requestId=0;const OPTS_CHECKSUM_PRESENT=1,OPTS_MORE_TO_COME=2,OPTS_EXHAUST_ALLOWED=65536;class Msg{constructor(e,s,t,o){if(null==t)throw new Error(\"query must be specified for query\");this.bson=e,this.ns=s,this.command=t,this.command.$db=databaseNamespace(s),o.readPreference&&o.readPreference.mode!==ReadPreference.PRIMARY&&(this.command.$readPreference=o.readPreference.toJSON()),this.options=o||{},this.requestId=Msg.getRequestId(),this.serializeFunctions=\"boolean\"==typeof o.serializeFunctions&&o.serializeFunctions,this.ignoreUndefined=\"boolean\"==typeof o.ignoreUndefined&&o.ignoreUndefined,this.checkKeys=\"boolean\"==typeof o.checkKeys&&o.checkKeys,this.maxBsonSize=o.maxBsonSize||16777216,this.checksumPresent=!1,this.moreToCome=o.moreToCome||!1,this.exhaustAllowed=!1}toBin(){const e=[];let s=0;this.checksumPresent&&(s|=OPTS_CHECKSUM_PRESENT),this.moreToCome&&(s|=OPTS_MORE_TO_COME),this.exhaustAllowed&&(s|=OPTS_EXHAUST_ALLOWED);const t=Buffer.alloc(20);e.push(t);let o=t.length;const r=this.command;return o+=this.makeDocumentSegment(e,r),t.writeInt32LE(o,0),t.writeInt32LE(this.requestId,4),t.writeInt32LE(0,8),t.writeInt32LE(opcodes.OP_MSG,12),t.writeUInt32LE(s,16),e}makeDocumentSegment(e,s){const t=Buffer.alloc(1);t[0]=0;const o=this.serializeBson(s);return e.push(t),e.push(o),t.length+o.length}serializeBson(e){return this.bson.serialize(e,{checkKeys:this.checkKeys,serializeFunctions:this.serializeFunctions,ignoreUndefined:this.ignoreUndefined})}}Msg.getRequestId=function(){return _requestId=_requestId+1&2147483647};class BinMsg{constructor(e,s,t,o,r){r=r||{promoteLongs:!0,promoteValues:!0,promoteBuffers:!1},this.parsed=!1,this.raw=s,this.data=o,this.bson=e,this.opts=r,this.length=t.length,this.requestId=t.requestId,this.responseTo=t.responseTo,this.opCode=t.opCode,this.fromCompressed=t.fromCompressed,this.responseFlags=o.readInt32LE(0),this.checksumPresent=0!=(this.responseFlags&OPTS_CHECKSUM_PRESENT),this.moreToCome=0!=(this.responseFlags&OPTS_MORE_TO_COME),this.exhaustAllowed=0!=(this.responseFlags&OPTS_EXHAUST_ALLOWED),this.promoteLongs=\"boolean\"!=typeof r.promoteLongs||r.promoteLongs,this.promoteValues=\"boolean\"!=typeof r.promoteValues||r.promoteValues,this.promoteBuffers=\"boolean\"==typeof r.promoteBuffers&&r.promoteBuffers,this.documents=[]}isParsed(){return this.parsed}parse(e){if(this.parsed)return;e=e||{},this.index=4;const s=e.raw||!1,t=e.documentsReturnedIn||null,o={promoteLongs:\"boolean\"==typeof e.promoteLongs?e.promoteLongs:this.opts.promoteLongs,promoteValues:\"boolean\"==typeof e.promoteValues?e.promoteValues:this.opts.promoteValues,promoteBuffers:\"boolean\"==typeof e.promoteBuffers?e.promoteBuffers:this.opts.promoteBuffers};for(;this.index<this.data.length;){const e=this.data.readUInt8(this.index++);if(1===e)console.error(\"TYPE 1\");else if(0===e){const e=this.data.readUInt32LE(this.index),t=this.data.slice(this.index,this.index+e);this.documents.push(s?t:this.bson.deserialize(t,o)),this.index+=e}}if(1===this.documents.length&&null!=t&&s){const e={};e[t]=!0,o.fieldsAsRaw=e;const s=this.bson.deserialize(this.documents[0],o);this.documents=[s]}this.parsed=!0}}module.exports={Msg:Msg,BinMsg:BinMsg};","node_modules/safe-buffer/index.js":"var buffer=require(\"buffer\"),Buffer=buffer.Buffer;function copyProps(f,r){for(var e in f)r[e]=f[e]}function SafeBuffer(f,r,e){return Buffer(f,r,e)}Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(f,r,e){if(\"number\"==typeof f)throw new TypeError(\"Argument must not be a number\");return Buffer(f,r,e)},SafeBuffer.alloc=function(f,r,e){if(\"number\"!=typeof f)throw new TypeError(\"Argument must be a number\");var u=Buffer(f);return void 0!==r?\"string\"==typeof e?u.fill(r,e):u.fill(r):u.fill(0),u},SafeBuffer.allocUnsafe=function(f){if(\"number\"!=typeof f)throw new TypeError(\"Argument must be a number\");return Buffer(f)},SafeBuffer.allocUnsafeSlow=function(f){if(\"number\"!=typeof f)throw new TypeError(\"Argument must be a number\");return buffer.SlowBuffer(f)};","node_modules/mongodb/lib/core/sdam/common.js":"\"use strict\";const STATE_CLOSING=\"closing\",STATE_CLOSED=\"closed\",STATE_CONNECTING=\"connecting\",STATE_CONNECTED=\"connected\",TopologyType={Single:\"Single\",ReplicaSetNoPrimary:\"ReplicaSetNoPrimary\",ReplicaSetWithPrimary:\"ReplicaSetWithPrimary\",Sharded:\"Sharded\",Unknown:\"Unknown\"},ServerType={Standalone:\"Standalone\",Mongos:\"Mongos\",PossiblePrimary:\"PossiblePrimary\",RSPrimary:\"RSPrimary\",RSSecondary:\"RSSecondary\",RSArbiter:\"RSArbiter\",RSOther:\"RSOther\",RSGhost:\"RSGhost\",Unknown:\"Unknown\"},TOPOLOGY_DEFAULTS={useUnifiedTopology:!0,localThresholdMS:15,serverSelectionTimeoutMS:3e4,heartbeatFrequencyMS:1e4,minHeartbeatFrequencyMS:500};function drainTimerQueue(e){e.forEach(clearTimeout),e.clear()}function clearAndRemoveTimerFrom(e,r){return clearTimeout(e),r.delete(e)}module.exports={STATE_CLOSING:\"closing\",STATE_CLOSED:\"closed\",STATE_CONNECTING:\"connecting\",STATE_CONNECTED:\"connected\",TOPOLOGY_DEFAULTS:TOPOLOGY_DEFAULTS,TopologyType:TopologyType,ServerType:ServerType,drainTimerQueue:drainTimerQueue,clearAndRemoveTimerFrom:clearAndRemoveTimerFrom};","node_modules/mongodb/lib/core/sdam/topology_description.js":"\"use strict\";const ServerType=require(\"./common\").ServerType,ServerDescription=require(\"./server_description\").ServerDescription,WIRE_CONSTANTS=require(\"../wireprotocol/constants\"),TopologyType=require(\"./common\").TopologyType,MIN_SUPPORTED_SERVER_VERSION=WIRE_CONSTANTS.MIN_SUPPORTED_SERVER_VERSION,MAX_SUPPORTED_SERVER_VERSION=WIRE_CONSTANTS.MAX_SUPPORTED_SERVER_VERSION,MIN_SUPPORTED_WIRE_VERSION=WIRE_CONSTANTS.MIN_SUPPORTED_WIRE_VERSION,MAX_SUPPORTED_WIRE_VERSION=WIRE_CONSTANTS.MAX_SUPPORTED_WIRE_VERSION;class TopologyDescription{constructor(e,r,o,s,i,t,n,a){n=n||{},this.type=e||TopologyType.Unknown,this.setName=o||null,this.maxSetVersion=s||null,this.maxElectionId=i||null,this.servers=r||new Map,this.stale=!1,this.compatible=!0,this.compatibilityError=null,this.logicalSessionTimeoutMinutes=null,this.heartbeatFrequencyMS=n.heartbeatFrequencyMS||0,this.localThresholdMS=n.localThresholdMS||0,this.error=a,this.commonWireVersion=t||null,Object.defineProperty(this,\"options\",{value:n,enumberable:!1});for(const e of this.servers.values())if(e.type!==ServerType.Unknown&&(e.minWireVersion>MAX_SUPPORTED_WIRE_VERSION&&(this.compatible=!1,this.compatibilityError=`Server at ${e.address} requires wire version ${e.minWireVersion}, but this version of the driver only supports up to ${MAX_SUPPORTED_WIRE_VERSION} (MongoDB ${MAX_SUPPORTED_SERVER_VERSION})`),e.maxWireVersion<MIN_SUPPORTED_WIRE_VERSION)){this.compatible=!1,this.compatibilityError=`Server at ${e.address} reports wire version ${e.maxWireVersion}, but this version of the driver requires at least ${MIN_SUPPORTED_WIRE_VERSION} (MongoDB ${MIN_SUPPORTED_SERVER_VERSION}).`;break}const l=Array.from(this.servers.values()).filter(e=>e.isReadable);this.logicalSessionTimeoutMinutes=l.reduce((e,r)=>null==r.logicalSessionTimeoutMinutes?null:null==e?r.logicalSessionTimeoutMinutes:Math.min(e,r.logicalSessionTimeoutMinutes),null)}updateFromSrvPollingEvent(e){const r=e.addresses(),o=new Map(this.servers);for(const e of this.servers)r.has(e[0])?r.delete(e[0]):o.delete(e[0]);if(o.size===this.servers.size&&0===r.size)return this;for(const e of r)o.set(e,new ServerDescription(e));return new TopologyDescription(this.type,o,this.setName,this.maxSetVersion,this.maxElectionId,this.commonWireVersion,this.options,null)}update(e){const r=e.address;let o=this.type,s=this.setName,i=this.maxSetVersion,t=this.maxElectionId,n=this.commonWireVersion,a=e.error||this.error;const l=e.type;let p=new Map(this.servers);if(0!==e.maxWireVersion&&(n=null==n?e.maxWireVersion:Math.min(n,e.maxWireVersion)),p.set(r,e),o===TopologyType.Single)return new TopologyDescription(TopologyType.Single,p,s,i,t,n,this.options,a);if(o===TopologyType.Unknown&&(l===ServerType.Standalone?p.delete(r):o=topologyTypeForServerType(l)),o===TopologyType.Sharded&&-1===[ServerType.Mongos,ServerType.Unknown].indexOf(l)&&p.delete(r),o===TopologyType.ReplicaSetNoPrimary)if([ServerType.Standalone,ServerType.Mongos].indexOf(l)>=0&&p.delete(r),l===ServerType.RSPrimary){const r=updateRsFromPrimary(p,s,e,i,t);o=r[0],s=r[1],i=r[2],t=r[3]}else if([ServerType.RSSecondary,ServerType.RSArbiter,ServerType.RSOther].indexOf(l)>=0){const r=updateRsNoPrimaryFromMember(p,s,e);o=r[0],s=r[1]}if(o===TopologyType.ReplicaSetWithPrimary)if([ServerType.Standalone,ServerType.Mongos].indexOf(l)>=0)p.delete(r),o=checkHasPrimary(p);else if(l===ServerType.RSPrimary){const r=updateRsFromPrimary(p,s,e,i,t);o=r[0],s=r[1],i=r[2],t=r[3]}else o=[ServerType.RSSecondary,ServerType.RSArbiter,ServerType.RSOther].indexOf(l)>=0?updateRsWithPrimaryFromMember(p,s,e):checkHasPrimary(p);return new TopologyDescription(o,p,s,i,t,n,this.options,a)}get hasKnownServers(){return Array.from(this.servers.values()).some(e=>e.type!==ServerType.Unknown)}get hasDataBearingServers(){return Array.from(this.servers.values()).some(e=>e.isDataBearing)}hasServer(e){return this.servers.has(e)}}function topologyTypeForServerType(e){return e===ServerType.Mongos?TopologyType.Sharded:e===ServerType.RSPrimary?TopologyType.ReplicaSetWithPrimary:TopologyType.ReplicaSetNoPrimary}function updateRsFromPrimary(e,r,o,s,i){if((r=r||o.setName)!==o.setName)return e.delete(o.address),[checkHasPrimary(e),r,s,i];const t=o.electionId?o.electionId.$oid:null,n=i?i.$oid:null;if(null!=o.setVersion&&null!=t){if(null!=s&&null!=n&&(s>o.setVersion||n>t))return e.set(o.address,new ServerDescription(o.address)),[checkHasPrimary(e),r,s,i];i=o.electionId}null!=o.setVersion&&(null==s||o.setVersion>s)&&(s=o.setVersion);for(const r of e.keys()){const s=e.get(r);if(s.type===ServerType.RSPrimary&&s.address!==o.address){e.set(r,new ServerDescription(s.address));break}}o.allHosts.forEach(r=>{e.has(r)||e.set(r,new ServerDescription(r))});const a=Array.from(e.keys()),l=o.allHosts;return a.filter(e=>-1===l.indexOf(e)).forEach(r=>{e.delete(r)}),[checkHasPrimary(e),r,s,i]}function updateRsWithPrimaryFromMember(e,r,o){if(null==r)throw new TypeError(\"setName is required\");return(r!==o.setName||o.me&&o.address!==o.me)&&e.delete(o.address),checkHasPrimary(e)}function updateRsNoPrimaryFromMember(e,r,o){let s=TopologyType.ReplicaSetNoPrimary;return(r=r||o.setName)!==o.setName?(e.delete(o.address),[s,r]):(o.allHosts.forEach(r=>{e.has(r)||e.set(r,new ServerDescription(r))}),o.me&&o.address!==o.me&&e.delete(o.address),[s,r])}function checkHasPrimary(e){for(const r of e.keys())if(e.get(r).type===ServerType.RSPrimary)return TopologyType.ReplicaSetWithPrimary;return TopologyType.ReplicaSetNoPrimary}module.exports={TopologyDescription:TopologyDescription};","node_modules/mongodb/lib/core/sdam/server_description.js":"\"use strict\";const arrayStrictEqual=require(\"../utils\").arrayStrictEqual,tagsStrictEqual=require(\"../utils\").tagsStrictEqual,ServerType=require(\"./common\").ServerType,WRITABLE_SERVER_TYPES=new Set([ServerType.RSPrimary,ServerType.Standalone,ServerType.Mongos]),DATA_BEARING_SERVER_TYPES=new Set([ServerType.RSPrimary,ServerType.RSSecondary,ServerType.Mongos,ServerType.Standalone]),ISMASTER_FIELDS=[\"minWireVersion\",\"maxWireVersion\",\"maxBsonObjectSize\",\"maxMessageSizeBytes\",\"maxWriteBatchSize\",\"compression\",\"me\",\"hosts\",\"passives\",\"arbiters\",\"tags\",\"setName\",\"setVersion\",\"electionId\",\"primary\",\"logicalSessionTimeoutMinutes\",\"saslSupportedMechs\",\"__nodejs_mock_server__\",\"$clusterTime\"];class ServerDescription{constructor(e,r,s){s=s||{},r=Object.assign({minWireVersion:0,maxWireVersion:0,hosts:[],passives:[],arbiters:[],tags:[]},r),this.address=e,this.error=s.error||null,this.roundTripTime=s.roundTripTime||0,this.lastUpdateTime=Date.now(),this.lastWriteDate=r.lastWrite?r.lastWrite.lastWriteDate:null,this.opTime=r.lastWrite?r.lastWrite.opTime:null,this.type=parseServerType(r),ISMASTER_FIELDS.forEach(e=>{void 0!==r[e]&&(this[e]=r[e])}),this.me&&(this.me=this.me.toLowerCase()),this.hosts=this.hosts.map(e=>e.toLowerCase()),this.passives=this.passives.map(e=>e.toLowerCase()),this.arbiters=this.arbiters.map(e=>e.toLowerCase())}get allHosts(){return this.hosts.concat(this.arbiters).concat(this.passives)}get isReadable(){return this.type===ServerType.RSSecondary||this.isWritable}get isDataBearing(){return DATA_BEARING_SERVER_TYPES.has(this.type)}get isWritable(){return WRITABLE_SERVER_TYPES.has(this.type)}equals(e){return null!=e&&this.error===e.error&&this.type===e.type&&this.minWireVersion===e.minWireVersion&&this.me===e.me&&arrayStrictEqual(this.hosts,e.hosts)&&tagsStrictEqual(this.tags,e.tags)&&this.setName===e.setName&&this.setVersion===e.setVersion&&(this.electionId?e.electionId&&this.electionId.equals(e.electionId):this.electionId===e.electionId)&&this.primary===e.primary&&this.logicalSessionTimeoutMinutes===e.logicalSessionTimeoutMinutes}}function parseServerType(e){return e&&e.ok?e.isreplicaset?ServerType.RSGhost:e.msg&&\"isdbgrid\"===e.msg?ServerType.Mongos:e.setName?e.hidden?ServerType.RSOther:e.ismaster?ServerType.RSPrimary:e.secondary?ServerType.RSSecondary:e.arbiterOnly?ServerType.RSArbiter:ServerType.RSOther:ServerType.Standalone:ServerType.Unknown}module.exports={ServerDescription:ServerDescription};","node_modules/mongodb/lib/core/wireprotocol/constants.js":"\"use strict\";const MIN_SUPPORTED_SERVER_VERSION=\"2.6\",MAX_SUPPORTED_SERVER_VERSION=\"4.2\",MIN_SUPPORTED_WIRE_VERSION=2,MAX_SUPPORTED_WIRE_VERSION=8;module.exports={MIN_SUPPORTED_SERVER_VERSION:\"2.6\",MAX_SUPPORTED_SERVER_VERSION:\"4.2\",MIN_SUPPORTED_WIRE_VERSION:2,MAX_SUPPORTED_WIRE_VERSION:8};","node_modules/mongodb/lib/core/connection/pool.js":"\"use strict\";const inherits=require(\"util\").inherits,EventEmitter=require(\"events\").EventEmitter,MongoError=require(\"../error\").MongoError,MongoTimeoutError=require(\"../error\").MongoTimeoutError,MongoWriteConcernError=require(\"../error\").MongoWriteConcernError,Logger=require(\"./logger\"),f=require(\"util\").format,Msg=require(\"./msg\").Msg,CommandResult=require(\"./command_result\"),MESSAGE_HEADER_SIZE=require(\"../wireprotocol/shared\").MESSAGE_HEADER_SIZE,COMPRESSION_DETAILS_SIZE=require(\"../wireprotocol/shared\").COMPRESSION_DETAILS_SIZE,opcodes=require(\"../wireprotocol/shared\").opcodes,compress=require(\"../wireprotocol/compression\").compress,compressorIDs=require(\"../wireprotocol/compression\").compressorIDs,uncompressibleCommands=require(\"../wireprotocol/compression\").uncompressibleCommands,apm=require(\"./apm\"),Buffer=require(\"safe-buffer\").Buffer,connect=require(\"./connect\"),updateSessionFromResponse=require(\"../sessions\").updateSessionFromResponse,eachAsync=require(\"../utils\").eachAsync,makeStateMachine=require(\"../utils\").makeStateMachine,DISCONNECTED=\"disconnected\",CONNECTING=\"connecting\",CONNECTED=\"connected\",DRAINING=\"draining\",DESTROYING=\"destroying\",DESTROYED=\"destroyed\",stateTransition=makeStateMachine({[DISCONNECTED]:[CONNECTING,DRAINING,DISCONNECTED],[CONNECTING]:[CONNECTING,CONNECTED,DRAINING,DISCONNECTED],[CONNECTED]:[CONNECTED,DISCONNECTED,DRAINING],[DRAINING]:[DRAINING,DESTROYING,DESTROYED],[DESTROYING]:[DESTROYING,DESTROYED],[DESTROYED]:[DESTROYED]}),CONNECTION_EVENTS=new Set([\"error\",\"close\",\"timeout\",\"parseError\",\"connect\",\"message\"]);var _id=0,Pool=function(e,n){if(EventEmitter.call(this),this.topology=e,this.s={state:DISCONNECTED},this.options=Object.assign({host:\"localhost\",port:27017,size:5,minSize:0,connectionTimeout:3e4,socketTimeout:36e4,keepAlive:!0,keepAliveInitialDelay:3e5,noDelay:!0,ssl:!1,checkServerIdentity:!0,ca:null,crl:null,cert:null,key:null,passphrase:null,rejectUnauthorized:!1,promoteLongs:!0,promoteValues:!0,promoteBuffers:!1,reconnect:!0,reconnectInterval:1e3,reconnectTries:30,domainsEnabled:!1,legacyCompatMode:!0},n),this.id=_id++,this.retriesLeft=this.options.reconnectTries,this.reconnectId=null,this.reconnectError=null,!n.bson||n.bson&&(\"function\"!=typeof n.bson.serialize||\"function\"!=typeof n.bson.deserialize))throw new Error(\"must pass in valid bson parser\");this.logger=Logger(\"Pool\",n),this.availableConnections=[],this.inUseConnections=[],this.connectingConnections=0,this.executing=!1,this.queue=[],this.numberOfConsecutiveTimeouts=0,this.connectionIndex=0;const o=this;this._messageHandler=messageHandler(this),this._connectionCloseHandler=function(e){connectionFailureHandler(o,\"close\",e,this)},this._connectionErrorHandler=function(e){connectionFailureHandler(o,\"error\",e,this)},this._connectionTimeoutHandler=function(e){connectionFailureHandler(o,\"timeout\",e,this)},this._connectionParseErrorHandler=function(e){connectionFailureHandler(o,\"parseError\",e,this)}};function resetPoolState(e){e.inUseConnections=[],e.availableConnections=[],e.connectingConnections=0,e.executing=!1,e.numberOfConsecutiveTimeouts=0,e.connectionIndex=0,e.retriesLeft=e.options.reconnectTries,e.reconnectId=null}function connectionFailureHandler(e,n,o,t){if(t){if(t._connectionFailHandled)return;for(t._connectionFailHandled=!0,t.destroy(),removeConnection(e,t);t.workItems.length>0;){const e=t.workItems.shift();e.cb&&e.cb(o)}if(e.state!==DRAINING&&!1===e.options.legacyCompatMode)return stateTransition(e,DRAINING),void e.emit(\"drain\",o)}if(\"timeout\"===n&&(e.numberOfConsecutiveTimeouts=e.numberOfConsecutiveTimeouts+1,e.numberOfConsecutiveTimeouts>e.options.reconnectTries))return e.numberOfConsecutiveTimeouts=0,e.destroy(!0),e.emit(\"close\",e);0===e.socketCount()&&(e.state!==DESTROYED&&e.state!==DESTROYING&&e.state!==DRAINING&&e.options.reconnect&&stateTransition(e,DISCONNECTED),n=\"error\"===n?\"close\":n,e.emit(n,o)),!e.reconnectId&&e.options.reconnect&&(e.reconnectError=o,e.reconnectId=setTimeout(attemptReconnect(e),e.options.reconnectInterval)),totalConnectionCount(e)<e.minSize&&createConnection(e)}function attemptReconnect(e,n){return function(){if(e.emit(\"attemptReconnect\",e),e.state!==DESTROYED&&e.state!==DESTROYING){if(e.retriesLeft=e.retriesLeft-1,e.retriesLeft<=0){e.destroy();const o=new MongoTimeoutError(`failed to reconnect after ${e.options.reconnectTries} attempts with interval ${e.options.reconnectInterval} ms`,e.reconnectError);return e.emit(\"reconnectFailed\",o),void(\"function\"==typeof n&&n(o))}e.reconnectId=null,createConnection(e,(o,t)=>{null==o&&(e.reconnectId=null,e.retriesLeft=e.options.reconnectTries,e.emit(\"reconnect\",e)),\"function\"==typeof n&&n(o,t)})}else\"function\"==typeof n&&n(new MongoError(\"Cannot create connection when pool is destroyed\"))}}function moveConnectionBetween(e,n,o){var t=n.indexOf(e);-1!==t&&(n.splice(t,1),o.push(e))}function messageHandler(e){return function(n,o){for(var t=null,i=0;i<o.workItems.length;i++)o.workItems[i].requestId===n.responseTo&&(t=o.workItems[i],o.workItems.splice(i,1));function r(e,n,o,t){if(!e.options.domainsEnabled)return process.nextTick(function(){return n(o,t)});n(o,t)}if(t&&t.monitoring&&moveConnectionBetween(o,e.inUseConnections,e.availableConnections),e.numberOfConsecutiveTimeouts=0,t&&t.socketTimeout&&o.resetSocketTimeout(),e.logger.isDebug()&&e.logger.debug(f(\"message [%s] received from %s:%s\",n.raw.toString(\"hex\"),e.options.host,e.options.port)),e.executing||process.nextTick(function(){_execute(e)()}),t&&!t.immediateRelease){try{n.parse(t)}catch(n){return r(e,t.cb,new MongoError(n))}if(n.documents[0]){const o=n.documents[0],i=t.session;i&&updateSessionFromResponse(i,o),e.topology&&o.$clusterTime&&(e.topology.clusterTime=o.$clusterTime)}if(t.command&&n.documents[0]){const o=n.documents[0];if(o.writeConcernError){const n=new MongoWriteConcernError(o.writeConcernError,o);return r(e,t.cb,n)}if(0===o.ok||o.$err||o.errmsg||o.code)return r(e,t.cb,new MongoError(o))}n.hashedName=o.hashedName,r(e,t.cb,null,new CommandResult(t.fullResult?n:n.documents[0],o,n))}}}function totalConnectionCount(e){return e.availableConnections.length+e.inUseConnections.length+e.connectingConnections}function destroy(e,n,o,t){stateTransition(e,DESTROYING),eachAsync(n,(e,n)=>{for(const n of CONNECTION_EVENTS)e.removeAllListeners(n);e.destroy(o,n)},n=>{n?\"function\"==typeof t&&t(n,null):(resetPoolState(e),e.queue=[],stateTransition(e,DESTROYED),\"function\"==typeof t&&t(null,null))})}function serializeCommand(e,n,o){const t=n.toBin();if(!!!e.options.agreedCompressor||!canCompress(n))return o(null,t);const i=Buffer.concat(t),r=i.slice(MESSAGE_HEADER_SIZE),s=i.readInt32LE(12);compress(e,r,function(t,i){if(t)return o(t,null);const c=Buffer.alloc(MESSAGE_HEADER_SIZE);c.writeInt32LE(MESSAGE_HEADER_SIZE+COMPRESSION_DETAILS_SIZE+i.length,0),c.writeInt32LE(n.requestId,4),c.writeInt32LE(0,8),c.writeInt32LE(opcodes.OP_COMPRESSED,12);const a=Buffer.alloc(COMPRESSION_DETAILS_SIZE);return a.writeInt32LE(s,0),a.writeInt32LE(r.length,4),a.writeUInt8(compressorIDs[e.options.agreedCompressor],8),o(null,[c,a,i])})}function canCompress(e){const n=e instanceof Msg?e.command:e.query,o=Object.keys(n)[0];return-1===uncompressibleCommands.indexOf(o)}function remove(e,n){for(var o=0;o<n.length;o++)if(n[o]===e)return n.splice(o,1),!0}function removeConnection(e,n){remove(n,e.availableConnections)||remove(n,e.inUseConnections)}function createConnection(e,n){e.state!==DESTROYED&&e.state!==DESTROYING?(e.connectingConnections++,connect(e.options,(o,t)=>(e.connectingConnections--,o?(e.logger.isDebug()&&e.logger.debug(`connection attempt failed with error [${JSON.stringify(o)}]`),!e.reconnectId&&e.options.reconnect?e.state===CONNECTING&&e.options.legacyCompatMode?void n(o):(e.reconnectError=o,void(e.reconnectId=setTimeout(attemptReconnect(e,n),e.options.reconnectInterval))):void(\"function\"==typeof n&&n(o))):e.state===DESTROYED||e.state===DESTROYING?(\"function\"==typeof n&&n(new MongoError(\"Pool was destroyed after connection creation\")),void t.destroy()):(t.on(\"error\",e._connectionErrorHandler),t.on(\"close\",e._connectionCloseHandler),t.on(\"timeout\",e._connectionTimeoutHandler),t.on(\"parseError\",e._connectionParseErrorHandler),t.on(\"message\",e._messageHandler),e.availableConnections.push(t),\"function\"==typeof n&&n(null,t),void _execute(e)())))):\"function\"==typeof n&&n(new MongoError(\"Cannot create connection when pool is destroyed\"))}function flushMonitoringOperations(e){for(var n=0;n<e.length;n++)if(e[n].monitoring){var o=e[n];e.splice(n,1),o.cb(new MongoError({message:\"no connection available for monitoring\",driver:!0}))}}function _execute(e){return function(){if(e.state!==DESTROYED&&!e.executing)if(e.executing=!0,e.connectingConnections>0)e.executing=!1;else{for(;;){const s=totalConnectionCount(e);if(0===e.availableConnections.length){flushMonitoringOperations(e.queue),s<e.options.size&&e.queue.length>0&&createConnection(e);break}if(0===e.queue.length)break;var n=null;const c=e.availableConnections.filter(e=>0===e.workItems.length);if(!(n=0===c.length?e.availableConnections[e.connectionIndex++%e.availableConnections.length]:c[e.connectionIndex++%c.length]).isConnected()){removeConnection(e,n),flushMonitoringOperations(e.queue);break}var o=e.queue.shift();if(o.monitoring){var t=!1;for(let o=0;o<e.availableConnections.length;o++)if(e.availableConnections[o].isConnected()&&0===e.availableConnections[o].workItems.length){t=!0,n=e.availableConnections[o];break}if(!t){e.queue.unshift(o),s<e.options.size&&e.queue.length>0&&createConnection(e),setTimeout(()=>_execute(e)(),10);break}}if(s<e.options.size&&n.workItems.length>0){e.queue.unshift(o),createConnection(e);break}var i=o.buffer;o.monitoring&&moveConnectionBetween(n,e.availableConnections,e.inUseConnections),o.noResponse||n.workItems.push(o),o.immediateRelease||\"number\"!=typeof o.socketTimeout||n.setSocketTimeout(o.socketTimeout);var r=!0;if(Array.isArray(i))for(let e=0;e<i.length;e++)r=n.write(i[e]);else r=n.write(i);if(o.noResponse&&\"function\"==typeof o.cb&&o.cb(null,null),!1===r){e.queue.unshift(o),removeConnection(e,n),flushMonitoringOperations(e.queue);break}}e.executing=!1}}}inherits(Pool,EventEmitter),Object.defineProperty(Pool.prototype,\"size\",{enumerable:!0,get:function(){return this.options.size}}),Object.defineProperty(Pool.prototype,\"minSize\",{enumerable:!0,get:function(){return this.options.minSize}}),Object.defineProperty(Pool.prototype,\"connectionTimeout\",{enumerable:!0,get:function(){return this.options.connectionTimeout}}),Object.defineProperty(Pool.prototype,\"socketTimeout\",{enumerable:!0,get:function(){return this.options.socketTimeout}}),Object.defineProperty(Pool.prototype,\"state\",{enumerable:!0,get:function(){return this.s.state}}),Pool.prototype.socketCount=function(){return this.availableConnections.length+this.inUseConnections.length},Pool.prototype.allConnections=function(){return this.availableConnections.concat(this.inUseConnections)},Pool.prototype.get=function(){return this.allConnections()[0]},Pool.prototype.isConnected=function(){if(this.state===DESTROYED||this.state===DESTROYING)return!1;for(var e=this.availableConnections.concat(this.inUseConnections),n=0;n<e.length;n++)if(e[n].isConnected())return!0;return!1},Pool.prototype.isDestroyed=function(){return this.state===DESTROYED||this.state===DESTROYING},Pool.prototype.isDisconnected=function(){return this.state===DISCONNECTED},Pool.prototype.connect=function(e){if(this.state!==DISCONNECTED)throw new MongoError(\"connection in unlawful state \"+this.state);stateTransition(this,CONNECTING),createConnection(this,(n,o)=>{if(n)return\"function\"==typeof e?(this.destroy(),void e(n)):(this.state===CONNECTING&&this.emit(\"error\",n),void this.destroy());if(stateTransition(this,CONNECTED),this.minSize)for(let e=0;e<this.minSize;e++)createConnection(this);\"function\"==typeof e?e(null,o):this.emit(\"connect\",this,o)})},Pool.prototype.auth=function(e,n){\"function\"==typeof n&&n(null,null)},Pool.prototype.logout=function(e,n){\"function\"==typeof n&&n(null,null)},Pool.prototype.unref=function(){this.availableConnections.concat(this.inUseConnections).forEach(function(e){e.unref()})},Pool.prototype.destroy=function(e,n){var o=this;if(\"function\"==typeof e&&(n=e,e=!1),this.state!==DESTROYED&&o.state!==DESTROYING){if(stateTransition(this,DRAINING),e){for(var t=o.availableConnections.concat(o.inUseConnections);o.queue.length>0;){var i=o.queue.shift();\"function\"==typeof i.cb&&i.cb(new MongoError(\"Pool was force destroyed\"))}return destroy(o,t,{force:!0},n)}this.reconnectId&&clearTimeout(this.reconnectId),function e(){if(o.state!==DESTROYED&&o.state!==DESTROYING)if(flushMonitoringOperations(o.queue),0===o.queue.length){for(var t=o.availableConnections.concat(o.inUseConnections),i=0;i<t.length;i++)if(t[i].workItems.length>0)return setTimeout(e,1);destroy(o,t,{force:!1},n)}else _execute(o)(),setTimeout(e,1);else\"function\"==typeof n&&n()}()}else\"function\"==typeof n&&n(null,null)},Pool.prototype.reset=function(e){if(this.s.state!==CONNECTED)return void(\"function\"==typeof e&&e(new MongoError(\"pool is not connected, reset aborted\")));const n=this.availableConnections.concat(this.inUseConnections);eachAsync(n,(e,n)=>{for(const n of CONNECTION_EVENTS)e.removeAllListeners(n);e.destroy({force:!0},n)},n=>{n&&\"function\"==typeof e?e(n,null):(resetPoolState(this),createConnection(this,()=>{\"function\"==typeof e&&e(null,null)}))})},Pool.prototype.write=function(e,n,o){var t=this;if(\"function\"==typeof n&&(o=n),n=n||{},\"function\"!=typeof o&&!n.noResponse)throw new MongoError(\"write method must provide a callback\");if(this.state!==DESTROYED&&this.state!==DESTROYING)if(this.state!==DRAINING){if(this.options.domainsEnabled&&process.domain&&\"function\"==typeof o){var i=o;o=process.domain.bind(function(){for(var e=new Array(arguments.length),n=0;n<arguments.length;n++)e[n]=arguments[n];process.nextTick(function(){i.apply(null,e)})})}var r={cb:o,raw:!1,promoteLongs:!0,promoteValues:!0,promoteBuffers:!1,fullResult:!1};r.promoteLongs=\"boolean\"!=typeof n.promoteLongs||n.promoteLongs,r.promoteValues=\"boolean\"!=typeof n.promoteValues||n.promoteValues,r.promoteBuffers=\"boolean\"==typeof n.promoteBuffers&&n.promoteBuffers,r.raw=\"boolean\"==typeof n.raw&&n.raw,r.immediateRelease=\"boolean\"==typeof n.immediateRelease&&n.immediateRelease,r.documentsReturnedIn=n.documentsReturnedIn,r.command=\"boolean\"==typeof n.command&&n.command,r.fullResult=\"boolean\"==typeof n.fullResult&&n.fullResult,r.noResponse=\"boolean\"==typeof n.noResponse&&n.noResponse,r.session=n.session||null,r.socketTimeout=n.socketTimeout,r.monitoring=n.monitoring,r.requestId=e.requestId,t.options.monitorCommands&&(this.emit(\"commandStarted\",new apm.CommandStartedEvent(this,e)),r.started=process.hrtime(),r.cb=((n,i)=>{n?t.emit(\"commandFailed\",new apm.CommandFailedEvent(this,e,n,r.started)):i&&i.result&&(0===i.result.ok||i.result.$err)?t.emit(\"commandFailed\",new apm.CommandFailedEvent(this,e,i.result,r.started)):t.emit(\"commandSucceeded\",new apm.CommandSucceededEvent(this,e,i,r.started)),\"function\"==typeof o&&o(n,i)})),serializeCommand(t,e,(e,o)=>{if(e)throw e;r.buffer=o,n.monitoring?t.queue.unshift(r):t.queue.push(r),t.executing||process.nextTick(function(){_execute(t)()})})}else o(new MongoError(\"pool is draining, new operations prohibited\"));else o(new MongoError(\"pool destroyed\"))},Pool._execute=_execute,module.exports=Pool;","node_modules/mongodb/lib/core/wireprotocol/index.js":"\"use strict\";const writeCommand=require(\"./write_command\");module.exports={insert:function(e,r,t,o,i){writeCommand(e,\"insert\",\"documents\",r,t,o,i)},update:function(e,r,t,o,i){writeCommand(e,\"update\",\"updates\",r,t,o,i)},remove:function(e,r,t,o,i){writeCommand(e,\"delete\",\"deletes\",r,t,o,i)},killCursors:require(\"./kill_cursors\"),getMore:require(\"./get_more\"),query:require(\"./query\"),command:require(\"./command\")};","node_modules/mongodb/lib/core/topologies/shared.js":"\"use strict\";const os=require(\"os\"),ReadPreference=require(\"./read_preference\"),Buffer=require(\"safe-buffer\").Buffer,TopologyType=require(\"../sdam/common\").TopologyType,MongoError=require(\"../error\").MongoError,MMAPv1_RETRY_WRITES_ERROR_CODE=20;function emitSDAMEvent(e,r,o){e.listeners(r).length>0&&e.emit(r,o)}const driverVersion=require(\"../../../package.json\").version,nodejsVersion=`'Node.js ${process.version}, ${os.endianness}`,type=os.type(),name=process.platform,architecture=process.arch,release=os.release();function createClientInfo(e){const r=e.clientInfo?clone(e.clientInfo):{driver:{name:\"nodejs\",version:driverVersion},os:{type:type,name:name,architecture:architecture,version:release}};if(e.useUnifiedTopology&&(r.platform=`${nodejsVersion} (${e.useUnifiedTopology?\"unified\":\"legacy\"})`),e.appname){var o=Buffer.from(e.appname),s=o.length>128?o.slice(0,128).toString(\"utf8\"):e.appname;r.application={name:s}}return e.driverInfo&&(e.driverInfo.name&&(r.driver.name=`${r.driver.name}|${e.driverInfo.name}`),e.driverInfo.version&&(r.driver.version=`${r.driver.version}|${e.driverInfo.version}`),e.driverInfo.platform&&(r.platform=`${r.platform}|${e.driverInfo.platform}`)),r}function createCompressionInfo(e){return e.compression&&e.compression.compressors?(e.compression.compressors.forEach(function(e){if(\"snappy\"!==e&&\"zlib\"!==e)throw new Error(\"compressors must be at least one of snappy or zlib\")}),e.compression.compressors):[]}function clone(e){return JSON.parse(JSON.stringify(e))}var getPreviousDescription=function(e){return e.s.serverDescription||(e.s.serverDescription={address:e.name,arbiters:[],hosts:[],passives:[],type:\"Unknown\"}),e.s.serverDescription},emitServerDescriptionChanged=function(e,r){e.listeners(\"serverDescriptionChanged\").length>0&&(e.emit(\"serverDescriptionChanged\",{topologyId:-1!==e.s.topologyId?e.s.topologyId:e.id,address:e.name,previousDescription:getPreviousDescription(e),newDescription:r}),e.s.serverDescription=r)},getPreviousTopologyDescription=function(e){return e.s.topologyDescription||(e.s.topologyDescription={topologyType:\"Unknown\",servers:[{address:e.name,arbiters:[],hosts:[],passives:[],type:\"Unknown\"}]}),e.s.topologyDescription},emitTopologyDescriptionChanged=function(e,r){e.listeners(\"topologyDescriptionChanged\").length>0&&(e.emit(\"topologyDescriptionChanged\",{topologyId:-1!==e.s.topologyId?e.s.topologyId:e.id,address:e.name,previousDescription:getPreviousTopologyDescription(e),newDescription:r}),e.s.serverDescription=r)},changedIsMaster=function(e,r,o){var s=getTopologyType(e,r);return getTopologyType(e,o)!==s},getTopologyType=function(e,r){return r||(r=e.ismaster),r?r.ismaster&&\"isdbgrid\"===r.msg?\"Mongos\":r.ismaster&&!r.hosts?\"Standalone\":r.ismaster?\"RSPrimary\":r.secondary?\"RSSecondary\":r.arbiterOnly?\"RSArbiter\":\"Unknown\":\"Unknown\"},inquireServerState=function(e){return function(r){if(\"destroyed\"!==e.s.state){var o=(new Date).getTime();emitSDAMEvent(e,\"serverHeartbeatStarted\",{connectionId:e.name}),e.command(\"admin.$cmd\",{ismaster:!0},{monitoring:!0},function(s,t){if(s)emitSDAMEvent(e,\"serverHeartbeatFailed\",{durationMS:n,failure:s,connectionId:e.name});else{e.emit(\"ismaster\",t,e);var n=(new Date).getTime()-o;emitSDAMEvent(e,\"serverHeartbeatSucceeded\",{durationMS:n,reply:t.result,connectionId:e.name}),changedIsMaster(e,e.s.ismaster,t.result)&&emitServerDescriptionChanged(e,{address:e.name,arbiters:[],hosts:[],passives:[],type:e.s.inTopology?getTopologyType(e):\"Standalone\"}),e.s.ismaster=t.result,e.s.isMasterLatencyMS=n}if(\"function\"==typeof r)return r(s,t);e.s.inquireServerStateTimeout=setTimeout(inquireServerState(e),e.s.haInterval)})}}},cloneOptions=function(e){var r={};for(var o in e)r[o]=e[o];return r};function Interval(e,r){var o=!1;this.start=function(){return this.isRunning()||(o=setInterval(e,r)),this},this.stop=function(){return clearInterval(o),o=!1,this},this.isRunning=function(){return!1!==o}}function Timeout(e,r){var o=!1;this.start=function(){return this.isRunning()||(o=setTimeout(e,r)),this},this.stop=function(){return clearTimeout(o),o=!1,this},this.isRunning=function(){return(!o||!o._called)&&!1!==o}}function diff(e,r){var o={servers:[]};e||(e={servers:[]});for(var s=0;s<e.servers.length;s++){for(var t=!1,n=0;n<r.servers.length;n++)if(r.servers[n].address.toLowerCase()===e.servers[s].address.toLowerCase()){t=!0;break}t||o.servers.push({address:e.servers[s].address,from:e.servers[s].type,to:\"Unknown\"})}for(n=0;n<r.servers.length;n++){for(t=!1,s=0;s<e.servers.length;s++)if(e.servers[s].address.toLowerCase()===r.servers[n].address.toLowerCase()){t=!0;break}t||o.servers.push({address:r.servers[n].address,from:\"Unknown\",to:r.servers[n].type})}for(s=0;s<e.servers.length;s++){var i=e.servers[s];for(n=0;n<r.servers.length;n++){var a=r.servers[n];i.address.toLowerCase()===a.address.toLowerCase()&&i.type!==a.type&&o.servers.push({address:i.address,from:i.type,to:a.type})}}return o}function resolveClusterTime(e,r){null==e.clusterTime?e.clusterTime=r:r.clusterTime.greaterThan(e.clusterTime.clusterTime)&&(e.clusterTime=r)}const SessionMixins={endSessions:function(e,r){Array.isArray(e)||(e=[e]),this.command(\"admin.$cmd\",{endSessions:e},{readPreference:ReadPreference.primaryPreferred},()=>{\"function\"==typeof r&&r()})}};function topologyType(e){return e.description?e.description.type:\"mongos\"===e.type?TopologyType.Sharded:\"replset\"===e.type?TopologyType.ReplicaSetWithPrimary:TopologyType.Single}const RETRYABLE_WIRE_VERSION=6,isRetryableWritesSupported=function(e){return!(e.lastIsMaster().maxWireVersion<6)&&(!!e.logicalSessionTimeoutMinutes&&topologyType(e)!==TopologyType.Single)},MMAPv1_RETRY_WRITES_ERROR_MESSAGE=\"This MongoDB deployment does not support retryable writes. Please add retryWrites=false to your connection string.\";function getMMAPError(e){if(e.code!==MMAPv1_RETRY_WRITES_ERROR_CODE||!e.errmsg.includes(\"Transaction numbers\"))return e;return new MongoError({message:MMAPv1_RETRY_WRITES_ERROR_MESSAGE,errmsg:MMAPv1_RETRY_WRITES_ERROR_MESSAGE,originalError:e})}module.exports.SessionMixins=SessionMixins,module.exports.resolveClusterTime=resolveClusterTime,module.exports.inquireServerState=inquireServerState,module.exports.getTopologyType=getTopologyType,module.exports.emitServerDescriptionChanged=emitServerDescriptionChanged,module.exports.emitTopologyDescriptionChanged=emitTopologyDescriptionChanged,module.exports.cloneOptions=cloneOptions,module.exports.createClientInfo=createClientInfo,module.exports.createCompressionInfo=createCompressionInfo,module.exports.clone=clone,module.exports.diff=diff,module.exports.Interval=Interval,module.exports.Timeout=Timeout,module.exports.isRetryableWritesSupported=isRetryableWritesSupported,module.exports.getMMAPError=getMMAPError,module.exports.topologyType=topologyType;","node_modules/mongodb/lib/core/connection/command_result.js":"\"use strict\";var CommandResult=function(t,e,s){this.result=t,this.connection=e,this.message=s};CommandResult.prototype.toJSON=function(){let t=Object.assign({},this,this.result);return delete t.message,t},CommandResult.prototype.toString=function(){return JSON.stringify(this.toJSON())},module.exports=CommandResult;","node_modules/mongodb/lib/core/connection/apm.js":"\"use strict\";const Msg=require(\"../connection/msg\").Msg,KillCursor=require(\"../connection/commands\").KillCursor,GetMore=require(\"../connection/commands\").GetMore,calculateDurationInMs=require(\"../utils\").calculateDurationInMs,SENSITIVE_COMMANDS=new Set([\"authenticate\",\"saslStart\",\"saslContinue\",\"getnonce\",\"createUser\",\"updateUser\",\"copydbgetnonce\",\"copydbsaslstart\",\"copydb\"]),extractCommandName=e=>Object.keys(e)[0],namespace=e=>e.ns,databaseName=e=>e.ns.split(\".\")[0],collectionName=e=>e.ns.split(\".\")[1],generateConnectionId=e=>`${e.options.host}:${e.options.port}`,maybeRedact=(e,t)=>SENSITIVE_COMMANDS.has(e)?{}:t,LEGACY_FIND_QUERY_MAP={$query:\"filter\",$orderby:\"sort\",$hint:\"hint\",$comment:\"comment\",$maxScan:\"maxScan\",$max:\"max\",$min:\"min\",$returnKey:\"returnKey\",$showDiskLoc:\"showRecordId\",$maxTimeMS:\"maxTimeMS\",$snapshot:\"snapshot\"},LEGACY_FIND_OPTIONS_MAP={numberToSkip:\"skip\",numberToReturn:\"batchSize\",returnFieldsSelector:\"projection\"},OP_QUERY_KEYS=[\"tailable\",\"oplogReplay\",\"noCursorTimeout\",\"awaitData\",\"partial\",\"exhaust\"],extractCommand=e=>{if(e instanceof GetMore)return{getMore:e.cursorId,collection:collectionName(e),batchSize:e.numberToReturn};if(e instanceof KillCursor)return{killCursors:collectionName(e),cursors:e.cursorIds};if(e instanceof Msg)return e.command;if(e.query&&e.query.$query){let t;return\"admin.$cmd\"===e.ns?t=Object.assign({},e.query.$query):(t={find:collectionName(e)},Object.keys(LEGACY_FIND_QUERY_MAP).forEach(n=>{void 0!==e.query[n]&&(t[LEGACY_FIND_QUERY_MAP[n]]=e.query[n])})),Object.keys(LEGACY_FIND_OPTIONS_MAP).forEach(n=>{void 0!==e[n]&&(t[LEGACY_FIND_OPTIONS_MAP[n]]=e[n])}),OP_QUERY_KEYS.forEach(n=>{e[n]&&(t[n]=e[n])}),void 0!==e.pre32Limit&&(t.limit=e.pre32Limit),e.query.$explain?{explain:t}:t}return e.query?e.query:e},extractReply=(e,t)=>e instanceof GetMore?{ok:1,cursor:{id:t.message.cursorId,ns:namespace(e),nextBatch:t.message.documents}}:e instanceof KillCursor?{ok:1,cursorsUnknown:e.cursorIds}:e.query&&void 0!==e.query.$query?{ok:1,cursor:{id:t.message.cursorId,ns:namespace(e),firstBatch:t.message.documents}}:null===t?t:t.result;class CommandStartedEvent{constructor(e,t){const n=extractCommand(t),a=extractCommandName(n);SENSITIVE_COMMANDS.has(a)&&(this.commandObj={},this.commandObj[a]=!0),Object.assign(this,{command:n,databaseName:databaseName(t),commandName:a,requestId:t.requestId,connectionId:generateConnectionId(e)})}}class CommandSucceededEvent{constructor(e,t,n,a){const o=extractCommand(t),r=extractCommandName(o);Object.assign(this,{duration:calculateDurationInMs(a),commandName:r,reply:maybeRedact(r,extractReply(t,n)),requestId:t.requestId,connectionId:generateConnectionId(e)})}}class CommandFailedEvent{constructor(e,t,n,a){const o=extractCommand(t),r=extractCommandName(o);Object.assign(this,{duration:calculateDurationInMs(a),commandName:r,failure:maybeRedact(r,n),requestId:t.requestId,connectionId:generateConnectionId(e)})}}module.exports={CommandStartedEvent:CommandStartedEvent,CommandSucceededEvent:CommandSucceededEvent,CommandFailedEvent:CommandFailedEvent};","node_modules/mongodb/lib/core/connection/connect.js":"\"use strict\";const net=require(\"net\"),tls=require(\"tls\"),Connection=require(\"./connection\"),Query=require(\"./commands\").Query,createClientInfo=require(\"../topologies/shared\").createClientInfo,MongoError=require(\"../error\").MongoError,MongoNetworkError=require(\"../error\").MongoNetworkError,defaultAuthProviders=require(\"../auth/defaultAuthProviders\").defaultAuthProviders,WIRE_CONSTANTS=require(\"../wireprotocol/constants\"),MAX_SUPPORTED_WIRE_VERSION=WIRE_CONSTANTS.MAX_SUPPORTED_WIRE_VERSION,MAX_SUPPORTED_SERVER_VERSION=WIRE_CONSTANTS.MAX_SUPPORTED_SERVER_VERSION,MIN_SUPPORTED_WIRE_VERSION=WIRE_CONSTANTS.MIN_SUPPORTED_WIRE_VERSION,MIN_SUPPORTED_SERVER_VERSION=WIRE_CONSTANTS.MIN_SUPPORTED_SERVER_VERSION;let AUTH_PROVIDERS;function connect(e,o){const r=e&&e.connectionType?e.connectionType:Connection;if(null==AUTH_PROVIDERS&&(AUTH_PROVIDERS=defaultAuthProviders(e.bson)),void 0===e.family)return makeConnection(6,e,(n,t)=>{n?makeConnection(0,e,(n,t)=>{n?o(n,t):performInitialHandshake(new r(t,e),e,o)}):performInitialHandshake(new r(t,e),e,o)});makeConnection(e.family,e,(n,t)=>{n?o(n,t):performInitialHandshake(new r(t,e),e,o)})}function getSaslSupportedMechs(e){if(!e||!e.credentials)return{};const o=e.credentials,r=o.mechanism,n=o.source||e.dbName||\"admin\",t=o.username||e.user;return\"string\"==typeof r&&\"DEFAULT\"!==r.toUpperCase()?{}:t?{saslSupportedMechs:`${n}.${t}`}:{}}function checkSupportedServer(e,o){const r=e&&\"number\"==typeof e.maxWireVersion&&e.maxWireVersion>=MIN_SUPPORTED_WIRE_VERSION,n=e&&\"number\"==typeof e.minWireVersion&&e.minWireVersion<=MAX_SUPPORTED_WIRE_VERSION;if(r){if(n)return null;const r=`Server at ${o.host}:${o.port} reports minimum wire version ${e.minWireVersion}, but this version of the Node.js Driver requires at most ${MAX_SUPPORTED_WIRE_VERSION} (MongoDB ${MAX_SUPPORTED_SERVER_VERSION})`;return new MongoError(r)}const t=`Server at ${o.host}:${o.port} reports maximum wire version ${e.maxWireVersion||0}, but this version of the Node.js Driver requires at least ${MIN_SUPPORTED_WIRE_VERSION} (MongoDB ${MIN_SUPPORTED_SERVER_VERSION})`;return new MongoError(t)}function performInitialHandshake(e,o,r){const n=function(o,n){o&&e&&e.destroy(),r(o,n)};let t=[];o.compression&&o.compression.compressors&&(t=o.compression.compressors);const i=Object.assign({ismaster:!0,client:createClientInfo(o),compression:t},getSaslSupportedMechs(o)),s=(new Date).getTime();runCommand(e,\"admin.$cmd\",i,o,(r,i)=>{if(r)return void n(r,null);if(0===i.ok)return void n(new MongoError(i),null);const c=checkSupportedServer(i,o);if(c)return void n(c,null);if(i.compression){const r=t.filter(e=>-1!==i.compression.indexOf(e));r.length&&(e.agreedCompressor=r[0]),o.compression&&o.compression.zlibCompressionLevel&&(e.zlibCompressionLevel=o.compression.zlibCompressionLevel)}e.ismaster=i,e.lastIsMasterMS=(new Date).getTime()-s;const u=o.credentials;if(!i.arbiterOnly&&u)return u.resolveAuthMechanism(i),void authenticate(e,u,n);n(null,e)})}const LEGAL_SSL_SOCKET_OPTIONS=[\"pfx\",\"key\",\"passphrase\",\"cert\",\"ca\",\"ciphers\",\"NPNProtocols\",\"ALPNProtocols\",\"servername\",\"ecdhCurve\",\"secureProtocol\",\"secureContext\",\"session\",\"minDHSize\",\"crl\",\"rejectUnauthorized\"];function parseConnectOptions(e,o){const r=\"string\"==typeof o.host?o.host:\"localhost\";return-1!==r.indexOf(\"/\")?{path:r}:{family:e,host:r,port:\"number\"==typeof o.port?o.port:27017,rejectUnauthorized:!1}}function parseSslOptions(e,o){const r=parseConnectOptions(e,o);for(const e in o)null!=o[e]&&-1!==LEGAL_SSL_SOCKET_OPTIONS.indexOf(e)&&(r[e]=o[e]);return!1===o.checkServerIdentity?r.checkServerIdentity=function(){}:\"function\"==typeof o.checkServerIdentity&&(r.checkServerIdentity=o.checkServerIdentity),null==r.servername&&(r.servername=r.host),r}function makeConnection(e,o,r){const n=\"boolean\"==typeof o.ssl&&o.ssl,t=\"boolean\"!=typeof o.keepAlive||o.keepAlive;let i=\"number\"==typeof o.keepAliveInitialDelay?o.keepAliveInitialDelay:3e5;const s=\"boolean\"!=typeof o.noDelay||o.noDelay,c=\"number\"==typeof o.connectionTimeout?o.connectionTimeout:3e4,u=\"number\"==typeof o.socketTimeout?o.socketTimeout:36e4,a=\"boolean\"!=typeof o.rejectUnauthorized||o.rejectUnauthorized;let l;i>u&&(i=Math.round(u/2));const m=function(e,o){e&&l&&l.destroy(),r(e,o)};try{n?\"function\"==typeof(l=tls.connect(parseSslOptions(e,o))).disableRenegotiation&&l.disableRenegotiation():l=net.createConnection(parseConnectOptions(e,o))}catch(e){return m(e)}l.setKeepAlive(t,i),l.setTimeout(c),l.setNoDelay(s);const E=[\"error\",\"close\",\"timeout\",\"parseError\"];function p(e){return o=>{E.forEach(e=>l.removeAllListeners(e)),l.removeListener(\"connect\",S),m(connectionFailureError(e,o),e)}}function S(){if(E.forEach(e=>l.removeAllListeners(e)),l.authorizationError&&a)return m(l.authorizationError);l.setTimeout(u),m(null,l)}l.once(\"error\",p(\"error\")),l.once(\"close\",p(\"close\")),l.once(\"timeout\",p(\"timeout\")),l.once(\"parseError\",p(\"parseError\")),l.once(\"connect\",S)}const CONNECTION_ERROR_EVENTS=[\"error\",\"close\",\"timeout\",\"parseError\"];function runCommand(e,o,r,n,t){\"function\"==typeof n&&(t=n,n={});const i=\"number\"==typeof n.socketTimeout?n.socketTimeout:36e4,s=e.options.bson,c=new Query(s,o,r,{numberToSkip:0,numberToReturn:1}),u=()=>{};function a(e,o){t(e,o),t=u}function l(o){e.resetSocketTimeout(),CONNECTION_ERROR_EVENTS.forEach(o=>e.removeListener(o,l)),e.removeListener(\"message\",m),null==o&&(o=new MongoError(`runCommand failed for connection to '${e.address}'`)),e.on(\"error\",u),a(o,null)}function m(o){o.responseTo===c.requestId&&(e.resetSocketTimeout(),CONNECTION_ERROR_EVENTS.forEach(o=>e.removeListener(o,l)),e.removeListener(\"message\",m),o.parse({promoteValues:!0}),a(null,o.documents[0]))}e.setSocketTimeout(i),CONNECTION_ERROR_EVENTS.forEach(o=>e.once(o,l)),e.on(\"message\",m),e.write(c.toBin())}function authenticate(e,o,r){const n=o.mechanism;AUTH_PROVIDERS[n]?AUTH_PROVIDERS[n].auth(runCommand,[e],o,o=>{if(o)return r(o);r(null,e)}):r(new MongoError(`authMechanism '${n}' not supported`))}function connectionFailureError(e,o){switch(e){case\"error\":return new MongoNetworkError(o);case\"timeout\":return new MongoNetworkError(\"connection timed out\");case\"close\":return new MongoNetworkError(\"connection closed\");default:return new MongoNetworkError(\"unknown network error\")}}module.exports=connect;","node_modules/mongodb/package.json":{"_from":"mongodb@^3.3.5","_id":"mongodb@3.3.5","_inBundle":false,"_integrity":"sha512-6NAv5gTFdwRyVfCz+O+KDszvjpyxmZw+VlmqmqKR2GmpkeKrKFRv/ZslgTtZba2dc9JYixIf99T5Gih7TIWv7Q==","_location":"/mongodb","_phantomChildren":{},"_requested":{"type":"range","registry":true,"raw":"mongodb@^3.3.5","name":"mongodb","escapedName":"mongodb","rawSpec":"^3.3.5","saveSpec":null,"fetchSpec":"^3.3.5"},"_requiredBy":["/"],"_resolved":"https://registry.npmjs.org/mongodb/-/mongodb-3.3.5.tgz","_shasum":"38d531013afede92b0dd282e3b9f3c08c9bdff3b","_spec":"mongodb@^3.3.5","_where":"C:\\Workspace\\walkner\\walkner-snf","bugs":{"url":"https://github.com/mongodb/node-mongodb-native/issues"},"bundleDependencies":false,"dependencies":{"bson":"^1.1.1","require_optional":"^1.0.1","safe-buffer":"^5.1.2","saslprep":"^1.0.0"},"deprecated":false,"description":"The official MongoDB driver for Node.js","devDependencies":{"bluebird":"3.5.0","chai":"^4.1.1","chai-subset":"^1.6.0","chalk":"^2.4.2","co":"4.6.0","coveralls":"^2.11.6","eslint":"^4.5.0","eslint-plugin-prettier":"^2.2.0","istanbul":"^0.4.5","jsdoc":"3.5.5","lodash.camelcase":"^4.3.0","mocha":"5.2.0","mocha-sinon":"^2.1.0","mongodb-extjson":"^2.1.1","mongodb-mock-server":"^1.0.1","prettier":"~1.12.0","semver":"^5.5.0","sinon":"^4.3.0","sinon-chai":"^3.2.0","snappy":"^6.1.2","standard-version":"^4.4.0","worker-farm":"^1.5.0","wtfnode":"^0.8.0","yargs":"^14.2.0"},"engines":{"node":">=4"},"files":["index.js","lib"],"homepage":"https://github.com/mongodb/node-mongodb-native","keywords":["mongodb","driver","official"],"license":"Apache-2.0","main":"index.js","name":"mongodb","optionalDependencies":{"saslprep":"^1.0.0"},"peerOptionalDependencies":{"kerberos":"^1.1.0","mongodb-client-encryption":"^1.0.0","mongodb-extjson":"^2.1.2","snappy":"^6.1.1","bson-ext":"^2.0.0"},"repository":{"type":"git","url":"git+ssh://git@github.com/mongodb/node-mongodb-native.git"},"scripts":{"atlas":"node ./test/atlas_connectivity_tests.js","bench":"node test/driverBench/","coverage":"istanbul cover mongodb-test-runner -- -t 60000 test/core test/unit test/functional","format":"prettier --print-width 100 --tab-width 2 --single-quote --write 'test/**/*.js' 'lib/**/*.js'","generate-evergreen":"node .evergreen/generate_evergreen_tasks.js","lint":"eslint lib test","release":"standard-version -i HISTORY.md","test":"npm run lint && mocha --recursive test/functional test/unit test/core","test-nolint":"mocha --recursive test/functional test/unit test/core"},"version":"3.3.5"},"node_modules/mongodb/lib/core/auth/sspi.js":"\"use strict\";const AuthProvider=require(\"./auth_provider\").AuthProvider,retrieveKerberos=require(\"../utils\").retrieveKerberos;let kerberos;class SSPI extends AuthProvider{_authenticateSingleConnection(e,r,t,n){const i=t.username,o=t.password,s=t.mechanismProperties,a=s.gssapiservicename||s.gssapiServiceName||\"mongodb\";SSIPAuthenticate(this,kerberos.processes.MongoAuthProcess,i,o,a,e,r,s,n)}auth(e,r,t,n){if(null==kerberos)try{kerberos=retrieveKerberos()}catch(e){return n(e,null)}super.auth(e,r,t,n)}}function SSIPAuthenticate(e,r,t,n,i,o,s,a,u){const c=new r(s.host,s.port,i,a);function l(e,r){o(s,\"$external.$cmd\",e,r)}c.init(t,n,e=>{if(e)return u(e,!1);c.transition(\"\",(e,r)=>{if(e)return u(e,!1);l({saslStart:1,mechanism:\"GSSAPI\",payload:r,autoAuthorize:1},(e,r)=>{if(e)return u(e,!1);c.transition(r.payload,(e,t)=>{if(e)return u(e,!1);l({saslContinue:1,conversationId:r.conversationId,payload:t},(e,r)=>{if(e)return u(e,!1);c.transition(r.payload,(e,t)=>{if(e)return u(e,!1);l({saslContinue:1,conversationId:r.conversationId,payload:t},(e,r)=>{if(e)return u(e,!1);c.transition(null,e=>{if(e)return u(e,null);u(null,r)})})})})})})})})}module.exports=SSPI;","node_modules/mongodb/lib/core/auth/auth_provider.js":"\"use strict\";const MongoError=require(\"../error\").MongoError;class AuthProvider{constructor(t){this.bson=t,this.authStore=[]}auth(t,e,r,n){let o=e.length;if(0===o)return void n(null,null);let i=0,u=null;const l=e=>{this._authenticateSingleConnection(t,e,r,(t,e)=>{o-=1,t?u=new MongoError(t):e&&(e.$err||e.errmsg)?u=new MongoError(e):i+=1,0===o&&(i>0?(this.addCredentials(r),n(null,!0)):(null==u&&(u=new MongoError(`failed to authenticate using ${r.mechanism}`)),n(u,!1)))})},h=t=>process.nextTick(()=>l(t));for(;e.length>0;)h(e.shift())}_authenticateSingleConnection(){throw new Error(\"_authenticateSingleConnection must be overridden\")}addCredentials(t){this.authStore.some(e=>e.equals(t))||this.authStore.push(t)}reauthenticate(t,e,r){const n=this.authStore.slice(0);let o=n.length;if(0===o)return r(null,null);for(let i=0;i<n.length;i++)this.auth(t,e,n[i],function(t){0===(o-=1)&&r(t,null)})}logout(t){this.authStore=this.authStore.filter(e=>e.source!==t)}}module.exports={AuthProvider:AuthProvider};","node_modules/saslprep/index.js":"\"use strict\";const{unassigned_code_points:unassigned_code_points,commonly_mapped_to_nothing:commonly_mapped_to_nothing,non_ASCII_space_characters:non_ASCII_space_characters,prohibited_characters:prohibited_characters,bidirectional_r_al:bidirectional_r_al,bidirectional_l:bidirectional_l}=require(\"./lib/memory-code-points\");module.exports=saslprep;const mapping2space=non_ASCII_space_characters,mapping2nothing=commonly_mapped_to_nothing,getCodePoint=t=>t.codePointAt(0),first=t=>t[0],last=t=>t[t.length-1];function toCodePoints(t){const e=[],o=t.length;for(let n=0;n<o;n+=1){const i=t.charCodeAt(n);if(i>=55296&&i<=56319&&o>n+1){const o=t.charCodeAt(n+1);if(o>=56320&&o<=57343){e.push(1024*(i-55296)+o-56320+65536),n+=1;continue}}e.push(i)}return e}function saslprep(t,e={}){if(\"string\"!=typeof t)throw new TypeError(\"Expected string.\");if(0===t.length)return\"\";const o=toCodePoints(t).map(t=>mapping2space.get(t)?32:t).filter(t=>!mapping2nothing.get(t)),n=String.fromCodePoint.apply(null,o).normalize(\"NFKC\"),i=toCodePoints(n);if(i.some(t=>prohibited_characters.get(t)))throw new Error(\"Prohibited character, see https://tools.ietf.org/html/rfc4013#section-2.3\");if(!0!==e.allowUnassigned){if(i.some(t=>unassigned_code_points.get(t)))throw new Error(\"Unassigned code point, see https://tools.ietf.org/html/rfc4013#section-2.5\")}const r=i.some(t=>bidirectional_r_al.get(t)),s=i.some(t=>bidirectional_l.get(t));if(r&&s)throw new Error(\"String must not contain RandALCat and LCat at the same time, see https://tools.ietf.org/html/rfc3454#section-6\");const a=bidirectional_r_al.get(getCodePoint(first(n))),c=bidirectional_r_al.get(getCodePoint(last(n)));if(r&&(!a||!c))throw new Error(\"Bidirectional RandALCat character must be the first and the last character of the string, see https://tools.ietf.org/html/rfc3454#section-6\");return n}","node_modules/saslprep/lib/memory-code-points.js":"\"use strict\";const fs=require(\"fs\"),path=require(\"path\"),bitfield=require(\"sparse-bitfield\"),memory=fs.readFileSync(path.resolve(__dirname,\"../code-points.mem\"));let offset=0;function read(){const e=memory.readUInt32BE(offset);offset+=4;const r=memory.slice(offset,offset+e);return offset+=e,bitfield({buffer:r})}const unassigned_code_points=read(),commonly_mapped_to_nothing=read(),non_ASCII_space_characters=read(),prohibited_characters=read(),bidirectional_r_al=read(),bidirectional_l=read();module.exports={unassigned_code_points:unassigned_code_points,commonly_mapped_to_nothing:commonly_mapped_to_nothing,non_ASCII_space_characters:non_ASCII_space_characters,prohibited_characters:prohibited_characters,bidirectional_r_al:bidirectional_r_al,bidirectional_l:bidirectional_l};","node_modules/sparse-bitfield/index.js":"var pager=require(\"memory-pager\");function Bitfield(e){if(!(this instanceof Bitfield))return new Bitfield(e);if(e||(e={}),Buffer.isBuffer(e)&&(e={buffer:e}),this.pageOffset=e.pageOffset||0,this.pageSize=e.pageSize||1024,this.pages=e.pages||pager(this.pageSize),this.byteLength=this.pages.length*this.pageSize,this.length=8*this.byteLength,!powerOfTwo(this.pageSize))throw new Error(\"The page size should be a power of two\");if(this._trackUpdates=!!e.trackUpdates,this._pageMask=this.pageSize-1,e.buffer){for(var t=0;t<e.buffer.length;t+=this.pageSize)this.pages.set(t/this.pageSize,e.buffer.slice(t,t+this.pageSize));this.byteLength=e.buffer.length,this.length=8*this.byteLength}}function alloc(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t}function powerOfTwo(e){return!(e&e-1)}module.exports=Bitfield,Bitfield.prototype.get=function(e){var t=7&e,i=(e-t)/8;return!!(this.getByte(i)&128>>t)},Bitfield.prototype.getByte=function(e){var t=e&this._pageMask,i=(e-t)/this.pageSize,s=this.pages.get(i,!0);return s?s.buffer[t+this.pageOffset]:0},Bitfield.prototype.set=function(e,t){var i=7&e,s=(e-i)/8,f=this.getByte(s);return this.setByte(s,t?f|128>>i:f&(255^128>>i))},Bitfield.prototype.toBuffer=function(){for(var e=alloc(this.pages.length*this.pageSize),t=0;t<this.pages.length;t++){var i=this.pages.get(t,!0),s=t*this.pageSize;i&&i.buffer.copy(e,s,this.pageOffset,this.pageOffset+this.pageSize)}return e},Bitfield.prototype.setByte=function(e,t){var i=e&this._pageMask,s=(e-i)/this.pageSize,f=this.pages.get(s,!1);return i+=this.pageOffset,f.buffer[i]!==t&&(f.buffer[i]=t,e>=this.byteLength&&(this.byteLength=e+1,this.length=8*this.byteLength),this._trackUpdates&&this.pages.updated(f),!0)};","node_modules/memory-pager/index.js":"function Pager(e,t){if(!(this instanceof Pager))return new Pager(e,t);this.length=0,this.updates=[],this.path=new Uint16Array(4),this.pages=new Array(32768),this.maxPages=this.pages.length,this.level=0,this.pageSize=e||1024,this.deduplicate=t?t.deduplicate:null,this.zeros=this.deduplicate?alloc(this.deduplicate.length):null}function grow(e,t){for(;e.maxPages<t;){var a=e.pages;e.pages=new Array(32768),e.pages[0]=a,e.level++,e.maxPages*=32768}}function truncate(e,t){if(e.length===t)return e;if(e.length>t)return e.slice(0,t);var a=alloc(t);return e.copy(a),a}function alloc(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t}function copy(e){var t=Buffer.allocUnsafe?Buffer.allocUnsafe(e.length):new Buffer(e.length);return e.copy(t),t}function Page(e,t){this.offset=e*t.length,this.buffer=t,this.updated=!1,this.deduplicate=0}function factor(e,t){e=((e=(e-(t[0]=32767&e))/32768)-(t[1]=32767&e))/32768,t[3]=(e-(t[2]=32767&e))/32768&32767}module.exports=Pager,Pager.prototype.updated=function(e){for(;this.deduplicate&&e.buffer[e.deduplicate]===this.deduplicate[e.deduplicate];)if(e.deduplicate++,e.deduplicate===this.deduplicate.length){e.deduplicate=0,e.buffer.equals&&e.buffer.equals(this.deduplicate)&&(e.buffer=this.deduplicate);break}!e.updated&&this.updates&&(e.updated=!0,this.updates.push(e))},Pager.prototype.lastUpdate=function(){if(!this.updates||!this.updates.length)return null;var e=this.updates.pop();return e.updated=!1,e},Pager.prototype._array=function(e,t){if(e>=this.maxPages){if(t)return;grow(this,e)}factor(e,this.path);for(var a=this.pages,r=this.level;r>0;r--){var i=this.path[r],u=a[i];if(!u){if(t)return;u=a[i]=new Array(32768)}a=u}return a},Pager.prototype.get=function(e,t){var a=this._array(e,t),r=this.path[0],i=a&&a[r];return i||t||(i=a[r]=new Page(e,alloc(this.pageSize)),e>=this.length&&(this.length=e+1)),i&&i.buffer===this.deduplicate&&this.deduplicate&&!t&&(i.buffer=copy(i.buffer),i.deduplicate=0),i},Pager.prototype.set=function(e,t){var a=this._array(e,!1),r=this.path[0];if(e>=this.length&&(this.length=e+1),!t||this.zeros&&t.equals&&t.equals(this.zeros))a[r]=void 0;else{this.deduplicate&&t.equals&&t.equals(this.deduplicate)&&(t=this.deduplicate);var i=a[r],u=truncate(t,this.pageSize);i?i.buffer=u:a[r]=new Page(e,u)}},Pager.prototype.toBuffer=function(){for(var e=new Array(this.length),t=alloc(this.pageSize),a=0;a<e.length;)for(var r=this._array(a,!0),i=0;i<32768&&a<e.length;i++)e[a++]=r&&r[i]?r[i].buffer:t;return Buffer.concat(e)};","node_modules/mongodb/lib/core/transactions.js":"\"use strict\";const MongoError=require(\"./error\").MongoError;let TxnState,stateMachine;TxnState={NO_TRANSACTION:\"NO_TRANSACTION\",STARTING_TRANSACTION:\"STARTING_TRANSACTION\",TRANSACTION_IN_PROGRESS:\"TRANSACTION_IN_PROGRESS\",TRANSACTION_COMMITTED:\"TRANSACTION_COMMITTED\",TRANSACTION_COMMITTED_EMPTY:\"TRANSACTION_COMMITTED_EMPTY\",TRANSACTION_ABORTED:\"TRANSACTION_ABORTED\"},stateMachine={NO_TRANSACTION:[\"NO_TRANSACTION\",\"STARTING_TRANSACTION\"],STARTING_TRANSACTION:[\"TRANSACTION_IN_PROGRESS\",\"TRANSACTION_COMMITTED\",\"TRANSACTION_COMMITTED_EMPTY\",\"TRANSACTION_ABORTED\"],TRANSACTION_IN_PROGRESS:[\"TRANSACTION_IN_PROGRESS\",\"TRANSACTION_COMMITTED\",\"TRANSACTION_ABORTED\"],TRANSACTION_COMMITTED:[\"TRANSACTION_COMMITTED\",\"TRANSACTION_COMMITTED_EMPTY\",\"STARTING_TRANSACTION\",\"NO_TRANSACTION\"],TRANSACTION_ABORTED:[\"STARTING_TRANSACTION\",\"NO_TRANSACTION\"],TRANSACTION_COMMITTED_EMPTY:[\"TRANSACTION_COMMITTED_EMPTY\",\"NO_TRANSACTION\"]};class Transaction{constructor(T){if(T=T||{},this.state=TxnState.NO_TRANSACTION,this.options={},T.writeConcern||void 0!==T.w){if((T.writeConcern?T.writeConcern.w:T.w)<=0)throw new MongoError(\"Transactions do not support unacknowledged write concern\");this.options.writeConcern=T.writeConcern?T.writeConcern:{w:T.w}}T.readConcern&&(this.options.readConcern=T.readConcern),T.readPreference&&(this.options.readPreference=T.readPreference),T.maxCommitTimeMS&&(this.options.maxTimeMS=T.maxCommitTimeMS),this._pinnedServer=void 0,this._recoveryToken=void 0}get server(){return this._pinnedServer}get recoveryToken(){return this._recoveryToken}get isPinned(){return!!this.server}get isActive(){return-1!==[TxnState.STARTING_TRANSACTION,TxnState.TRANSACTION_IN_PROGRESS].indexOf(this.state)}transition(T){const e=stateMachine[this.state];if(e&&-1!==e.indexOf(T))return this.state=T,void(this.state!==TxnState.NO_TRANSACTION&&this.state!==TxnState.STARTING_TRANSACTION||this.unpinServer());throw new MongoError(`Attempted illegal state transition from [${this.state}] to [${T}]`)}pinServer(T){this.isActive&&(this._pinnedServer=T)}unpinServer(){this._pinnedServer=void 0}}function isTransactionCommand(T){return!(!T.commitTransaction&&!T.abortTransaction)}module.exports={TxnState:TxnState,Transaction:Transaction,isTransactionCommand:isTransactionCommand};","node_modules/mongodb/lib/core/wireprotocol/write_command.js":"\"use strict\";const MongoError=require(\"../error\").MongoError,collectionNamespace=require(\"./shared\").collectionNamespace,command=require(\"./command\");function writeCommand(o,e,n,t,r,c,a){if(0===r.length)throw new MongoError(`${e} must contain at least one document`);\"function\"==typeof c&&(a=c,c={});const i=\"boolean\"!=typeof(c=c||{}).ordered||c.ordered,l=c.writeConcern,s={};if(s[e]=collectionNamespace(t),s[n]=r,s.ordered=i,l&&Object.keys(l).length>0&&(s.writeConcern=l),c.collation)for(let o=0;o<s[n].length;o++)s[n][o].collation||(s[n][o].collation=c.collation);!0===c.bypassDocumentValidation&&(s.bypassDocumentValidation=c.bypassDocumentValidation);const m=Object.assign({checkKeys:\"insert\"===e,numberToReturn:1},c);command(o,t,s,m,a)}module.exports=writeCommand;","node_modules/mongodb/lib/core/wireprotocol/kill_cursors.js":"\"use strict\";const KillCursor=require(\"../connection/commands\").KillCursor,MongoError=require(\"../error\").MongoError,MongoNetworkError=require(\"../error\").MongoNetworkError,collectionNamespace=require(\"./shared\").collectionNamespace,maxWireVersion=require(\"../utils\").maxWireVersion,command=require(\"./command\");function killCursors(r,o,e,s){s=\"function\"==typeof s?s:()=>{};const n=e.cursorId;if(maxWireVersion(r)<4){const i=r.s.bson,t=r.s.pool,c=new KillCursor(i,o,[n]),u={immediateRelease:!0,noResponse:!0};if(\"object\"==typeof e.session&&(u.session=e.session),t&&t.isConnected())try{t.write(c,u,s)}catch(r){\"function\"==typeof s?s(r,null):console.warn(r)}return}const i={killCursors:collectionNamespace(o),cursors:[n]},t={};\"object\"==typeof e.session&&(t.session=e.session),command(r,o,i,t,(r,o)=>{if(r)return s(r);const e=o.message;return e.cursorNotFound?s(new MongoNetworkError(\"cursor killed or timed out\"),null):Array.isArray(e.documents)&&0!==e.documents.length?void s(null,e.documents[0]):s(new MongoError(`invalid killCursors result returned for cursor id ${n}`))})}module.exports=killCursors;","node_modules/mongodb/lib/core/wireprotocol/get_more.js":"\"use strict\";const GetMore=require(\"../connection/commands\").GetMore,retrieveBSON=require(\"../connection/utils\").retrieveBSON,MongoError=require(\"../error\").MongoError,MongoNetworkError=require(\"../error\").MongoNetworkError,BSON=retrieveBSON(),Long=BSON.Long,collectionNamespace=require(\"./shared\").collectionNamespace,maxWireVersion=require(\"../utils\").maxWireVersion,applyCommonQueryOptions=require(\"./shared\").applyCommonQueryOptions,command=require(\"./command\");function getMore(e,o,r,n,t,c){t=t||{};const s=maxWireVersion(e);function u(e,o){if(e)return c(e);const n=o.message;if(n.cursorNotFound)return c(new MongoNetworkError(\"cursor killed or timed out\"),null);if(s<4){const e=\"number\"==typeof n.cursorId?Long.fromNumber(n.cursorId):n.cursorId;return r.documents=n.documents,r.cursorId=e,void c(null,null,n.connection)}if(0===n.documents[0].ok)return c(new MongoError(n.documents[0]));const t=\"number\"==typeof n.documents[0].cursor.id?Long.fromNumber(n.documents[0].cursor.id):n.documents[0].cursor.id;r.documents=n.documents[0].cursor.nextBatch,r.cursorId=t,c(null,n.documents[0],n.connection)}if(s<4){const t=e.s.bson,c=new GetMore(t,o,r.cursorId,{numberToReturn:n}),s=applyCommonQueryOptions({},r);return void e.s.pool.write(c,s,u)}const i={getMore:r.cursorId,collection:collectionNamespace(o),batchSize:Math.abs(n)};r.cmd.tailable&&\"number\"==typeof r.cmd.maxAwaitTimeMS&&(i.maxTimeMS=r.cmd.maxAwaitTimeMS);const m=Object.assign({returnFieldSelector:null,documentsReturnedIn:\"nextBatch\"},t);r.session&&(m.session=r.session),command(e,o,i,m,u)}module.exports=getMore;","node_modules/mongodb/lib/core/wireprotocol/query.js":"\"use strict\";const Query=require(\"../connection/commands\").Query,MongoError=require(\"../error\").MongoError,getReadPreference=require(\"./shared\").getReadPreference,collectionNamespace=require(\"./shared\").collectionNamespace,isSharded=require(\"./shared\").isSharded,maxWireVersion=require(\"../utils\").maxWireVersion,applyCommonQueryOptions=require(\"./shared\").applyCommonQueryOptions,command=require(\"./command\");function query(e,a,r,i,o,t){if(o=o||{},null!=i.cursorId)return t();if(null==r)return t(new MongoError(`command ${JSON.stringify(r)} does not return a cursor`));if(maxWireVersion(e)<4){const n=prepareLegacyFindQuery(e,a,r,i,o),s=applyCommonQueryOptions({},i);return\"string\"==typeof n.documentsReturnedIn&&(s.documentsReturnedIn=n.documentsReturnedIn),void e.s.pool.write(n,s,t)}const n=getReadPreference(r,o),s=prepareFindCommand(e,a,r,i,o);r.virtual=!1;const l=Object.assign({documentsReturnedIn:\"firstBatch\",numberToReturn:1,slaveOk:n.slaveOk()},o);r.readPreference&&(l.readPreference=n),i.session&&(l.session=i.session),command(e,a,s,l,t)}function prepareFindCommand(e,a,r,i){i.batchSize=r.batchSize||i.batchSize;let o={find:collectionNamespace(a)};r.query&&(r.query.$query?o.filter=r.query.$query:o.filter=r.query);let t=r.sort;if(Array.isArray(t)){const e={};if(t.length>0&&!Array.isArray(t[0])){let a=t[1];\"asc\"===a?a=1:\"desc\"===a&&(a=-1),e[t[0]]=a}else for(let a=0;a<t.length;a++){let r=t[a][1];\"asc\"===r?r=1:\"desc\"===r&&(r=-1),e[t[a][0]]=r}t=e}return r.sort&&(o.sort=t),r.fields&&(o.projection=r.fields),r.hint&&(o.hint=r.hint),r.skip&&(o.skip=r.skip),r.limit&&(o.limit=r.limit),r.limit<0&&(o.limit=Math.abs(r.limit),o.singleBatch=!0),\"number\"==typeof r.batchSize&&(r.batchSize<0&&(0!==r.limit&&Math.abs(r.batchSize)<Math.abs(r.limit)&&(o.limit=Math.abs(r.batchSize)),o.singleBatch=!0),o.batchSize=Math.abs(r.batchSize)),r.comment&&(o.comment=r.comment),r.maxScan&&(o.maxScan=r.maxScan),r.maxTimeMS&&(o.maxTimeMS=r.maxTimeMS),r.min&&(o.min=r.min),r.max&&(o.max=r.max),o.returnKey=!!r.returnKey&&r.returnKey,o.showRecordId=!!r.showDiskLoc&&r.showDiskLoc,r.snapshot&&(o.snapshot=r.snapshot),r.tailable&&(o.tailable=r.tailable),r.oplogReplay&&(o.oplogReplay=r.oplogReplay),r.noCursorTimeout&&(o.noCursorTimeout=r.noCursorTimeout),r.awaitData&&(o.awaitData=r.awaitData),r.awaitdata&&(o.awaitData=r.awaitdata),r.partial&&(o.partial=r.partial),r.collation&&(o.collation=r.collation),r.readConcern&&(o.readConcern=r.readConcern),r.explain&&(o={explain:o}),o}function prepareLegacyFindQuery(e,a,r,i,o){o=o||{};const t=e.s.bson,n=getReadPreference(r,o);i.batchSize=r.batchSize||i.batchSize;let s=0;s=i.limit<0||0!==i.limit&&i.limit<i.batchSize||i.limit>0&&0===i.batchSize?i.limit:i.batchSize;const l=i.skip||0,c={};if(isSharded(e)&&n&&(c.$readPreference=n.toJSON()),r.sort&&(c.$orderby=r.sort),r.hint&&(c.$hint=r.hint),r.snapshot&&(c.$snapshot=r.snapshot),void 0!==r.returnKey&&(c.$returnKey=r.returnKey),r.maxScan&&(c.$maxScan=r.maxScan),r.min&&(c.$min=r.min),r.max&&(c.$max=r.max),void 0!==r.showDiskLoc&&(c.$showDiskLoc=r.showDiskLoc),r.comment&&(c.$comment=r.comment),r.maxTimeMS&&(c.$maxTimeMS=r.maxTimeMS),r.explain&&(s=-Math.abs(r.limit||0),c.$explain=!0),c.$query=r.query,r.readConcern&&\"local\"!==r.readConcern.level)throw new MongoError(`server find command does not support a readConcern level of ${r.readConcern.level}`);r.readConcern&&delete(r=Object.assign({},r)).readConcern;const m=\"boolean\"==typeof o.serializeFunctions&&o.serializeFunctions,u=\"boolean\"==typeof o.ignoreUndefined&&o.ignoreUndefined,d=new Query(t,a,c,{numberToSkip:l,numberToReturn:s,pre32Limit:void 0!==r.limit?r.limit:void 0,checkKeys:!1,returnFieldSelector:r.fields,serializeFunctions:m,ignoreUndefined:u});return\"boolean\"==typeof r.tailable&&(d.tailable=r.tailable),\"boolean\"==typeof r.oplogReplay&&(d.oplogReplay=r.oplogReplay),\"boolean\"==typeof r.noCursorTimeout&&(d.noCursorTimeout=r.noCursorTimeout),\"boolean\"==typeof r.awaitData&&(d.awaitData=r.awaitData),\"boolean\"==typeof r.partial&&(d.partial=r.partial),d.slaveOk=n.slaveOk(),d}module.exports=query;","node_modules/mongodb/lib/core/wireprotocol/command.js":"\"use strict\";const Query=require(\"../connection/commands\").Query,Msg=require(\"../connection/msg\").Msg,MongoError=require(\"../error\").MongoError,getReadPreference=require(\"./shared\").getReadPreference,isSharded=require(\"./shared\").isSharded,databaseNamespace=require(\"./shared\").databaseNamespace,isTransactionCommand=require(\"../transactions\").isTransactionCommand,applySession=require(\"../sessions\").applySession,MongoNetworkError=require(\"../error\").MongoNetworkError;function isClientEncryptionEnabled(r){return r.autoEncrypter}function command(r,e,n,s,o){if(\"function\"==typeof s&&(o=s,s={}),s=s||{},null==n)return o(new MongoError(`command ${JSON.stringify(n)} does not return a cursor`));isClientEncryptionEnabled(r)?_cryptCommand(r,e,n,s,o):_command(r,e,n,s,o)}function _command(r,e,n,s,o){const t=r.s.bson,a=r.s.pool,i=getReadPreference(n,s),c=supportsOpMsg(r),u=s.session;let m=r.clusterTime,l=Object.assign({},n);if(hasSessionSupport(r)&&u){u.clusterTime&&u.clusterTime.clusterTime.greaterThan(m.clusterTime)&&(m=u.clusterTime);const r=applySession(u,l,s);if(r)return o(r)}m&&(l.$clusterTime=m),isSharded(r)&&!c&&i&&\"primary\"!==i.preference&&(l={$query:l,$readPreference:i.toJSON()});const p=Object.assign({command:!0,numberToSkip:0,numberToReturn:-1,checkKeys:!1},s);p.slaveOk=i.slaveOk();const d=`${databaseNamespace(e)}.$cmd`,y=c?new Msg(t,d,l,p):new Query(t,d,l,p),f=u&&(u.inTransaction()||isTransactionCommand(l))?function(r){return r&&r instanceof MongoNetworkError&&!r.hasErrorLabel(\"TransientTransactionError\")&&(null==r.errorLabels&&(r.errorLabels=[]),r.errorLabels.push(\"TransientTransactionError\")),!n.commitTransaction&&r&&r instanceof MongoError&&r.hasErrorLabel(\"TransientTransactionError\")&&u.transaction.unpinServer(),o.apply(null,arguments)}:o;try{a.write(y,p,f)}catch(r){f(r)}}function hasSessionSupport(r){return null!=r&&(r.description?r.description.maxWireVersion>=6:null!=r.ismaster&&r.ismaster.maxWireVersion>=6)}function supportsOpMsg(r){const e=r.ismaster?r.ismaster:r.description;return null!=e&&(e.maxWireVersion>=6&&null==e.__nodejs_mock_server__)}function _cryptCommand(r,e,n,s,o){const t=!!r.s.options.bypassAutoEncryption,a=r.autoEncrypter;function i(r,e){r||null==e?o(r,e):a.decrypt(e.result,(r,n)=>{r?o(r,null):(e.result=n,e.message.documents=[n],o(null,e))})}t?_command(r,e,n,s,i):a.encrypt(e,n,(n,t)=>{n?o(n,null):_command(r,e,t,s,i)})}module.exports=command;","node_modules/mongodb/lib/operations/execute_operation.js":"\"use strict\";const MongoError=require(\"../core/error\").MongoError,Aspect=require(\"./operation\").Aspect,OperationBase=require(\"./operation\").OperationBase,ReadPreference=require(\"../core/topologies/read_preference\"),isRetryableError=require(\"../core/error\").isRetryableError,maxWireVersion=require(\"../core/utils\").maxWireVersion,isUnifiedTopology=require(\"../core/utils\").isUnifiedTopology;function executeOperation(e,r,o){if(null==e)throw new TypeError(\"This method requires a valid topology instance\");if(!(r instanceof OperationBase))throw new TypeError(\"This method requires a valid operation instance\");if(isUnifiedTopology(e)&&!r.hasAspect(Aspect.SKIP_SESSION)&&e.shouldCheckForSessionSupport())return selectServerForSessionSupport(e,r,o);const s=e.s.promiseLibrary;let t,n;if(!r.hasAspect(Aspect.SKIP_SESSION)&&e.hasSessionSupport())if(null==r.session)n=Symbol(),t=e.startSession({owner:n}),r.session=t;else if(r.session.hasEnded)throw new MongoError(\"Use of expired sessions is not permitted\");const i=(e,o)=>(function(s,i){if(t&&t.owner===n)t.endSession(()=>{if(r.session===t&&r.clearSession(),s)return o(s);e(i)});else{if(s)return o(s);e(i)}});if(\"function\"==typeof o){const s=i(e=>o(null,e),e=>o(e,null));try{return r.hasAspect(Aspect.EXECUTE_WITH_SELECTION)?executeWithServerSelection(e,r,s):r.execute(s)}catch(e){throw s(e),e}}return new s(function(o,s){const t=i(o,s);try{return r.hasAspect(Aspect.EXECUTE_WITH_SELECTION)?executeWithServerSelection(e,r,t):r.execute(t)}catch(e){t(e)}})}function supportsRetryableReads(e){return maxWireVersion(e)>=6}function executeWithServerSelection(e,r,o){const s=r.readPreference||ReadPreference.primary,t=r.session&&r.session.inTransaction();if(t&&!s.equals(ReadPreference.primary))return void o(new MongoError(`Read preference in a transaction must be primary, not: ${s.mode}`));const n={readPreference:s,session:r.session};function i(s,t){return null==s?o(null,t):isRetryableError(s)?void e.selectServer(n,(e,s)=>{!e&&supportsRetryableReads(s)?r.execute(s,o):o(e,null)}):o(s)}e.selectServer(n,(s,n)=>{if(s)return void o(s,null);const c=!1!==e.s.options.retryReads&&r.session&&!t&&supportsRetryableReads(n)&&r.canRetryRead;r.hasAspect(Aspect.RETRYABLE)&&c?r.execute(n,i):r.execute(n,o)})}function selectServerForSessionSupport(e,r,o){const s=e.s.promiseLibrary;let t;return\"function\"!=typeof o&&(t=new s((e,r)=>{o=((o,s)=>{if(o)return r(o);e(s)})})),e.selectServer(ReadPreference.primaryPreferred,s=>{s?o(s):executeOperation(e,r,o)}),t}module.exports=executeOperation;","node_modules/mongodb/lib/utils.js":"\"use strict\";const MongoError=require(\"./core/error\").MongoError,ReadPreference=require(\"./core/topologies/read_preference\"),WriteConcern=require(\"./write_concern\");var shallowClone=function(e){var r={};for(var n in e)r[n]=e[n];return r},translateReadPreference=function(e){var r=null;if(!e.readPreference)return e;if(\"string\"==typeof(r=e.readPreference))e.readPreference=new ReadPreference(r);else if(!r||r instanceof ReadPreference||\"object\"!=typeof r){if(!(r instanceof ReadPreference))throw new TypeError(\"Invalid read preference: \"+r)}else{const n=r.mode||r.preference;n&&\"string\"==typeof n&&(e.readPreference=new ReadPreference(n,r.tags,{maxStalenessSeconds:r.maxStalenessSeconds}))}return e},getSingleProperty=function(e,r,n){Object.defineProperty(e,r,{enumerable:!0,get:function(){return n}})},formatSortValue=exports.formatSortValue=function(e){switch((\"\"+e).toLowerCase()){case\"ascending\":case\"asc\":case\"1\":return 1;case\"descending\":case\"desc\":case\"-1\":return-1;default:throw new Error(\"Illegal sort clause, must be of the form [['field1', '(ascending|descending)'], ['field2', '(ascending|descending)']]\")}},formattedOrderClause=exports.formattedOrderClause=function(e){var r={};if(null==e)return null;if(Array.isArray(e)){if(0===e.length)return null;for(var n=0;n<e.length;n++)e[n].constructor===String?r[e[n]]=1:r[e[n][0]]=formatSortValue(e[n][1])}else if(null!=e&&\"object\"==typeof e)r=e;else{if(\"string\"!=typeof e)throw new Error(\"Illegal sort clause, must be of the form [['field1', '(ascending|descending)'], ['field2', '(ascending|descending)']]\");r[e]=1}return r},checkCollectionName=function(e){if(\"string\"!=typeof e)throw new MongoError(\"collection name must be a String\");if(!e||-1!==e.indexOf(\"..\"))throw new MongoError(\"collection names cannot be empty\");if(-1!==e.indexOf(\"$\")&&null==e.match(/((^\\$cmd)|(oplog\\.\\$main))/))throw new MongoError(\"collection names must not contain '$'\");if(null!=e.match(/^\\.|\\.$/))throw new MongoError(\"collection names must not start or end with '.'\");if(-1!==e.indexOf(\"\\0\"))throw new MongoError(\"collection names cannot contain a null character\")},handleCallback=function(e,r,n,t){try{if(null==e)return;if(e)return t?e(r,n,t):e(r,n)}catch(r){return process.nextTick(function(){throw r}),!1}return!0},toError=function(e){if(e instanceof Error)return e;for(var r=e.err||e.errmsg||e.errMessage||e,n=MongoError.create({message:r,driver:!0}),t=\"object\"==typeof e?Object.keys(e):[],o=0;o<t.length;o++)try{n[t[o]]=e[t[o]]}catch(e){}return n},normalizeHintField=function(e){var r=null;if(\"string\"==typeof e)r=e;else if(Array.isArray(e))r={},e.forEach(function(e){r[e]=1});else if(null!=e&&\"object\"==typeof e)for(var n in r={},e)r[n]=e[n];return r},parseIndexOptions=function(e){var r,n={},t=[];return\"string\"==typeof e?(t.push(e+\"_1\"),n[e]=1):Array.isArray(e)?e.forEach(function(e){\"string\"==typeof e?(t.push(e+\"_1\"),n[e]=1):Array.isArray(e)?(t.push(e[0]+\"_\"+(e[1]||1)),n[e[0]]=e[1]||1):isObject(e)&&(r=Object.keys(e)).forEach(function(r){t.push(r+\"_\"+e[r]),n[r]=e[r]})}):isObject(e)&&(r=Object.keys(e)).forEach(function(r){t.push(r+\"_\"+e[r]),n[r]=e[r]}),{name:t.join(\"_\"),keys:r,fieldHash:n}},isObject=exports.isObject=function(e){return\"[object Object]\"===Object.prototype.toString.call(e)},debugOptions=function(e,r){var n={};return e.forEach(function(e){n[e]=r[e]}),n},decorateCommand=function(e,r,n){for(var t in r)-1===n.indexOf(t)&&(e[t]=r[t]);return e},mergeOptions=function(e,r){for(var n in r)e[n]=r[n];return e},translateOptions=function(e,r){var n={sslCA:\"ca\",sslCRL:\"crl\",sslValidate:\"rejectUnauthorized\",sslKey:\"key\",sslCert:\"cert\",sslPass:\"passphrase\",socketTimeoutMS:\"socketTimeout\",connectTimeoutMS:\"connectionTimeout\",replicaSet:\"setName\",rs_name:\"setName\",secondaryAcceptableLatencyMS:\"acceptableLatency\",connectWithNoPrimary:\"secondaryOnlyConnectionAllowed\",acceptableLatencyMS:\"localThresholdMS\"};for(var t in r)n[t]?e[n[t]]=r[t]:e[t]=r[t];return e},filterOptions=function(e,r){var n={};for(var t in e)-1!==r.indexOf(t)&&(n[t]=e[t]);return n},writeConcernKeys=[\"w\",\"j\",\"wtimeout\",\"fsync\"],mergeOptionsAndWriteConcern=function(e,r,n,t){for(var o=0;o<n.length;o++)e[n[o]]||void 0===r[n[o]]||(e[n[o]]=r[n[o]]);if(!t)return e;var i=!1;for(o=0;o<writeConcernKeys.length;o++)if(e[writeConcernKeys[o]]){i=!0;break}if(!i)for(o=0;o<writeConcernKeys.length;o++)r[writeConcernKeys[o]]&&(e[writeConcernKeys[o]]=r[writeConcernKeys[o]]);return e};const executeLegacyOperation=(e,r,n,t)=>{if(null==e)throw new TypeError(\"This method requires a valid topology instance\");if(!Array.isArray(n))throw new TypeError(\"This method requires an array of arguments to apply\");t=t||{};const o=e.s.promiseLibrary;let i,s,a,c=n[n.length-1];if(!t.skipSessions&&e.hasSessionSupport())if(null==(s=n[n.length-2])||null==s.session){a=Symbol(),i=e.startSession({owner:a});const r=n.length-2;n[r]=Object.assign({},n[r],{session:i})}else if(s.session&&s.session.hasEnded)throw new MongoError(\"Use of expired sessions is not permitted\");const l=(e,r)=>(function(n,o){if(i&&i.owner===a&&!t.returnsCursor)i.endSession(()=>{if(delete s.session,n)return r(n);e(o)});else{if(n)return r(n);e(o)}});if(\"function\"==typeof c){c=n.pop();const e=l(e=>c(null,e),e=>c(e,null));n.push(e);try{return r.apply(null,n)}catch(r){throw e(r),r}}if(null!=n[n.length-1])throw new TypeError(\"final argument to `executeLegacyOperation` must be a callback\");return new o(function(e,t){const o=l(e,t);n[n.length-1]=o;try{return r.apply(null,n)}catch(e){o(e)}})};function applyRetryableWrites(e,r){return r&&r.s.options.retryWrites&&(e.retryWrites=!0),e}function applyWriteConcern(e,r,n){n=n||{};const t=r.db,o=r.collection;if(n.session&&n.session.inTransaction())return e.writeConcern&&delete e.writeConcern,e;const i=WriteConcern.fromOptions(n);return i?Object.assign(e,{writeConcern:i}):o&&o.writeConcern?Object.assign(e,{writeConcern:Object.assign({},o.writeConcern)}):t&&t.writeConcern?Object.assign(e,{writeConcern:Object.assign({},t.writeConcern)}):e}function resolveReadPreference(e,r){const n=(r=r||{}).session,t=e.readPreference;let o;if(r.readPreference)o=ReadPreference.fromOptions(r);else if(n&&n.inTransaction()&&n.transaction.options.readPreference)o=n.transaction.options.readPreference;else{if(null==t)throw new Error(\"No readPreference was provided or inherited.\");o=t}return\"string\"==typeof o?new ReadPreference(o):o}function isPromiseLike(e){return e&&\"function\"==typeof e.then}function decorateWithCollation(e,r,n){const t=r.s&&r.s.topology||r.topology;if(!t)throw new TypeError('parameter \"target\" is missing a topology');const o=t.capabilities();if(n.collation&&\"object\"==typeof n.collation){if(!o||!o.commandsTakeCollation)throw new MongoError(\"Current topology does not support collation\");e.collation=n.collation}}function decorateWithReadConcern(e,r,n){if(n&&n.session&&n.session.inTransaction())return;let t=Object.assign({},e.readConcern||{});r.s.readConcern&&Object.assign(t,r.s.readConcern),Object.keys(t).length>0&&Object.assign(e,{readConcern:t})}const emitProcessWarning=e=>process.emitWarning(e,\"DeprecationWarning\"),emitConsoleWarning=e=>console.error(e),emitDeprecationWarning=process.emitWarning?emitProcessWarning:emitConsoleWarning;function defaultMsgHandler(e,r){return`${e} option [${r}] is deprecated and will be removed in a later version.`}function deprecateOptions(e,r){if(!0===process.noDeprecation)return r;const n=e.msgHandler?e.msgHandler:defaultMsgHandler,t=new Set;function o(){const o=arguments[e.optionsIndex];return isObject(o)&&0!==Object.keys(o).length?(e.deprecatedOptions.forEach(r=>{if(o.hasOwnProperty(r)&&!t.has(r)){t.add(r);const o=n(e.name,r);if(emitDeprecationWarning(o),this&&this.getLogger){const e=this.getLogger();e&&e.warn(o)}}}),r.apply(this,arguments)):r.apply(this,arguments)}return Object.setPrototypeOf(o,r),r.prototype&&(o.prototype=r.prototype),o}const SUPPORTS={};try{require(\"./async/async_iterator\"),SUPPORTS.ASYNC_ITERATOR=!0}catch(e){SUPPORTS.ASYNC_ITERATOR=!1}class MongoDBNamespace{constructor(e,r){this.db=e,this.collection=r}toString(){return this.collection?`${this.db}.${this.collection}`:this.db}withCollection(e){return new MongoDBNamespace(this.db,e)}static fromString(e){if(!e)throw new Error(`Cannot parse namespace from \"${e}\"`);const r=e.indexOf(\".\");return new MongoDBNamespace(e.substring(0,r),e.substring(r+1))}}module.exports={filterOptions:filterOptions,mergeOptions:mergeOptions,translateOptions:translateOptions,shallowClone:shallowClone,getSingleProperty:getSingleProperty,checkCollectionName:checkCollectionName,toError:toError,formattedOrderClause:formattedOrderClause,parseIndexOptions:parseIndexOptions,normalizeHintField:normalizeHintField,handleCallback:handleCallback,decorateCommand:decorateCommand,isObject:isObject,debugOptions:debugOptions,MAX_JS_INT:Number.MAX_SAFE_INTEGER+1,mergeOptionsAndWriteConcern:mergeOptionsAndWriteConcern,translateReadPreference:translateReadPreference,executeLegacyOperation:executeLegacyOperation,applyRetryableWrites:applyRetryableWrites,applyWriteConcern:applyWriteConcern,isPromiseLike:isPromiseLike,decorateWithCollation:decorateWithCollation,decorateWithReadConcern:decorateWithReadConcern,deprecateOptions:deprecateOptions,SUPPORTS:SUPPORTS,MongoDBNamespace:MongoDBNamespace,resolveReadPreference:resolveReadPreference,emitDeprecationWarning:emitDeprecationWarning};","node_modules/mongodb/lib/operations/operation.js":"\"use strict\";const Aspect={READ_OPERATION:Symbol(\"READ_OPERATION\"),SKIP_SESSION:Symbol(\"SKIP_SESSION\"),WRITE_OPERATION:Symbol(\"WRITE_OPERATION\"),RETRYABLE:Symbol(\"RETRYABLE\"),EXECUTE_WITH_SELECTION:Symbol(\"EXECUTE_WITH_SELECTION\")};class OperationBase{constructor(e){this.options=Object.assign({},e)}hasAspect(e){return null!=this.constructor.aspects&&this.constructor.aspects.has(e)}set session(e){Object.assign(this.options,{session:e})}get session(){return this.options.session}clearSession(){delete this.options.session}get canRetryRead(){return!0}execute(){throw new TypeError(\"`execute` must be implemented for OperationBase subclasses\")}}function defineAspects(e,s){return Array.isArray(s)||s instanceof Set||(s=[s]),s=new Set(s),Object.defineProperty(e,\"aspects\",{value:s,writable:!1}),s}module.exports={Aspect:Aspect,defineAspects:defineAspects,OperationBase:OperationBase};","node_modules/mongodb/lib/async/async_iterator.js":"\"use strict\";function asyncIterator(){const e=this;return{next:function(){return Promise.resolve().then(()=>e.next()).then(t=>t?{value:t,done:!1}:e.close().then(()=>({value:t,done:!0})))}}}exports.asyncIterator=asyncIterator;","node_modules/mongodb/lib/write_concern.js":"\"use strict\";class WriteConcern{constructor(n,t,e,r){null!=n&&(this.w=n),null!=t&&(this.wtimeout=t),null!=e&&(this.j=e),null!=r&&(this.fsync=r)}static fromOptions(n){if(null!=n&&(null!=n.writeConcern||null!=n.w||null!=n.wtimeout||null!=n.j||null!=n.fsync))return n.writeConcern?new WriteConcern(n.writeConcern.w,n.writeConcern.wtimeout,n.writeConcern.j,n.writeConcern.fsync):new WriteConcern(n.w,n.wtimeout,n.j,n.fsync)}}module.exports=WriteConcern;","node_modules/mongodb/lib/core/topologies/replset_state.js":"\"use strict\";var inherits=require(\"util\").inherits,f=require(\"util\").format,diff=require(\"./shared\").diff,EventEmitter=require(\"events\").EventEmitter,Logger=require(\"../connection/logger\"),ReadPreference=require(\"./read_preference\"),MongoError=require(\"../error\").MongoError,Buffer=require(\"safe-buffer\").Buffer,TopologyType={Single:\"Single\",ReplicaSetNoPrimary:\"ReplicaSetNoPrimary\",ReplicaSetWithPrimary:\"ReplicaSetWithPrimary\",Sharded:\"Sharded\",Unknown:\"Unknown\"},ServerType={Standalone:\"Standalone\",Mongos:\"Mongos\",PossiblePrimary:\"PossiblePrimary\",RSPrimary:\"RSPrimary\",RSSecondary:\"RSSecondary\",RSArbiter:\"RSArbiter\",RSOther:\"RSOther\",RSGhost:\"RSGhost\",Unknown:\"Unknown\"},ReplSetState=function(e){e=e||{},EventEmitter.call(this),this.topologyType=TopologyType.ReplicaSetNoPrimary,this.setName=e.setName,this.set={},this.id=e.id,this.setName=e.setName,this.logger=e.logger||Logger(\"ReplSet\",e),this.index=0,this.acceptableLatency=e.acceptableLatency||15,this.heartbeatFrequencyMS=e.heartbeatFrequencyMS||1e4,this.primary=null,this.secondaries=[],this.arbiters=[],this.passives=[],this.ghosts=[],this.unknownServers=[],this.set={},this.maxElectionId=null,this.maxSetVersion=0,this.replicasetDescription={topologyType:\"Unknown\",servers:[]},this.logicalSessionTimeoutMinutes=void 0};inherits(ReplSetState,EventEmitter),ReplSetState.prototype.hasPrimaryAndSecondary=function(){return null!=this.primary&&this.secondaries.length>0},ReplSetState.prototype.hasPrimaryOrSecondary=function(){return this.hasPrimary()||this.hasSecondary()},ReplSetState.prototype.hasPrimary=function(){return null!=this.primary},ReplSetState.prototype.hasSecondary=function(){return this.secondaries.length>0},ReplSetState.prototype.get=function(e){for(var r=this.allServers(),t=0;t<r.length;t++)if(r[t].name.toLowerCase()===e.toLowerCase())return r[t];return null},ReplSetState.prototype.allServers=function(e){e=e||{};var r=this.primary?[this.primary]:[];return r=r.concat(this.secondaries),e.ignoreArbiters||(r=r.concat(this.arbiters)),r=r.concat(this.passives)},ReplSetState.prototype.destroy=function(e,r){const t=this.secondaries.concat(this.arbiters).concat(this.passives).concat(this.ghosts);this.primary&&t.push(this.primary);let s=t.length;const i=()=>{--s>0||(this.secondaries=[],this.arbiters=[],this.passives=[],this.ghosts=[],this.unknownServers=[],this.set={},this.primary=null,emitTopologyDescriptionChanged(this),\"function\"==typeof r&&r(null,null))};0!==s?t.forEach(r=>r.destroy(e,i)):i()},ReplSetState.prototype.remove=function(e,r){r=r||{};var t=e.name.toLowerCase(),s=this.primary?[this.primary]:[];s=(s=(s=s.concat(this.secondaries)).concat(this.arbiters)).concat(this.passives);for(var i=0;i<s.length;i++)if(!r.force&&s[i].equals(e)&&s[i].isConnected&&s[i].isConnected())return;this.set[t]&&(this.set[t].type=ServerType.Unknown,this.set[t].electionId=null,this.set[t].setName=null,this.set[t].setVersion=null);var a=null;this.primary&&this.primary.equals(e)&&(this.primary=null,this.topologyType=TopologyType.ReplicaSetNoPrimary,a=\"primary\"),a=removeFrom(e,this.secondaries)?\"secondary\":a,a=removeFrom(e,this.arbiters)?\"arbiter\":a,a=removeFrom(e,this.passives)?\"secondary\":a,removeFrom(e,this.ghosts),removeFrom(e,this.unknownServers),this.unknownServers.push(t),a&&this.emit(\"left\",a,e)};const isArbiter=e=>e.arbiterOnly&&e.setName;ReplSetState.prototype.update=function(e){var r=e.lastIsMaster(),t=e.name.toLowerCase();if(r){var s=Array.isArray(r.hosts)?r.hosts:[];s=(s=(s=s.concat(Array.isArray(r.arbiters)?r.arbiters:[])).concat(Array.isArray(r.passives)?r.passives:[])).map(function(e){return e.toLowerCase()});for(var i=0;i<s.length;i++)-1!==this.unknownServers.indexOf(s[i])||this.set[s[i]]&&this.set[s[i]].type!==ServerType.Unknown||this.unknownServers.push(s[i].toLowerCase()),this.set[s[i]]||(this.set[s[i]]={type:ServerType.Unknown,electionId:null,setName:null,setVersion:null})}if(!r&&!inList(r,e,this.unknownServers))return this.set[t]={type:ServerType.Unknown,setVersion:null,electionId:null,setName:null},this.set[t].type=ServerType.Unknown,this.set[t].electionId=r?r.electionId:r,this.set[t].setName=r?r.setName:r,this.set[t].setVersion=r?r.setVersion:r,-1===this.unknownServers.indexOf(e.name)&&this.unknownServers.push(t),!1;if(void 0===r.logicalSessionTimeoutMinutes||isArbiter(r)||(void 0===this.logicalSessionTimeoutMinutes||null===r.logicalSessionTimeoutMinutes?this.logicalSessionTimeoutMinutes=r.logicalSessionTimeoutMinutes:this.logicalSessionTimeoutMinutes=Math.min(this.logicalSessionTimeoutMinutes,r.logicalSessionTimeoutMinutes)),r&&\"isdbgrid\"===r.msg)return this.primary&&this.primary.name===t&&(this.primary=null,this.topologyType=TopologyType.ReplicaSetNoPrimary),!1;if(r.isreplicaset)return this.set[t]={type:ServerType.RSGhost,setVersion:null,electionId:null,setName:r.setName},this.primary&&this.primary.name===t&&(this.primary=null),this.topologyType=this.primary?TopologyType.ReplicaSetWithPrimary:TopologyType.ReplicaSetNoPrimary,r.setName&&(this.setName=r.setName),!1;if(r.setName&&r.hidden||r.setName&&!r.ismaster&&!r.secondary&&!r.arbiterOnly&&!r.passive)return this.set[t]={type:ServerType.RSOther,setVersion:null,electionId:null,setName:r.setName},this.topologyType=this.primary?TopologyType.ReplicaSetWithPrimary:TopologyType.ReplicaSetNoPrimary,r.setName&&(this.setName=r.setName),!1;if(r&&r.ismaster&&!r.setName)return this.topologyType=this.primary?TopologyType.ReplicaSetWithPrimary:TopologyType.Unknown,this.remove(e,{force:!0}),!1;if(r&&!r.ismaster&&!r.secondary&&!r.arbiterOnly)return this.remove(e,{force:!0}),!1;if(r.me&&r.me.toLowerCase()!==t)return this.logger.isWarn()&&this.logger.warn(f(\"the seedlist server was removed due to its address %s not matching its ismaster.me address %s\",e.name,r.me)),delete this.set[t],removeFrom(e,this.unknownServers),e.destroy({force:!0}),this.primary&&!this.primary.equals(e)?this.topologyType=TopologyType.ReplicaSetWithPrimary:this.topologyType=TopologyType.ReplicaSetNoPrimary,!this.primary&&r.primary&&(this.set[r.primary.toLowerCase()]={type:ServerType.PossiblePrimary,setName:null,electionId:null,setVersion:null}),!1;if(!this.primary&&r.ismaster&&r.setName){var a=e.lastIsMaster().electionId;if(this.setName&&this.setName!==r.setName)return this.topologyType=TopologyType.ReplicaSetNoPrimary,new MongoError(f(\"setName from ismaster does not match provided connection setName [%s] != [%s]\",r.setName,this.setName));if(!this.maxElectionId&&a)this.maxElectionId=a;else if(this.maxElectionId&&a){var o=compareObjectIds(this.maxElectionId,a),n=e.lastIsMaster().setVersion;if(1===o)return this.topologyType=TopologyType.ReplicaSetNoPrimary,!1;if(0===o&&n&&n<this.maxSetVersion)return this.topologyType=TopologyType.ReplicaSetNoPrimary,!1;this.maxSetVersion=n,this.maxElectionId=a}return-1!==r.hosts.map(function(e){return e.toLowerCase()}).indexOf(t)?(this.primary=e,this.set[t]={type:ServerType.RSPrimary,setVersion:r.setVersion,electionId:r.electionId,setName:r.setName},this.topologyType=TopologyType.ReplicaSetWithPrimary,r.setName&&(this.setName=r.setName),removeFrom(e,this.unknownServers),removeFrom(e,this.secondaries),removeFrom(e,this.passives),this.emit(\"joined\",\"primary\",e)):this.topologyType=TopologyType.ReplicaSetNoPrimary,emitTopologyDescriptionChanged(this),!0}if(r.ismaster&&r.setName){var l=this.set[this.primary.name.toLowerCase()].electionId,p=this.set[this.primary.name.toLowerCase()].setVersion,m=this.set[this.primary.name.toLowerCase()].setName;a=e.lastIsMaster().electionId,n=e.lastIsMaster().setVersion;var y=e.lastIsMaster().setName;if(this.primary.equals(e)&&m===y)return!1;if(m&&m!==y)return this.primary.equals(e)?this.topologyType=TopologyType.ReplicaSetNoPrimary:this.topologyType=TopologyType.ReplicaSetWithPrimary,!1;if(l&&a){if(1===(o=compareObjectIds(l,a)))return!1;if(0===o&&p>n)return!1}else if(!l&&a&&n&&n<this.maxSetVersion)return!1;if(!this.maxElectionId&&a)this.maxElectionId=a;else if(this.maxElectionId&&a){if(1===(o=compareObjectIds(this.maxElectionId,a)))return!1;if(0===o&&p&&n){if(n<this.maxSetVersion)return!1}else if(n<this.maxSetVersion)return!1;this.maxElectionId=a,this.maxSetVersion=n}else this.maxSetVersion=n;return this.set[this.primary.name.toLowerCase()]={type:ServerType.Unknown,setVersion:null,electionId:null,setName:null},this.emit(\"left\",\"primary\",this.primary),this.primary.destroy({force:!0}),this.primary=e,this.set[t]={type:ServerType.RSPrimary,setVersion:r.setVersion,electionId:r.electionId,setName:r.setName},this.topologyType=TopologyType.ReplicaSetWithPrimary,r.setName&&(this.setName=r.setName),removeFrom(e,this.unknownServers),removeFrom(e,this.secondaries),removeFrom(e,this.passives),this.emit(\"joined\",\"primary\",e),emitTopologyDescriptionChanged(this),!0}return!this.primary&&r.primary&&(this.set[r.primary.toLowerCase()]={type:ServerType.PossiblePrimary,setVersion:null,electionId:null,setName:null}),r.secondary&&r.setName&&!inList(r,e,this.secondaries)&&this.setName&&this.setName===r.setName?(addToList(this,ServerType.RSSecondary,r,e,this.secondaries),this.topologyType=this.primary?TopologyType.ReplicaSetWithPrimary:TopologyType.ReplicaSetNoPrimary,r.setName&&(this.setName=r.setName),removeFrom(e,this.unknownServers),this.primary&&this.primary.name.toLowerCase()===t&&(e.destroy({force:!0}),this.primary=null,this.emit(\"left\",\"primary\",e)),this.emit(\"joined\",\"secondary\",e),emitTopologyDescriptionChanged(this),!0):isArbiter(r)&&!inList(r,e,this.arbiters)&&this.setName&&this.setName===r.setName?(addToList(this,ServerType.RSArbiter,r,e,this.arbiters),this.topologyType=this.primary?TopologyType.ReplicaSetWithPrimary:TopologyType.ReplicaSetNoPrimary,r.setName&&(this.setName=r.setName),removeFrom(e,this.unknownServers),this.emit(\"joined\",\"arbiter\",e),emitTopologyDescriptionChanged(this),!0):r.passive&&r.setName&&!inList(r,e,this.passives)&&this.setName&&this.setName===r.setName?(addToList(this,ServerType.RSSecondary,r,e,this.passives),this.topologyType=this.primary?TopologyType.ReplicaSetWithPrimary:TopologyType.ReplicaSetNoPrimary,r.setName&&(this.setName=r.setName),removeFrom(e,this.unknownServers),this.primary&&this.primary.name.toLowerCase()===t&&(e.destroy({force:!0}),this.primary=null,this.emit(\"left\",\"primary\",e)),this.emit(\"joined\",\"secondary\",e),emitTopologyDescriptionChanged(this),!0):this.set[t]&&this.set[t].type===ServerType.RSPrimary?(this.emit(\"left\",\"primary\",this.primary),this.primary.destroy({force:!0}),this.primary=null,this.topologyType=TopologyType.ReplicaSetNoPrimary,!1):(this.topologyType=this.primary?TopologyType.ReplicaSetWithPrimary:TopologyType.ReplicaSetNoPrimary,!1)},ReplSetState.prototype.updateServerMaxStaleness=function(e,r){for(var t=0,s=0;s<this.secondaries.length;s++)t=Math.max(t,this.secondaries[s].lastWriteDate);e.ismaster.maxWireVersion>=5&&e.ismaster.secondary&&this.hasPrimary()?e.staleness=e.lastUpdateTime-e.lastWriteDate-(this.primary.lastUpdateTime-this.primary.lastWriteDate)+r:e.ismaster.maxWireVersion>=5&&e.ismaster.secondary&&(e.staleness=t-e.lastWriteDate+r)},ReplSetState.prototype.updateSecondariesMaxStaleness=function(e){for(var r=0;r<this.secondaries.length;r++)this.updateServerMaxStaleness(this.secondaries[r],e)},ReplSetState.prototype.pickServer=function(e){if(\"primary\"===(e=e||ReadPreference.primary).preference&&null!=e.maxStalenessSeconds)return new MongoError(\"primary readPreference incompatible with maxStalenessSeconds\");var r=this.primary?[this.primary]:[];if(r=r.concat(this.secondaries),null!=e.maxStalenessSeconds)for(var t=0;t<r.length;t++)if(r[t].ismaster.maxWireVersion<5)return new MongoError(\"maxStalenessSeconds not supported by at least one of the replicaset members\");if(\"nearest\"===e.preference&&null==e.maxStalenessSeconds)return pickNearest(this,e);if(\"nearest\"===e.preference&&null!=e.maxStalenessSeconds)return pickNearestMaxStalenessSeconds(this,e);var s=this.secondaries;if(e.equals(ReadPreference.secondary)&&0===s.length)return new MongoError(\"no secondary server available\");if(e.equals(ReadPreference.secondaryPreferred)&&0===s.length&&null==this.primary)return new MongoError(\"no secondary or primary server available\");if(e.equals(ReadPreference.primary)&&null==this.primary)return new MongoError(\"no primary server available\");if(e.equals(ReadPreference.secondaryPreferred)||e.equals(ReadPreference.secondary)){if(s.length>0&&null==e.maxStalenessSeconds){var i=pickNearest(this,e);if(i)return i}else if(s.length>0&&null!=e.maxStalenessSeconds&&(i=pickNearestMaxStalenessSeconds(this,e)))return i;return e.equals(ReadPreference.secondaryPreferred)?this.primary:null}if(e.equals(ReadPreference.primaryPreferred)){if(i=null,this.primary)return this.primary;if(s.length>0&&null==e.maxStalenessSeconds?i=pickNearest(this,e):s.length>0&&null!=e.maxStalenessSeconds&&(i=pickNearestMaxStalenessSeconds(this,e)),i)return i}return this.primary};var filterByTags=function(e,r){if(null==e.tags)return r;for(var t=[],s=Array.isArray(e.tags)?e.tags:[e.tags],i=0;i<s.length;i++)for(var a=s[i],o=0;o<r.length;o++){var n=r[o].lastIsMaster().tags||{},l=!0;for(var p in a)n[p]!==a[p]&&(l=!1);l&&t.push(r[o])}return t};function pickNearestMaxStalenessSeconds(e,r){var t=[],s=1e3*r.maxStalenessSeconds;if(s<9e4)return new MongoError(\"maxStalenessSeconds must be set to at least 90 seconds\");e.primary&&\"secondary\"!==r.preference&&\"secondaryPreferred\"!==r.preference&&t.push(e.primary);for(var i=0;i<e.secondaries.length;i++)t.push(e.secondaries[i]);if(e.primary&&0===t.length&&\"secondaryPreferred\"!==r.preference&&t.push(e.primary),(t=(t=filterByTags(r,t)).filter(function(e){return e.staleness<=s})).sort(function(e,r){return e.lastIsMasterMS-r.lastIsMasterMS}),0===t.length)return null;e.index=e.index%t.length;var a=t[e.index];return e.index=e.index+1,a}function pickNearest(e,r){var t=[];e.primary&&\"secondary\"!==r.preference&&\"secondaryPreferred\"!==r.preference&&t.push(e.primary);for(var s=0;s<e.secondaries.length;s++)t.push(e.secondaries[s]);0===t.length&&e.primary&&\"secondaryPreferred\"!==r.preference&&t.push(e.primary),(t=filterByTags(r,t)).sort(function(e,r){return e.lastIsMasterMS-r.lastIsMasterMS});var i=t.length>0?t[0].lastIsMasterMS:0;if(0===(t=t.filter(function(r){return r.lastIsMasterMS<=i+e.acceptableLatency})).length)return null;e.index=e.index%t.length;var a=t[e.index];return e.index=e.index+1,a}function inList(e,r,t){for(var s=0;s<t.length;s++)if(t[s]&&t[s].name&&t[s].name.toLowerCase()===r.name.toLowerCase())return!0;return!1}function addToList(e,r,t,s,i){var a=s.name.toLowerCase();e.set[a].type=r,e.set[a].electionId=t?t.electionId:t,e.set[a].setName=t?t.setName:t,e.set[a].setVersion=t?t.setVersion:t,i.push(s)}function compareObjectIds(e,r){var t=Buffer.from(e.toHexString(),\"hex\"),s=Buffer.from(r.toHexString(),\"hex\");if(t===s)return 0;if(\"function\"==typeof Buffer.compare)return Buffer.compare(t,s);for(var i=t.length,a=s.length,o=Math.min(i,a),n=0;n<o&&t[n]===s[n];n++);return n!==o&&(i=t[n],a=s[n]),i<a?-1:a<i?1:0}function removeFrom(e,r){for(var t=0;t<r.length;t++){if(r[t].equals&&r[t].equals(e))return r.splice(t,1),!0;if(\"string\"==typeof r[t]&&r[t].toLowerCase()===e.name.toLowerCase())return r.splice(t,1),!0}return!1}function emitTopologyDescriptionChanged(e){if(e.listeners(\"topologyDescriptionChanged\").length>0){var r=\"Unknown\",t=e.setName;e.hasPrimaryAndSecondary()?r=\"ReplicaSetWithPrimary\":!e.hasPrimary()&&e.hasSecondary()&&(r=\"ReplicaSetNoPrimary\");var s={topologyType:r,setName:t,servers:[]};if(e.hasPrimary()){var i=e.primary.getDescription();i.type=\"RSPrimary\",s.servers.push(i)}s.servers=s.servers.concat(e.secondaries.map(function(e){var r=e.getDescription();return r.type=\"RSSecondary\",r})),s.servers=s.servers.concat(e.arbiters.map(function(e){var r=e.getDescription();return r.type=\"RSArbiter\",r})),s.servers=s.servers.concat(e.passives.map(function(e){var r=e.getDescription();return r.type=\"RSSecondary\",r}));var a=diff(e.replicasetDescription,s),o={topologyId:e.id,previousDescription:e.replicasetDescription,newDescription:s,diff:a};e.emit(\"topologyDescriptionChanged\",o),e.replicasetDescription=s}}module.exports=ReplSetState;","node_modules/mongodb/lib/core/sdam/monitoring.js":"\"use strict\";const ServerDescription=require(\"./server_description\").ServerDescription,calculateDurationInMs=require(\"../utils\").calculateDurationInMs,STATE_CLOSED=\"closed\",STATE_CLOSING=\"closing\";class ServerDescriptionChangedEvent{constructor(e,t,r,o){Object.assign(this,{topologyId:e,address:t,previousDescription:r,newDescription:o})}}class ServerOpeningEvent{constructor(e,t){Object.assign(this,{topologyId:e,address:t})}}class ServerClosedEvent{constructor(e,t){Object.assign(this,{topologyId:e,address:t})}}class TopologyDescriptionChangedEvent{constructor(e,t,r){Object.assign(this,{topologyId:e,previousDescription:t,newDescription:r})}}class TopologyOpeningEvent{constructor(e){Object.assign(this,{topologyId:e})}}class TopologyClosedEvent{constructor(e){Object.assign(this,{topologyId:e})}}class ServerHeartbeatStartedEvent{constructor(e){Object.assign(this,{connectionId:e})}}class ServerHeartbeatSucceededEvent{constructor(e,t,r){Object.assign(this,{duration:e,reply:t,connectionId:r})}}class ServerHeartbeatFailedEvent{constructor(e,t,r){Object.assign(this,{duration:e,failure:t,connectionId:r})}}function monitorServer(e,t){const r=(t=t||{}).heartbeatFrequencyMS||1e4;if(!0===t.initial)return void(e.s.monitorId=setTimeout(()=>monitorServer(e),r));const o=()=>{e.s.monitoring=!1,e.s.monitorId=setTimeout(()=>{e.s.monitorId=void 0,e.monitor()},r)},n=t=>{let r=process.hrtime();e.emit(\"serverHeartbeatStarted\",new ServerHeartbeatStartedEvent(e.name)),process.nextTick(()=>e.emit(\"monitoring\",e)),e.command(\"admin.$cmd\",{ismaster:!0},{monitoring:!0,socketTimeout:e.s.options.connectionTimeout||2e3},(o,n)=>{let s=calculateDurationInMs(r);if(o)return e.emit(\"serverHeartbeatFailed\",new ServerHeartbeatFailedEvent(s,o,e.name)),t(o,null);const i=n.result;return e.emit(\"serverHeartbeatSucceeded\",new ServerHeartbeatSucceededEvent(s,i,e.name)),t(null,i)})},s=t=>{e.emit(\"descriptionReceived\",new ServerDescription(e.description.address,t)),e.s.state!==STATE_CLOSED&&e.s.state!==STATE_CLOSING&&o()};e.s.monitoring=!0,n((t,r)=>{t?e.s.pool.reset(()=>{n((t,r)=>{if(t)return e.emit(\"descriptionReceived\",new ServerDescription(e.description.address,null,{error:t})),void o();s(r)})}):s(r)})}module.exports={ServerDescriptionChangedEvent:ServerDescriptionChangedEvent,ServerOpeningEvent:ServerOpeningEvent,ServerClosedEvent:ServerClosedEvent,TopologyDescriptionChangedEvent:TopologyDescriptionChangedEvent,TopologyOpeningEvent:TopologyOpeningEvent,TopologyClosedEvent:TopologyClosedEvent,ServerHeartbeatStartedEvent:ServerHeartbeatStartedEvent,ServerHeartbeatSucceededEvent:ServerHeartbeatSucceededEvent,ServerHeartbeatFailedEvent:ServerHeartbeatFailedEvent,monitorServer:monitorServer};","node_modules/mongodb/lib/core/sdam/server.js":"\"use strict\";const EventEmitter=require(\"events\"),MongoError=require(\"../error\").MongoError,Pool=require(\"../connection/pool\"),relayEvents=require(\"../utils\").relayEvents,wireProtocol=require(\"../wireprotocol\"),BSON=require(\"../connection/utils\").retrieveBSON(),createClientInfo=require(\"../topologies/shared\").createClientInfo,Logger=require(\"../connection/logger\"),ServerDescription=require(\"./server_description\").ServerDescription,ReadPreference=require(\"../topologies/read_preference\"),monitorServer=require(\"./monitoring\").monitorServer,MongoParseError=require(\"../error\").MongoParseError,MongoNetworkError=require(\"../error\").MongoNetworkError,collationNotSupported=require(\"../utils\").collationNotSupported,debugOptions=require(\"../connection/utils\").debugOptions,isSDAMUnrecoverableError=require(\"../error\").isSDAMUnrecoverableError,makeStateMachine=require(\"../utils\").makeStateMachine,common=require(\"./common\"),DEBUG_FIELDS=[\"reconnect\",\"reconnectTries\",\"reconnectInterval\",\"emitError\",\"cursorFactory\",\"host\",\"port\",\"size\",\"keepAlive\",\"keepAliveInitialDelay\",\"noDelay\",\"connectionTimeout\",\"checkServerIdentity\",\"socketTimeout\",\"ssl\",\"ca\",\"crl\",\"cert\",\"key\",\"rejectUnauthorized\",\"promoteLongs\",\"promoteValues\",\"promoteBuffers\",\"servername\"],STATE_CLOSING=common.STATE_CLOSING,STATE_CLOSED=common.STATE_CLOSED,STATE_CONNECTING=common.STATE_CONNECTING,STATE_CONNECTED=common.STATE_CONNECTED,stateTransition=makeStateMachine({[STATE_CLOSED]:[STATE_CLOSED,STATE_CONNECTING],[STATE_CONNECTING]:[STATE_CONNECTING,STATE_CLOSING,STATE_CONNECTED,STATE_CLOSED],[STATE_CONNECTED]:[STATE_CONNECTED,STATE_CLOSING,STATE_CLOSED],[STATE_CLOSING]:[STATE_CLOSING,STATE_CLOSED]});class Server extends EventEmitter{constructor(e,r,o){super(),this.s={description:e,options:r,logger:Logger(\"Server\",r),bson:r.bson||new BSON([BSON.Binary,BSON.Code,BSON.DBRef,BSON.Decimal128,BSON.Double,BSON.Int32,BSON.Long,BSON.Map,BSON.MaxKey,BSON.MinKey,BSON.ObjectId,BSON.BSONRegExp,BSON.Symbol,BSON.Timestamp]),clientInfo:createClientInfo(r),monitoring:!1,monitorFunction:r.monitorFunction||monitorServer,pool:null,state:STATE_CLOSED,credentials:r.credentials,topology:o}}get description(){return this.s.description}get name(){return this.s.description.address}get autoEncrypter(){return this.s.options&&this.s.options.autoEncrypter?this.s.options.autoEncrypter:null}connect(e){if(e=e||{},this.s.pool&&!this.s.pool.isDisconnected()&&!this.s.pool.isDestroyed())throw new MongoError(`Server instance in invalid state ${this.s.pool.state}`);const r=this.description.address.split(\":\"),o=Object.assign({host:r[0],port:parseInt(r[1],10)},this.s.options,e,{bson:this.s.bson});o.reconnect=!1,o.legacyCompatMode=!1,this.s.pool=new Pool(this,o),this.s.pool.on(\"parseError\",parseErrorEventHandler(this)),this.s.pool.on(\"drain\",e=>{this.emit(\"error\",e)}),relayEvents(this.s.pool,this,[\"commandStarted\",\"commandSucceeded\",\"commandFailed\"]),stateTransition(this,STATE_CONNECTING),this.s.pool.connect(connectEventHandler(this))}destroy(e,r){if(\"function\"==typeof e&&(r=e,e={}),e=Object.assign({},{force:!1},e),this.s.state===STATE_CLOSED)return void(\"function\"==typeof r&&r());stateTransition(this,STATE_CLOSING);const o=e=>{stateTransition(this,STATE_CLOSED),this.emit(\"closed\"),\"function\"==typeof r&&r(e,null)};if(!this.s.pool)return o();[\"close\",\"error\",\"timeout\",\"parseError\",\"connect\"].forEach(e=>{this.s.pool.removeAllListeners(e)}),this.s.monitorId&&clearTimeout(this.s.monitorId),this.s.pool.destroy(e.force,o)}monitor(e){e=e||{},this.s.state!==STATE_CONNECTED||this.s.monitoring||(this.s.monitorId&&clearTimeout(this.s.monitorId),this.s.monitorFunction(this,e))}command(e,r,o,t){if(\"function\"==typeof o&&(t=o,o=(o={})||{}),this.s.state===STATE_CLOSING||this.s.state===STATE_CLOSED)return void t(new MongoError(\"server is closed\"));const s=basicReadValidations(this,o);if(s)return t(s,null);o=Object.assign({},o,{wireProtocolCommand:!1}),this.s.logger.isDebug()&&this.s.logger.debug(`executing command [${JSON.stringify({ns:e,cmd:r,options:debugOptions(DEBUG_FIELDS,o)})}] against ${this.name}`),collationNotSupported(this,r)?t(new MongoError(`server ${this.name} does not support collation`)):wireProtocol.command(this,e,r,o,(e,r)=>{e&&(o.session&&e instanceof MongoNetworkError&&(o.session.serverSession.isDirty=!0),isSDAMUnrecoverableError(e,this)&&this.emit(\"error\",e)),t(e,r)})}query(e,r,o,t,s){this.s.state!==STATE_CLOSING&&this.s.state!==STATE_CLOSED?wireProtocol.query(this,e,r,o,t,(e,r)=>{e&&(t.session&&e instanceof MongoNetworkError&&(t.session.serverSession.isDirty=!0),isSDAMUnrecoverableError(e,this)&&this.emit(\"error\",e)),s(e,r)}):s(new MongoError(\"server is closed\"))}getMore(e,r,o,t,s){this.s.state!==STATE_CLOSING&&this.s.state!==STATE_CLOSED?wireProtocol.getMore(this,e,r,o,t,(e,r)=>{e&&(t.session&&e instanceof MongoNetworkError&&(t.session.serverSession.isDirty=!0),isSDAMUnrecoverableError(e,this)&&this.emit(\"error\",e)),s(e,r)}):s(new MongoError(\"server is closed\"))}killCursors(e,r,o){this.s.state!==STATE_CLOSING&&this.s.state!==STATE_CLOSED?wireProtocol.killCursors(this,e,r,(e,r)=>{e&&isSDAMUnrecoverableError(e,this)&&this.emit(\"error\",e),\"function\"==typeof o&&o(e,r)}):\"function\"==typeof o&&o(new MongoError(\"server is closed\"))}insert(e,r,o,t){executeWriteOperation({server:this,op:\"insert\",ns:e,ops:r},o,t)}update(e,r,o,t){executeWriteOperation({server:this,op:\"update\",ns:e,ops:r},o,t)}remove(e,r,o,t){executeWriteOperation({server:this,op:\"remove\",ns:e,ops:r},o,t)}}function basicWriteValidations(e){return e.s.pool?e.s.pool.isDestroyed()?new MongoError(\"server instance pool was destroyed\"):null:new MongoError(\"server instance is not connected\")}function basicReadValidations(e,r){const o=basicWriteValidations(e,r);return o||(!r.readPreference||r.readPreference instanceof ReadPreference?void 0:new MongoError(\"readPreference must be an instance of ReadPreference\"))}function executeWriteOperation(e,r,o){\"function\"==typeof r&&(o=r,r={}),r=r||{};const t=e.server,s=e.op,i=e.ns,n=Array.isArray(e.ops)?e.ops:[e.ops];if(t.s.state===STATE_CLOSING||t.s.state===STATE_CLOSED)return void o(new MongoError(\"server is closed\"));const c=basicWriteValidations(t,r);if(c)o(c,null);else{if(!collationNotSupported(t,r))return wireProtocol[s](t,i,n,r,(e,s)=>{e&&(r.session&&e instanceof MongoNetworkError&&(r.session.serverSession.isDirty=!0),isSDAMUnrecoverableError(e,t)&&t.emit(\"error\",e)),o(e,s)});o(new MongoError(`server ${t.name} does not support collation`))}}function connectEventHandler(e){return function(r,o){if(e.s.state===STATE_CLOSING||e.s.state===STATE_CLOSED)return;if(r)return e.emit(\"error\",new MongoNetworkError(r)),stateTransition(e,STATE_CLOSED),void e.emit(\"close\");const t=o.ismaster;if(e.s.lastIsMasterMS=o.lastIsMasterMS,o.agreedCompressor&&(e.s.pool.options.agreedCompressor=o.agreedCompressor),o.zlibCompressionLevel&&(e.s.pool.options.zlibCompressionLevel=o.zlibCompressionLevel),o.ismaster.$clusterTime){const r=o.ismaster.$clusterTime;e.s.sclusterTime=r}e.s.logger.isInfo()&&e.s.logger.info(`server ${e.name} connected with ismaster [${JSON.stringify(t)}]`),stateTransition(e,STATE_CONNECTED),e.emit(\"connect\",e),e.emit(\"descriptionReceived\",new ServerDescription(e.description.address,t))}}function parseErrorEventHandler(e){return function(r){stateTransition(this,STATE_CLOSED),e.emit(\"error\",new MongoParseError(r))}}Object.defineProperty(Server.prototype,\"clusterTime\",{get:function(){return this.s.topology.clusterTime},set:function(e){this.s.topology.clusterTime=e}}),module.exports={Server:Server};","node_modules/mongodb/lib/core/sdam/srv_polling.js":"\"use strict\";const Logger=require(\"../connection/logger\"),EventEmitter=require(\"events\").EventEmitter,dns=require(\"dns\");function matchesParentDomain(e,t){const s=/^.*?\\./,r=`.${e.replace(s,\"\")}`,i=`.${t.replace(s,\"\")}`;return r.endsWith(i)}class SrvPollingEvent{constructor(e){this.srvRecords=e}addresses(){return new Set(this.srvRecords.map(e=>`${e.name}:${e.port}`))}}class SrvPoller extends EventEmitter{constructor(e){if(super(),!e||!e.srvHost)throw new TypeError(\"options for SrvPoller must exist and include srvHost\");this.srvHost=e.srvHost,this.rescanSrvIntervalMS=6e4,this.heartbeatFrequencyMS=e.heartbeatFrequencyMS||1e4,this.logger=Logger(\"srvPoller\",e),this.haMode=!1,this.generation=0,this._timeout=null}get srvAddress(){return`_mongodb._tcp.${this.srvHost}`}get intervalMS(){return this.haMode?this.heartbeatFrequencyMS:this.rescanSrvIntervalMs}start(){this._timeout||this.schedule()}stop(){this._timeout&&(clearTimeout(this._timeout),this.generation+=1,this._timeout=null)}schedule(){clearTimeout(this._timeout),this._timeout=setTimeout(()=>this._poll(),this.intervalMS)}success(e){this.haMode=!1,this.schedule(),this.emit(\"srvRecordDiscovery\",new SrvPollingEvent(e))}failure(e,t){this.logger.warn(e,t),this.haMode=!0,this.schedule()}parentDomainMismatch(e){this.logger.warn(`parent domain mismatch on SRV record (${e.name}:${e.port})`,e)}_poll(){const e=this.generation;dns.resolveSrv(this.srvAddress,(t,s)=>{if(e!==this.generation)return;if(t)return void this.failure(\"DNS error\",t);const r=[];s.forEach(e=>{matchesParentDomain(e.name,this.srvHost)?r.push(e):this.parentDomainMismatch(e)}),r.length?this.success(r):this.failure(\"No valid addresses found at host\")})}}module.exports.SrvPollingEvent=SrvPollingEvent,module.exports.SrvPoller=SrvPoller;","node_modules/mongodb/lib/core/sdam/server_selection.js":"\"use strict\";const ServerType=require(\"./common\").ServerType,TopologyType=require(\"./common\").TopologyType,ReadPreference=require(\"../topologies/read_preference\"),MongoError=require(\"../error\").MongoError,calculateDurationInMs=require(\"../utils\").calculateDurationInMs,MongoTimeoutError=require(\"../error\").MongoTimeoutError,common=require(\"./common\"),STATE_CLOSED=common.STATE_CLOSED,clearAndRemoveTimerFrom=common.clearAndRemoveTimerFrom,IDLE_WRITE_PERIOD=1e4,SMALLEST_MAX_STALENESS_SECONDS=90;function writableServerSelector(){return function(e,r){return latencyWindowReducer(e,r.filter(e=>e.isWritable))}}function maxStalenessReducer(e,r,t){if(null==e.maxStalenessSeconds||e.maxStalenessSeconds<0)return t;const n=e.maxStalenessSeconds,o=(r.heartbeatFrequencyMS+IDLE_WRITE_PERIOD)/1e3;if(n<o)throw new MongoError(`maxStalenessSeconds must be at least ${o} seconds`);if(n<SMALLEST_MAX_STALENESS_SECONDS)throw new MongoError(`maxStalenessSeconds must be at least ${SMALLEST_MAX_STALENESS_SECONDS} seconds`);if(r.type===TopologyType.ReplicaSetWithPrimary){const n=t.filter(primaryFilter)[0];return t.reduce((t,o)=>{return(o.lastUpdateTime-o.lastWriteDate-(n.lastUpdateTime-n.lastWriteDate)+r.heartbeatFrequencyMS)/1e3<=e.maxStalenessSeconds&&t.push(o),t},[])}if(r.type===TopologyType.ReplicaSetNoPrimary){const n=t.reduce((e,r)=>r.lastWriteDate>e.lastWriteDate?r:e);return t.reduce((t,o)=>{return(n.lastWriteDate-o.lastWriteDate+r.heartbeatFrequencyMS)/1e3<=e.maxStalenessSeconds&&t.push(o),t},[])}return t}function tagSetMatch(e,r){const t=Object.keys(e),n=Object.keys(r);for(let o=0;o<t.length;++o){const i=t[o];if(-1===n.indexOf(i)||r[i]!==e[i])return!1}return!0}function tagSetReducer(e,r){if(null==e.tags||Array.isArray(e.tags)&&0===e.tags.length)return r;for(let t=0;t<e.tags.length;++t){const n=e.tags[t],o=r.reduce((e,r)=>(tagSetMatch(n,r.tags)&&e.push(r),e),[]);if(o.length)return o}return[]}function latencyWindowReducer(e,r){const t=r.reduce((e,r)=>-1===e?r.roundTripTime:Math.min(r.roundTripTime,e),-1),n=t+e.localThresholdMS;return r.reduce((e,r)=>(r.roundTripTime<=n&&r.roundTripTime>=t&&e.push(r),e),[])}function primaryFilter(e){return e.type===ServerType.RSPrimary}function secondaryFilter(e){return e.type===ServerType.RSSecondary}function nearestFilter(e){return e.type===ServerType.RSSecondary||e.type===ServerType.RSPrimary}function knownFilter(e){return e.type!==ServerType.Unknown}function readPreferenceServerSelector(e){if(!e.isValid())throw new TypeError(\"Invalid read preference specified\");return function(r,t){const n=r.commonWireVersion;if(n&&e.minWireVersion&&e.minWireVersion>n)throw new MongoError(`Minimum wire version '${e.minWireVersion}' required, but found '${n}'`);if(r.type===TopologyType.Single||r.type===TopologyType.Sharded)return latencyWindowReducer(r,t.filter(knownFilter));if(e.mode===ReadPreference.PRIMARY)return t.filter(primaryFilter);if(e.mode===ReadPreference.SECONDARY)return latencyWindowReducer(r,tagSetReducer(e,maxStalenessReducer(e,r,t))).filter(secondaryFilter);if(e.mode===ReadPreference.NEAREST)return latencyWindowReducer(r,tagSetReducer(e,maxStalenessReducer(e,r,t))).filter(nearestFilter);if(e.mode===ReadPreference.SECONDARY_PREFERRED){const n=latencyWindowReducer(r,tagSetReducer(e,maxStalenessReducer(e,r,t))).filter(secondaryFilter);return 0===n.length?t.filter(primaryFilter):n}if(e.mode===ReadPreference.PRIMARY_PREFERRED){const n=t.filter(primaryFilter);return n.length?n:latencyWindowReducer(r,tagSetReducer(e,maxStalenessReducer(e,r,t))).filter(secondaryFilter)}}}function selectServers(e,r,t,n,o){const i=calculateDurationInMs(n);if(i>=t)return o(new MongoTimeoutError(`Server selection timed out after ${t} ms`),e.description.error);if(e.s.state===STATE_CLOSED)return void o(new MongoError(\"Topology is closed, please connect\"));const a=Array.from(e.description.servers.values());let c;if(\"object\"==typeof r){const e=r.readPreference?r.readPreference:ReadPreference.primary;r=readPreferenceServerSelector(e)}try{c=r?r(e.description,a):a}catch(e){return o(e,null)}if(c.length){const r=c.map(r=>e.s.servers.get(r.address));return o(null,r)}(()=>{e.s.servers.forEach(r=>r.monitor({heartbeatFrequencyMS:e.description.heartbeatFrequencyMS}));const a=setTimeout(()=>{e.removeListener(\"topologyDescriptionChanged\",c),o(new MongoTimeoutError(`Server selection timed out after ${t} ms`,e.description.error))},t-i),c=()=>{clearAndRemoveTimerFrom(a,e.s.iterationTimers),selectServers(e,r,t,n,o)};e.s.iterationTimers.add(a),e.once(\"topologyDescriptionChanged\",c)})()}module.exports={selectServers:selectServers,writableServerSelector:writableServerSelector,readPreferenceServerSelector:readPreferenceServerSelector};","node_modules/mongodb/lib/change_stream.js":"\"use strict\";const EventEmitter=require(\"events\"),isResumableError=require(\"./error\").isResumableError,MongoError=require(\"./core\").MongoError,Cursor=require(\"./cursor\"),relayEvents=require(\"./core/utils\").relayEvents,maxWireVersion=require(\"./core/utils\").maxWireVersion,AggregateOperation=require(\"./operations/aggregate\"),CHANGE_STREAM_OPTIONS=[\"resumeAfter\",\"startAfter\",\"startAtOperationTime\",\"fullDocument\"],CURSOR_OPTIONS=[\"batchSize\",\"maxAwaitTimeMS\",\"collation\",\"readPreference\"].concat(CHANGE_STREAM_OPTIONS),CHANGE_DOMAIN_TYPES={COLLECTION:Symbol(\"Collection\"),DATABASE:Symbol(\"Database\"),CLUSTER:Symbol(\"Cluster\")};class ChangeStream extends EventEmitter{constructor(e,r,t){super();const s=require(\"./collection\"),o=require(\"./db\"),n=require(\"./mongo_client\");if(this.pipeline=r||[],this.options=t||{},this.parent=e,this.namespace=e.s.namespace,e instanceof s)this.type=CHANGE_DOMAIN_TYPES.COLLECTION,this.topology=e.s.db.serverConfig;else if(e instanceof o)this.type=CHANGE_DOMAIN_TYPES.DATABASE,this.topology=e.serverConfig;else{if(!(e instanceof n))throw new TypeError(\"parent provided to ChangeStream constructor is not an instance of Collection, Db, or MongoClient\");this.type=CHANGE_DOMAIN_TYPES.CLUSTER,this.topology=e.topology}this.promiseLibrary=e.s.promiseLibrary,!this.options.readPreference&&e.s.readPreference&&(this.options.readPreference=e.s.readPreference),this.cursor=createChangeStreamCursor(this,t),this.on(\"newListener\",e=>{\"change\"===e&&this.cursor&&0===this.listenerCount(\"change\")&&this.cursor.on(\"data\",e=>processNewChange({changeStream:this,change:e,eventEmitter:!0}))}),this.on(\"removeListener\",e=>{\"change\"===e&&0===this.listenerCount(\"change\")&&this.cursor&&this.cursor.removeAllListeners(\"data\")})}get resumeToken(){return this.cursor.resumeToken}hasNext(e){return this.cursor.hasNext(e)}next(e){var r=this;return this.isClosed()?e?e(new Error(\"Change Stream is not open.\"),null):r.promiseLibrary.reject(new Error(\"Change Stream is not open.\")):this.cursor.next().then(t=>processNewChange({changeStream:r,change:t,callback:e})).catch(t=>processNewChange({changeStream:r,error:t,callback:e}))}isClosed(){return!this.cursor||this.cursor.isClosed()}close(e){if(!this.cursor)return e?e():this.promiseLibrary.resolve();const r=this.cursor;return e?r.close(t=>([\"data\",\"close\",\"end\",\"error\"].forEach(e=>r.removeAllListeners(e)),delete this.cursor,e(t))):new(this.promiseLibrary||Promise)((e,t)=>{r.close(s=>{if([\"data\",\"close\",\"end\",\"error\"].forEach(e=>r.removeAllListeners(e)),delete this.cursor,s)return t(s);e()})})}pipe(e,r){return this.pipeDestinations||(this.pipeDestinations=[]),this.pipeDestinations.push(e),this.cursor.pipe(e,r)}unpipe(e){return this.pipeDestinations&&this.pipeDestinations.indexOf(e)>-1&&this.pipeDestinations.splice(this.pipeDestinations.indexOf(e),1),this.cursor.unpipe(e)}stream(e){return this.streamOptions=e,this.cursor.stream(e)}pause(){return this.cursor.pause()}resume(){return this.cursor.resume()}}class ChangeStreamCursor extends Cursor{constructor(e,r,t){super(e,r,t),t=t||{},this._resumeToken=null,this.startAtOperationTime=t.startAtOperationTime,t.startAfter?this.resumeToken=t.startAfter:t.resumeAfter&&(this.resumeToken=t.resumeAfter)}set resumeToken(e){this._resumeToken=e,this.emit(\"resumeTokenChanged\",e)}get resumeToken(){return this._resumeToken}get resumeOptions(){const e={};for(const r of CURSOR_OPTIONS)this.options[r]&&(e[r]=this.options[r]);return(this.resumeToken||this.startAtOperationTime)&&([\"resumeAfter\",\"startAfter\",\"startAtOperationTime\"].forEach(r=>delete e[r]),this.resumeToken?e.resumeAfter=this.resumeToken:this.startAtOperationTime&&maxWireVersion(this.server)>=7&&(e.startAtOperationTime=this.startAtOperationTime)),e}_initializeCursor(e){super._initializeCursor((r,t)=>{if(r)return void e(r,null);const s=t.documents[0];null==this.startAtOperationTime&&null==this.resumeAfter&&null==this.startAfter&&maxWireVersion(this.server)>=7&&(this.startAtOperationTime=s.operationTime);const o=s.cursor;o.postBatchResumeToken&&(this.cursorState.postBatchResumeToken=o.postBatchResumeToken,0===o.firstBatch.length&&(this.resumeToken=o.postBatchResumeToken)),this.emit(\"response\"),e(r,t)})}_getMore(e){super._getMore((r,t)=>{if(r)return void e(r,null);const s=t.cursor;s.postBatchResumeToken&&(this.cursorState.postBatchResumeToken=s.postBatchResumeToken,0===s.nextBatch.length&&(this.resumeToken=s.postBatchResumeToken)),this.emit(\"response\"),e(r,t)})}}function createChangeStreamCursor(e,r){const t={fullDocument:r.fullDocument||\"default\"};applyKnownOptions(t,r,CHANGE_STREAM_OPTIONS),e.type===CHANGE_DOMAIN_TYPES.CLUSTER&&(t.allChangesForCluster=!0);const s=[{$changeStream:t}].concat(e.pipeline),o=applyKnownOptions({},r,CURSOR_OPTIONS),n=new ChangeStreamCursor(e.topology,new AggregateOperation(e.parent,s,r),o);if(relayEvents(n,e,[\"resumeTokenChanged\",\"end\",\"close\"]),e.listenerCount(\"change\")>0&&n.on(\"data\",function(r){processNewChange({changeStream:e,change:r,eventEmitter:!0})}),n.on(\"error\",function(r){processNewChange({changeStream:e,error:r,eventEmitter:!0})}),e.pipeDestinations){const r=n.stream(e.streamOptions);for(let t in e.pipeDestinations)r.pipe(t)}return n}function applyKnownOptions(e,r,t){return t.forEach(t=>{r[t]&&(e[t]=r[t])}),e}const SELECTION_TIMEOUT=3e4;function waitForTopologyConnected(e,r,t){setTimeout(()=>{r&&null==r.start&&(r.start=process.hrtime());const s=r.start||process.hrtime(),o=r.timeout||SELECTION_TIMEOUT,n=r.readPreference;if(e.isConnected({readPreference:n}))return t(null,null);const i=process.hrtime(s);if((1e9*i[0]+i[1])/1e6>o)return t(new MongoError(\"Timed out waiting for connection\"));waitForTopologyConnected(e,r,t)},3e3)}function processNewChange(e){const r=e.changeStream,t=e.error,s=e.change,o=e.callback,n=e.eventEmitter||!1;if(r.isClosed()){if(n)return;const e=new MongoError(\"ChangeStream is closed\");return\"function\"==typeof o?o(e,null):r.promiseLibrary.reject(e)}const i=r.cursor,a=r.topology,c=r.cursor.options;if(t)return isResumableError(t)&&!r.attemptingResume?(r.attemptingResume=!0,[\"data\",\"close\",\"end\",\"error\"].forEach(e=>r.cursor.removeAllListeners(e)),r.cursor.close(),n?void waitForTopologyConnected(a,{readPreference:c.readPreference},e=>{if(e)return r.emit(\"error\",e),void r.emit(\"close\");r.cursor=createChangeStreamCursor(r,i.resumeOptions)}):o?void waitForTopologyConnected(a,{readPreference:c.readPreference},e=>{if(e)return o(e,null);r.cursor=createChangeStreamCursor(r,i.resumeOptions),r.next(o)}):new Promise((e,r)=>{waitForTopologyConnected(a,{readPreference:c.readPreference},t=>{if(t)return r(t);e()})}).then(()=>r.cursor=createChangeStreamCursor(r,i.resumeOptions)).then(()=>r.next())):n?r.emit(\"error\",t):\"function\"==typeof o?o(t,null):r.promiseLibrary.reject(t);if(r.attemptingResume=!1,s&&!s._id){const e=new Error(\"A change stream document has been received that lacks a resume token (_id).\");return n?r.emit(\"error\",e):\"function\"==typeof o?o(e,null):r.promiseLibrary.reject(e)}return 0===i.bufferedCount()&&i.cursorState.postBatchResumeToken?i.resumeToken=i.cursorState.postBatchResumeToken:i.resumeToken=s._id,r.options.startAtOperationTime=void 0,n?r.emit(\"change\",s):\"function\"==typeof o?o(t,s):r.promiseLibrary.resolve(s)}module.exports=ChangeStream;","node_modules/mongodb/lib/operations/connect.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,defineAspects=require(\"./operation\").defineAspects,Aspect=require(\"./operation\").Aspect,deprecate=require(\"util\").deprecate,Logger=require(\"../core\").Logger,MongoCredentials=require(\"../core\").MongoCredentials,MongoError=require(\"../core\").MongoError,Mongos=require(\"../topologies/mongos\"),NativeTopology=require(\"../topologies/native_topology\"),parse=require(\"../core\").parseConnectionString,ReadConcern=require(\"../read_concern\"),ReadPreference=require(\"../core\").ReadPreference,ReplSet=require(\"../topologies/replset\"),Server=require(\"../topologies/server\"),ServerSessionPool=require(\"../core\").Sessions.ServerSessionPool,emitDeprecationWarning=require(\"../utils\").emitDeprecationWarning;let client;function loadClient(){return client||(client=require(\"../mongo_client\")),client}const legacyParse=deprecate(require(\"../url_parser\"),\"current URL string parser is deprecated, and will be removed in a future version. To use the new parser, pass option { useNewUrlParser: true } to MongoClient.connect.\"),AUTH_MECHANISM_INTERNAL_MAP={DEFAULT:\"default\",\"MONGODB-CR\":\"mongocr\",PLAIN:\"plain\",\"MONGODB-X509\":\"x509\",\"SCRAM-SHA-1\":\"scram-sha-1\",\"SCRAM-SHA-256\":\"scram-sha-256\"},monitoringEvents=[\"timeout\",\"close\",\"serverOpening\",\"serverDescriptionChanged\",\"serverHeartbeatStarted\",\"serverHeartbeatSucceeded\",\"serverHeartbeatFailed\",\"serverClosed\",\"topologyOpening\",\"topologyClosed\",\"topologyDescriptionChanged\",\"commandStarted\",\"commandSucceeded\",\"commandFailed\",\"joined\",\"left\",\"ping\",\"ha\",\"all\",\"fullsetup\",\"open\"],VALID_AUTH_MECHANISMS=new Set([\"DEFAULT\",\"MONGODB-CR\",\"PLAIN\",\"MONGODB-X509\",\"SCRAM-SHA-1\",\"SCRAM-SHA-256\",\"GSSAPI\"]),validOptionNames=[\"poolSize\",\"ssl\",\"sslValidate\",\"sslCA\",\"sslCert\",\"sslKey\",\"sslPass\",\"sslCRL\",\"autoReconnect\",\"noDelay\",\"keepAlive\",\"keepAliveInitialDelay\",\"connectTimeoutMS\",\"family\",\"socketTimeoutMS\",\"reconnectTries\",\"reconnectInterval\",\"ha\",\"haInterval\",\"replicaSet\",\"secondaryAcceptableLatencyMS\",\"acceptableLatencyMS\",\"connectWithNoPrimary\",\"authSource\",\"w\",\"wtimeout\",\"j\",\"forceServerObjectId\",\"serializeFunctions\",\"ignoreUndefined\",\"raw\",\"bufferMaxEntries\",\"readPreference\",\"pkFactory\",\"promiseLibrary\",\"readConcern\",\"maxStalenessSeconds\",\"loggerLevel\",\"logger\",\"promoteValues\",\"promoteBuffers\",\"promoteLongs\",\"domainsEnabled\",\"checkServerIdentity\",\"validateOptions\",\"appname\",\"auth\",\"user\",\"password\",\"authMechanism\",\"compression\",\"fsync\",\"readPreferenceTags\",\"numberOfRetries\",\"auto_reconnect\",\"minSize\",\"monitorCommands\",\"retryWrites\",\"retryReads\",\"useNewUrlParser\",\"useUnifiedTopology\",\"serverSelectionTimeoutMS\",\"useRecoveryToken\",\"autoEncryption\",\"driverInfo\"],ignoreOptionNames=[\"native_parser\"],legacyOptionNames=[\"server\",\"replset\",\"replSet\",\"mongos\",\"db\"];function validOptions(e){const r=validOptionNames.concat(legacyOptionNames);for(const n in e)if(-1===ignoreOptionNames.indexOf(n)){if(-1===r.indexOf(n)){if(e.validateOptions)return new MongoError(`option ${n} is not supported`);console.warn(`the options [${n}] is not supported`)}-1!==legacyOptionNames.indexOf(n)&&console.warn(\"the server/replset/mongos/db options are deprecated, \"+`all their options are supported at the top level of the options object [${validOptionNames}]`)}}const LEGACY_OPTIONS_MAP=validOptionNames.reduce((e,r)=>(e[r.toLowerCase()]=r,e),{});class ConnectOperation extends OperationBase{constructor(e){super(),this.mongoClient=e}execute(e){const r=this.mongoClient,n=validOptions(r.s.options);if(n)return e(n);connect(r,r.s.url,r.s.options,n=>{if(n)return e(n);e(null,r)})}}function addListeners(e,r){r.on(\"authenticated\",createListener(e,\"authenticated\")),r.on(\"error\",createListener(e,\"error\")),r.on(\"timeout\",createListener(e,\"timeout\")),r.on(\"close\",createListener(e,\"close\")),r.on(\"parseError\",createListener(e,\"parseError\")),r.once(\"open\",createListener(e,\"open\")),r.once(\"fullsetup\",createListener(e,\"fullsetup\")),r.once(\"all\",createListener(e,\"all\")),r.on(\"reconnect\",createListener(e,\"reconnect\"))}function assignTopology(e,r){e.topology=r,r.s.sessionPool=new ServerSessionPool(r instanceof NativeTopology?r:r.s.coreTopology)}function clearAllEvents(e){monitoringEvents.forEach(r=>e.removeAllListeners(r))}function collectEvents(e,r){let n=loadClient();const o=[];return e instanceof n&&monitoringEvents.forEach(n=>{r.on(n,(r,t)=>{\"open\"===n?o.push({event:n,object1:e}):o.push({event:n,object1:r,object2:t})})}),o}defineAspects(ConnectOperation,[Aspect.SKIP_SESSION]);const emitDeprecationForNonUnifiedTopology=deprecate(()=>{},\"current Server Discovery and Monitoring engine is deprecated, and will be removed in a future version. To use the new Server Discover and Monitoring engine, pass option { useUnifiedTopology: true } to the MongoClient constructor.\");function connect(e,r,n,o){if(n=Object.assign({},n),null==o)throw new Error(\"no callback function provided\");let t=!1;const s=Logger(\"MongoClient\",n);if(r instanceof Server||r instanceof ReplSet||r instanceof Mongos)return connectWithUrl(e,r,n,c);const i=!1!==n.useNewUrlParser,a=i?transformUrlOptions:legacyTransformUrlOptions;function c(r,n){const i=\"seed list contains no mongos proxies, replicaset connections requires the parameter replicaSet to be supplied in the URI or options object, mongodb://server:port/db?replicaSet=name\";if(r&&\"no mongos proxies found in seed list\"===r.message)return s.isWarn()&&s.warn(i),o(new MongoError(i));t&&e.emit(\"authenticated\",null,!0),o(r,n)}(i?parse:legacyParse)(r,n,(r,s)=>{if(r)return o(r);const i=a(s),l=createUnifiedOptions(i,n);if(null==l.socketTimeoutMS&&(l.socketTimeoutMS=36e4),null==l.connectTimeoutMS&&(l.connectTimeoutMS=3e4),null==l.retryWrites&&(l.retryWrites=!0),null==l.useRecoveryToken&&(l.useRecoveryToken=!0),null==l.readPreference&&(l.readPreference=\"primary\"),l.db_options&&l.db_options.auth&&delete l.db_options.auth,e.s.options=l,0===i.servers.length)return o(new Error(\"connection string must contain at least one seed host\"));if(l.auth&&!l.credentials)try{t=!0,l.credentials=generateCredentials(e,l.auth.user,l.auth.password,l)}catch(r){return o(r)}return l.useUnifiedTopology?createTopology(e,\"unified\",l,c):(emitDeprecationForNonUnifiedTopology(),l.replicaSet||l.rs_name?createTopology(e,\"replicaset\",l,c):i.servers.length>1?createTopology(e,\"mongos\",l,c):createServer(e,l,c))})}function connectWithUrl(e,r,n,o){assignTopology(e,r),addListeners(e,r),relayEvents(e,r);let t=Object.assign({},n);if(\"string\"!=typeof n.readPreference&&\"string\"!=typeof n.read_preference||(t.readPreference=new ReadPreference(n.readPreference||n.read_preference)),(t.user||t.password||t.authMechanism)&&!t.credentials)try{t.credentials=generateCredentials(e,t.user,t.password,t)}catch(e){return o(e,r)}return r.connect(t,o)}function createListener(e,r){const n=new Set([\"all\",\"fullsetup\",\"open\",\"reconnect\"]);return(o,t)=>{if(n.has(r))return e.emit(r,e);e.emit(r,o,t)}}function createServer(e,r,n){r.promiseLibrary=e.s.promiseLibrary;const o=translateOptions(r)[0],t=collectEvents(e,o);o.connect(r,(s,i)=>{if(s)return o.close(!0),n(s);clearAllEvents(o),relayEvents(e,o),addListeners(e,o);const a=i.lastIsMaster();if(assignTopology(e,i),a&&\"isdbgrid\"===a.msg)return i.close(),createTopology(e,\"mongos\",r,n);replayEvents(e,t),n(s,i)})}const DEPRECATED_UNIFIED_EVENTS=new Set([\"reconnect\",\"reconnectFailed\",\"attemptReconnect\"]);function registerDeprecatedEventNotifiers(e){e.on(\"newListener\",e=>{DEPRECATED_UNIFIED_EVENTS.has(e)&&emitDeprecationWarning(`The \\`${e}\\` event is no longer supported by the unified topology, please read more by visiting http://bit.ly/2D8WfT6`,\"DeprecationWarning\")})}function createTopology(e,r,n,o){n.promiseLibrary=e.s.promiseLibrary;const t={};\"unified\"===r&&(t.createServers=!1);const s=translateOptions(n,t);let i;\"mongos\"===r?i=new Mongos(s,n):\"replicaset\"===r?i=new ReplSet(s,n):\"unified\"===r&&(i=new NativeTopology(n.servers,n),registerDeprecatedEventNotifiers(e)),addListeners(e,i),relayEvents(e,i),assignTopology(e,i),i.connect(n,r=>{if(r)return i.close(!0),o(r);if(null==n.autoEncryption)return void o(null,i);let t;try{require.resolve(\"mongodb-client-encryption\")}catch(r){return void o(new MongoError(\"Auto-encryption requested, but the module is not installed. Please add `mongodb-client-encryption` as a dependency of your project\"))}try{t=require(\"mongodb-client-encryption\")(require(\"../../index\")).AutoEncrypter}catch(r){return void o(r)}const s=Object.assign({},n.autoEncryption);i.s.options.autoEncrypter=new t(e,s),i.s.options.autoEncrypter.init(e=>{if(e)return o(e,null);o(null,i)})})}function createUnifiedOptions(e,r){const n=[\"mongos\",\"server\",\"db\",\"replset\",\"db_options\",\"server_options\",\"rs_options\",\"mongos_options\"],o=[\"readconcern\",\"compression\"];for(const t in r)-1!==o.indexOf(t.toLowerCase())?e[t]=r[t]:-1!==n.indexOf(t.toLowerCase())?e=mergeOptions(e,r[t],!1):!r[t]||\"object\"!=typeof r[t]||Buffer.isBuffer(r[t])||Array.isArray(r[t])?e[t]=r[t]:e=mergeOptions(e,r[t],!0);return e}function generateCredentials(e,r,n,o){const t=(o=Object.assign({},o)).authSource||o.authdb||o.dbName,s=o.authMechanism||\"DEFAULT\",i=s.toUpperCase();if(!VALID_AUTH_MECHANISMS.has(i))throw MongoError.create({message:`authentication mechanism ${s} not supported', options.authMechanism`,driver:!0});return new MongoCredentials(\"GSSAPI\"===i?{mechanism:\"win32\"===process.platform?\"sspi\":\"gssapi\",mechanismProperties:o,source:t,username:r,password:n}:{mechanism:AUTH_MECHANISM_INTERNAL_MAP[i],source:t,username:r,password:n})}function legacyTransformUrlOptions(e){return mergeOptions(createUnifiedOptions({},e),e,!1)}function mergeOptions(e,r,n){for(const o in r)r[o]&&\"object\"==typeof r[o]&&n?e=mergeOptions(e,r[o],n):e[o]=r[o];return e}function relayEvents(e,r){[\"serverOpening\",\"serverDescriptionChanged\",\"serverHeartbeatStarted\",\"serverHeartbeatSucceeded\",\"serverHeartbeatFailed\",\"serverClosed\",\"topologyOpening\",\"topologyClosed\",\"topologyDescriptionChanged\",\"commandStarted\",\"commandSucceeded\",\"commandFailed\",\"joined\",\"left\",\"ping\",\"ha\"].forEach(n=>{r.on(n,(r,o)=>{e.emit(n,r,o)})})}function replayEvents(e,r){for(let n=0;n<r.length;n++)e.emit(r[n].event,r[n].object1,r[n].object2)}function transformUrlOptions(e){let r=Object.assign({servers:e.hosts},e.options);for(let e in r){const n=LEGACY_OPTIONS_MAP[e];n&&(r[n]=r[e])}const n=e.auth&&e.auth.username,o=e.options&&e.options.authMechanism;return(n||o)&&(r.auth=Object.assign({},e.auth),r.auth.db&&(r.authSource=r.authSource||r.auth.db),r.auth.username&&(r.auth.user=r.auth.username)),e.defaultDatabase&&(r.dbName=e.defaultDatabase),r.maxPoolSize&&(r.poolSize=r.maxPoolSize),r.readConcernLevel&&(r.readConcern=new ReadConcern(r.readConcernLevel)),r.wTimeoutMS&&(r.wtimeout=r.wTimeoutMS),e.srvHost&&(r.srvHost=e.srvHost),r}function translateOptions(e,r){if(r=Object.assign({},{createServers:!0},r),\"string\"!=typeof e.readPreference&&\"string\"!=typeof e.read_preference||(e.readPreference=new ReadPreference(e.readPreference||e.read_preference)),e.readPreference&&(e.readPreferenceTags||e.read_preference_tags)&&(e.readPreference.tags=e.readPreferenceTags||e.read_preference_tags),e.maxStalenessSeconds&&(e.readPreference.maxStalenessSeconds=e.maxStalenessSeconds),null==e.socketTimeoutMS&&(e.socketTimeoutMS=36e4),null==e.connectTimeoutMS&&(e.connectTimeoutMS=3e4),r.createServers)return e.servers.map(r=>r.domain_socket?new Server(r.domain_socket,27017,e):new Server(r.host,r.port,e))}module.exports=ConnectOperation;","node_modules/mongodb/lib/operations/close.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,OperationBase=require(\"./operation\").OperationBase,NativeTopology=require(\"../topologies/native_topology\");class CloseOperation extends OperationBase{constructor(e,o){super(),this.client=e,this.force=o}execute(e){const o=this.client,t=this.force,s=t=>{if(o.emit(\"close\",o),!(o.topology instanceof NativeTopology))for(const e of o.s.dbCache)e[1].emit(\"close\",o);o.removeAllListeners(\"close\"),e(t,null)};null!=o.topology?o.topology.close(t,e=>{const i=o.topology.s.options.autoEncrypter;i?i.teardown(t,o=>s(e||o)):s(e)}):s()}}defineAspects(CloseOperation,[Aspect.SKIP_SESSION]),module.exports=CloseOperation;","node_modules/mongodb/lib/error.js":"\"use strict\";const MongoNetworkError=require(\"./core\").MongoNetworkError,mongoErrorContextSymbol=require(\"./core\").mongoErrorContextSymbol,GET_MORE_NON_RESUMABLE_CODES=new Set([136,237,11601]);function isGetMoreError(r){if(r[mongoErrorContextSymbol])return r[mongoErrorContextSymbol].isGetMore}function isResumableError(r){return!!isGetMoreError(r)&&(r instanceof MongoNetworkError||!(GET_MORE_NON_RESUMABLE_CODES.has(r.code)||r.hasErrorLabel(\"NonRetryableChangeStreamError\")))}module.exports={GET_MORE_NON_RESUMABLE_CODES:GET_MORE_NON_RESUMABLE_CODES,isResumableError:isResumableError};","node_modules/mongodb/lib/operations/aggregate.js":"\"use strict\";const CommandOperationV2=require(\"./command_v2\"),MongoError=require(\"../core\").MongoError,maxWireVersion=require(\"../core/utils\").maxWireVersion,ReadPreference=require(\"../core\").ReadPreference,Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,DB_AGGREGATE_COLLECTION=1,MIN_WIRE_VERSION_$OUT_READ_CONCERN_SUPPORT=8;class AggregateOperation extends CommandOperationV2{constructor(e,t,r){if(super(e,r,{fullResponse:!0}),this.target=e.s.namespace&&e.s.namespace.collection?e.s.namespace.collection:DB_AGGREGATE_COLLECTION,this.pipeline=t,this.hasWriteStage=!1,\"string\"==typeof r.out)this.pipeline=this.pipeline.concat({$out:r.out}),this.hasWriteStage=!0;else if(t.length>0){const e=t[t.length-1];(e.$out||e.$merge)&&(this.hasWriteStage=!0)}if(this.hasWriteStage&&(this.readPreference=ReadPreference.primary),r.explain&&(this.readConcern||this.writeConcern))throw new MongoError('\"explain\" cannot be used on an aggregate call with readConcern/writeConcern');if(null!=r.cursor&&\"object\"!=typeof r.cursor)throw new MongoError(\"cursor options must be an object\")}get canRetryRead(){return!this.hasWriteStage}addToPipeline(e){this.pipeline.push(e)}execute(e,t){const r=this.options,i=maxWireVersion(e),n={aggregate:this.target,pipeline:this.pipeline};this.hasWriteStage&&i<MIN_WIRE_VERSION_$OUT_READ_CONCERN_SUPPORT&&(this.readConcern=null),i>=5&&this.hasWriteStage&&this.writeConcern&&Object.assign(n,{writeConcern:this.writeConcern}),!0===r.bypassDocumentValidation&&(n.bypassDocumentValidation=r.bypassDocumentValidation),\"boolean\"==typeof r.allowDiskUse&&(n.allowDiskUse=r.allowDiskUse),r.hint&&(n.hint=r.hint),r.explain&&(r.full=!1,n.explain=r.explain),n.cursor=r.cursor||{},r.batchSize&&!this.hasWriteStage&&(n.cursor.batchSize=r.batchSize),super.executeCommand(e,n,t)}}defineAspects(AggregateOperation,[Aspect.READ_OPERATION,Aspect.RETRYABLE,Aspect.EXECUTE_WITH_SELECTION]),module.exports=AggregateOperation;","node_modules/mongodb/lib/operations/cursor_ops.js":"\"use strict\";const buildCountCommand=require(\"./collection_ops\").buildCountCommand,formattedOrderClause=require(\"../utils\").formattedOrderClause,handleCallback=require(\"../utils\").handleCallback,MongoError=require(\"../core\").MongoError,push=Array.prototype.push,CursorState=require(\"../core/cursor\").CursorState;function count(e,r,t,o){r&&(\"number\"==typeof e.cursorSkip()&&(t.skip=e.cursorSkip()),\"number\"==typeof e.cursorLimit()&&(t.limit=e.cursorLimit())),t.readPreference&&e.setReadPreference(t.readPreference),\"number\"!=typeof t.maxTimeMS&&e.cmd&&\"number\"==typeof e.cmd.maxTimeMS&&(t.maxTimeMS=e.cmd.maxTimeMS);let n,a={};a.skip=t.skip,a.limit=t.limit,a.hint=t.hint,a.maxTimeMS=t.maxTimeMS,a.collectionName=e.namespace.collection;try{n=buildCountCommand(e,e.cmd.query,a)}catch(e){return o(e)}e.server=e.topology.s.coreTopology,e.topology.command(e.namespace.withCollection(\"$cmd\"),n,e.options,(e,r)=>{o(e,r?r.result.n:null)})}function each(e,r){if(!r)throw MongoError.create({message:\"callback is mandatory\",driver:!0});if(e.isNotified())return;if(e.s.state===CursorState.CLOSED||e.isDead())return handleCallback(r,MongoError.create({message:\"Cursor is closed\",driver:!0}));e.s.state===CursorState.INIT&&(e.s.state=CursorState.OPEN);let t=null;if(e.bufferedCount()>0){for(;t=loop(e,r);)t(e,r);each(e,r)}else e.next((t,o)=>t?handleCallback(r,t):null==o?e.close({skipKillCursors:!0},()=>handleCallback(r,null,null)):void(!1!==handleCallback(r,null,o)&&each(e,r)))}function hasNext(e,r){return e.s.currentDoc?r(null,!0):e.isNotified()?r(null,!1):void nextObject(e,(t,o)=>t?r(t,null):e.s.state===CursorState.CLOSED||e.isDead()?r(null,!1):o?(e.s.currentDoc=o,void r(null,!0)):r(null,!1))}function loop(e,r){if(0!==e.bufferedCount())return e._next(r),loop}function next(e,r){if(e.s.currentDoc){const t=e.s.currentDoc;return e.s.currentDoc=null,r(null,t)}nextObject(e,r)}function nextObject(e,r){if(e.s.state===CursorState.CLOSED||e.isDead&&e.isDead())return handleCallback(r,MongoError.create({message:\"Cursor is closed\",driver:!0}));if(e.s.state===CursorState.INIT&&e.cmd.sort)try{e.cmd.sort=formattedOrderClause(e.cmd.sort)}catch(e){return handleCallback(r,e)}e._next((t,o)=>{if(e.s.state=CursorState.OPEN,t)return handleCallback(r,t);handleCallback(r,null,o)})}function toArray(e,r){const t=[];e.rewind(),e.s.state=CursorState.INIT;const o=()=>{e._next((n,a)=>{if(n)return e._endSession?e._endSession(()=>handleCallback(r,n)):handleCallback(r,n);if(null==a)return e.close({skipKillCursors:!0},()=>handleCallback(r,null,t));if(t.push(a),e.bufferedCount()>0){let r=e.readBufferedDocuments(e.bufferedCount());e.s.transforms&&\"function\"==typeof e.s.transforms.doc&&(r=r.map(e.s.transforms.doc)),push.apply(t,r)}o()})};o()}module.exports={count:count,each:each,hasNext:hasNext,next:next,toArray:toArray};","node_modules/mongodb/lib/operations/count.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,buildCountCommand=require(\"./common_functions\").buildCountCommand,defineAspects=require(\"./operation\").defineAspects,OperationBase=require(\"./operation\").OperationBase;class CountOperation extends OperationBase{constructor(e,t,i){super(i),this.cursor=e,this.applySkipLimit=t}execute(e){const t=this.cursor,i=this.applySkipLimit,o=this.options;i&&(\"number\"==typeof t.cursorSkip()&&(o.skip=t.cursorSkip()),\"number\"==typeof t.cursorLimit()&&(o.limit=t.cursorLimit())),o.readPreference&&t.setReadPreference(o.readPreference),\"number\"!=typeof o.maxTimeMS&&t.cmd&&\"number\"==typeof t.cmd.maxTimeMS&&(o.maxTimeMS=t.cmd.maxTimeMS);let r,n={};n.skip=o.skip,n.limit=o.limit,n.hint=o.hint,n.maxTimeMS=o.maxTimeMS,n.collectionName=t.namespace.collection;try{r=buildCountCommand(t,t.cmd.query,n)}catch(t){return e(t)}t.server=t.topology.s.coreTopology,t.topology.command(t.namespace.withCollection(\"$cmd\"),r,t.options,(t,i)=>{e(t,i?i.result.n:null)})}}defineAspects(CountOperation,Aspect.SKIP_SESSION),module.exports=CountOperation;","node_modules/mongodb/lib/operations/explain.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,CoreCursor=require(\"../core/cursor\").CoreCursor,defineAspects=require(\"./operation\").defineAspects,OperationBase=require(\"./operation\").OperationBase;class ExplainOperation extends OperationBase{constructor(e){super(),this.cursor=e}execute(){const e=this.cursor;return CoreCursor.prototype._next.apply(e,arguments)}}defineAspects(ExplainOperation,Aspect.SKIP_SESSION),module.exports=ExplainOperation;","node_modules/mongodb/lib/operations/has_next.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,loadCursor=require(\"../dynamic_loaders\").loadCursor,OperationBase=require(\"./operation\").OperationBase,nextObject=require(\"./common_functions\").nextObject;class HasNextOperation extends OperationBase{constructor(e){super(),this.cursor=e}execute(e){const t=this.cursor;let r=loadCursor();return t.s.currentDoc?e(null,!0):t.isNotified()?e(null,!1):void nextObject(t,(s,o)=>s?e(s,null):t.s.state===r.CLOSED||t.isDead()?e(null,!1):o?(t.s.currentDoc=o,void e(null,!0)):e(null,!1))}}defineAspects(HasNextOperation,Aspect.SKIP_SESSION),module.exports=HasNextOperation;","node_modules/mongodb/lib/operations/next.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,OperationBase=require(\"./operation\").OperationBase,nextObject=require(\"./common_functions\").nextObject;class NextOperation extends OperationBase{constructor(e){super(),this.cursor=e}execute(e){const t=this.cursor;if(t.s.currentDoc){const r=t.s.currentDoc;return t.s.currentDoc=null,e(null,r)}nextObject(t,e)}}defineAspects(NextOperation,Aspect.SKIP_SESSION),module.exports=NextOperation;","node_modules/mongodb/lib/operations/to_array.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,handleCallback=require(\"../utils\").handleCallback,CursorState=require(\"../core/cursor\").CursorState,OperationBase=require(\"./operation\").OperationBase,push=Array.prototype.push;class ToArrayOperation extends OperationBase{constructor(e){super(),this.cursor=e}execute(e){const r=this.cursor,s=[];r.rewind(),r.s.state=CursorState.INIT;const t=()=>{r._next((o,a)=>{if(o)return r._endSession?r._endSession(()=>handleCallback(e,o)):handleCallback(e,o);if(null==a)return r.close({skipKillCursors:!0},()=>handleCallback(e,null,s));if(s.push(a),r.bufferedCount()>0){let e=r.readBufferedDocuments(r.bufferedCount());r.s.transforms&&\"function\"==typeof r.s.transforms.doc&&(e=e.map(r.s.transforms.doc)),push.apply(s,e)}t()})};t()}}defineAspects(ToArrayOperation,Aspect.SKIP_SESSION),module.exports=ToArrayOperation;","node_modules/mongodb/lib/operations/collection_ops.js":"\"use strict\";const applyWriteConcern=require(\"../utils\").applyWriteConcern,Code=require(\"../core\").BSON.Code,createIndexDb=require(\"./db_ops\").createIndex,decorateWithCollation=require(\"../utils\").decorateWithCollation,decorateWithReadConcern=require(\"../utils\").decorateWithReadConcern,ensureIndexDb=require(\"./db_ops\").ensureIndex,evaluate=require(\"./db_ops\").evaluate,executeCommand=require(\"./db_ops\").executeCommand,resolveReadPreference=require(\"../utils\").resolveReadPreference,handleCallback=require(\"../utils\").handleCallback,indexInformationDb=require(\"./db_ops\").indexInformation,Long=require(\"../core\").BSON.Long,MongoError=require(\"../core\").MongoError,ReadPreference=require(\"../core\").ReadPreference,toError=require(\"../utils\").toError,insertDocuments=require(\"./common_functions\").insertDocuments,updateDocuments=require(\"./common_functions\").updateDocuments,groupFunction='function () {\\nvar c = db[ns].find(condition);\\nvar map = new Map();\\nvar reduce_function = reduce;\\n\\nwhile (c.hasNext()) {\\nvar obj = c.next();\\nvar key = {};\\n\\nfor (var i = 0, len = keys.length; i < len; ++i) {\\nvar k = keys[i];\\nkey[k] = obj[k];\\n}\\n\\nvar aggObj = map.get(key);\\n\\nif (aggObj == null) {\\nvar newObj = Object.extend({}, key);\\naggObj = Object.extend(newObj, initial);\\nmap.put(key, aggObj);\\n}\\n\\nreduce_function(obj, aggObj);\\n}\\n\\nreturn { \"result\": map.values() };\\n}';function checkForAtomicOperators(e){if(Array.isArray(e))return e.reduce((e,n)=>e||checkForAtomicOperators(n),null);const n=Object.keys(e);return 0===n.length?toError(\"The update operation document must contain at least one atomic operator.\"):\"$\"!==n[0][0]?toError(\"the update operation document must contain atomic operators.\"):void 0}function createIndex(e,n,r,o){createIndexDb(e.s.db,e.collectionName,n,r,o)}function createIndexes(e,n,r,o){const t=e.s.topology.capabilities();for(let e=0;e<n.length;e++)if(null==n[e].name){const r=[];if(n[e].collation&&t&&!t.commandsTakeCollation)return o(new MongoError(\"server/primary/mongos does not support collation\"));for(let o in n[e].key)r.push(`${o}_${n[e].key[o]}`);n[e].name=r.join(\"_\")}r=Object.assign({},r,{readPreference:ReadPreference.PRIMARY}),executeCommand(e.s.db,{createIndexes:e.collectionName,indexes:n},r,o)}function ensureIndex(e,n,r,o){ensureIndexDb(e.s.db,e.collectionName,n,r,o)}function group(e,n,r,o,t,l,a,c,i){if(a){const a=t&&\"Code\"===t._bsontype?t:new Code(t),u={group:{ns:e.collectionName,$reduce:a,cond:r,initial:o,out:\"inline\"}};if(null!=l&&(u.group.finalize=l),\"function\"==typeof n||n&&\"Code\"===n._bsontype)u.group.$keyf=n&&\"Code\"===n._bsontype?n:new Code(n);else{const e={};n.forEach(n=>{e[n]=1}),u.group.key=e}(c=Object.assign({},c)).readPreference=resolveReadPreference(e,c),decorateWithReadConcern(u,e,c);try{decorateWithCollation(u,e,c)}catch(e){return i(e,null)}executeCommand(e.s.db,u,c,(e,n)=>{if(e)return handleCallback(i,e,null);handleCallback(i,null,n.retval)})}else{const l=null!=t&&\"Code\"===t._bsontype?t.scope:{};l.ns=e.collectionName,l.keys=n,l.condition=r,l.initial=o;const a=groupFunction.replace(/ reduce;/,t.toString()+\";\");evaluate(e.s.db,new Code(a,l),null,c,(e,n)=>{if(e)return handleCallback(i,e,null);handleCallback(i,null,n.result||n)})}}function indexes(e,n,r){n=Object.assign({},{full:!0},n),indexInformationDb(e.s.db,e.collectionName,n,r)}function indexExists(e,n,r,o){indexInformation(e,r,(e,r)=>{if(null!=e)return handleCallback(o,e,null);if(!Array.isArray(n))return handleCallback(o,null,null!=r[n]);for(let e=0;e<n.length;e++)if(null==r[n[e]])return handleCallback(o,null,!1);return handleCallback(o,null,!0)})}function indexInformation(e,n,r){indexInformationDb(e.s.db,e.collectionName,n,r)}function parallelCollectionScan(e,n,r){const o={parallelCollectionScan:e.collectionName,numCursors:n.numCursors};decorateWithReadConcern(o,e,n);const t=n.raw;delete n.raw,executeCommand(e.s.db,o,n,(o,l)=>{if(o)return handleCallback(r,o,null);if(null==l)return handleCallback(r,new Error(\"no result returned for parallelCollectionScan\"),null);n=Object.assign({explicitlyIgnoreSession:!0},n);const a=[];t&&(n.raw=t);for(let r=0;r<l.cursors.length;r++){const o=l.cursors[r].cursor.id,t=\"number\"==typeof o?Long.fromNumber(o):o;a.push(e.s.topology.cursor(e.namespace,t,n))}handleCallback(r,null,a)})}function save(e,n,r,o){const t=applyWriteConcern(Object.assign({},r),{db:e.s.db,collection:e},r);if(null!=n._id)return t.upsert=!0,updateDocuments(e,{_id:n._id},n,t,o);insertDocuments(e,[n],t,(e,r)=>{if(null!=o)return null==n?handleCallback(o,null,null):e?handleCallback(o,e,null):void handleCallback(o,null,r)})}module.exports={checkForAtomicOperators:checkForAtomicOperators,createIndex:createIndex,createIndexes:createIndexes,ensureIndex:ensureIndex,group:group,indexes:indexes,indexExists:indexExists,indexInformation:indexInformation,parallelCollectionScan:parallelCollectionScan,save:save};","node_modules/mongodb/lib/operations/db_ops.js":"\"use strict\";const applyWriteConcern=require(\"../utils\").applyWriteConcern,Code=require(\"../core\").BSON.Code,resolveReadPreference=require(\"../utils\").resolveReadPreference,crypto=require(\"crypto\"),debugOptions=require(\"../utils\").debugOptions,handleCallback=require(\"../utils\").handleCallback,MongoError=require(\"../core\").MongoError,parseIndexOptions=require(\"../utils\").parseIndexOptions,ReadPreference=require(\"../core\").ReadPreference,toError=require(\"../utils\").toError,CONSTANTS=require(\"../constants\"),MongoDBNamespace=require(\"../utils\").MongoDBNamespace,count=require(\"./collection_ops\").count,findOne=require(\"./collection_ops\").findOne,remove=require(\"./collection_ops\").remove,updateOne=require(\"./collection_ops\").updateOne;let collection,db;function loadCollection(){return collection||(collection=require(\"../collection\")),collection}function loadDb(){return db||(db=require(\"../db\")),db}const debugFields=[\"authSource\",\"w\",\"wtimeout\",\"j\",\"native_parser\",\"forceServerObjectId\",\"serializeFunctions\",\"raw\",\"promoteLongs\",\"promoteValues\",\"promoteBuffers\",\"bufferMaxEntries\",\"numberOfRetries\",\"retryMiliSeconds\",\"readPreference\",\"pkFactory\",\"parentDb\",\"promiseLibrary\",\"noListener\"];function addUser(e,n,r,o,a){let l=loadDb();if(e.serverConfig&&e.serverConfig.isDestroyed())return a(new MongoError(\"topology was destroyed\"));executeAuthCreateUserCommand(e,n,r,o,(t,s)=>{if(t&&-5e3===t.code){const t=applyWriteConcern(Object.assign({},o),{db:e},o),s=crypto.createHash(\"md5\");s.update(n+\":mongo:\"+r);const i=s.digest(\"hex\"),d=(o.dbName?new l(o.dbName,e.s.topology,e.s.options):e).collection(CONSTANTS.SYSTEM_USER_COLLECTION);count(d,{},t,(e,r)=>{if(null!=e)return handleCallback(a,e,null);const o=Object.assign({projection:{dbName:1}},t);d.find({user:n},o).toArray(e=>{if(null!=e)return handleCallback(a,e,null);t.upsert=!0,updateOne(d,{user:n},{$set:{user:n,pwd:i}},t,e=>0===r&&e?handleCallback(a,null,[{user:n,pwd:i}]):e?handleCallback(a,e,null):void handleCallback(a,null,[{user:n,pwd:i}]))})})}else{if(t)return handleCallback(a,t);handleCallback(a,t,s)}})}function collections(e,n,r){let o=loadCollection();n=Object.assign({},n,{nameOnly:!0}),e.listCollections({},n).toArray((n,a)=>{if(null!=n)return handleCallback(r,n,null);a=a.filter(e=>-1===e.name.indexOf(\"$\")),handleCallback(r,null,a.map(n=>new o(e,e.s.topology,e.databaseName,n.name,e.s.pkFactory,e.s.options)))})}function createIndex(e,n,r,o,a){let l=Object.assign({},{readPreference:ReadPreference.PRIMARY},o);if((l=applyWriteConcern(l,{db:e},o)).writeConcern&&\"function\"!=typeof a)throw MongoError.create({message:\"Cannot use a writeConcern without a provided callback\",driver:!0});if(e.serverConfig&&e.serverConfig.isDestroyed())return a(new MongoError(\"topology was destroyed\"));createIndexUsingCreateIndexes(e,n,r,l,(t,s)=>{if(null==t)return handleCallback(a,t,s);if(67===t.code||11e3===t.code||85===t.code||86===t.code||11600===t.code||197===t.code)return handleCallback(a,t,s);const i=createCreateIndexCommand(e,n,r,o);l.checkKeys=!1,e.s.topology.insert(e.s.namespace.withCollection(CONSTANTS.SYSTEM_INDEX_COLLECTION),i,l,(e,n)=>{if(null!=a)return e?handleCallback(a,e):null==n?handleCallback(a,null,null):n.result.writeErrors?handleCallback(a,MongoError.create(n.result.writeErrors[0]),null):void handleCallback(a,null,i.name)})})}function createListener(e,n,r){return function(o){if(r.listeners(n).length>0){r.emit(n,o,e);for(let r=0;r<e.s.children.length;r++)e.s.children[r].emit(n,o,e.s.children[r])}}}function dropCollection(e,n,r,o){executeCommand(e,n,r,(n,r)=>e.serverConfig&&e.serverConfig.isDestroyed()?o(new MongoError(\"topology was destroyed\")):n?handleCallback(o,n):r.ok?handleCallback(o,null,!0):void handleCallback(o,null,!1))}function dropDatabase(e,n,r,o){executeCommand(e,n,r,(n,r)=>e.serverConfig&&e.serverConfig.isDestroyed()?o(new MongoError(\"topology was destroyed\")):null!=o?n?handleCallback(o,n,null):void handleCallback(o,null,!!r.ok):void 0)}function ensureIndex(e,n,r,o,a){const l=applyWriteConcern({},{db:e},o),t=createCreateIndexCommand(e,n,r,o).name;if(e.serverConfig&&e.serverConfig.isDestroyed())return a(new MongoError(\"topology was destroyed\"));l.readPreference=ReadPreference.PRIMARY,indexInformation(e,n,l,(l,s)=>{if(null!=l&&26!==l.code)return handleCallback(a,l,null);if(null!=s&&s[t]){if(\"function\"==typeof a)return handleCallback(a,null,t)}else createIndex(e,n,r,o,a)})}function evaluate(e,n,r,o,a){let l=n,t=[];if(e.serverConfig&&e.serverConfig.isDestroyed())return a(new MongoError(\"topology was destroyed\"));l&&\"Code\"===l._bsontype||(l=new Code(l)),null==r||Array.isArray(r)||\"function\"==typeof r?null!=r&&Array.isArray(r)&&\"function\"!=typeof r&&(t=r):t=[r];let s={$eval:l,args:t};o.nolock&&(s.nolock=o.nolock),o.readPreference=new ReadPreference(ReadPreference.PRIMARY),executeCommand(e,s,o,(e,n)=>e?handleCallback(a,e,null):n&&1===n.ok?handleCallback(a,null,n.retval):n?handleCallback(a,MongoError.create({message:`eval failed: ${n.errmsg}`,driver:!0}),null):void handleCallback(a,e,n))}function executeCommand(e,n,r,o){if(e.serverConfig&&e.serverConfig.isDestroyed())return o(new MongoError(\"topology was destroyed\"));const a=r.dbName||r.authdb||e.databaseName;r.readPreference=resolveReadPreference(e,r),e.s.logger.isDebug()&&e.s.logger.debug(`executing command ${JSON.stringify(n)} against ${a}.$cmd with options [${JSON.stringify(debugOptions(debugFields,r))}]`),e.s.topology.command(e.s.namespace.withCollection(\"$cmd\"),n,r,(e,n)=>e?handleCallback(o,e):r.full?handleCallback(o,null,n):void handleCallback(o,null,n.result))}function executeDbAdminCommand(e,n,r,o){const a=new MongoDBNamespace(\"admin\",\"$cmd\");e.s.topology.command(a,n,r,(n,r)=>e.serverConfig&&e.serverConfig.isDestroyed()?o(new MongoError(\"topology was destroyed\")):n?handleCallback(o,n):void handleCallback(o,null,r.result))}function indexInformation(e,n,r,o){const a=null!=r.full&&r.full;if(e.serverConfig&&e.serverConfig.isDestroyed())return o(new MongoError(\"topology was destroyed\"));e.collection(n).listIndexes(r).toArray((e,n)=>e?o(toError(e)):Array.isArray(n)?a?handleCallback(o,null,n):void handleCallback(o,null,function(e){let n={};for(let r=0;r<e.length;r++){const o=e[r];n[o.name]=[];for(let e in o.key)n[o.name].push([e,o.key[e]])}return n}(n)):handleCallback(o,null,[]))}function profilingInfo(e,n,r){try{e.collection(\"system.profile\").find({},n).toArray(r)}catch(e){return r(e,null)}}function removeUser(e,n,r,o){let a=loadDb();executeAuthRemoveUserCommand(e,n,r,(e,l)=>{if(e&&-5e3===e.code){const e=applyWriteConcern(Object.assign({},r),{db:l},r),l=r.dbName?new a(r.dbName,l.s.topology,l.s.options):l,t=l.collection(CONSTANTS.SYSTEM_USER_COLLECTION);findOne(t,{user:n},e,(r,a)=>{if(null==a)return handleCallback(o,r,!1);remove(t,{user:n},e,e=>{handleCallback(o,e,!0)})})}else{if(e)return handleCallback(o,e);handleCallback(o,e,l)}})}function validateDatabaseName(e){if(\"string\"!=typeof e)throw MongoError.create({message:\"database name must be a string\",driver:!0});if(0===e.length)throw MongoError.create({message:\"database name cannot be the empty string\",driver:!0});if(\"$external\"===e)return;const n=[\" \",\".\",\"$\",\"/\",\"\\\\\"];for(let r=0;r<n.length;r++)if(-1!==e.indexOf(n[r]))throw MongoError.create({message:\"database names cannot contain the character '\"+n[r]+\"'\",driver:!0})}function createCreateIndexCommand(e,n,r,o){const a=parseIndexOptions(r),l=a.fieldHash,t=\"string\"==typeof o.name?o.name:a.name,s={ns:e.s.namespace.withCollection(n).toString(),key:l,name:t},i=null!=o&&\"object\"!=typeof o&&o;o=null==o||\"boolean\"==typeof o?{}:o;const d=Object.keys(s);for(let e in o)-1===d.indexOf(e)&&(s[e]=o[e]);null==s.unique&&(s.unique=i);const c=[\"w\",\"wtimeout\",\"j\",\"fsync\",\"readPreference\",\"session\"];for(let e=0;e<c.length;e++)delete s[c[e]];return s}function createIndexUsingCreateIndexes(e,n,r,o,a){const l=parseIndexOptions(r),t=\"string\"==typeof o.name?o.name:l.name,s=[{name:t,key:l.fieldHash}],i=Object.keys(s[0]).concat([\"writeConcern\",\"w\",\"wtimeout\",\"j\",\"fsync\",\"readPreference\",\"session\"]);for(let e in o)-1===i.indexOf(e)&&(s[0][e]=o[e]);const d=e.s.topology.capabilities();if(s[0].collation&&d&&!d.commandsTakeCollation){const e=new MongoError(\"server/primary/mongos does not support collation\");return e.code=67,a(e)}const c=applyWriteConcern({createIndexes:n,indexes:s},{db:e},o);o.readPreference=ReadPreference.PRIMARY,executeCommand(e,c,o,(e,n)=>e?handleCallback(a,e,null):0===n.ok?handleCallback(a,toError(n),null):void handleCallback(a,null,t))}function executeAuthCreateUserCommand(e,n,r,o,a){if(\"string\"==typeof n&&null!=r&&\"object\"==typeof r&&(o=r,r=null),\"function\"==typeof o&&(a=o,o={}),null!=o.digestPassword)return a(toError(\"The digestPassword option is not supported via add_user. Please use db.command('createUser', ...) instead for this option.\"));const l=null!=o.customData?o.customData:{};let t=Array.isArray(o.roles)?o.roles:[];const s=\"number\"==typeof o.maxTimeMS?o.maxTimeMS:null;0===t.length&&console.log(\"Creating a user without roles is deprecated in MongoDB >= 2.6\");const i={writeCommand:!0};o.dbName&&(i.dbName=o.dbName),null!=s&&(i.maxTimeMS=s),\"admin\"!==e.databaseName.toLowerCase()&&\"admin\"!==o.dbName||Array.isArray(o.roles)?Array.isArray(o.roles)||(t=[\"dbOwner\"]):t=[\"root\"];const d=e.s.topology.lastIsMaster().maxWireVersion>=7;let c={createUser:n,customData:l,roles:t,digestPassword:d};c=applyWriteConcern(c,{db:e},o);let u=r;if(!d){const e=crypto.createHash(\"md5\");e.update(n+\":mongo:\"+r),u=e.digest(\"hex\")}\"string\"==typeof r&&(c.pwd=u),i.readPreference=ReadPreference.primary,executeCommand(e,c,i,(e,r)=>e&&0===e.ok&&void 0===e.code?handleCallback(a,{code:-5e3},null):e?handleCallback(a,e,null):void handleCallback(a,r.ok?null:toError(r),r.ok?[{user:n,pwd:\"\"}]:null))}function executeAuthRemoveUserCommand(e,n,r,o){if(\"function\"==typeof r&&(o=r,r={}),r=r||{},e.serverConfig&&e.serverConfig.isDestroyed())return o(new MongoError(\"topology was destroyed\"));const a={writeCommand:!0};r.dbName&&(a.dbName=r.dbName);const l=\"number\"==typeof r.maxTimeMS?r.maxTimeMS:null;null!=l&&(a.maxTimeMS=l);let t={dropUser:n};t=applyWriteConcern(t,{db:e},r),a.readPreference=ReadPreference.primary,executeCommand(e,t,a,(e,n)=>e&&!e.ok&&void 0===e.code?handleCallback(o,{code:-5e3}):e?handleCallback(o,e,null):void handleCallback(o,null,!!n.ok))}module.exports={addUser:addUser,collections:collections,createListener:createListener,createIndex:createIndex,dropCollection:dropCollection,dropDatabase:dropDatabase,ensureIndex:ensureIndex,evaluate:evaluate,executeCommand:executeCommand,executeDbAdminCommand:executeDbAdminCommand,indexInformation:indexInformation,profilingInfo:profilingInfo,removeUser:removeUser,validateDatabaseName:validateDatabaseName};","node_modules/mongodb/lib/operations/common_functions.js":"\"use strict\";const applyRetryableWrites=require(\"../utils\").applyRetryableWrites,applyWriteConcern=require(\"../utils\").applyWriteConcern,decorateWithCollation=require(\"../utils\").decorateWithCollation,decorateWithReadConcern=require(\"../utils\").decorateWithReadConcern,executeCommand=require(\"./db_ops\").executeCommand,formattedOrderClause=require(\"../utils\").formattedOrderClause,handleCallback=require(\"../utils\").handleCallback,MongoError=require(\"../core\").MongoError,ReadPreference=require(\"../core\").ReadPreference,toError=require(\"../utils\").toError,CursorState=require(\"../core/cursor\").CursorState;function buildCountCommand(e,r,t){const l=t.skip,n=t.limit;let o=t.hint;const a=t.maxTimeMS;r=r||{};const i={count:t.collectionName,query:r};return e.s.numberOfRetries?(e.options.hint?o=e.options.hint:e.cmd.hint&&(o=e.cmd.hint),decorateWithCollation(i,e,e.cmd)):decorateWithCollation(i,e,t),\"number\"==typeof l&&(i.skip=l),\"number\"==typeof n&&(i.limit=n),\"number\"==typeof a&&(i.maxTimeMS=a),o&&(i.hint=o),decorateWithReadConcern(i,e),i}function deleteCallback(e,r,t){if(null!=t){if(e&&t)return t(e);if(null==r)return t(null,{result:{ok:1}});r.deletedCount=r.result.n,t&&t(null,r)}}function findAndModify(e,r,t,l,n,o){const a={findAndModify:e.collectionName,query:r};(t=formattedOrderClause(t))&&(a.sort=t),a.new=!!n.new,a.remove=!!n.remove,a.upsert=!!n.upsert;const i=n.projection||n.fields;i&&(a.fields=i),n.arrayFilters&&(a.arrayFilters=n.arrayFilters,delete n.arrayFilters),l&&!n.remove&&(a.update=l),n.maxTimeMS&&(a.maxTimeMS=n.maxTimeMS),n.serializeFunctions=n.serializeFunctions||e.s.serializeFunctions,n.checkKeys=!1;let s=Object.assign({},n);s=applyRetryableWrites(s,e.s.db),(s=applyWriteConcern(s,{db:e.s.db,collection:e},n)).writeConcern&&(a.writeConcern=s.writeConcern),!0===s.bypassDocumentValidation&&(a.bypassDocumentValidation=s.bypassDocumentValidation),s.readPreference=ReadPreference.primary;try{decorateWithCollation(a,e,s)}catch(e){return o(e,null)}executeCommand(e.s.db,a,s,(e,r)=>e?handleCallback(o,e,null):handleCallback(o,null,r))}function indexInformation(e,r,t,l){const n=null!=t.full&&t.full;if(e.serverConfig&&e.serverConfig.isDestroyed())return l(new MongoError(\"topology was destroyed\"));e.collection(r).listIndexes(t).toArray((e,r)=>e?l(toError(e)):Array.isArray(r)?n?handleCallback(l,null,r):void handleCallback(l,null,function(e){let r={};for(let t=0;t<e.length;t++){const l=e[t];r[l.name]=[];for(let e in l.key)r[l.name].push([e,l.key[e]])}return r}(r)):handleCallback(l,null,[]))}function prepareDocs(e,r,t){const l=\"boolean\"==typeof t.forceServerObjectId?t.forceServerObjectId:e.s.db.options.forceServerObjectId;return!0===l?r:r.map(r=>(!0!==l&&null==r._id&&(r._id=e.s.pkFactory.createPk()),r))}function nextObject(e,r){if(e.s.state===CursorState.CLOSED||e.isDead&&e.isDead())return handleCallback(r,MongoError.create({message:\"Cursor is closed\",driver:!0}));if(e.s.state===CursorState.INIT&&e.cmd&&e.cmd.sort)try{e.cmd.sort=formattedOrderClause(e.cmd.sort)}catch(e){return handleCallback(r,e)}e._next((t,l)=>{if(e.s.state=CursorState.OPEN,t)return handleCallback(r,t);handleCallback(r,null,l)})}function insertDocuments(e,r,t,l){\"function\"==typeof t&&(l=t,t={}),t=t||{},r=Array.isArray(r)?r:[r];let n=Object.assign({},t);n=applyRetryableWrites(n,e.s.db),!0===(n=applyWriteConcern(n,{db:e.s.db,collection:e},t)).keepGoing&&(n.ordered=!1),n.serializeFunctions=t.serializeFunctions||e.s.serializeFunctions,r=prepareDocs(e,r,t),e.s.topology.insert(e.s.namespace,r,n,(e,t)=>{if(null!=l){if(e)return handleCallback(l,e);if(null==t)return handleCallback(l,null,null);if(t.result.code)return handleCallback(l,toError(t.result));if(t.result.writeErrors)return handleCallback(l,toError(t.result.writeErrors[0]));t.ops=r,handleCallback(l,null,t)}})}function removeDocuments(e,r,t,l){\"function\"==typeof t?(l=t,t={}):\"function\"==typeof r&&(l=r,t={},r={}),t=t||{};let n=Object.assign({},t);n=applyRetryableWrites(n,e.s.db),n=applyWriteConcern(n,{db:e.s.db,collection:e},t),null==r&&(r={});const o={q:r,limit:0};t.single?o.limit=1:n.retryWrites&&(n.retryWrites=!1);try{decorateWithCollation(n,e,t)}catch(e){return l(e,null)}e.s.topology.remove(e.s.namespace,[o],n,(e,r)=>{if(null!=l)return e?handleCallback(l,e,null):null==r?handleCallback(l,null,null):r.result.code?handleCallback(l,toError(r.result)):r.result.writeErrors?handleCallback(l,toError(r.result.writeErrors[0])):void handleCallback(l,null,r)})}function updateDocuments(e,r,t,l,n){if(\"function\"==typeof l&&(n=l,l=null),null==l&&(l={}),\"function\"!=typeof n&&(n=null),null==r||\"object\"!=typeof r)return n(toError(\"selector must be a valid JavaScript object\"));if(null==t||\"object\"!=typeof t)return n(toError(\"document must be a valid JavaScript object\"));let o=Object.assign({},l);o=applyRetryableWrites(o,e.s.db),(o=applyWriteConcern(o,{db:e.s.db,collection:e},l)).serializeFunctions=l.serializeFunctions||e.s.serializeFunctions;const a={q:r,u:t};a.upsert=void 0!==l.upsert&&!!l.upsert,a.multi=void 0!==l.multi&&!!l.multi,l.hint&&(a.hint=l.hint),o.arrayFilters&&(a.arrayFilters=o.arrayFilters,delete o.arrayFilters),o.retryWrites&&a.multi&&(o.retryWrites=!1);try{decorateWithCollation(o,e,l)}catch(e){return n(e,null)}e.s.topology.update(e.s.namespace,[a],o,(e,r)=>{if(null!=n)return e?handleCallback(n,e,null):null==r?handleCallback(n,null,null):r.result.code?handleCallback(n,toError(r.result)):r.result.writeErrors?handleCallback(n,toError(r.result.writeErrors[0])):void handleCallback(n,null,r)})}function updateCallback(e,r,t){if(null!=t){if(e)return t(e);if(null==r)return t(null,{result:{ok:1}});r.modifiedCount=null!=r.result.nModified?r.result.nModified:r.result.n,r.upsertedId=Array.isArray(r.result.upserted)&&r.result.upserted.length>0?r.result.upserted[0]:null,r.upsertedCount=Array.isArray(r.result.upserted)&&r.result.upserted.length?r.result.upserted.length:0,r.matchedCount=Array.isArray(r.result.upserted)&&r.result.upserted.length>0?0:r.result.n,t(null,r)}}module.exports={buildCountCommand:buildCountCommand,deleteCallback:deleteCallback,findAndModify:findAndModify,indexInformation:indexInformation,nextObject:nextObject,prepareDocs:prepareDocs,insertDocuments:insertDocuments,removeDocuments:removeDocuments,updateDocuments:updateDocuments,updateCallback:updateCallback};","node_modules/mongodb/lib/constants.js":"\"use strict\";module.exports={SYSTEM_NAMESPACE_COLLECTION:\"system.namespaces\",SYSTEM_INDEX_COLLECTION:\"system.indexes\",SYSTEM_PROFILE_COLLECTION:\"system.profile\",SYSTEM_USER_COLLECTION:\"system.users\",SYSTEM_COMMAND_COLLECTION:\"$cmd\",SYSTEM_JS_COLLECTION:\"system.js\"};","node_modules/mongodb/lib/dynamic_loaders.js":"\"use strict\";let collection,cursor,db;function loadCollection(){return collection||(collection=require(\"./collection\")),collection}function loadCursor(){return cursor||(cursor=require(\"./cursor\")),cursor}function loadDb(){return db||(db=require(\"./db\")),db}module.exports={loadCollection:loadCollection,loadCursor:loadCursor,loadDb:loadDb};","node_modules/mongodb/lib/operations/command_v2.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,OperationBase=require(\"./operation\").OperationBase,resolveReadPreference=require(\"../utils\").resolveReadPreference,ReadConcern=require(\"../read_concern\"),WriteConcern=require(\"../write_concern\"),maxWireVersion=require(\"../core/utils\").maxWireVersion,commandSupportsReadConcern=require(\"../core/sessions\").commandSupportsReadConcern,MongoError=require(\"../error\").MongoError,SUPPORTS_WRITE_CONCERN_AND_COLLATION=5;class CommandOperationV2 extends OperationBase{constructor(e,r,o){super(r),this.ns=e.s.namespace.withCollection(\"$cmd\"),this.readPreference=resolveReadPreference(e,this.options),this.readConcern=resolveReadConcern(e,this.options),this.writeConcern=resolveWriteConcern(e,this.options),this.explain=!1,o&&\"boolean\"==typeof o.fullResponse&&(this.fullResponse=!0),this.options.readPreference=this.readPreference,e.s.logger?this.logger=e.s.logger:e.s.db&&e.s.db.logger&&(this.logger=e.s.db.logger)}executeCommand(e,r,o){this.server=e;const n=this.options,s=maxWireVersion(e),t=this.session&&this.session.inTransaction();this.readConcern&&commandSupportsReadConcern(r)&&!t&&Object.assign(r,{readConcern:this.readConcern}),n.collation&&s<SUPPORTS_WRITE_CONCERN_AND_COLLATION?o(new MongoError(`Server ${e.name}, which reports wire version ${s}, does not support collation`)):(s>=SUPPORTS_WRITE_CONCERN_AND_COLLATION&&(this.writeConcern&&this.hasAspect(Aspect.WRITE_OPERATION)&&Object.assign(r,{writeConcern:this.writeConcern}),n.collation&&\"object\"==typeof n.collation&&Object.assign(r,{collation:n.collation})),\"number\"==typeof n.maxTimeMS&&(r.maxTimeMS=n.maxTimeMS),\"string\"==typeof n.comment&&(r.comment=n.comment),this.logger&&this.logger.isDebug()&&this.logger.debug(`executing command ${JSON.stringify(r)} against ${this.ns}`),e.command(this.ns.toString(),r,this.options,(e,r)=>{e?o(e,null):this.fullResponse?o(null,r):o(null,r.result)}))}}function resolveWriteConcern(e,r){return WriteConcern.fromOptions(r)||e.writeConcern}function resolveReadConcern(e,r){return ReadConcern.fromOptions(r)||e.readConcern}module.exports=CommandOperationV2;","node_modules/mongodb/lib/read_concern.js":"\"use strict\";class ReadConcern{constructor(e){null!=e&&(this.level=e)}static fromOptions(e){if(null!=e)return e.readConcern?e.readConcern instanceof ReadConcern?e.readConcern:new ReadConcern(e.readConcern.level):e.level?new ReadConcern(e.level):void 0}static get MAJORITY(){return\"majority\"}static get AVAILABLE(){return\"available\"}static get LINEARIZABLE(){return\"linearizable\"}static get SNAPSHOT(){return\"snapshot\"}}module.exports=ReadConcern;","node_modules/mongodb/lib/operations/add_user.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,CommandOperation=require(\"./command\"),defineAspects=require(\"./operation\").defineAspects,crypto=require(\"crypto\"),handleCallback=require(\"../utils\").handleCallback,toError=require(\"../utils\").toError;class AddUserOperation extends CommandOperation{constructor(e,r,s,t){super(e,t),this.username=r,this.password=s}_buildCommand(){const e=this.db,r=this.username,s=this.password,t=this.options;let o=Array.isArray(t.roles)?t.roles:[];0===o.length&&console.log(\"Creating a user without roles is deprecated in MongoDB >= 2.6\"),\"admin\"!==e.databaseName.toLowerCase()&&\"admin\"!==t.dbName||Array.isArray(t.roles)?Array.isArray(t.roles)||(o=[\"dbOwner\"]):o=[\"root\"];const a=e.s.topology.lastIsMaster().maxWireVersion>=7;let i=s;if(!a){const e=crypto.createHash(\"md5\");e.update(r+\":mongo:\"+s),i=e.digest(\"hex\")}const n={createUser:r,customData:t.customData||{},roles:o,digestPassword:a};return\"string\"==typeof s&&(n.pwd=i),n}execute(e){if(null!=this.options.digestPassword)return e(toError(\"The digestPassword option is not supported via add_user. Please use db.command('createUser', ...) instead for this option.\"));super.execute((r,s)=>handleCallback(e,r,r?null:s))}}defineAspects(AddUserOperation,Aspect.WRITE_OPERATION),module.exports=AddUserOperation;","node_modules/mongodb/lib/operations/collections.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,handleCallback=require(\"../utils\").handleCallback;let collection;function loadCollection(){return collection||(collection=require(\"../collection\")),collection}class CollectionsOperation extends OperationBase{constructor(e,l){super(l),this.db=e}execute(e){const l=this.db;let o=this.options,t=loadCollection();o=Object.assign({},o,{nameOnly:!0}),l.listCollections({},o).toArray((o,n)=>{if(null!=o)return handleCallback(e,o,null);n=n.filter(e=>-1===e.name.indexOf(\"$\")),handleCallback(e,null,n.map(e=>new t(l,l.s.topology,l.databaseName,e.name,l.s.pkFactory,l.s.options)))})}}module.exports=CollectionsOperation;","node_modules/mongodb/lib/operations/command.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,OperationBase=require(\"./operation\").OperationBase,applyWriteConcern=require(\"../utils\").applyWriteConcern,debugOptions=require(\"../utils\").debugOptions,handleCallback=require(\"../utils\").handleCallback,MongoError=require(\"../core\").MongoError,ReadPreference=require(\"../core\").ReadPreference,resolveReadPreference=require(\"../utils\").resolveReadPreference,MongoDBNamespace=require(\"../utils\").MongoDBNamespace,debugFields=[\"authSource\",\"w\",\"wtimeout\",\"j\",\"native_parser\",\"forceServerObjectId\",\"serializeFunctions\",\"raw\",\"promoteLongs\",\"promoteValues\",\"promoteBuffers\",\"bufferMaxEntries\",\"numberOfRetries\",\"retryMiliSeconds\",\"readPreference\",\"pkFactory\",\"parentDb\",\"promiseLibrary\",\"noListener\"];class CommandOperation extends OperationBase{constructor(e,r,n,o){super(r),this.hasAspect(Aspect.WRITE_OPERATION)?(applyWriteConcern(this.options,null!=n?{db:e,coll:n}:{db:e},this.options),this.options.readPreference=ReadPreference.primary):this.options.readPreference=resolveReadPreference(null!=n?n:e,r),this.db=e,null!=o&&(this.command=o),null!=n&&(this.collection=n)}_buildCommand(){if(null!=this.command)return this.command}execute(e){const r=this.db,n=Object.assign({},this.options);if(r.serverConfig&&r.serverConfig.isDestroyed())return e(new MongoError(\"topology was destroyed\"));let o;try{o=this._buildCommand()}catch(r){return e(r)}const s=n.dbName||n.authdb||r.databaseName;this.hasAspect(Aspect.WRITE_OPERATION)&&(!n.writeConcern||n.session&&n.session.inTransaction()||(o.writeConcern=n.writeConcern)),r.s.logger.isDebug()&&r.s.logger.debug(`executing command ${JSON.stringify(o)} against ${s}.$cmd with options [${JSON.stringify(debugOptions(debugFields,n))}]`);const t=null!=this.namespace?this.namespace:new MongoDBNamespace(s,\"$cmd\");r.s.topology.command(t,o,n,(r,o)=>r?handleCallback(e,r):n.full?handleCallback(e,null,o):void handleCallback(e,null,o.result))}}module.exports=CommandOperation;","node_modules/mongodb/lib/operations/create_collection.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,CommandOperation=require(\"./command\"),applyWriteConcern=require(\"../utils\").applyWriteConcern,handleCallback=require(\"../utils\").handleCallback,loadCollection=require(\"../dynamic_loaders\").loadCollection,MongoError=require(\"../core\").MongoError,ReadPreference=require(\"../core\").ReadPreference,illegalCommandFields=[\"w\",\"wtimeout\",\"j\",\"fsync\",\"autoIndexId\",\"strict\",\"serializeFunctions\",\"pkFactory\",\"raw\",\"readPreference\",\"session\",\"readConcern\",\"writeConcern\"];class CreateCollectionOperation extends CommandOperation{constructor(e,r,n){super(e,n),this.name=r}_buildCommand(){const e=this.name,r=this.options,n={create:e};for(let e in r)null!=r[e]&&\"function\"!=typeof r[e]&&-1===illegalCommandFields.indexOf(e)&&(n[e]=r[e]);return n}execute(e){const r=this.db,n=this.name,t=this.options;let o=loadCollection();if(r.serverConfig&&r.serverConfig.isDestroyed())return e(new MongoError(\"topology was destroyed\"));let a=Object.assign({},t,{nameOnly:!0});a=applyWriteConcern(a,{db:r},a),r.listCollections({name:n},a).setReadPreference(ReadPreference.PRIMARY).toArray((l,i)=>{if(null!=l)return handleCallback(e,l,null);if(i.length>0&&a.strict)return handleCallback(e,MongoError.create({message:`Collection ${n} already exists. Currently in strict mode.`,driver:!0}),null);if(i.length>0)try{return handleCallback(e,null,new o(r,r.s.topology,r.databaseName,n,r.s.pkFactory,t))}catch(l){return handleCallback(e,l)}super.execute(a=>{if(a)return handleCallback(e,a);try{return handleCallback(e,null,new o(r,r.s.topology,r.databaseName,n,r.s.pkFactory,t))}catch(a){return handleCallback(e,a)}})})}}defineAspects(CreateCollectionOperation,Aspect.WRITE_OPERATION),module.exports=CreateCollectionOperation;","node_modules/mongodb/lib/operations/create_index.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,CommandOperation=require(\"./command\"),defineAspects=require(\"./operation\").defineAspects,handleCallback=require(\"../utils\").handleCallback,MongoError=require(\"../core\").MongoError,parseIndexOptions=require(\"../utils\").parseIndexOptions,keysToOmit=new Set([\"name\",\"key\",\"writeConcern\",\"w\",\"wtimeout\",\"j\",\"fsync\",\"readPreference\",\"session\"]);class CreateIndexOperation extends CommandOperation{constructor(e,n,o,t){super(e,t);const r=parseIndexOptions(o),s={name:\"string\"==typeof t.name?t.name:r.name,key:r.fieldHash};this.name=n,this.fieldOrSpec=o,this.indexes=s}_buildCommand(){const e=this.options,n=this.name,o=this.indexes;for(let n in e)keysToOmit.has(n)||(o[n]=e[n]);return{createIndexes:n,indexes:[o]}}execute(e){const n=this.db,o=this.options,t=this.indexes,r=n.s.topology.capabilities();if(o.collation&&r&&!r.commandsTakeCollation){const n=new MongoError(\"server/primary/mongos does not support collation\");return n.code=67,e(n)}if(o.writeConcern&&\"function\"!=typeof e)throw MongoError.create({message:\"Cannot use a writeConcern without a provided callback\",driver:!0});super.execute((n,o)=>handleCallback(e,n,null==n?t.name:o))}}defineAspects(CreateIndexOperation,Aspect.WRITE_OPERATION),module.exports=CreateIndexOperation;","node_modules/mongodb/lib/operations/drop.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,CommandOperation=require(\"./command\"),defineAspects=require(\"./operation\").defineAspects,handleCallback=require(\"../utils\").handleCallback;class DropOperation extends CommandOperation{constructor(e,a){const o=Object.assign({},a,e.s.options);a.session&&(o.session=a.session),super(e,o)}execute(e){super.execute((a,o)=>a?handleCallback(e,a):o.ok?handleCallback(e,null,!0):void handleCallback(e,null,!1))}}defineAspects(DropOperation,Aspect.WRITE_OPERATION);class DropCollectionOperation extends DropOperation{constructor(e,a,o){super(e,o),this.name=a,this.namespace=`${e.namespace}.${a}`}_buildCommand(){return{drop:this.name}}}class DropDatabaseOperation extends DropOperation{_buildCommand(){return{dropDatabase:1}}}module.exports={DropOperation:DropOperation,DropCollectionOperation:DropCollectionOperation,DropDatabaseOperation:DropDatabaseOperation};","node_modules/mongodb/lib/operations/execute_db_admin_command.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,handleCallback=require(\"../utils\").handleCallback,MongoError=require(\"../core\").MongoError,MongoDBNamespace=require(\"../utils\").MongoDBNamespace;class ExecuteDbAdminCommandOperation extends OperationBase{constructor(e,o,r){super(r),this.db=e,this.selector=o}execute(e){const o=this.db,r=this.selector,s=this.options,a=new MongoDBNamespace(\"admin\",\"$cmd\");o.s.topology.command(a,r,s,(r,s)=>o.serverConfig&&o.serverConfig.isDestroyed()?e(new MongoError(\"topology was destroyed\")):r?handleCallback(e,r):void handleCallback(e,null,s.result))}}module.exports=ExecuteDbAdminCommandOperation;","node_modules/mongodb/lib/operations/index_information.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,indexInformation=require(\"./common_functions\").indexInformation;class IndexInformationOperation extends OperationBase{constructor(n,e,o){super(o),this.db=n,this.name=e}execute(n){const e=this.db,o=this.name,t=this.options;indexInformation(e,o,t,n)}}module.exports=IndexInformationOperation;","node_modules/mongodb/lib/operations/list_collections.js":"\"use strict\";const CommandOperationV2=require(\"./command_v2\"),Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,maxWireVersion=require(\"../core/utils\").maxWireVersion,CONSTANTS=require(\"../constants\"),LIST_COLLECTIONS_WIRE_VERSION=3;function listCollectionsTransforms(e){const t=`${e}.`;return{doc:e=>{const s=e.name.indexOf(t);return e.name&&0===s&&(e.name=e.name.substr(s+t.length)),e}}}class ListCollectionsOperation extends CommandOperationV2{constructor(e,t,s){super(e,s,{fullResponse:!0}),this.db=e,this.filter=t,this.nameOnly=!!this.options.nameOnly,\"number\"==typeof this.options.batchSize&&(this.batchSize=this.options.batchSize)}execute(e,t){if(maxWireVersion(e)<LIST_COLLECTIONS_WIRE_VERSION){let s=this.filter;const n=this.db.s.namespace.db;\"string\"!=typeof s.name||new RegExp(\"^\"+n+\"\\\\.\").test(s.name)||((s=Object.assign({},s)).name=this.db.s.namespace.withCollection(s.name).toString()),null==s&&(s.name=`/${n}/`),s=s.name?{$and:[{name:s.name},{name:/^((?!\\$).)*$/}]}:{name:/^((?!\\$).)*$/};const i=listCollectionsTransforms(n);return void e.query(`${n}.${CONSTANTS.SYSTEM_NAMESPACE_COLLECTION}`,{query:s},{batchSize:this.batchSize||1e3},{},(e,s)=>{s&&s.message&&s.message.documents&&Array.isArray(s.message.documents)&&(s.message.documents=s.message.documents.map(i.doc)),t(e,s)})}const s={listCollections:1,filter:this.filter,cursor:this.batchSize?{batchSize:this.batchSize}:{},nameOnly:this.nameOnly};return super.executeCommand(e,s,t)}}defineAspects(ListCollectionsOperation,[Aspect.READ_OPERATION,Aspect.RETRYABLE,Aspect.EXECUTE_WITH_SELECTION]),module.exports=ListCollectionsOperation;","node_modules/mongodb/lib/operations/profiling_level.js":"\"use strict\";const CommandOperation=require(\"./command\");class ProfilingLevelOperation extends CommandOperation{constructor(l,e,r){super(l,r)}_buildCommand(){return{profile:-1}}execute(l){super.execute((e,r)=>{if(null==e&&1===r.ok){const e=r.was;return 0===e?l(null,\"off\"):1===e?l(null,\"slow_only\"):2===e?l(null,\"all\"):l(new Error(\"Error: illegal profiling level value \"+e),null)}l(null!=e?e:new Error(\"Error with profile command\"),null)})}}module.exports=ProfilingLevelOperation;","node_modules/mongodb/lib/operations/remove_user.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,CommandOperation=require(\"./command\"),defineAspects=require(\"./operation\").defineAspects,handleCallback=require(\"../utils\").handleCallback,WriteConcern=require(\"../write_concern\");class RemoveUserOperation extends CommandOperation{constructor(e,r,n){const t={},a=WriteConcern.fromOptions(n);null!=a&&(t.writeConcern=a),n.dbName&&(t.dbName=n.dbName),\"number\"==typeof n.maxTimeMS&&(t.maxTimeMS=n.maxTimeMS),super(e,t),this.username=r}_buildCommand(){return{dropUser:this.username}}execute(e){super.execute((r,n)=>{if(r)return handleCallback(e,r,null);handleCallback(e,r,!!n.ok)})}}defineAspects(RemoveUserOperation,[Aspect.WRITE_OPERATION,Aspect.SKIP_SESSIONS]),module.exports=RemoveUserOperation;","node_modules/mongodb/lib/operations/rename.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,applyWriteConcern=require(\"../utils\").applyWriteConcern,checkCollectionName=require(\"../utils\").checkCollectionName,executeDbAdminCommand=require(\"./db_ops\").executeDbAdminCommand,handleCallback=require(\"../utils\").handleCallback,loadCollection=require(\"../dynamic_loaders\").loadCollection,toError=require(\"../utils\").toError;class RenameOperation extends OperationBase{constructor(e,o,t){super(t),this.collection=e,this.newName=o}execute(e){const o=this.collection,t=this.newName,l=this.options;let r=loadCollection();checkCollectionName(t);const n={renameCollection:o.namespace,to:o.s.namespace.withCollection(t).toString(),dropTarget:\"boolean\"==typeof l.dropTarget&&l.dropTarget};applyWriteConcern(n,{db:o.s.db,collection:o},l),executeDbAdminCommand(o.s.db.admin().s.db,n,l,(l,n)=>{if(l)return handleCallback(e,l,null);if(n.errmsg)return handleCallback(e,toError(n),null);try{return handleCallback(e,null,new r(o.s.db,o.s.topology,o.s.namespace.db,t,o.s.pkFactory,o.s.options))}catch(l){return handleCallback(e,toError(l),null)}})}}module.exports=RenameOperation;","node_modules/mongodb/lib/operations/set_profiling_level.js":"\"use strict\";const CommandOperation=require(\"./command\"),levelValues=new Set([\"off\",\"slow_only\",\"all\"]);class SetProfilingLevelOperation extends CommandOperation{constructor(e,l,r){let o=0;\"off\"===l?o=0:\"slow_only\"===l?o=1:\"all\"===l&&(o=2),super(e,r),this.level=l,this.profile=o}_buildCommand(){return{profile:this.profile}}execute(e){const l=this.level;if(!levelValues.has(l))return e(new Error(\"Error: illegal profiling level value \"+l));super.execute((r,o)=>null==r&&1===o.ok?e(null,l):e(null!=r?r:new Error(\"Error with profile command\"),null))}}module.exports=SetProfilingLevelOperation;","node_modules/mongodb/lib/bulk/unordered.js":"\"use strict\";const common=require(\"./common\"),BulkOperationBase=common.BulkOperationBase,Batch=common.Batch,bson=common.bson,utils=require(\"../utils\"),toError=utils.toError;function addToOperationsList(e,r,t){const n=bson.calculateObjectSize(t,{checkKeys:!1,ignoreUndefined:!1});if(n>=e.s.maxBatchSizeBytes)throw toError(\"document is larger than the maximum size \"+e.s.maxBatchSizeBytes);e.s.currentBatch=null,r===common.INSERT?e.s.currentBatch=e.s.currentInsertBatch:r===common.UPDATE?e.s.currentBatch=e.s.currentUpdateBatch:r===common.REMOVE&&(e.s.currentBatch=e.s.currentRemoveBatch);const s=e.s.maxKeySize;if(null==e.s.currentBatch&&(e.s.currentBatch=new Batch(r,e.s.currentIndex)),(e.s.currentBatch.size+1>=e.s.maxWriteBatchSize||e.s.currentBatch.sizeBytes+s+n>=e.s.maxBatchSizeBytes||e.s.currentBatch.batchType!==r)&&(e.s.batches.push(e.s.currentBatch),e.s.currentBatch=new Batch(r,e.s.currentIndex)),Array.isArray(t))throw toError(\"operation passed in cannot be an Array\");return e.s.currentBatch.operations.push(t),e.s.currentBatch.originalIndexes.push(e.s.currentIndex),e.s.currentIndex=e.s.currentIndex+1,r===common.INSERT?(e.s.currentInsertBatch=e.s.currentBatch,e.s.bulkResult.insertedIds.push({index:e.s.bulkResult.insertedIds.length,_id:t._id})):r===common.UPDATE?e.s.currentUpdateBatch=e.s.currentBatch:r===common.REMOVE&&(e.s.currentRemoveBatch=e.s.currentBatch),e.s.currentBatch.size+=1,e.s.currentBatch.sizeBytes+=s+n,e}class UnorderedBulkOperation extends BulkOperationBase{constructor(e,r,t){t=t||{},super(e,r,t=Object.assign(t,{addToOperationsList:addToOperationsList}),!1)}}function initializeUnorderedBulkOp(e,r,t){return new UnorderedBulkOperation(e,r,t)}initializeUnorderedBulkOp.UnorderedBulkOperation=UnorderedBulkOperation,module.exports=initializeUnorderedBulkOp,module.exports.Bulk=UnorderedBulkOperation;","node_modules/mongodb/lib/bulk/ordered.js":"\"use strict\";const common=require(\"./common\"),BulkOperationBase=common.BulkOperationBase,Batch=common.Batch,bson=common.bson,utils=require(\"../utils\"),toError=utils.toError;function addToOperationsList(e,r,t){const n=bson.calculateObjectSize(t,{checkKeys:!1,ignoreUndefined:!1});if(n>=e.s.maxBatchSizeBytes)throw toError(\"document is larger than the maximum size \"+e.s.maxBatchSizeBytes);null==e.s.currentBatch&&(e.s.currentBatch=new Batch(r,e.s.currentIndex));const s=e.s.maxKeySize;if((e.s.currentBatchSize+1>=e.s.maxWriteBatchSize||e.s.currentBatchSizeBytes+s+n>=e.s.maxBatchSizeBytes||e.s.currentBatch.batchType!==r)&&(e.s.batches.push(e.s.currentBatch),e.s.currentBatch=new Batch(r,e.s.currentIndex),e.s.currentBatchSize=0,e.s.currentBatchSizeBytes=0),r===common.INSERT&&e.s.bulkResult.insertedIds.push({index:e.s.currentIndex,_id:t._id}),Array.isArray(t))throw toError(\"operation passed in cannot be an Array\");return e.s.currentBatch.originalIndexes.push(e.s.currentIndex),e.s.currentBatch.operations.push(t),e.s.currentBatchSize+=1,e.s.currentBatchSizeBytes+=s+n,e.s.currentIndex+=1,e}class OrderedBulkOperation extends BulkOperationBase{constructor(e,r,t){t=t||{},super(e,r,t=Object.assign(t,{addToOperationsList:addToOperationsList}),!0)}}function initializeOrderedBulkOp(e,r,t){return new OrderedBulkOperation(e,r,t)}initializeOrderedBulkOp.OrderedBulkOperation=OrderedBulkOperation,module.exports=initializeOrderedBulkOp,module.exports.Bulk=OrderedBulkOperation;","node_modules/mongodb/lib/operations/bulk_write.js":"\"use strict\";const applyRetryableWrites=require(\"../utils\").applyRetryableWrites,applyWriteConcern=require(\"../utils\").applyWriteConcern,MongoError=require(\"../core\").MongoError,OperationBase=require(\"./operation\").OperationBase;class BulkWriteOperation extends OperationBase{constructor(e,t,n){super(n),this.collection=e,this.operations=t}execute(e){const t=this.collection,n=this.operations;let r=this.options;t.s.options.ignoreUndefined&&((r=Object.assign({},r)).ignoreUndefined=t.s.options.ignoreUndefined);const o=!0===r.ordered||null==r.ordered?t.initializeOrderedBulkOp(r):t.initializeUnorderedBulkOp(r);let i=!1;try{for(let e=0;e<n.length;e++){const t=Object.keys(n[e])[0];n[e][t].collation&&(i=!0),o.raw(n[e])}}catch(t){return e(t,null)}let s=Object.assign({},r);s=applyRetryableWrites(s,t.s.db);const d=(s=applyWriteConcern(s,{db:t.s.db,collection:t},r)).writeConcern?s.writeConcern:{},l=t.s.topology.capabilities();if(i&&l&&!l.commandsTakeCollation)return e(new MongoError(\"server/primary/mongos does not support collation\"));o.execute(d,s,(t,n)=>{if(!n&&t)return e(t,null);n.insertedCount=n.nInserted,n.matchedCount=n.nMatched,n.modifiedCount=n.nModified||0,n.deletedCount=n.nRemoved,n.upsertedCount=n.getUpsertedIds().length,n.upsertedIds={},n.insertedIds={},n.n=n.insertedCount;const r=n.getInsertedIds();for(let e=0;e<r.length;e++)n.insertedIds[r[e].index]=r[e]._id;const o=n.getUpsertedIds();for(let e=0;e<o.length;e++)n.upsertedIds[o[e].index]=o[e]._id;e(null,n)})}}module.exports=BulkWriteOperation;","node_modules/mongodb/lib/operations/count_documents.js":"\"use strict\";const AggregateOperation=require(\"./aggregate\");class CountDocumentsOperation extends AggregateOperation{constructor(t,e,r){const u=[{$match:e}];\"number\"==typeof r.skip&&u.push({$skip:r.skip}),\"number\"==typeof r.limit&&u.push({$limit:r.limit}),u.push({$group:{_id:1,n:{$sum:1}}}),super(t,u,r)}execute(t,e){super.execute(t,(t,r)=>{if(t)return void e(t,null);const u=r.result;if(null==u.cursor||null==u.cursor.firstBatch)return void e(null,0);const s=u.cursor.firstBatch;e(null,s.length?s[0].n:0)})}}module.exports=CountDocumentsOperation;","node_modules/mongodb/lib/operations/create_indexes.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,OperationBase=require(\"./operation\").OperationBase,executeCommand=require(\"./db_ops\").executeCommand,MongoError=require(\"../core\").MongoError,ReadPreference=require(\"../core\").ReadPreference;class CreateIndexesOperation extends OperationBase{constructor(e,o,r){super(r),this.collection=e,this.indexSpecs=o}execute(e){const o=this.collection,r=this.indexSpecs;let t=this.options;const n=o.s.topology.capabilities();for(let o=0;o<r.length;o++)if(null==r[o].name){const t=[];if(r[o].collation&&n&&!n.commandsTakeCollation)return e(new MongoError(\"server/primary/mongos does not support collation\"));for(let e in r[o].key)t.push(`${e}_${r[o].key[e]}`);r[o].name=t.join(\"_\")}t=Object.assign({},t,{readPreference:ReadPreference.PRIMARY}),executeCommand(o.s.db,{createIndexes:o.collectionName,indexes:r},t,e)}}defineAspects(CreateIndexesOperation,Aspect.WRITE_OPERATION),module.exports=CreateIndexesOperation;","node_modules/mongodb/lib/operations/delete_many.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,deleteCallback=require(\"./common_functions\").deleteCallback,removeDocuments=require(\"./common_functions\").removeDocuments;class DeleteManyOperation extends OperationBase{constructor(e,t,o){super(o),this.collection=e,this.filter=t}execute(e){const t=this.collection,o=this.filter,n=this.options;n.single=!1,removeDocuments(t,o,n,(t,o)=>deleteCallback(t,o,e))}}module.exports=DeleteManyOperation;","node_modules/mongodb/lib/operations/delete_one.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,deleteCallback=require(\"./common_functions\").deleteCallback,removeDocuments=require(\"./common_functions\").removeDocuments;class DeleteOneOperation extends OperationBase{constructor(e,t,o){super(o),this.collection=e,this.filter=t}execute(e){const t=this.collection,o=this.filter,n=this.options;n.single=!0,removeDocuments(t,o,n,(t,o)=>deleteCallback(t,o,e))}}module.exports=DeleteOneOperation;","node_modules/mongodb/lib/operations/distinct.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,CommandOperationV2=require(\"./command_v2\"),decorateWithCollation=require(\"../utils\").decorateWithCollation,decorateWithReadConcern=require(\"../utils\").decorateWithReadConcern;class DistinctOperation extends CommandOperationV2{constructor(e,t,i,o){super(e,o),this.collection=e,this.key=t,this.query=i}execute(e,t){const i=this.collection,o=this.key,n=this.query,r=this.options,s={distinct:i.collectionName,key:o,query:n};\"number\"==typeof r.maxTimeMS&&(s.maxTimeMS=r.maxTimeMS),decorateWithReadConcern(s,i,r);try{decorateWithCollation(s,i,r)}catch(e){return t(e,null)}super.executeCommand(e,s,(e,i)=>{e?t(e):t(null,this.options.full?i:i.values)})}}defineAspects(DistinctOperation,[Aspect.READ_OPERATION,Aspect.RETRYABLE,Aspect.EXECUTE_WITH_SELECTION]),module.exports=DistinctOperation;","node_modules/mongodb/lib/operations/drop_index.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,CommandOperation=require(\"./command\"),applyWriteConcern=require(\"../utils\").applyWriteConcern,handleCallback=require(\"../utils\").handleCallback;class DropIndexOperation extends CommandOperation{constructor(e,n,t){super(e.s.db,t,e),this.collection=e,this.indexName=n}_buildCommand(){const e=this.collection,n=this.indexName,t=this.options;let o={dropIndexes:e.collectionName,index:n};return o=applyWriteConcern(o,{db:e.s.db,collection:e},t)}execute(e){super.execute((n,t)=>{if(\"function\"==typeof e)return n?handleCallback(e,n,null):void handleCallback(e,null,t)})}}defineAspects(DropIndexOperation,Aspect.WRITE_OPERATION),module.exports=DropIndexOperation;","node_modules/mongodb/lib/operations/drop_indexes.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,DropIndexOperation=require(\"./drop_index\"),handleCallback=require(\"../utils\").handleCallback;class DropIndexesOperation extends DropIndexOperation{constructor(e,r){super(e,\"*\",r)}execute(e){super.execute(r=>{if(r)return handleCallback(e,r,!1);handleCallback(e,null,!0)})}}defineAspects(DropIndexesOperation,Aspect.WRITE_OPERATION),module.exports=DropIndexesOperation;","node_modules/mongodb/lib/operations/estimated_document_count.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,CommandOperationV2=require(\"./command_v2\");class EstimatedDocumentCountOperation extends CommandOperationV2{constructor(e,t,i){void 0===i&&(i=t,t=void 0),super(e,i),this.collectionName=e.s.namespace.collection,t&&(this.query=t)}execute(e,t){const i=this.options,o={count:this.collectionName};this.query&&(o.query=this.query),\"number\"==typeof i.skip&&(o.skip=i.skip),\"number\"==typeof i.limit&&(o.limit=i.limit),i.hint&&(o.hint=i.hint),super.executeCommand(e,o,(e,i)=>{e?t(e):t(null,i.n)})}}defineAspects(EstimatedDocumentCountOperation,[Aspect.READ_OPERATION,Aspect.RETRYABLE,Aspect.EXECUTE_WITH_SELECTION]),module.exports=EstimatedDocumentCountOperation;","node_modules/mongodb/lib/operations/find.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,resolveReadPreference=require(\"../utils\").resolveReadPreference;class FindOperation extends OperationBase{constructor(e,s,t,r){super(r),this.ns=s,this.cmd=t,this.readPreference=resolveReadPreference(e,this.options)}execute(e,s){this.server=e;const t=this.cursorState||{};e.query(this.ns.toString(),this.cmd,t,this.options,s)}}defineAspects(FindOperation,[Aspect.READ_OPERATION,Aspect.RETRYABLE,Aspect.EXECUTE_WITH_SELECTION,Aspect.SKIP_SESSION]),module.exports=FindOperation;","node_modules/mongodb/lib/operations/find_one.js":"\"use strict\";const handleCallback=require(\"../utils\").handleCallback,OperationBase=require(\"./operation\").OperationBase,toError=require(\"../utils\").toError;class FindOneOperation extends OperationBase{constructor(e,t,r){super(r),this.collection=e,this.query=t}execute(e){const t=this.collection,r=this.query,i=this.options;t.find(r,i).limit(-1).batchSize(1).next((t,r)=>{if(null!=t)return handleCallback(e,toError(t),null);handleCallback(e,null,r)})}}module.exports=FindOneOperation;","node_modules/mongodb/lib/operations/find_and_modify.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,applyRetryableWrites=require(\"../utils\").applyRetryableWrites,applyWriteConcern=require(\"../utils\").applyWriteConcern,decorateWithCollation=require(\"../utils\").decorateWithCollation,executeCommand=require(\"./db_ops\").executeCommand,formattedOrderClause=require(\"../utils\").formattedOrderClause,handleCallback=require(\"../utils\").handleCallback,ReadPreference=require(\"../core\").ReadPreference;class FindAndModifyOperation extends OperationBase{constructor(e,r,t,i,a){super(a),this.collection=e,this.query=r,this.sort=t,this.doc=i}execute(e){const r=this.collection,t=this.query,i=formattedOrderClause(this.sort),a=this.doc;let o=this.options;const n={findAndModify:r.collectionName,query:t};i&&(n.sort=i),n.new=!!o.new,n.remove=!!o.remove,n.upsert=!!o.upsert;const s=o.projection||o.fields;s&&(n.fields=s),o.arrayFilters&&(n.arrayFilters=o.arrayFilters),a&&!o.remove&&(n.update=a),o.maxTimeMS&&(n.maxTimeMS=o.maxTimeMS),o.serializeFunctions=o.serializeFunctions||r.s.serializeFunctions,o.checkKeys=!1,o=applyRetryableWrites(o,r.s.db),(o=applyWriteConcern(o,{db:r.s.db,collection:r},o)).writeConcern&&(n.writeConcern=o.writeConcern),!0===o.bypassDocumentValidation&&(n.bypassDocumentValidation=o.bypassDocumentValidation),o.readPreference=ReadPreference.primary;try{decorateWithCollation(n,r,o)}catch(r){return e(r,null)}executeCommand(r.s.db,n,o,(r,t)=>r?handleCallback(e,r,null):handleCallback(e,null,t))}}module.exports=FindAndModifyOperation;","node_modules/mongodb/lib/operations/find_one_and_delete.js":"\"use strict\";const FindAndModifyOperation=require(\"./find_and_modify\");class FindOneAndDeleteOperation extends FindAndModifyOperation{constructor(e,n,i){const o=Object.assign({},i);o.fields=i.projection,o.remove=!0,super(e,n,o.sort,null,o)}}module.exports=FindOneAndDeleteOperation;","node_modules/mongodb/lib/operations/find_one_and_replace.js":"\"use strict\";const FindAndModifyOperation=require(\"./find_and_modify\");class FindOneAndReplaceOperation extends FindAndModifyOperation{constructor(e,n,i,r){const t=Object.assign({},r);t.fields=r.projection,t.update=!0,t.new=void 0!==r.returnOriginal&&!r.returnOriginal,t.upsert=void 0!==r.upsert&&!!r.upsert,super(e,n,t.sort,i,t)}}module.exports=FindOneAndReplaceOperation;","node_modules/mongodb/lib/operations/find_one_and_update.js":"\"use strict\";const FindAndModifyOperation=require(\"./find_and_modify\");class FindOneAndUpdateOperation extends FindAndModifyOperation{constructor(e,n,t,o){const r=Object.assign({},o);r.fields=o.projection,r.update=!0,r.new=\"boolean\"==typeof o.returnOriginal&&!o.returnOriginal,r.upsert=\"boolean\"==typeof o.upsert&&o.upsert,super(e,n,r.sort,t,r)}}module.exports=FindOneAndUpdateOperation;","node_modules/mongodb/lib/operations/geo_haystack_search.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,OperationBase=require(\"./operation\").OperationBase,decorateCommand=require(\"../utils\").decorateCommand,decorateWithReadConcern=require(\"../utils\").decorateWithReadConcern,executeCommand=require(\"./db_ops\").executeCommand,handleCallback=require(\"../utils\").handleCallback,resolveReadPreference=require(\"../utils\").resolveReadPreference,toError=require(\"../utils\").toError;class GeoHaystackSearchOperation extends OperationBase{constructor(e,r,a,t){super(t),this.collection=e,this.x=r,this.y=a}execute(e){const r=this.collection,a=this.x,t=this.y;let o=this.options,c={geoSearch:r.collectionName,near:[a,t]};c=decorateCommand(c,o,[\"readPreference\",\"session\"]),(o=Object.assign({},o)).readPreference=resolveReadPreference(r,o),decorateWithReadConcern(c,r,o),executeCommand(r.s.db,c,o,(r,a)=>{if(r)return handleCallback(e,r);(a.err||a.errmsg)&&handleCallback(e,toError(a)),handleCallback(e,null,a)})}}defineAspects(GeoHaystackSearchOperation,Aspect.READ_OPERATION),module.exports=GeoHaystackSearchOperation;","node_modules/mongodb/lib/operations/indexes.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,indexInformation=require(\"./common_functions\").indexInformation;class IndexesOperation extends OperationBase{constructor(e,o){super(o),this.collection=e}execute(e){const o=this.collection;let n=this.options;n=Object.assign({},{full:!0},n),indexInformation(o.s.db,o.collectionName,n,e)}}module.exports=IndexesOperation;","node_modules/mongodb/lib/operations/index_exists.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,handleCallback=require(\"../utils\").handleCallback,indexInformationDb=require(\"./db_ops\").indexInformation;class IndexExistsOperation extends OperationBase{constructor(e,n,l){super(l),this.collection=e,this.indexes=n}execute(e){const n=this.collection,l=this.indexes,t=this.options;indexInformationDb(n.s.db,n.collectionName,t,(n,t)=>{if(null!=n)return handleCallback(e,n,null);if(!Array.isArray(l))return handleCallback(e,null,null!=t[l]);for(let n=0;n<l.length;n++)if(null==t[l[n]])return handleCallback(e,null,!1);return handleCallback(e,null,!0)})}}module.exports=IndexExistsOperation;","node_modules/mongodb/lib/operations/insert_many.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,BulkWriteOperation=require(\"./bulk_write\"),MongoError=require(\"../core\").MongoError,prepareDocs=require(\"./common_functions\").prepareDocs;class InsertManyOperation extends OperationBase{constructor(e,r,t){super(t),this.collection=e,this.docs=r}execute(e){const r=this.collection;let t=this.docs;const s=this.options;if(!Array.isArray(t))return e(MongoError.create({message:\"docs parameter must be an array of documents\",driver:!0}));s.serializeFunctions=s.serializeFunctions||r.s.serializeFunctions,t=prepareDocs(r,t,s),new BulkWriteOperation(r,[{insertMany:t}],s).execute((r,s)=>{if(r)return e(r,null);e(null,mapInsertManyResults(t,s))})}}function mapInsertManyResults(e,r){const t={result:{ok:1,n:r.insertedCount},ops:e,insertedCount:r.insertedCount,insertedIds:r.insertedIds};return r.getLastOp()&&(t.result.opTime=r.getLastOp()),t}module.exports=InsertManyOperation;","node_modules/mongodb/lib/operations/insert_one.js":"\"use strict\";const MongoError=require(\"../core\").MongoError,OperationBase=require(\"./operation\").OperationBase,insertDocuments=require(\"./common_functions\").insertDocuments;class InsertOneOperation extends OperationBase{constructor(e,r,t){super(t),this.collection=e,this.doc=r}execute(e){const r=this.collection,t=this.doc,n=this.options;if(Array.isArray(t))return e(MongoError.create({message:\"doc parameter must be an object\",driver:!0}));insertDocuments(r,[t],n,(r,n)=>{if(null!=e){if(r&&e)return e(r);if(null==n)return e(null,{result:{ok:1}});n.insertedCount=n.result.n,n.insertedId=t._id,e&&e(null,n)}})}}module.exports=InsertOneOperation;","node_modules/mongodb/lib/operations/is_capped.js":"\"use strict\";const OptionsOperation=require(\"./options_operation\"),handleCallback=require(\"../utils\").handleCallback;class IsCappedOperation extends OptionsOperation{constructor(e,a){super(e,a)}execute(e){super.execute((a,t)=>{if(a)return handleCallback(e,a);handleCallback(e,null,!(!t||!t.capped))})}}module.exports=IsCappedOperation;","node_modules/mongodb/lib/operations/list_indexes.js":"\"use strict\";const CommandOperationV2=require(\"./command_v2\"),Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,maxWireVersion=require(\"../core/utils\").maxWireVersion,LIST_INDEXES_WIRE_VERSION=3;class ListIndexesOperation extends CommandOperationV2{constructor(e,s){super(e,s,{fullResponse:!0}),this.collectionNamespace=e.s.namespace}execute(e,s){if(maxWireVersion(e)<LIST_INDEXES_WIRE_VERSION){const t=this.collectionNamespace.withCollection(\"system.indexes\").toString(),i=this.collectionNamespace.toString();return void e.query(t,{query:{ns:i}},{},this.options,s)}const t=this.options.batchSize?{batchSize:this.options.batchSize}:{};super.executeCommand(e,{listIndexes:this.collectionNamespace.collection,cursor:t},s)}}defineAspects(ListIndexesOperation,[Aspect.READ_OPERATION,Aspect.RETRYABLE,Aspect.EXECUTE_WITH_SELECTION]),module.exports=ListIndexesOperation;","node_modules/mongodb/lib/operations/map_reduce.js":"\"use strict\";const applyWriteConcern=require(\"../utils\").applyWriteConcern,Code=require(\"../core\").BSON.Code,decorateWithCollation=require(\"../utils\").decorateWithCollation,decorateWithReadConcern=require(\"../utils\").decorateWithReadConcern,executeCommand=require(\"./db_ops\").executeCommand,handleCallback=require(\"../utils\").handleCallback,isObject=require(\"../utils\").isObject,loadDb=require(\"../dynamic_loaders\").loadDb,OperationBase=require(\"./operation\").OperationBase,resolveReadPreference=require(\"../utils\").resolveReadPreference,toError=require(\"../utils\").toError,exclusionList=[\"readPreference\",\"session\",\"bypassDocumentValidation\",\"w\",\"wtimeout\",\"j\",\"writeConcern\"];class MapReduceOperation extends OperationBase{constructor(e,t,r,o){super(o),this.collection=e,this.map=t,this.reduce=r}execute(e){const t=this.collection,r=this.map,o=this.reduce;let n=this.options;const l={mapreduce:t.collectionName,map:r,reduce:o};for(let e in n)\"scope\"===e?l[e]=processScope(n[e]):-1===exclusionList.indexOf(e)&&(l[e]=n[e]);(n=Object.assign({},n)).readPreference=resolveReadPreference(t,n),!1!==n.readPreference&&\"primary\"!==n.readPreference&&n.out&&1!==n.out.inline&&\"inline\"!==n.out?(n.readPreference=\"primary\",applyWriteConcern(l,{db:t.s.db,collection:t},n)):decorateWithReadConcern(l,t,n),!0===n.bypassDocumentValidation&&(l.bypassDocumentValidation=n.bypassDocumentValidation);try{decorateWithCollation(l,t,n)}catch(t){return e(t,null)}executeCommand(t.s.db,l,n,(r,o)=>{if(r)return handleCallback(e,r);if(1!==o.ok||o.err||o.errmsg)return handleCallback(e,toError(o));const l={};if(o.timeMillis&&(l.processtime=o.timeMillis),o.counts&&(l.counts=o.counts),o.timing&&(l.timing=o.timing),o.results)return null!=n.verbose&&n.verbose?handleCallback(e,null,{results:o.results,stats:l}):handleCallback(e,null,o.results);let i=null;if(null!=o.result&&\"object\"==typeof o.result){const e=o.result;i=new(loadDb())(e.db,t.s.db.s.topology,t.s.db.s.options).collection(e.collection)}else i=t.s.db.collection(o.result);if(null==n.verbose||!n.verbose)return handleCallback(e,r,i);handleCallback(e,r,{collection:i,stats:l})})}}function processScope(e){if(!isObject(e)||\"ObjectID\"===e._bsontype)return e;const t=Object.keys(e);let r;const o={};for(let n=t.length-1;n>=0;n--)\"function\"==typeof e[r=t[n]]?o[r]=new Code(String(e[r])):o[r]=processScope(e[r]);return o}module.exports=MapReduceOperation;","node_modules/mongodb/lib/operations/options_operation.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,handleCallback=require(\"../utils\").handleCallback,MongoError=require(\"../core\").MongoError;class OptionsOperation extends OperationBase{constructor(e,o){super(o),this.collection=e}execute(e){const o=this.collection,n=this.options;o.s.db.listCollections({name:o.collectionName},n).toArray((n,t)=>n?handleCallback(e,n):0===t.length?handleCallback(e,MongoError.create({message:`collection ${o.namespace} not found`,driver:!0})):void handleCallback(e,n,t[0].options||null))}}module.exports=OptionsOperation;","node_modules/mongodb/lib/operations/re_index.js":"\"use strict\";const CommandOperation=require(\"./command\"),handleCallback=require(\"../utils\").handleCallback;class ReIndexOperation extends CommandOperation{constructor(e,l){super(e.s.db,l,e)}_buildCommand(){return{reIndex:this.collection.collectionName}}execute(e){super.execute((l,n)=>{if(null!=e)return l?handleCallback(e,l,null):void handleCallback(e,null,!!n.ok)})}}module.exports=ReIndexOperation;","node_modules/mongodb/lib/operations/replace_one.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,updateDocuments=require(\"./common_functions\").updateDocuments;class ReplaceOneOperation extends OperationBase{constructor(e,t,r,s){super(s),this.collection=e,this.filter=t,this.doc=r}execute(e){const t=this.collection,r=this.filter,s=this.doc,u=this.options;u.multi=!1,updateDocuments(t,r,s,u,(t,r)=>replaceCallback(t,r,s,e))}}function replaceCallback(e,t,r,s){if(null!=s){if(e&&s)return s(e);if(null==t)return s(null,{result:{ok:1}});t.modifiedCount=null!=t.result.nModified?t.result.nModified:t.result.n,t.upsertedId=Array.isArray(t.result.upserted)&&t.result.upserted.length>0?t.result.upserted[0]:null,t.upsertedCount=Array.isArray(t.result.upserted)&&t.result.upserted.length?t.result.upserted.length:0,t.matchedCount=Array.isArray(t.result.upserted)&&t.result.upserted.length>0?0:t.result.n,t.ops=[r],s&&s(null,t)}}module.exports=ReplaceOneOperation;","node_modules/mongodb/lib/operations/stats.js":"\"use strict\";const Aspect=require(\"./operation\").Aspect,CommandOperation=require(\"./command\"),defineAspects=require(\"./operation\").defineAspects;class StatsOperation extends CommandOperation{constructor(e,t){super(e.s.db,t,e)}_buildCommand(){const e=this.collection,t=this.options,s={collStats:e.collectionName};return null!=t.scale&&(s.scale=t.scale),s}}defineAspects(StatsOperation,Aspect.READ_OPERATION),module.exports=StatsOperation;","node_modules/mongodb/lib/operations/update_many.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,updateCallback=require(\"./common_functions\").updateCallback,updateDocuments=require(\"./common_functions\").updateDocuments;class UpdateManyOperation extends OperationBase{constructor(t,e,a,o){super(o),this.collection=t,this.filter=e,this.update=a}execute(t){const e=this.collection,a=this.filter,o=this.update,s=this.options;s.multi=!0,updateDocuments(e,a,o,s,(e,a)=>updateCallback(e,a,t))}}module.exports=UpdateManyOperation;","node_modules/mongodb/lib/operations/update_one.js":"\"use strict\";const OperationBase=require(\"./operation\").OperationBase,updateDocuments=require(\"./common_functions\").updateDocuments;class UpdateOneOperation extends OperationBase{constructor(e,t,r,u){super(u),this.collection=e,this.filter=t,this.update=r}execute(e){const t=this.collection,r=this.filter,u=this.update,s=this.options;s.multi=!1,updateDocuments(t,r,u,s,(t,r)=>updateCallback(t,r,e))}}function updateCallback(e,t,r){if(null!=r){if(e)return r(e);if(null==t)return r(null,{result:{ok:1}});t.modifiedCount=null!=t.result.nModified?t.result.nModified:t.result.n,t.upsertedId=Array.isArray(t.result.upserted)&&t.result.upserted.length>0?t.result.upserted[0]:null,t.upsertedCount=Array.isArray(t.result.upserted)&&t.result.upserted.length?t.result.upserted.length:0,t.matchedCount=Array.isArray(t.result.upserted)&&t.result.upserted.length>0?0:t.result.n,r(null,t)}}module.exports=UpdateOneOperation;","node_modules/mongodb/lib/topologies/native_topology.js":"\"use strict\";const Topology=require(\"../core\").Topology,ServerCapabilities=require(\"./topology_base\").ServerCapabilities,Cursor=require(\"../cursor\"),translateOptions=require(\"../utils\").translateOptions;class NativeTopology extends Topology{constructor(e,t){t=t||{};let o=Object.assign({},{cursorFactory:Cursor,reconnect:!1,emitError:\"boolean\"!=typeof t.emitError||t.emitError,size:\"number\"==typeof t.poolSize?t.poolSize:5,monitorCommands:\"boolean\"==typeof t.monitorCommands&&t.monitorCommands});o=translateOptions(o,t);var s=t.socketOptions&&Object.keys(t.socketOptions).length>0?t.socketOptions:t;super(e,o=translateOptions(o,s)),t.appname&&(this.s.clientInfo.application={name:t.appname})}capabilities(){return this.s.sCapabilities?this.s.sCapabilities:null==this.lastIsMaster()?null:(this.s.sCapabilities=new ServerCapabilities(this.lastIsMaster()),this.s.sCapabilities)}command(e,t,o,s){super.command(e.toString(),t,o,s)}insert(e,t,o,s){super.insert(e.toString(),t,o,s)}update(e,t,o,s){super.update(e.toString(),t,o,s)}remove(e,t,o,s){super.remove(e.toString(),t,o,s)}}module.exports=NativeTopology;","node_modules/mongodb/lib/url_parser.js":"\"use strict\";const ReadPreference=require(\"./core\").ReadPreference,parser=require(\"url\"),f=require(\"util\").format,Logger=require(\"./core\").Logger,dns=require(\"dns\"),ReadConcern=require(\"./read_concern\");function matchesParentDomain(e,r){let t=/^.*?\\./,n=`.${e.replace(t,\"\")}`,s=`.${r.replace(t,\"\")}`;return!!n.endsWith(s)}function parseHandler(e,r,t){let n,s;try{n=parseConnectionString(e,r)}catch(e){s=e}return s?t(s,null):t(null,n)}function parseConnectionString(e,r){let t=\"\",n=\"\",s=\"\",o=\"admin\",a=parser.parse(e,!0);if((null==a.hostname||\"\"===a.hostname)&&-1===e.indexOf(\".sock\"))throw new Error(\"No hostname or hostnames provided in connection string\");if(\"0\"===a.port)throw new Error(\"Invalid port (zero) with hostname\");if(!isNaN(parseInt(a.port,10))&&parseInt(a.port,10)>65535)throw new Error(\"Invalid port (larger than 65535) with hostname\");if(a.path&&a.path.length>0&&\"/\"!==a.path[0]&&-1===e.indexOf(\".sock\"))throw new Error(\"Missing delimiting slash between hosts and options\");if(a.query)for(let e in a.query){if(-1!==e.indexOf(\"::\"))throw new Error(\"Double colon in host identifier\");if(\"\"===a.query[e])throw new Error(\"Query parameter \"+e+\" is an incomplete value pair\")}if(a.auth){let r=a.auth.split(\":\");if(-1!==e.indexOf(a.auth)&&r.length>2)throw new Error(\"Username with password containing an unescaped colon\");if(-1!==e.indexOf(a.auth)&&-1!==a.auth.indexOf(\"@\"))throw new Error(\"Username containing an unescaped at-sign\")}let i=e.split(\"?\").shift().split(\",\"),c=[];for(let e=0;e<i.length;e++){let r=i[e];-1!==r.indexOf(\"mongodb\")?-1!==r.indexOf(\"@\")?c.push(r.split(\"@\").pop()):c.push(r.substr(\"mongodb://\".length)):-1!==r.indexOf(\"/\")?c.push(r.split(\"/\").shift()):-1===r.indexOf(\"/\")&&c.push(r.trim())}for(let e=0;e<c.length;e++){let r=parser.parse(f(\"mongodb://%s\",c[e].trim()));if((!r.path||-1===r.path.indexOf(\".sock\"))&&(r.path&&-1!==r.path.indexOf(\":\")))throw r.path.split(\"/\").length>1&&-1===r.path.indexOf(\"::\")?new Error(\"Slash in host identifier\"):new Error(\"Double colon in host identifier\")}if(-1!==e.indexOf(\"?\")?(s=e.substr(e.indexOf(\"?\")+1),t=e.substring(\"mongodb://\".length,e.indexOf(\"?\"))):t=e.substring(\"mongodb://\".length),-1!==t.indexOf(\"@\")&&(n=t.split(\"@\")[0],t=t.split(\"@\")[1]),t.split(\"/\").length>2)throw new Error(\"Unsupported host '\"+t.split(\"?\")[0]+\"', hosts must be URL encoded and contain at most one unencoded slash\");if(-1!==t.indexOf(\".sock\")){if(-1!==t.indexOf(\".sock/\")){if(-1!==(o=t.split(\".sock/\")[1]).indexOf(\"/\")){if(2===o.split(\"/\").length&&0===o.split(\"/\")[1].length)throw new Error(\"Illegal trailing backslash after database name\");throw new Error(\"More than 1 database name in URL\")}t=t.split(\"/\",t.indexOf(\".sock\")+\".sock\".length)}}else if(-1!==t.indexOf(\"/\")){if(t.split(\"/\").length>2){if(0===t.split(\"/\")[2].length)throw new Error(\"Illegal trailing backslash after database name\");throw new Error(\"More than 1 database name in URL\")}o=t.split(\"/\")[1],t=t.split(\"/\")[0]}t=decodeURIComponent(t);let l,p,d,h,u={},m=n||\"\",g=m.split(\":\",2),w=decodeURIComponent(g[0]);if(g[0]!==encodeURIComponent(w))throw new Error(\"Username contains an illegal unescaped character\");if(g[0]=w,g[1]){let e=decodeURIComponent(g[1]);if(g[1]!==encodeURIComponent(e))throw new Error(\"Password contains an illegal unescaped character\");g[1]=e}2===g.length&&(u.auth={user:g[0],password:g[1]}),r&&null!=r.auth&&(u.auth=r.auth);let b={socketOptions:{}},k={read_preference_tags:[]},O={socketOptions:{}},S={socketOptions:{}};if(u.server_options=b,u.db_options=k,u.rs_options=O,u.mongos_options=S,e.match(/\\.sock/)){let r=e.substring(e.indexOf(\"mongodb://\")+\"mongodb://\".length,e.lastIndexOf(\".sock\")+\".sock\".length);-1!==r.indexOf(\"@\")&&(r=r.split(\"@\")[1]),d=[{domain_socket:r=decodeURIComponent(r)}]}else{let e={};d=(l=t).split(\",\").map(function(r){let t,n,s;if(s=/\\[([^\\]]+)\\](?::(.+))?/.exec(r))t=s[1],n=parseInt(s[2],10)||27017;else{let e=r.split(\":\",2);t=e[0]||\"localhost\",n=null!=e[1]?parseInt(e[1],10):27017,-1!==t.indexOf(\"?\")&&(t=t.split(/\\?/)[0])}return e[t+\"_\"+n]?null:(e[t+\"_\"+n]=1,{host:t,port:n})}).filter(function(e){return null!=e})}if(u.dbName=o||\"admin\",(p=(s||\"\").split(/[&;]/)).forEach(function(e){if(e){var r=e.split(\"=\"),t=r[0],n=r[1];switch(t){case\"slaveOk\":case\"slave_ok\":b.slave_ok=\"true\"===n,k.slaveOk=\"true\"===n;break;case\"maxPoolSize\":case\"poolSize\":b.poolSize=parseInt(n,10),O.poolSize=parseInt(n,10);break;case\"appname\":u.appname=decodeURIComponent(n);break;case\"autoReconnect\":case\"auto_reconnect\":b.auto_reconnect=\"true\"===n;break;case\"ssl\":if(\"prefer\"===n){b.ssl=n,O.ssl=n,S.ssl=n;break}b.ssl=\"true\"===n,O.ssl=\"true\"===n,S.ssl=\"true\"===n;break;case\"sslValidate\":b.sslValidate=\"true\"===n,O.sslValidate=\"true\"===n,S.sslValidate=\"true\"===n;break;case\"replicaSet\":case\"rs_name\":O.rs_name=n;break;case\"reconnectWait\":O.reconnectWait=parseInt(n,10);break;case\"retries\":O.retries=parseInt(n,10);break;case\"readSecondary\":case\"read_secondary\":O.read_secondary=\"true\"===n;break;case\"fsync\":k.fsync=\"true\"===n;break;case\"journal\":k.j=\"true\"===n;break;case\"safe\":k.safe=\"true\"===n;break;case\"nativeParser\":case\"native_parser\":k.native_parser=\"true\"===n;break;case\"readConcernLevel\":k.readConcern=new ReadConcern(n);break;case\"connectTimeoutMS\":b.socketOptions.connectTimeoutMS=parseInt(n,10),O.socketOptions.connectTimeoutMS=parseInt(n,10),S.socketOptions.connectTimeoutMS=parseInt(n,10);break;case\"socketTimeoutMS\":b.socketOptions.socketTimeoutMS=parseInt(n,10),O.socketOptions.socketTimeoutMS=parseInt(n,10),S.socketOptions.socketTimeoutMS=parseInt(n,10);break;case\"w\":k.w=parseInt(n,10),isNaN(k.w)&&(k.w=n);break;case\"authSource\":k.authSource=n;break;case\"gssapiServiceName\":k.gssapiServiceName=n;break;case\"authMechanism\":if(\"GSSAPI\"===n)if(null==u.auth){let e=decodeURIComponent(m);if(-1===e.indexOf(\"@\"))throw new Error(\"GSSAPI requires a provided principal\");u.auth={user:e,password:null}}else u.auth.user=decodeURIComponent(u.auth.user);else\"MONGODB-X509\"===n&&(u.auth={user:decodeURIComponent(m)});if(\"GSSAPI\"!==n&&\"MONGODB-X509\"!==n&&\"MONGODB-CR\"!==n&&\"DEFAULT\"!==n&&\"SCRAM-SHA-1\"!==n&&\"SCRAM-SHA-256\"!==n&&\"PLAIN\"!==n)throw new Error(\"Only DEFAULT, GSSAPI, PLAIN, MONGODB-X509, or SCRAM-SHA-1 is supported by authMechanism\");k.authMechanism=n;break;case\"authMechanismProperties\":{let e={};n.split(\",\").forEach(function(r){let t=r.split(\":\");e[t[0]]=t[1]}),k.authMechanismProperties=e,\"string\"==typeof e.SERVICE_NAME&&(k.gssapiServiceName=e.SERVICE_NAME),\"string\"==typeof e.SERVICE_REALM&&(k.gssapiServiceRealm=e.SERVICE_REALM),\"string\"==typeof e.CANONICALIZE_HOST_NAME&&(k.gssapiCanonicalizeHostName=\"true\"===e.CANONICALIZE_HOST_NAME)}break;case\"wtimeoutMS\":k.wtimeout=parseInt(n,10);break;case\"readPreference\":if(!ReadPreference.isValid(n))throw new Error(\"readPreference must be either primary/primaryPreferred/secondary/secondaryPreferred/nearest\");k.readPreference=n;break;case\"maxStalenessSeconds\":k.maxStalenessSeconds=parseInt(n,10);break;case\"readPreferenceTags\":{let e={};if(null==(n=decodeURIComponent(n))||\"\"===n){k.read_preference_tags.push(e);break}let r=n.split(/,/);for(let t=0;t<r.length;t++){let n=r[t].trim().split(/:/);e[n[0]]=n[1]}k.read_preference_tags.push(e)}break;case\"compressors\":{h=b.compression||{};let e=n.split(\",\");if(!e.every(function(e){return\"snappy\"===e||\"zlib\"===e}))throw new Error(\"Compressors must be at least one of snappy or zlib\");h.compressors=e,b.compression=h}break;case\"zlibCompressionLevel\":{h=b.compression||{};let e=parseInt(n,10);if(e<-1||e>9)throw new Error(\"zlibCompressionLevel must be an integer between -1 and 9\");h.zlibCompressionLevel=e,b.compression=h}break;case\"retryWrites\":k.retryWrites=\"true\"===n;break;case\"minSize\":k.minSize=parseInt(n,10);break;default:Logger(\"URL Parser\").warn(`${t} is not supported as a connection string option`)}}}),0===k.read_preference_tags.length&&(k.read_preference_tags=null),!(-1!==k.w&&0!==k.w||!0!==k.journal&&!0!==k.fsync&&!0!==k.safe))throw new Error(\"w set to -1 or 0 cannot be combined with safe/w/journal/fsync\");return k.readPreference||(k.readPreference=\"primary\"),k=Object.assign(k,r),u.servers=d,u}module.exports=function(e,r,t){let n;\"function\"==typeof r&&(t=r,r={}),r=r||{};try{n=parser.parse(e,!0)}catch(e){return t(new Error(\"URL malformed, cannot be parsed\"))}if(\"mongodb:\"!==n.protocol&&\"mongodb+srv:\"!==n.protocol)return t(new Error(\"Invalid schema, expected `mongodb` or `mongodb+srv`\"));if(\"mongodb:\"===n.protocol)return parseHandler(e,r,t);if(n.hostname.split(\".\").length<3)return t(new Error(\"URI does not have hostname, domain name and tld\"));if(n.domainLength=n.hostname.split(\".\").length,n.pathname&&n.pathname.match(\",\"))return t(new Error(\"Invalid URI, cannot contain multiple hostnames\"));if(n.port)return t(new Error(\"Ports not accepted with `mongodb+srv` URIs\"));let s=`_mongodb._tcp.${n.host}`;dns.resolveSrv(s,function(e,s){if(e)return t(e);if(0===s.length)return t(new Error(\"No addresses found at host\"));for(let e=0;e<s.length;e++)if(!matchesParentDomain(s[e].name,n.hostname,n.domainLength))return t(new Error(\"Server record does not share hostname with parent URI\"));let o=n.auth?`mongodb://${n.auth}@`:\"mongodb://\",a=s.map(function(e,r){return 0===r?`${o}${e.name}:${e.port}`:`${e.name}:${e.port}`}).join(\",\")+\"/\",i=[];if(n.path){let e=n.path.slice(1);-1!==e.indexOf(\"?\")&&(e=e.slice(0,e.indexOf(\"?\"))),a+=e}(r.ssl||n.search)&&(r.ssl||!n.search||n.search.match(\"ssl\"))||i.push(\"ssl=true\"),n.search&&i.push(n.search.replace(\"?\",\"\")),dns.resolveTxt(n.host,function(e,n){if(e&&\"ENODATA\"!==e.code)return t(e);if(e&&\"ENODATA\"===e.code&&(n=null),n){if(n.length>1)return t(new Error(\"Multiple text records not allowed\"));if(!(n=(n=n[0]).length>1?n.join(\"\"):n[0]).includes(\"authSource\")&&!n.includes(\"replicaSet\"))return t(new Error(\"Text record must only set `authSource` or `replicaSet`\"));i.push(n)}i.length&&(a+=`?${i.join(\"&\")}`),parseHandler(a,r,t)})})};","node_modules/mongodb/lib/topologies/topology_base.js":"\"use strict\";const EventEmitter=require(\"events\"),MongoError=require(\"../core\").MongoError,f=require(\"util\").format,os=require(\"os\"),translateReadPreference=require(\"../utils\").translateReadPreference,ClientSession=require(\"../core\").Sessions.ClientSession;var Store=function(e,o){var s=this;o=o||{force:!1,bufferMaxEntries:-1},this.s={storedOps:[],storeOptions:o,topology:e},Object.defineProperty(this,\"length\",{enumerable:!0,get:function(){return s.s.storedOps.length}})};Store.prototype.add=function(e,o,s,r,t){if(this.s.storeOptions.force)return t(MongoError.create({message:\"db closed by application\",driver:!0}));if(0===this.s.storeOptions.bufferMaxEntries)return t(MongoError.create({message:f(\"no connection available for operation and number of stored operation > %s\",this.s.storeOptions.bufferMaxEntries),driver:!0}));if(this.s.storeOptions.bufferMaxEntries>0&&this.s.storedOps.length>this.s.storeOptions.bufferMaxEntries)for(;this.s.storedOps.length>0;){this.s.storedOps.shift().c(MongoError.create({message:f(\"no connection available for operation and number of stored operation > %s\",this.s.storeOptions.bufferMaxEntries),driver:!0}))}else this.s.storedOps.push({t:e,n:o,o:s,op:r,c:t})},Store.prototype.addObjectAndMethod=function(e,o,s,r,t){if(this.s.storeOptions.force)return t(MongoError.create({message:\"db closed by application\",driver:!0}));if(0===this.s.storeOptions.bufferMaxEntries)return t(MongoError.create({message:f(\"no connection available for operation and number of stored operation > %s\",this.s.storeOptions.bufferMaxEntries),driver:!0}));if(this.s.storeOptions.bufferMaxEntries>0&&this.s.storedOps.length>this.s.storeOptions.bufferMaxEntries)for(;this.s.storedOps.length>0;){this.s.storedOps.shift().c(MongoError.create({message:f(\"no connection available for operation and number of stored operation > %s\",this.s.storeOptions.bufferMaxEntries),driver:!0}))}else this.s.storedOps.push({t:e,m:s,o:o,p:r,c:t})},Store.prototype.flush=function(e){for(;this.s.storedOps.length>0;)this.s.storedOps.shift().c(e||MongoError.create({message:f(\"no connection available for operation\"),driver:!0}))};var primaryOptions=[\"primary\",\"primaryPreferred\",\"nearest\",\"secondaryPreferred\"],secondaryOptions=[\"secondary\",\"secondaryPreferred\"];Store.prototype.execute=function(e){e=e||{};var o=this.s.storedOps;this.s.storedOps=[];for(var s=\"boolean\"!=typeof e.executePrimary||e.executePrimary,r=\"boolean\"!=typeof e.executeSecondary||e.executeSecondary;o.length>0;){var t=o.shift();\"cursor\"===t.t?s&&r?t.o[t.m].apply(t.o,t.p):s&&t.o.options&&t.o.options.readPreference&&-1!==primaryOptions.indexOf(t.o.options.readPreference.mode)?t.o[t.m].apply(t.o,t.p):!s&&r&&t.o.options&&t.o.options.readPreference&&-1!==secondaryOptions.indexOf(t.o.options.readPreference.mode)&&t.o[t.m].apply(t.o,t.p):\"auth\"===t.t?this.s.topology[t.t].apply(this.s.topology,t.o):s&&r?this.s.topology[t.t](t.n,t.o,t.op,t.c):s&&t.op&&t.op.readPreference&&-1!==primaryOptions.indexOf(t.op.readPreference.mode)?this.s.topology[t.t](t.n,t.o,t.op,t.c):!s&&r&&t.op&&t.op.readPreference&&-1!==secondaryOptions.indexOf(t.op.readPreference.mode)&&this.s.topology[t.t](t.n,t.o,t.op,t.c)}},Store.prototype.all=function(){return this.s.storedOps};var ServerCapabilities=function(e){var o=function(e,o,s){Object.defineProperty(e,o,{enumerable:!0,get:function(){return s}})},s=!1,r=!1,t=!1,i=!1,n=!1,a=!1,p=e.maxWriteBatchSize||1e3,c=!1,l=!1;e.minWireVersion>=0&&(t=!0),e.maxWireVersion>=1&&(s=!0,i=!0),e.maxWireVersion>=2&&(r=!0),e.maxWireVersion>=3&&(n=!0,a=!0),e.maxWireVersion>=5&&(c=!0,l=!0),null==e.minWireVersion&&(e.minWireVersion=0),null==e.maxWireVersion&&(e.maxWireVersion=0),o(this,\"hasAggregationCursor\",s),o(this,\"hasWriteCommands\",r),o(this,\"hasTextSearch\",t),o(this,\"hasAuthCommands\",i),o(this,\"hasListCollectionsCommand\",n),o(this,\"hasListIndexesCommand\",a),o(this,\"minWireVersion\",e.minWireVersion),o(this,\"maxWireVersion\",e.maxWireVersion),o(this,\"maxNumberOfDocsInBatch\",p),o(this,\"commandsTakeWriteConcern\",c),o(this,\"commandsTakeCollation\",l)};const driverVersion=require(\"../../package.json\").version,nodejsversion=f(\"Node.js %s, %s\",process.version,os.endianness()),type=os.type(),name=process.platform,architecture=process.arch,release=os.release();class TopologyBase extends EventEmitter{constructor(){super(),this.clientInfo={driver:{name:\"nodejs\",version:driverVersion},os:{type:type,name:name,architecture:architecture,version:release},platform:nodejsversion},this.setMaxListeners(1/0)}hasSessionSupport(){return null!=this.logicalSessionTimeoutMinutes}startSession(e,o){const s=new ClientSession(this,this.s.sessionPool,e,o);return s.once(\"ended\",()=>{this.s.sessions.delete(s)}),this.s.sessions.add(s),s}endSessions(e,o){return this.s.coreTopology.endSessions(e,o)}capabilities(){return this.s.sCapabilities?this.s.sCapabilities:null==this.s.coreTopology.lastIsMaster()?null:(this.s.sCapabilities=new ServerCapabilities(this.s.coreTopology.lastIsMaster()),this.s.sCapabilities)}command(e,o,s,r){this.s.coreTopology.command(e.toString(),o,translateReadPreference(s),r)}insert(e,o,s,r){this.s.coreTopology.insert(e.toString(),o,s,r)}update(e,o,s,r){this.s.coreTopology.update(e.toString(),o,s,r)}remove(e,o,s,r){this.s.coreTopology.remove(e.toString(),o,s,r)}isConnected(e){return e=translateReadPreference(e=e||{}),this.s.coreTopology.isConnected(e)}isDestroyed(){return this.s.coreTopology.isDestroyed()}cursor(e,o,s){return(s=translateReadPreference(s=s||{})).disconnectHandler=this.s.store,s.topology=this,this.s.coreTopology.cursor(e,o,s)}lastIsMaster(){return this.s.coreTopology.lastIsMaster()}selectServer(e,o,s){return this.s.coreTopology.selectServer(e,o,s)}unref(){return this.s.coreTopology.unref()}connections(){return this.s.coreTopology.connections()}close(e,o){this.s.sessions.forEach(e=>e.endSession()),this.s.sessionPool&&this.s.sessionPool.endAllPooledSessions(),!0===e&&(this.s.storeOptions.force=e,this.s.store.flush()),this.s.coreTopology.destroy({force:\"boolean\"==typeof e&&e},o)}}Object.defineProperty(TopologyBase.prototype,\"bson\",{enumerable:!0,get:function(){return this.s.coreTopology.s.bson}}),Object.defineProperty(TopologyBase.prototype,\"parserType\",{enumerable:!0,get:function(){return this.s.coreTopology.parserType}}),Object.defineProperty(TopologyBase.prototype,\"logicalSessionTimeoutMinutes\",{enumerable:!0,get:function(){return this.s.coreTopology.logicalSessionTimeoutMinutes}}),Object.defineProperty(TopologyBase.prototype,\"type\",{enumerable:!0,get:function(){return this.s.coreTopology.type}}),exports.Store=Store,exports.ServerCapabilities=ServerCapabilities,exports.TopologyBase=TopologyBase;","node_modules/mongodb/lib/operations/validate_collection.js":"\"use strict\";const CommandOperation=require(\"./command\");class ValidateCollectionOperation extends CommandOperation{constructor(l,e,r){let t={validate:e};const n=Object.keys(r);for(let l=0;l<n.length;l++)r.hasOwnProperty(n[l])&&\"session\"!==n[l]&&(t[n[l]]=r[n[l]]);super(l.s.db,r,null,t),this.collectionName}execute(l){const e=this.collectionName;super.execute((r,t)=>null!=r?l(r,null):0===t.ok?l(new Error(\"Error with validate command\"),null):null!=t.result&&t.result.constructor!==String?l(new Error(\"Error with validation data\"),null):null!=t.result&&null!=t.result.match(/exception|corrupt/)?l(new Error(\"Error: invalid collection \"+e),null):null==t.valid||t.valid?l(null,t):l(new Error(\"Error: invalid collection \"+e),null))}}module.exports=ValidateCollectionOperation;","node_modules/mongodb/lib/operations/list_databases.js":"\"use strict\";const CommandOperationV2=require(\"./command_v2\"),Aspect=require(\"./operation\").Aspect,defineAspects=require(\"./operation\").defineAspects,MongoDBNamespace=require(\"../utils\").MongoDBNamespace;class ListDatabasesOperation extends CommandOperationV2{constructor(e,s){super(e,s),this.ns=new MongoDBNamespace(\"admin\",\"$cmd\")}execute(e,s){const t={listDatabases:1};this.options.nameOnly&&(t.nameOnly=Number(t.nameOnly)),this.options.filter&&(t.filter=this.options.filter),\"boolean\"==typeof this.options.authorizedDatabases&&(t.authorizedDatabases=this.options.authorizedDatabases),super.executeCommand(e,t,s)}}defineAspects(ListDatabasesOperation,[Aspect.READ_OPERATION,Aspect.RETRYABLE,Aspect.EXECUTE_WITH_SELECTION]),module.exports=ListDatabasesOperation;","node_modules/mongodb/lib/gridfs-stream/download.js":"\"use strict\";var stream=require(\"stream\"),util=require(\"util\");function GridFSBucketReadStream(e,t,r,n,i){this.s={bytesRead:0,chunks:e,cursor:null,expected:0,files:t,filter:n,init:!1,expectedEnd:0,file:null,options:i,readPreference:r},stream.Readable.call(this)}function throwIfInitialized(e){if(e.s.init)throw new Error(\"You cannot change options after the stream has enteredflowing mode!\")}function doRead(e){e.destroyed||e.s.cursor.next(function(t,r){if(e.destroyed)return;if(t)return __handleError(e,t);if(!r)return e.push(null),void process.nextTick(()=>{e.s.cursor.close(function(t){t?__handleError(e,t):e.emit(\"close\")})});var n=e.s.file.length-e.s.bytesRead,i=e.s.expected++,s=Math.min(e.s.file.chunkSize,n);if(r.n>i){var o=\"ChunkIsMissing: Got unexpected n: \"+r.n+\", expected: \"+i;return __handleError(e,new Error(o))}if(r.n<i)return o=\"ExtraChunk: Got unexpected n: \"+r.n+\", expected: \"+i,__handleError(e,new Error(o));var a=Buffer.isBuffer(r.data)?r.data:r.data.buffer;if(a.length!==s)return n<=0?(o=\"ExtraChunk: Got unexpected n: \"+r.n,__handleError(e,new Error(o))):(o=\"ChunkIsWrongSize: Got unexpected length: \"+a.length+\", expected: \"+s,__handleError(e,new Error(o)));if(e.s.bytesRead+=a.length,0===a.length)return e.push(null);var l=null,d=null;null!=e.s.bytesToSkip&&(l=e.s.bytesToSkip,e.s.bytesToSkip=0);const u=i===e.s.expectedEnd-1,h=e.s.options.end-e.s.bytesToSkip;u&&null!=e.s.bytesToTrim?d=e.s.file.chunkSize-e.s.bytesToTrim:e.s.options.end&&h<r.data.length()&&(d=h),null==l&&null==d||(a=a.slice(l||0,d||a.length)),e.push(a)})}function init(e){var t={};e.s.readPreference&&(t.readPreference=e.s.readPreference),e.s.options&&e.s.options.sort&&(t.sort=e.s.options.sort),e.s.options&&e.s.options.skip&&(t.skip=e.s.options.skip),e.s.files.findOne(e.s.filter,t,function(t,r){if(t)return __handleError(e,t);if(!r){var n=e.s.filter._id?e.s.filter._id.toString():e.s.filter.filename,i=new Error(\"FileNotFound: file \"+n+\" was not found\");return i.code=\"ENOENT\",__handleError(e,i)}if(r.length<=0)e.push(null);else if(e.destroyed)e.emit(\"close\");else{e.s.bytesToSkip=handleStartOption(e,r,e.s.options);var s={files_id:r._id};if(e.s.options&&null!=e.s.options.start){var o=Math.floor(e.s.options.start/r.chunkSize);o>0&&(s.n={$gte:o})}e.s.cursor=e.s.chunks.find(s).sort({n:1}),e.s.readPreference&&e.s.cursor.setReadPreference(e.s.readPreference),e.s.expectedEnd=Math.ceil(r.length/r.chunkSize),e.s.file=r,e.s.bytesToTrim=handleEndOption(e,r,e.s.cursor,e.s.options),e.emit(\"file\",r)}})}function waitForFile(e,t){if(e.s.file)return t();e.s.init||(init(e),e.s.init=!0),e.once(\"file\",function(){t()})}function handleStartOption(e,t,r){if(r&&null!=r.start){if(r.start>t.length)throw new Error(\"Stream start (\"+r.start+\") must not be more than the length of the file (\"+t.length+\")\");if(r.start<0)throw new Error(\"Stream start (\"+r.start+\") must not be negative\");if(null!=r.end&&r.end<r.start)throw new Error(\"Stream start (\"+r.start+\") must not be greater than stream end (\"+r.end+\")\");return e.s.bytesRead=Math.floor(r.start/t.chunkSize)*t.chunkSize,e.s.expected=Math.floor(r.start/t.chunkSize),r.start-e.s.bytesRead}}function handleEndOption(e,t,r,n){if(n&&null!=n.end){if(n.end>t.length)throw new Error(\"Stream end (\"+n.end+\") must not be more than the length of the file (\"+t.length+\")\");if(n.start<0)throw new Error(\"Stream end (\"+n.end+\") must not be negative\");var i=null!=n.start?Math.floor(n.start/t.chunkSize):0;return r.limit(Math.ceil(n.end/t.chunkSize)-i),e.s.expectedEnd=Math.ceil(n.end/t.chunkSize),Math.ceil(n.end/t.chunkSize)*t.chunkSize-n.end}}function __handleError(e,t){e.emit(\"error\",t)}module.exports=GridFSBucketReadStream,util.inherits(GridFSBucketReadStream,stream.Readable),GridFSBucketReadStream.prototype._read=function(){var e=this;this.destroyed||waitForFile(e,function(){doRead(e)})},GridFSBucketReadStream.prototype.start=function(e){return throwIfInitialized(this),this.s.options.start=e,this},GridFSBucketReadStream.prototype.end=function(e){return throwIfInitialized(this),this.s.options.end=e,this},GridFSBucketReadStream.prototype.abort=function(e){var t=this;this.push(null),this.destroyed=!0,this.s.cursor?this.s.cursor.close(function(r){t.emit(\"close\"),e&&e(r)}):(this.s.init||t.emit(\"close\"),e&&e())};","node_modules/mongodb/lib/gridfs-stream/upload.js":"\"use strict\";var core=require(\"../core\"),crypto=require(\"crypto\"),stream=require(\"stream\"),util=require(\"util\"),Buffer=require(\"safe-buffer\").Buffer,ERROR_NAMESPACE_NOT_FOUND=26;function GridFSBucketWriteStream(e,t,n){if(n=n||{},this.bucket=e,this.chunks=e.s._chunksCollection,this.filename=t,this.files=e.s._filesCollection,this.options=n,this.done=!1,this.id=n.id?n.id:core.BSON.ObjectId(),this.chunkSizeBytes=this.options.chunkSizeBytes,this.bufToStore=Buffer.alloc(this.chunkSizeBytes),this.length=0,this.md5=!n.disableMD5&&crypto.createHash(\"md5\"),this.n=0,this.pos=0,this.state={streamEnd:!1,outstandingRequests:0,errored:!1,aborted:!1,promiseLibrary:this.bucket.s.promiseLibrary},!this.bucket.s.calledOpenUploadStream){this.bucket.s.calledOpenUploadStream=!0;var r=this;checkIndexes(this,function(){r.bucket.s.checkedIndexes=!0,r.bucket.emit(\"index\")})}}function __handleError(e,t,n){if(!e.state.errored){if(e.state.errored=!0,n)return n(t);e.emit(\"error\",t)}}function createChunkDoc(e,t,n){return{_id:core.BSON.ObjectId(),files_id:e,n:t,data:n}}function checkChunksIndex(e,t){e.chunks.listIndexes().toArray(function(n,r){if(n){if(n.code===ERROR_NAMESPACE_NOT_FOUND){var i={files_id:1,n:1};return void e.chunks.createIndex(i,{background:!1,unique:!0},function(e){if(e)return t(e);t()})}return t(n)}var o=!1;if(r.forEach(function(e){e.key&&(2===Object.keys(e.key).length&&1===e.key.files_id&&1===e.key.n&&(o=!0))}),o)t();else{i={files_id:1,n:1};var s=getWriteOptions(e);s.background=!1,s.unique=!0,e.chunks.createIndex(i,s,function(e){if(e)return t(e);t()})}})}function checkDone(e,t){if(e.done)return!0;if(e.state.streamEnd&&0===e.state.outstandingRequests&&!e.state.errored){e.done=!0;var n=createFilesDoc(e.id,e.length,e.chunkSizeBytes,e.md5&&e.md5.digest(\"hex\"),e.filename,e.options.contentType,e.options.aliases,e.options.metadata);return!checkAborted(e,t)&&(e.files.insertOne(n,getWriteOptions(e),function(r){if(r)return __handleError(e,r,t);e.emit(\"finish\",n)}),!0)}return!1}function checkIndexes(e,t){e.files.findOne({},{_id:1},function(n,r){return n?t(n):r?t():void e.files.listIndexes().toArray(function(n,r){if(n){if(n.code===ERROR_NAMESPACE_NOT_FOUND){var i={filename:1,uploadDate:1};return void e.files.createIndex(i,{background:!1},function(n){if(n)return t(n);checkChunksIndex(e,t)})}return t(n)}var o=!1;if(r.forEach(function(e){2===Object.keys(e.key).length&&1===e.key.filename&&1===e.key.uploadDate&&(o=!0)}),o)checkChunksIndex(e,t);else{i={filename:1,uploadDate:1};var s=getWriteOptions(e);s.background=!1,e.files.createIndex(i,s,function(n){if(n)return t(n);checkChunksIndex(e,t)})}})})}function createFilesDoc(e,t,n,r,i,o,s,u){var c={_id:e,length:t,chunkSize:n,uploadDate:new Date,filename:i};return r&&(c.md5=r),o&&(c.contentType=o),s&&(c.aliases=s),u&&(c.metadata=u),c}function doWrite(e,t,n,r){if(checkAborted(e,r))return!1;var i=Buffer.isBuffer(t)?t:Buffer.from(t,n);if(e.length+=i.length,e.pos+i.length<e.chunkSizeBytes)return i.copy(e.bufToStore,e.pos),e.pos+=i.length,r&&r(),!0;for(var o=i.length,s=e.chunkSizeBytes-e.pos,u=Math.min(s,i.length),c=0;o>0;){var a=i.length-o;if(i.copy(e.bufToStore,e.pos,a,a+u),e.pos+=u,0===(s-=u)){e.md5&&e.md5.update(e.bufToStore);var f=createChunkDoc(e.id,e.n,e.bufToStore);if(++e.state.outstandingRequests,++c,checkAborted(e,r))return!1;e.chunks.insertOne(f,getWriteOptions(e),function(t){if(t)return __handleError(e,t);--e.state.outstandingRequests,--c||(e.emit(\"drain\",f),r&&r(),checkDone(e))}),s=e.chunkSizeBytes,e.pos=0,++e.n}o-=u,u=Math.min(s,o)}return!1}function getWriteOptions(e){var t={};return e.options.writeConcern&&(t.w=e.options.writeConcern.w,t.wtimeout=e.options.writeConcern.wtimeout,t.j=e.options.writeConcern.j),t}function waitForIndexes(e,t){return e.bucket.s.checkedIndexes?t(!1):(e.bucket.once(\"index\",function(){t(!0)}),!0)}function writeRemnant(e,t){if(0===e.pos)return checkDone(e,t);++e.state.outstandingRequests;var n=Buffer.alloc(e.pos);e.bufToStore.copy(n,0,0,e.pos),e.md5&&e.md5.update(n);var r=createChunkDoc(e.id,e.n,n);if(checkAborted(e,t))return!1;e.chunks.insertOne(r,getWriteOptions(e),function(t){if(t)return __handleError(e,t);--e.state.outstandingRequests,checkDone(e)})}function checkAborted(e,t){return!!e.state.aborted&&(\"function\"==typeof t&&t(new Error(\"this stream has been aborted\")),!0)}module.exports=GridFSBucketWriteStream,util.inherits(GridFSBucketWriteStream,stream.Writable),GridFSBucketWriteStream.prototype.write=function(e,t,n){var r=this;return waitForIndexes(this,function(){return doWrite(r,e,t,n)})},GridFSBucketWriteStream.prototype.abort=function(e){if(this.state.streamEnd){var t=new Error(\"Cannot abort a stream that has already completed\");return\"function\"==typeof e?e(t):this.state.promiseLibrary.reject(t)}if(this.state.aborted)return t=new Error(\"Cannot call abort() on a stream twice\"),\"function\"==typeof e?e(t):this.state.promiseLibrary.reject(t);this.state.aborted=!0,this.chunks.deleteMany({files_id:this.id},function(t){\"function\"==typeof e&&e(t)})},GridFSBucketWriteStream.prototype.end=function(e,t,n){var r=this;\"function\"==typeof e?(n=e,e=null,t=null):\"function\"==typeof t&&(n=t,t=null),checkAborted(this,n)||(this.state.streamEnd=!0,n&&this.once(\"finish\",function(e){n(null,e)}),e?this.write(e,t,function(){writeRemnant(r)}):waitForIndexes(this,function(){writeRemnant(r)}))};","node_modules/mongoose/lib/collection.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter,STATES=require(\"./connectionstate\"),immediate=require(\"./helpers/immediate\");function Collection(e,t,o){void 0===o&&(o={}),void 0===o.capped&&(o.capped={}),o.bufferCommands=void 0===o.bufferCommands||o.bufferCommands,\"number\"==typeof o.capped&&(o.capped={size:o.capped}),this.opts=o,this.name=e,this.collectionName=e,this.conn=t,this.queue=[],this.buffer=this.opts.bufferCommands,this.emitter=new EventEmitter,STATES.connected===this.conn.readyState&&this.onOpen()}Collection.prototype.name,Collection.prototype.collectionName,Collection.prototype.conn,Collection.prototype.onOpen=function(){this.buffer=!1,immediate(()=>this.doQueue())},Collection.prototype.onClose=function(e){this.opts.bufferCommands&&!e&&(this.buffer=!0)},Collection.prototype.addQueue=function(e,t){return this.queue.push([e,t]),this},Collection.prototype.doQueue=function(){for(let e=0,t=this.queue.length;e<t;e++)\"function\"==typeof this.queue[e][0]?this.queue[e][0].apply(this,this.queue[e][1]):this[this.queue[e][0]].apply(this,this.queue[e][1]);this.queue=[];const e=this;return process.nextTick(function(){e.emitter.emit(\"queue\")}),this},Collection.prototype.ensureIndex=function(){throw new Error(\"Collection#ensureIndex unimplemented by driver\")},Collection.prototype.createIndex=function(){throw new Error(\"Collection#ensureIndex unimplemented by driver\")},Collection.prototype.findAndModify=function(){throw new Error(\"Collection#findAndModify unimplemented by driver\")},Collection.prototype.findOneAndUpdate=function(){throw new Error(\"Collection#findOneAndUpdate unimplemented by driver\")},Collection.prototype.findOneAndDelete=function(){throw new Error(\"Collection#findOneAndDelete unimplemented by driver\")},Collection.prototype.findOneAndReplace=function(){throw new Error(\"Collection#findOneAndReplace unimplemented by driver\")},Collection.prototype.findOne=function(){throw new Error(\"Collection#findOne unimplemented by driver\")},Collection.prototype.find=function(){throw new Error(\"Collection#find unimplemented by driver\")},Collection.prototype.insert=function(){throw new Error(\"Collection#insert unimplemented by driver\")},Collection.prototype.insertOne=function(){throw new Error(\"Collection#insertOne unimplemented by driver\")},Collection.prototype.insertMany=function(){throw new Error(\"Collection#insertMany unimplemented by driver\")},Collection.prototype.save=function(){throw new Error(\"Collection#save unimplemented by driver\")},Collection.prototype.update=function(){throw new Error(\"Collection#update unimplemented by driver\")},Collection.prototype.getIndexes=function(){throw new Error(\"Collection#getIndexes unimplemented by driver\")},Collection.prototype.mapReduce=function(){throw new Error(\"Collection#mapReduce unimplemented by driver\")},Collection.prototype.watch=function(){throw new Error(\"Collection#watch unimplemented by driver\")},module.exports=Collection;","node_modules/mongoose/lib/error/mongooseError.js":"\"use strict\";function MongooseError(r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this):this.stack=(new Error).stack,this.message=r,this.name=\"MongooseError\"}MongooseError.prototype=Object.create(Error.prototype),MongooseError.prototype.constructor=Error,module.exports=MongooseError;","node_modules/sliced/index.js":"module.exports=function(r,t,e){var n=[],o=r.length;if(0===o)return n;var a=t<0?Math.max(0,t+o):t||0;for(void 0!==e&&(o=e<0?e+o:e);o-- >a;)n[o-a]=r[o];return n};","node_modules/mongoose/lib/helpers/immediate.js":"\"use strict\";module.exports=function(e){return process.nextTick(e)};","node_modules/kareem/index.js":"\"use strict\";function Kareem(){this._pres=new Map,this._posts=new Map}function _handleWrapError(t,e,n,r,o,s,c){if(s.useErrorHandlers){var i={error:e};return t.execPost(n,r,o,i,function(t){return\"function\"==typeof c&&c(t)})}return\"function\"==typeof c?c(e):void 0}function get(t,e,n){return t.has(e)?t.get(e):n}function callMiddlewareFunction(t,e,n,r){let o;try{o=t.apply(e,n)}catch(t){return r(t)}isPromise(o)&&o.then(()=>r(),t=>r(t))}function isPromise(t){return null!=t&&\"function\"==typeof t.then}function decorateNextFn(t){var e=!1,n=this;return function(){if(!e)return e=!0,process.nextTick(()=>t.apply(n,arguments))}}Kareem.prototype.execPre=function(t,e,n,r){3===arguments.length&&(r=n,n=[]);var o=get(this._pres,t,[]),s=o.length,c=0,i=o.numAsync||0,l=!1,u=n;if(!s)return process.nextTick(function(){r(null)});var p=function(){if(!(c>=s)){var t=o[c];if(t.isAsync){var n=[decorateNextFn(f),decorateNextFn(function(t){if(t){if(l)return;return l=!0,r(t)}if(0==--i&&c>=s)return r(null)})];callMiddlewareFunction(t.fn,e,n,n[0])}else if(t.fn.length>0){n=[decorateNextFn(f)];for(var a=arguments.length>=2?arguments:[null].concat(u),h=1;h<a.length;++h)n.push(a[h]);callMiddlewareFunction(t.fn,e,n,n[0])}else{let n=null,o=null;try{o=t.fn.call(e)}catch(t){n=t}if(isPromise(o))o.then(()=>f(),t=>f(t));else{if(++c>=s)return i>0?void 0:process.nextTick(function(){r(n)});p(n)}}}};function f(t){if(t){if(l)return;return l=!0,r(t)}if(++c>=s)return i>0?void 0:r(null);p.apply(e,arguments)}p.apply(null,[null].concat(n))},Kareem.prototype.execPreSync=function(t,e,n){for(var r=get(this._pres,t,[]),o=r.length,s=0;s<o;++s)r[s].fn.apply(e,n||[])},Kareem.prototype.execPost=function(t,e,n,r,o){arguments.length<5&&(o=r,r=null);var s=get(this._posts,t,[]),c=s.length,i=0,l=null;if(r&&r.error&&(l=r.error),!c)return process.nextTick(function(){o.apply(null,[l].concat(n))});var u=function(){for(var t=s[i].fn,r=0,p=n.length,f=[],a=0;a<p;++a)r+=n[a]&&n[a]._kareemIgnore?0:1,n[a]&&n[a]._kareemIgnore||f.push(n[a]);if(l)if(t.length===r+2){var h=decorateNextFn(function(t){if(t&&(l=t),++i>=c)return o.call(null,l);u()});callMiddlewareFunction(t,e,[l].concat(f).concat([h]),h)}else{if(++i>=c)return o.call(null,l);u()}else{const s=decorateNextFn(function(t){return t?(l=t,u()):++i>=c?o.apply(null,[null].concat(n)):void u()});if(t.length===r+2)return++i>=c?o.apply(null,[null].concat(n)):u();if(t.length===r+1)callMiddlewareFunction(t,e,f.concat([s]),s);else{let r,p;try{p=t.apply(e,f)}catch(t){r=t,l=t}if(isPromise(p))return p.then(()=>s(),t=>s(t));if(++i>=c)return o.apply(null,[r].concat(n));u(r)}}};u()},Kareem.prototype.execPostSync=function(t,e,n){const r=get(this._posts,t,[]),o=r.length;for(let t=0;t<o;++t)r[t].fn.apply(e,n||[])},Kareem.prototype.createWrapperSync=function(t,e){var n=this;return function(){n.execPreSync(t,this,arguments);var r=e.apply(this,arguments);return n.execPostSync(t,this,[r]),r}},Kareem.prototype.wrap=function(t,e,n,r,o){const s=r.length>0?r[r.length-1]:null,c=(\"function\"==typeof s&&r.slice(0,r.length-1),this),i=(o=o||{}).checkForPromise;this.execPre(t,n,r,function(l){if(l){const e=o.numCallbackParams||0,r=o.contextParameter?[n]:[];for(var u=r.length;u<e;++u)r.push(null);return _handleWrapError(c,l,t,n,r,o,s)}const p=\"function\"==typeof s?r.length-1:r.length,f=e.length,a=e.apply(n,r.slice(0,p).concat(h));if(i){if(null!=a&&\"function\"==typeof a.then)return a.then(t=>h(null,t),t=>h(t));if(f<p+1)return h(null,a)}function h(){const e=Array.prototype.slice.call(arguments,1);if(o.nullResultByDefault&&0===e.length&&e.push(null),arguments[0])return _handleWrapError(c,arguments[0],t,n,e,o,s);c.execPost(t,n,e,function(){return arguments[0]?\"function\"==typeof s?s(arguments[0]):void 0:\"function\"==typeof s?s.apply(n,arguments):void 0})}})},Kareem.prototype.filter=function(t){const e=this.clone(),n=Array.from(e._pres.keys());for(const r of n){const n=this._pres.get(r).map(t=>Object.assign({},t,{name:r})).filter(t);0!==n.length?(n.numAsync=n.filter(t=>t.isAsync).length,e._pres.set(r,n)):e._pres.delete(r)}const r=Array.from(e._posts.keys());for(const n of r){const r=this._posts.get(n).map(t=>Object.assign({},t,{name:n})).filter(t);0!==r.length?e._posts.set(n,r):e._posts.delete(n)}return e},Kareem.prototype.hasHooks=function(t){return this._pres.has(t)||this._posts.has(t)},Kareem.prototype.createWrapper=function(t,e,n,r){var o=this;return this.hasHooks(t)?function(){var s=n||this,c=Array.prototype.slice.call(arguments);o.wrap(t,e,s,c,r)}:function(){process.nextTick(()=>e.apply(this,arguments))}},Kareem.prototype.pre=function(t,e,n,r,o){let s={};\"object\"==typeof e&&null!=e?e=(s=e).isAsync:\"boolean\"!=typeof arguments[1]&&(n,n=e,e=!1);const c=get(this._pres,t,[]);if(this._pres.set(t,c),e&&(c.numAsync=c.numAsync||0,++c.numAsync),\"function\"!=typeof n)throw new Error('pre() requires a function, got \"'+typeof n+'\"');return o?c.unshift(Object.assign({},s,{fn:n,isAsync:e})):c.push(Object.assign({},s,{fn:n,isAsync:e})),this},Kareem.prototype.post=function(t,e,n,r){const o=get(this._posts,t,[]);if(\"function\"==typeof e&&(r=!!n,n=e,e={}),\"function\"!=typeof n)throw new Error('post() requires a function, got \"'+typeof n+'\"');return r?o.unshift(Object.assign({},e,{fn:n})):o.push(Object.assign({},e,{fn:n})),this._posts.set(t,o),this},Kareem.prototype.clone=function(){const t=new Kareem;for(let e of this._pres.keys()){const n=this._pres.get(e).slice();n.numAsync=this._pres.get(e).numAsync,t._pres.set(e,n)}for(let e of this._posts.keys())t._posts.set(e,this._posts.get(e).slice());return t},Kareem.prototype.merge=function(t,e){var n=(e=1===arguments.length||e)?this.clone():this;for(let e of t._pres.keys()){const r=get(n._pres,e,[]),o=t._pres.get(e).filter(t=>-1===r.map(t=>t.fn).indexOf(t.fn)),s=r.concat(o);s.numAsync=r.numAsync||0,s.numAsync+=o.filter(t=>t.isAsync).length,n._pres.set(e,s)}for(let e of t._posts.keys()){const r=get(n._posts,e,[]),o=t._posts.get(e).filter(t=>-1===r.indexOf(t));n._posts.set(e,r.concat(o))}return n},module.exports=Kareem;","node_modules/mongoose/lib/helpers/update/applyTimestampsToChildren.js":"\"use strict\";const cleanPositionalOperators=require(\"../schema/cleanPositionalOperators\"),handleTimestampOption=require(\"../schema/handleTimestampOption\");function applyTimestampsToChildren(t,e,s){if(null==e)return;const n=Object.keys(e);let i,a,o,l,p;if(n.length&&n[0].startsWith(\"$\")){if(e.$push)for(i in e.$push){const n=s.path(i);e.$push[i]&&n&&n.$isMongooseDocumentArray&&n.schema.options.timestamps&&(l=n.schema.options.timestamps,a=handleTimestampOption(l,\"createdAt\"),o=handleTimestampOption(l,\"updatedAt\"),e.$push[i].$each?e.$push[i].$each.forEach(function(e){null!=o&&(e[o]=t),null!=a&&(e[a]=t)}):(null!=o&&(e.$push[i][o]=t),null!=a&&(e.$push[i][a]=t)))}if(null!=e.$set){const n=Object.keys(e.$set);for(i of n){const n=cleanPositionalOperators(i);if(!(p=s.path(n)))continue;let m=null;const r=n.split(\".\");for(let t=r.length-1;t>0;--t){const e=s.path(r.slice(0,t).join(\".\"));if(null!=e&&(e.$isMongooseDocumentArray||e.$isSingleNested)){m=e;break}}if(Array.isArray(e.$set[i])&&p.$isMongooseDocumentArray)applyTimestampsToDocumentArray(e.$set[i],p,t);else if(e.$set[i]&&p.$isSingleNested)applyTimestampsToSingleNested(e.$set[i],p,t);else if(null!=m){if(l=m.schema.options.timestamps,a=handleTimestampOption(l,\"createdAt\"),o=handleTimestampOption(l,\"updatedAt\"),!l||null==o)continue;if(m.$isSingleNested){e.$set[m.path+\".\"+o]=t;continue}let s=i.substr(m.path.length+1);if(/^\\d+$/.test(s)){e.$set[m.path+\".\"+s][o]=t;continue}const n=s.indexOf(\".\");s=-1!==n?s.substr(0,n):s,e.$set[m.path+\".\"+s+\".\"+o]=t}else if(null!=p.schema&&p.schema!=s&&e.$set[i]){if(l=p.schema.options.timestamps,a=handleTimestampOption(l,\"createdAt\"),o=handleTimestampOption(l,\"updatedAt\"),!l)continue;null!=o&&(e.$set[i][o]=t),null!=a&&(e.$set[i][a]=t)}}}}else{const n=Object.keys(e).filter(t=>!t.startsWith(\"$\"));for(i of n){const n=cleanPositionalOperators(i);(p=s.path(n))&&(Array.isArray(e[i])&&p.$isMongooseDocumentArray?applyTimestampsToDocumentArray(e[i],p,t):null!=e[i]&&p.$isSingleNested&&applyTimestampsToSingleNested(e[i],p,t))}}}function applyTimestampsToDocumentArray(t,e,s){const n=e.schema.options.timestamps;if(!n)return;const i=t.length,a=handleTimestampOption(n,\"createdAt\"),o=handleTimestampOption(n,\"updatedAt\");for(let e=0;e<i;++e)null!=o&&(t[e][o]=s),null!=a&&(t[e][a]=s)}function applyTimestampsToSingleNested(t,e,s){const n=e.schema.options.timestamps;if(!n)return;const i=handleTimestampOption(n,\"createdAt\"),a=handleTimestampOption(n,\"updatedAt\");null!=a&&(t[a]=s),null!=i&&(t[i]=s)}module.exports=applyTimestampsToChildren;","node_modules/mongoose/lib/helpers/update/applyTimestampsToUpdate.js":"\"use strict\";const get=require(\"../get\");function applyTimestampsToUpdate(e,t,s,n,r){const $=n;let l=$;const a=get(r,\"overwrite\",!1),p=get(r,\"timestamps\",!0);if(!p||null==$)return n;const u=null!=p&&!1===p.createdAt,o=null!=p&&!1===p.updatedAt;return a?(n&&n.$set&&(n=n.$set,$.$set={},l=$.$set),o||!s||n[s]||(l[s]=e),u||!t||n[t]||(l[t]=e),$):(n=n||{},$.$set=$.$set||{},o||!s||n.$currentDate&&n.$currentDate[s]||($.$set[s]=e,$.hasOwnProperty(s)&&delete $[s]),!u&&t&&(n[t]&&delete n[t],n.$set&&n.$set[t]&&delete n.$set[t],$.$setOnInsert=$.$setOnInsert||{},$.$setOnInsert[t]=e),0===Object.keys($.$set).length&&delete $.$set,$)}module.exports=applyTimestampsToUpdate;","node_modules/mongoose/lib/helpers/symbols.js":"\"use strict\";exports.arrayAtomicsSymbol=Symbol(\"mongoose#Array#_atomics\"),exports.arrayParentSymbol=Symbol(\"mongoose#Array#_parent\"),exports.arrayPathSymbol=Symbol(\"mongoose#Array#_path\"),exports.arraySchemaSymbol=Symbol(\"mongoose#Array#_schema\"),exports.documentArrayParent=Symbol(\"mongoose:documentArrayParent\"),exports.documentSchemaSymbol=Symbol(\"mongoose#Document#schema\"),exports.getSymbol=Symbol(\"mongoose#Document#get\"),exports.modelSymbol=Symbol(\"mongoose#Model\"),exports.objectIdSymbol=Symbol(\"mongoose#ObjectId\"),exports.populateModelSymbol=Symbol(\"mongoose.PopulateOptions#Model\"),exports.schemaTypeSymbol=Symbol(\"mongoose#schemaType\"),exports.validatorErrorSymbol=Symbol(\"mongoose:validatorError\");","node_modules/mongoose/lib/helpers/schema/getIndexes.js":"\"use strict\";const get=require(\"../get\"),utils=require(\"../../utils\");module.exports=function(e){let t=[];const n=new WeakMap,s=e.constructor.indexTypes,o=function(e,c,i){if(n.has(e))return;n.set(e,!0),c=c||\"\";const r=Object.keys(e.paths),u=r.length;for(let n=0;n<u;++n){const u=r[n],d=e.paths[u];if(null!=i&&i.paths[u])continue;if(d.$isMongooseDocumentArray||d.$isSingleNested){if(!0!==get(d,\"options.excludeIndexes\")&&!0!==get(d,\"schemaOptions.excludeIndexes\")&&!0!==get(d,\"schema.options.excludeIndexes\")&&o(d.schema,c+u+\".\"),null!=d.schema.discriminators){const e=d.schema.discriminators,t=Object.keys(e);for(const n of t)o(e[n],c+u+\".\",d.schema)}if(d.$isMongooseDocumentArray)continue}const a=d._index||d.caster&&d.caster._index;if(!1!==a&&null!==a&&void 0!==a){const e={},n=utils.isObject(a),o=n?a:{},i=\"string\"==typeof a?a:!!n&&a.type;i&&-1!==s.indexOf(i)?e[c+u]=i:o.text?(e[c+u]=\"text\",delete o.text):e[c+u]=1,delete o.type,\"background\"in o||(o.background=!0),t.push([e,o])}}n.delete(e),c?function(e,n){const s=e._indexes,o=s.length;for(let e=0;e<o;++e){const o=s[e][0],c=Object.keys(o),i=c.length,r={};for(let e=0;e<i;++e){const t=c[e];r[n+t]=o[t]}t.push([r,s[e][1]])}}(e,c):(e._indexes.forEach(function(e){\"background\"in e[1]||(e[1].background=!0)}),t=t.concat(e._indexes))};return o(e),t};","node_modules/mongoose/lib/helpers/schema/handleTimestampOption.js":"\"use strict\";function handleTimestampOption(n,e){return null==n?null:\"boolean\"==typeof n?e:\"boolean\"==typeof n[e]?n[e]?e:null:e in n?n[e]:e}module.exports=handleTimestampOption;","node_modules/mongoose/lib/helpers/schema/merge.js":"\"use strict\";module.exports=function(e,o){e.add(o.obj||{}),e.callQueue=e.callQueue.concat(o.callQueue),e.method(o.methods),e.static(o.statics);for(const s in o.query)e.query[s]=o.query[s];for(const s in o.virtuals)e.virtuals[s]=o.virtuals[s].clone();e.s.hooks.merge(o.s.hooks,!1)};","node_modules/mpath/index.js":"module.exports=exports=require(\"./lib\");","node_modules/mongoose/lib/schema/symbols.js":"\"use strict\";exports.schemaMixedSymbol=Symbol.for(\"mongoose:schema_mixed\"),exports.builtInMiddleware=Symbol.for(\"mongoose:built-in-middleware\");","node_modules/mongoose/lib/helpers/populate/validateRef.js":"\"use strict\";const MongooseError=require(\"../../error/mongooseError\"),util=require(\"util\");function validateRef(o,e){if(\"string\"!=typeof o&&\"function\"!=typeof o)throw new MongooseError('Invalid ref at path \"'+e+'\". Got '+util.inspect(o,{depth:0}))}module.exports=validateRef;","node_modules/mongoose/lib/helpers/query/applyQueryMiddleware.js":"\"use strict\";function applyQueryMiddleware(e,t){const a={useErrorHandlers:!0,numCallbackParams:1,nullResultByDefault:!0},n=t.hooks.filter(e=>\"updateOne\"===e.name||\"deleteOne\"===e.name?null==e.query||!!e.query:\"remove\"===e.name?!!e.query:\"validate\"!==e.name||!!e.query);e.prototype._execUpdate=n.createWrapper(\"update\",e.prototype._execUpdate,null,a),e.prototype.__distinct=n.createWrapper(\"distinct\",e.prototype.__distinct,null,a),e.prototype.validate=n.createWrapper(\"validate\",e.prototype.validate,null,a),applyQueryMiddleware.middlewareFunctions.filter(e=>\"update\"!==e&&\"distinct\"!==e&&\"validate\"!==e).forEach(t=>{e.prototype[`_${t}`]=n.createWrapper(t,e.prototype[`_${t}`],null,a)})}module.exports=applyQueryMiddleware,applyQueryMiddleware.middlewareFunctions=[\"count\",\"countDocuments\",\"deleteMany\",\"deleteOne\",\"distinct\",\"estimatedDocumentCount\",\"find\",\"findOne\",\"findOneAndDelete\",\"findOneAndRemove\",\"findOneAndReplace\",\"findOneAndUpdate\",\"remove\",\"replaceOne\",\"update\",\"updateMany\",\"updateOne\",\"validate\"];","node_modules/mongoose/lib/helpers/model/applyHooks.js":"\"use strict\";const symbols=require(\"../../schema/symbols\"),utils=require(\"../../utils\");function applyHooks(e,t,o){const a={useErrorHandlers:!0,numCallbackParams:1,nullResultByDefault:!0,contextParameter:!0},s=(o=o||{}).decorateDoc?e:e.prototype;e.$appliedHooks=!0;for(const e of Object.keys(t.paths)){const a=t.paths[e];let s=null;if(a.$isSingleNested)s=a.caster;else{if(!a.$isMongooseDocumentArray)continue;s=a.Constructor}if(!s.$appliedHooks&&(applyHooks(s,a.schema,o),null!=s.discriminators)){const e=Object.keys(s.discriminators);for(let t=0;t<e.length;++t)applyHooks(s.discriminators[e[t]],s.discriminators[e[t]].schema,o)}}const l=t.s.hooks.filter(e=>\"updateOne\"===e.name||\"deleteOne\"===e.name?!!e.document:\"remove\"!==e.name||(null==e.document||!!e.document)).filter(e=>!t.methods[e.name]||!e.fn[symbols.builtInMiddleware]);e._middleware=l,s.$__save=l.createWrapper(\"save\",s.$__save,null,a),s.$__originalValidate=s.$__originalValidate||s.$__validate,s.$__validate=l.createWrapper(\"validate\",s.$__originalValidate,null,a),s.$__remove=l.createWrapper(\"remove\",s.$__remove,null,a),s.$__deleteOne=l.createWrapper(\"deleteOne\",s.$__deleteOne,null,a),s.$__init=l.createWrapperSync(\"init\",s.$__init,null,a);const n=Object.keys(t.methods),r=Object.assign({},a,{checkForPromise:!0});for(const t of n){if(!l.hasHooks(t))continue;const o=s[t];s[t]=function(){const o=Array.prototype.slice.call(arguments),a=utils.last(o),s=\"function\"==typeof a?o.slice(0,o.length-1):o;return utils.promiseOrCallback(a,e=>this[`$__${t}`].apply(this,s.concat([e])),e.events)},s[`$__${t}`]=l.createWrapper(t,o,null,r)}}module.exports=applyHooks,applyHooks.middlewareFunctions=[\"deleteOne\",\"save\",\"validate\",\"remove\",\"updateOne\",\"init\"];","node_modules/mongoose/lib/schema/operators/exists.js":"\"use strict\";const castBoolean=require(\"../../cast/boolean\");module.exports=function(t){const o=null!=this?this.path:null;return castBoolean(t,o)};","node_modules/mongoose/lib/schema/operators/type.js":"\"use strict\";module.exports=function(r){if(\"number\"!=typeof r&&\"string\"!=typeof r)throw new Error(\"$type parameter must be number or string\");return r};","node_modules/mongoose/lib/helpers/schematype/handleImmutable.js":"\"use strict\";const StrictModeError=require(\"../../error/strict\");function createImmutableSetter(t,e){return function(r){if(null==this||null==this.$__)return r;if(this.isNew)return r;if(!(\"function\"==typeof e?e.call(this,this):e))return r;if(\"throw\"===this.$__.strictMode&&r!==this[t])throw new StrictModeError(t,\"Path `\"+t+\"` is immutable and strict mode is set to throw.\",!0);return this[t]}}module.exports=function(t){t.$immutable?(t.$immutableSetter=createImmutableSetter(t.path,t.options.immutable),t.set(t.$immutableSetter)):t.$immutableSetter&&(t.setters=t.setters.filter(e=>e!==t.$immutableSetter),delete t.$immutableSetter)};","node_modules/mongoose/lib/error/messages.js":"\"use strict\";const msg=module.exports=exports={};msg.DocumentNotFoundError=null,msg.general={},msg.general.default=\"Validator failed for path `{PATH}` with value `{VALUE}`\",msg.general.required=\"Path `{PATH}` is required.\",msg.Number={},msg.Number.min=\"Path `{PATH}` ({VALUE}) is less than minimum allowed value ({MIN}).\",msg.Number.max=\"Path `{PATH}` ({VALUE}) is more than maximum allowed value ({MAX}).\",msg.Date={},msg.Date.min=\"Path `{PATH}` ({VALUE}) is before minimum allowed value ({MIN}).\",msg.Date.max=\"Path `{PATH}` ({VALUE}) is after maximum allowed value ({MAX}).\",msg.String={},msg.String.enum=\"`{VALUE}` is not a valid enum value for path `{PATH}`.\",msg.String.match=\"Path `{PATH}` is invalid ({VALUE}).\",msg.String.minlength=\"Path `{PATH}` (`{VALUE}`) is shorter than the minimum allowed length ({MINLENGTH}).\",msg.String.maxlength=\"Path `{PATH}` (`{VALUE}`) is longer than the maximum allowed length ({MAXLENGTH}).\";","node_modules/mongoose/lib/error/notFound.js":"\"use strict\";const MongooseError=require(\"./\"),util=require(\"util\");function DocumentNotFoundError(o,r,t,e){let n;const u=MongooseError.messages;n=null!=u.DocumentNotFoundError?\"function\"==typeof u.DocumentNotFoundError?u.DocumentNotFoundError(o,r):u.DocumentNotFoundError:'No document found for query \"'+util.inspect(o)+'\" on model \"'+r+'\"',MongooseError.call(this,n),this.name=\"DocumentNotFoundError\",this.result=e,this.numAffected=t,Error.captureStackTrace?Error.captureStackTrace(this):this.stack=(new Error).stack,this.filter=o,this.query=o}DocumentNotFoundError.prototype=Object.create(MongooseError.prototype),DocumentNotFoundError.prototype.constructor=MongooseError,module.exports=DocumentNotFoundError;","node_modules/mongoose/lib/error/validation.js":"\"use strict\";const MongooseError=require(\"./\"),util=require(\"util\");function ValidationError(r){this.errors={},this._message=\"\",MongooseError.call(this,this._message),r&&\"model\"===r.constructor.name?this._message=r.constructor.modelName+\" validation failed\":this._message=\"Validation failed\",this.name=\"ValidationError\",Error.captureStackTrace?Error.captureStackTrace(this):this.stack=(new Error).stack,r&&(r.errors=this.errors)}function _generateMessage(r){const t=Object.keys(r.errors||{}),e=t.length,o=[];let s;for(let i=0;i<e;++i)s=t[i],r!==r.errors[s]&&o.push(s+\": \"+r.errors[s].message);return o.join(\", \")}ValidationError.prototype=Object.create(MongooseError.prototype),ValidationError.prototype.constructor=MongooseError,ValidationError.prototype.toString=function(){return this.name+\": \"+_generateMessage(this)},ValidationError.prototype.inspect=function(){return Object.assign(new Error(this.message),this)},util.inspect.custom&&(ValidationError.prototype[util.inspect.custom]=ValidationError.prototype.inspect),ValidationError.prototype.toJSON=function(){return Object.assign({},this,{message:this.message})},ValidationError.prototype.addError=function(r,t){this.errors[r]=t,this.message=this._message+\": \"+_generateMessage(this)},module.exports=exports=ValidationError;","node_modules/mongoose/lib/error/validator.js":"\"use strict\";const MongooseError=require(\"./\");function ValidatorError(r){let t=r.message;t||(t=MongooseError.messages.general.default);const e=this.formatMessage(t,r);MongooseError.call(this,e),r=Object.assign({},r,{message:e}),this.name=\"ValidatorError\",Error.captureStackTrace?Error.captureStackTrace(this):this.stack=(new Error).stack,this.properties=r,this.kind=r.type,this.path=r.path,this.value=r.value,this.reason=r.reason}ValidatorError.prototype=Object.create(MongooseError.prototype),ValidatorError.prototype.constructor=MongooseError,Object.defineProperty(ValidatorError.prototype,\"properties\",{enumerable:!1,writable:!0,value:null}),ValidatorError.prototype.formatMessage=function(r,t){if(\"function\"==typeof r)return r(t);const e=Object.keys(t);for(let o=0;o<e.length;++o){const a=e[o];\"message\"!==a&&(r=r.replace(\"{\"+a.toUpperCase()+\"}\",t[a]))}return r},ValidatorError.prototype.toString=function(){return this.message},module.exports=ValidatorError;","node_modules/mongoose/lib/error/version.js":"\"use strict\";const MongooseError=require(\"./\");function VersionError(o,r,e){const t=e.join(\", \");MongooseError.call(this,'No matching document found for id \"'+o._id+'\" version '+r+' modifiedPaths \"'+t+'\"'),this.name=\"VersionError\",this.version=r,this.modifiedPaths=e}VersionError.prototype=Object.create(MongooseError.prototype),VersionError.prototype.constructor=MongooseError,module.exports=VersionError;","node_modules/mongoose/lib/error/parallelSave.js":"\"use strict\";const MongooseError=require(\"./\");function ParallelSaveError(r){MongooseError.call(this,\"Can't save() the same doc multiple times in parallel. Document: \"+r.id),this.name=\"ParallelSaveError\"}ParallelSaveError.prototype=Object.create(MongooseError.prototype),ParallelSaveError.prototype.constructor=MongooseError,module.exports=ParallelSaveError;","node_modules/mongoose/lib/error/overwriteModel.js":"\"use strict\";const MongooseError=require(\"./\");function OverwriteModelError(r){MongooseError.call(this,\"Cannot overwrite `\"+r+\"` model once compiled.\"),this.name=\"OverwriteModelError\",Error.captureStackTrace?Error.captureStackTrace(this):this.stack=(new Error).stack}OverwriteModelError.prototype=Object.create(MongooseError.prototype),OverwriteModelError.prototype.constructor=MongooseError,module.exports=OverwriteModelError;","node_modules/mongoose/lib/error/missingSchema.js":"\"use strict\";const MongooseError=require(\"./\");function MissingSchemaError(r){const o=\"Schema hasn't been registered for model \\\"\"+r+'\".\\nUse mongoose.model(name, schema)';MongooseError.call(this,o),this.name=\"MissingSchemaError\",Error.captureStackTrace?Error.captureStackTrace(this):this.stack=(new Error).stack}MissingSchemaError.prototype=Object.create(MongooseError.prototype),MissingSchemaError.prototype.constructor=MongooseError,module.exports=MissingSchemaError;","node_modules/mongoose/lib/error/divergentArray.js":"\"use strict\";const MongooseError=require(\"./\");function DivergentArrayError(r){const e=\"For your own good, using `document.save()` to update an array which was selected using an $elemMatch projection OR populated using skip, limit, query conditions, or exclusion of the _id field when the operation results in a $pop or $set of the entire array is not supported. The following path(s) would have been modified unsafely:\\n  \"+r.join(\"\\n  \")+\"\\nUse Model.update() to update these arrays instead.\";MongooseError.call(this,e),this.name=\"DivergentArrayError\",Error.captureStackTrace?Error.captureStackTrace(this):this.stack=(new Error).stack}DivergentArrayError.prototype=Object.create(MongooseError.prototype),DivergentArrayError.prototype.constructor=MongooseError,module.exports=DivergentArrayError;","node_modules/mongoose/lib/error/strict.js":"\"use strict\";const MongooseError=require(\"./\");function StrictModeError(r,o,t){o=o||\"Field `\"+r+\"` is not in schema and strict mode is set to throw.\",MongooseError.call(this,o),this.name=\"StrictModeError\",this.isImmutableError=!!t,Error.captureStackTrace?Error.captureStackTrace(this):this.stack=(new Error).stack,this.path=r}StrictModeError.prototype=Object.create(MongooseError.prototype),StrictModeError.prototype.constructor=MongooseError,module.exports=StrictModeError;","node_modules/mongoose/lib/options/propertyOptions.js":"\"use strict\";module.exports=Object.freeze({enumerable:!0,configurable:!0,writable:!0,value:void 0});","node_modules/mongoose/lib/types/decimal128.js":"\"use strict\";module.exports=require(\"../driver\").get().Decimal128;","node_modules/mongoose/lib/types/objectid.js":"\"use strict\";const ObjectId=require(\"../driver\").get().ObjectId,objectIdSymbol=require(\"../helpers/symbols\").objectIdSymbol;Object.defineProperty(ObjectId.prototype,\"_id\",{enumerable:!1,configurable:!0,get:function(){return this}}),ObjectId.prototype[objectIdSymbol]=!0,module.exports=ObjectId;","node_modules/mongoose/lib/options/PopulateOptions.js":"\"use strict\";const utils=require(\"../utils\");class PopulateOptions{constructor(t){this._docs={},null!=t&&(t=utils.clone(t),Object.assign(this,t),\"object\"==typeof t.subPopulate&&(this.populate=t.subPopulate))}}module.exports=PopulateOptions;","node_modules/regexp-clone/index.js":"const toString=Object.prototype.toString;function isRegExp(t){return\"object\"==typeof t&&\"[object RegExp]\"==toString.call(t)}module.exports=exports=function(t){if(!isRegExp(t))throw new TypeError(\"Not a RegExp\");const e=[];t.global&&e.push(\"g\"),t.multiline&&e.push(\"m\"),t.ignoreCase&&e.push(\"i\"),t.dotAll&&e.push(\"s\"),t.unicode&&e.push(\"u\"),t.sticky&&e.push(\"y\");const o=new RegExp(t.source,e.join(\"\"));return\"number\"==typeof t.lastIndex&&(o.lastIndex=t.lastIndex),o};","node_modules/ms/index.js":"var s=1e3,m=60*s,h=60*m,d=24*h,w=7*d,y=365.25*d;function parse(e){if(!((e=String(e)).length>100)){var r=/^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var a=parseFloat(r[1]);switch((r[2]||\"ms\").toLowerCase()){case\"years\":case\"year\":case\"yrs\":case\"yr\":case\"y\":return a*y;case\"weeks\":case\"week\":case\"w\":return a*w;case\"days\":case\"day\":case\"d\":return a*d;case\"hours\":case\"hour\":case\"hrs\":case\"hr\":case\"h\":return a*h;case\"minutes\":case\"minute\":case\"mins\":case\"min\":case\"m\":return a*m;case\"seconds\":case\"second\":case\"secs\":case\"sec\":case\"s\":return a*s;case\"milliseconds\":case\"millisecond\":case\"msecs\":case\"msec\":case\"ms\":return a;default:return}}}}function fmtShort(e){var r=Math.abs(e);return r>=d?Math.round(e/d)+\"d\":r>=h?Math.round(e/h)+\"h\":r>=m?Math.round(e/m)+\"m\":r>=s?Math.round(e/s)+\"s\":e+\"ms\"}function fmtLong(e){var r=Math.abs(e);return r>=d?plural(e,r,d,\"day\"):r>=h?plural(e,r,h,\"hour\"):r>=m?plural(e,r,m,\"minute\"):r>=s?plural(e,r,s,\"second\"):e+\" ms\"}function plural(s,e,r,a){var n=e>=1.5*r;return Math.round(s/r)+\" \"+a+(n?\"s\":\"\")}module.exports=function(s,e){e=e||{};var r=typeof s;if(\"string\"===r&&s.length>0)return parse(s);if(\"number\"===r&&isFinite(s))return e.long?fmtLong(s):fmtShort(s);throw new Error(\"val is not a non-empty string or a valid number. val=\"+JSON.stringify(s))};","node_modules/mquery/lib/utils.js":"\"use strict\";var Buffer=require(\"safe-buffer\").Buffer,RegExpClone=require(\"regexp-clone\"),clone=exports.clone=function e(r,t){if(void 0===r||null===r)return r;if(Array.isArray(r))return exports.cloneArray(r,t);if(r.constructor){if(/ObjectI[dD]$/.test(r.constructor.name))return\"function\"==typeof r.clone?r.clone():new r.constructor(r.id);if(\"ReadPreference\"===r.constructor.name)return new r.constructor(r.mode,e(r.tags,t));if(\"Binary\"==r._bsontype&&r.buffer&&r.value)return\"function\"==typeof r.clone?r.clone():new r.constructor(r.value(!0),r.sub_type);if(\"Date\"===r.constructor.name||\"Function\"===r.constructor.name)return new r.constructor(+r);if(\"RegExp\"===r.constructor.name)return RegExpClone(r);if(\"Buffer\"===r.constructor.name)return exports.cloneBuffer(r)}return isObject(r)?exports.cloneObject(r,t):r.valueOf?r.valueOf():void 0};exports.cloneObject=function(e,r){var t,o,n,c=r&&r.minimize,s={};for(n in e)o=clone(e[n],r),c&&void 0===o||(t||(t=!0),s[n]=o);return c?t&&s:s},exports.cloneArray=function(e,r){for(var t=[],o=0,n=e.length;o<n;o++)t.push(clone(e[o],r));return t},exports.tick=function(e){if(\"function\"==typeof e)return function(){var r=arguments;soon(function(){e.apply(this,r)})}},exports.merge=function e(r,t){for(var o,n=Object.keys(t),c=n.length;c--;)void 0===r[o=n[c]]?r[o]=t[o]:exports.isObject(t[o])?e(r[o],t[o]):r[o]=t[o]},exports.mergeClone=function e(r,t){for(var o,n=Object.keys(t),c=n.length;c--;)void 0===r[o=n[c]]?r[o]=clone(t[o]):exports.isObject(t[o])?e(r[o],t[o]):r[o]=clone(t[o])},exports.readPref=function(e){switch(e){case\"p\":e=\"primary\";break;case\"pp\":e=\"primaryPreferred\";break;case\"s\":e=\"secondary\";break;case\"sp\":e=\"secondaryPreferred\";break;case\"n\":e=\"nearest\"}return e},exports.readConcern=function(e){if(\"string\"==typeof e){switch(e){case\"l\":e=\"local\";break;case\"a\":e=\"available\";break;case\"m\":e=\"majority\";break;case\"lz\":e=\"linearizable\";break;case\"s\":e=\"snapshot\"}e={level:e}}return e};var _toString=Object.prototype.toString;exports.toString=function(e){return _toString.call(e)};var isObject=exports.isObject=function(e){return\"[object Object]\"==exports.toString(e)};function create(e){if(arguments.length>1)throw new Error(\"Adding properties is not supported\");function r(){}return r.prototype=e,new r}exports.isArray=function(e){return Array.isArray(e)||\"object\"==typeof e&&\"[object Array]\"==exports.toString(e)},exports.keys=Object.keys||function(e){var r=[];for(var t in e)e.hasOwnProperty(t)&&r.push(t);return r},exports.create=\"function\"==typeof Object.create?Object.create:create,exports.inherits=function(e,r){e.prototype=exports.create(r.prototype),e.prototype.constructor=e};var soon=exports.soon=\"function\"==typeof setImmediate?setImmediate:process.nextTick;exports.cloneBuffer=function(e){var r=Buffer.alloc(e.length);return e.copy(r,0,0,e.length),r},exports.isArgumentsObject=function(e){return\"[object Arguments]\"===Object.prototype.toString.call(e)};","node_modules/debug/src/index.js":"\"undefined\"==typeof process||\"renderer\"===process.type||!0===process.browser||process.__nwjs?module.exports=require(\"./browser.js\"):module.exports=require(\"./node.js\");","node_modules/mquery/lib/permissions.js":"\"use strict\";var denied=exports;denied.distinct=function(e){return e._fields&&Object.keys(e._fields).length>0?\"field selection and slice\":(Object.keys(denied.distinct).every(function(d){return!e.options[d]||(n=d,!1)}),n);var n},denied.distinct.select=denied.distinct.slice=denied.distinct.sort=denied.distinct.limit=denied.distinct.skip=denied.distinct.batchSize=denied.distinct.comment=denied.distinct.maxScan=denied.distinct.snapshot=denied.distinct.hint=denied.distinct.tailable=!0,denied.findOneAndUpdate=denied.findOneAndRemove=function(e){var n;return Object.keys(denied.findOneAndUpdate).every(function(d){return!e.options[d]||(n=d,!1)}),n},denied.findOneAndUpdate.limit=denied.findOneAndUpdate.skip=denied.findOneAndUpdate.batchSize=denied.findOneAndUpdate.maxScan=denied.findOneAndUpdate.snapshot=denied.findOneAndUpdate.hint=denied.findOneAndUpdate.tailable=denied.findOneAndUpdate.comment=!0,denied.count=function(e){return e._fields&&Object.keys(e._fields).length>0?\"field selection and slice\":(Object.keys(denied.count).every(function(d){return!e.options[d]||(n=d,!1)}),n);var n},denied.count.slice=denied.count.batchSize=denied.count.comment=denied.count.maxScan=denied.count.snapshot=denied.count.tailable=!0;","node_modules/mquery/lib/env.js":"\"use strict\";exports.isNode=\"undefined\"!=typeof process&&\"object\"==typeof module&&\"object\"==typeof global&&\"function\"==typeof Buffer&&process.argv,exports.isMongo=!exports.isNode&&\"function\"==typeof printjson&&\"function\"==typeof ObjectId&&\"function\"==typeof rs&&\"function\"==typeof sh,exports.isBrowser=!exports.isNode&&!exports.isMongo&&\"undefined\"!=typeof window,exports.type=exports.isNode?\"node\":exports.isMongo?\"mongo\":exports.isBrowser?\"browser\":\"unknown\";","node_modules/mquery/lib/collection/index.js":"\"use strict\";var env=require(\"../env\");if(\"unknown\"==env.type)throw new Error(\"Unknown environment\");module.exports=env.isNode?require(\"./node\"):(env.isMongo,require(\"./collection\"));","node_modules/mquery/lib/collection/collection.js":"\"use strict\";var methods=[\"find\",\"findOne\",\"update\",\"updateMany\",\"updateOne\",\"replaceOne\",\"remove\",\"count\",\"distinct\",\"findAndModify\",\"aggregate\",\"findStream\",\"deleteOne\",\"deleteMany\"];function Collection(){}for(var i=0,len=methods.length;i<len;++i){var method=methods[i];Collection.prototype[method]=notImplemented(method)}function notImplemented(e){return function(){throw new Error(\"collection.\"+e+\" not implemented\")}}module.exports=exports=Collection,Collection.methods=methods;","node_modules/bluebird/js/release/bluebird.js":"\"use strict\";var old;function noConflict(){try{Promise===bluebird&&(Promise=old)}catch(e){}return bluebird}\"undefined\"!=typeof Promise&&(old=Promise);var bluebird=require(\"./promise\")();bluebird.noConflict=noConflict,module.exports=bluebird;","node_modules/debug/src/node.js":"const tty=require(\"tty\"),util=require(\"util\");exports.init=init,exports.log=log,exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors,exports.colors=[6,2,3,4,5,1];try{const t=require(\"supports-color\");t&&(t.stderr||t).level>=2&&(exports.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(t){}function useColors(){return\"colors\"in exports.inspectOpts?Boolean(exports.inspectOpts.colors):tty.isatty(process.stderr.fd)}function formatArgs(t){const{namespace:e,useColors:s}=this;if(s){const s=this.color,o=\"\u001b[3\"+(s<8?s:\"8;5;\"+s),r=`  ${o};1m${e} \u001b[0m`;t[0]=r+t[0].split(\"\\n\").join(\"\\n\"+r),t.push(o+\"m+\"+module.exports.humanize(this.diff)+\"\u001b[0m\")}else t[0]=getDate()+e+\" \"+t[0]}function getDate(){return exports.inspectOpts.hideDate?\"\":(new Date).toISOString()+\" \"}function log(...t){return process.stderr.write(util.format(...t)+\"\\n\")}function save(t){t?process.env.DEBUG=t:delete process.env.DEBUG}function load(){return process.env.DEBUG}function init(t){t.inspectOpts={};const e=Object.keys(exports.inspectOpts);for(let s=0;s<e.length;s++)t.inspectOpts[e[s]]=exports.inspectOpts[e[s]]}exports.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{const s=e.substring(6).toLowerCase().replace(/_([a-z])/g,(t,e)=>e.toUpperCase());let o=process.env[e];return o=!!/^(yes|on|true|enabled)$/i.test(o)||!/^(no|off|false|disabled)$/i.test(o)&&(\"null\"===o?null:Number(o)),t[s]=o,t},{}),module.exports=require(\"./common\")(exports);const{formatters:formatters}=module.exports;formatters.o=function(t){return this.inspectOpts.colors=this.useColors,util.inspect(t,this.inspectOpts).replace(/\\s*\\n\\s*/g,\" \")},formatters.O=function(t){return this.inspectOpts.colors=this.useColors,util.inspect(t,this.inspectOpts)};","node_modules/debug/src/common.js":"function setup(e){function n(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]}function t(e){let o;function i(...e){if(!i.enabled)return;const n=i,s=Number(new Date),r=s-(o||s);n.diff=r,n.prev=o,n.curr=s,o=s,e[0]=t.coerce(e[0]),\"string\"!=typeof e[0]&&e.unshift(\"%O\");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(s,r)=>{if(\"%%\"===s)return s;a++;const o=t.formatters[r];if(\"function\"==typeof o){const t=e[a];s=o.call(n,t),e.splice(a,1),a--}return s}),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return i.namespace=e,i.enabled=t.enabled(e),i.useColors=t.useColors(),i.color=n(e),i.destroy=s,i.extend=r,\"function\"==typeof t.init&&t.init(i),t.instances.push(i),i}function s(){const e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function r(e,n){const s=t(this.namespace+(void 0===n?\":\":n)+e);return s.log=this.log,s}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\\.\\*\\?$/,\"*\")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map(e=>\"-\"+e)].join(\",\");return t.enable(\"\"),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const s=(\"string\"==typeof e?e:\"\").split(/[\\s,]+/),r=s.length;for(n=0;n<r;n++)s[n]&&(\"-\"===(e=s[n].replace(/\\*/g,\".*?\"))[0]?t.skips.push(new RegExp(\"^\"+e.substr(1)+\"$\")):t.names.push(new RegExp(\"^\"+e+\"$\")));for(n=0;n<t.instances.length;n++){const e=t.instances[n];e.enabled=t.enabled(e.namespace)}},t.enabled=function(e){if(\"*\"===e[e.length-1])return!0;let n,s;for(n=0,s=t.skips.length;n<s;n++)if(t.skips[n].test(e))return!1;for(n=0,s=t.names.length;n<s;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=require(\"ms\"),Object.keys(e).forEach(n=>{t[n]=e[n]}),t.instances=[],t.names=[],t.skips=[],t.formatters={},t.selectColor=n,t.enable(t.load()),t}module.exports=setup;","node_modules/mquery/lib/collection/node.js":"\"use strict\";var Collection=require(\"./collection\"),utils=require(\"../utils\");function NodeCollection(o){this.collection=o,this.collectionName=o.collectionName}utils.inherits(NodeCollection,Collection),NodeCollection.prototype.find=function(o,t,e){this.collection.find(o,t,function(o,t){if(o)return e(o);try{t.toArray(e)}catch(o){e(o)}})},NodeCollection.prototype.findOne=function(o,t,e){this.collection.findOne(o,t,e)},NodeCollection.prototype.count=function(o,t,e){this.collection.count(o,t,e)},NodeCollection.prototype.distinct=function(o,t,e,n){this.collection.distinct(o,t,e,n)},NodeCollection.prototype.update=function(o,t,e,n){this.collection.update(o,t,e,n)},NodeCollection.prototype.updateMany=function(o,t,e,n){this.collection.updateMany(o,t,e,n)},NodeCollection.prototype.updateOne=function(o,t,e,n){this.collection.updateOne(o,t,e,n)},NodeCollection.prototype.replaceOne=function(o,t,e,n){this.collection.replaceOne(o,t,e,n)},NodeCollection.prototype.deleteOne=function(o,t,e){this.collection.deleteOne(o,t,e)},NodeCollection.prototype.deleteMany=function(o,t,e){this.collection.deleteMany(o,t,e)},NodeCollection.prototype.remove=function(o,t,e){this.collection.remove(o,t,e)},NodeCollection.prototype.findAndModify=function(o,t,e,n){var i=Array.isArray(e.sort)?e.sort:[];this.collection.findAndModify(o,i,t,e,n)},NodeCollection.prototype.findStream=function(o,t,e){return this.collection.find(o,t).stream(e)},NodeCollection.prototype.findCursor=function(o,t){return this.collection.find(o,t)},module.exports=exports=NodeCollection;","node_modules/bluebird/js/release/promise.js":"\"use strict\";module.exports=function(){var e=function(){return new _(\"circular promise resolution chain\\n\\n    See http://goo.gl/MqrFmX\\n\")},t=function(){return new P.PromiseInspection(this._target())},i=function(e){return P.reject(new _(e))};function r(){}var n,o={},s=require(\"./util\");n=s.isNode?function(){var e=process.domain;return void 0===e&&(e=null),e}:function(){return null},s.notEnumerableProp(P,\"_getDomain\",n);var l=require(\"./es5\"),a=require(\"./async\"),c=new a;l.defineProperty(P,\"_async\",{value:c});var u=require(\"./errors\"),_=P.TypeError=u.TypeError;P.RangeError=u.RangeError;var h=P.CancellationError=u.CancellationError;P.TimeoutError=u.TimeoutError,P.OperationalError=u.OperationalError,P.RejectionError=u.OperationalError,P.AggregateError=u.AggregateError;var f=function(){},d={},p={},v=require(\"./thenables\")(P,f),m=require(\"./promise_array\")(P,f,v,i,r),b=require(\"./context\")(P),y=b.create,j=require(\"./debuggability\")(P,b),g=(j.CapturedTrace,require(\"./finally\")(P,v,p)),F=require(\"./catch_filter\")(p),C=require(\"./nodeback\"),w=s.errorObj,k=s.tryCatch;function P(e){e!==f&&function(e,t){if(null==e||e.constructor!==P)throw new _(\"the promise constructor cannot be invoked directly\\n\\n    See http://goo.gl/MqrFmX\\n\");if(\"function\"!=typeof t)throw new _(\"expecting a function but got \"+s.classString(t))}(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent(\"promiseCreated\",this)}function q(e){this.promise._resolveCallback(e)}function E(e){this.promise._rejectCallback(e,!1)}function H(e){var t=new P(f);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return P.prototype.toString=function(){return\"[object Promise]\"},P.prototype.caught=P.prototype.catch=function(e){var t=arguments.length;if(t>1){var r,n=new Array(t-1),o=0;for(r=0;r<t-1;++r){var l=arguments[r];if(!s.isObject(l))return i(\"Catch statement predicate: expecting an object but got \"+s.classString(l));n[o++]=l}return n.length=o,e=arguments[r],this.then(void 0,F(n,e,this))}return this.then(void 0,e)},P.prototype.reflect=function(){return this._then(t,t,void 0,this,void 0)},P.prototype.then=function(e,t){if(j.warnings()&&arguments.length>0&&\"function\"!=typeof e&&\"function\"!=typeof t){var i=\".then() only accepts functions but was passed: \"+s.classString(e);arguments.length>1&&(i+=\", \"+s.classString(t)),this._warn(i)}return this._then(e,t,void 0,void 0,void 0)},P.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},P.prototype.spread=function(e){return\"function\"!=typeof e?i(\"expecting a function but got \"+s.classString(e)):this.all()._then(e,void 0,void 0,d,void 0)},P.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},P.prototype.all=function(){return arguments.length>0&&this._warn(\".all() was passed arguments but it does not take any\"),new m(this).promise()},P.prototype.error=function(e){return this.caught(s.originatesFromRejection,e)},P.getNewLibraryCopy=module.exports,P.is=function(e){return e instanceof P},P.fromNode=P.fromCallback=function(e){var t=new P(f);t._captureStackTrace();var i=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=k(e)(C(t,i));return r===w&&t._rejectCallback(r.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},P.all=function(e){return new m(e).promise()},P.cast=function(e){var t=v(e);return t instanceof P||((t=new P(f))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},P.resolve=P.fulfilled=P.cast,P.reject=P.rejected=function(e){var t=new P(f);return t._captureStackTrace(),t._rejectCallback(e,!0),t},P.setScheduler=function(e){if(\"function\"!=typeof e)throw new _(\"expecting a function but got \"+s.classString(e));return c.setScheduler(e)},P.prototype._then=function(e,t,i,r,o){var l=void 0!==o,a=l?o:new P(f),u=this._target(),_=u._bitField;l||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(r=0!=(50397184&_)?this._boundValue():u===this?void 0:this._boundTo),this._fireEvent(\"promiseChained\",this,a));var d=n();if(0!=(50397184&_)){var p,v,m=u._settlePromiseCtx;0!=(33554432&_)?(v=u._rejectionHandler0,p=e):0!=(16777216&_)?(v=u._fulfillmentHandler0,p=t,u._unsetRejectionIsUnhandled()):(m=u._settlePromiseLateCancellationObserver,v=new h(\"late cancellation observer\"),u._attachExtraTrace(v),p=t),c.invoke(m,u,{handler:null===d?p:\"function\"==typeof p&&s.domainBind(d,p),promise:a,receiver:r,value:v})}else u._addCallbacks(e,t,a,r,d);return a},P.prototype._length=function(){return 65535&this._bitField},P.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},P.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},P.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},P.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent(\"promiseFulfilled\",this)},P.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent(\"promiseRejected\",this)},P.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent(\"promiseResolved\",this)},P.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},P.prototype._isFinal=function(){return(4194304&this._bitField)>0},P.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},P.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent(\"promiseCancelled\",this)},P.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},P.prototype._setAsyncGuaranteed=function(){c.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},P.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==o)return void 0===t&&this._isBound()?this._boundValue():t},P.prototype._promiseAt=function(e){return this[4*e-4+2]},P.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},P.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},P.prototype._boundValue=function(){},P.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,i=e._rejectionHandler0,r=e._promise0,n=e._receiverAt(0);void 0===n&&(n=o),this._addCallbacks(t,i,r,n,null)},P.prototype._migrateCallbackAt=function(e,t){var i=e._fulfillmentHandlerAt(t),r=e._rejectionHandlerAt(t),n=e._promiseAt(t),s=e._receiverAt(t);void 0===s&&(s=o),this._addCallbacks(i,r,n,s,null)},P.prototype._addCallbacks=function(e,t,i,r,n){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=i,this._receiver0=r,\"function\"==typeof e&&(this._fulfillmentHandler0=null===n?e:s.domainBind(n,e)),\"function\"==typeof t&&(this._rejectionHandler0=null===n?t:s.domainBind(n,t));else{var l=4*o-4;this[l+2]=i,this[l+3]=r,\"function\"==typeof e&&(this[l+0]=null===n?e:s.domainBind(n,e)),\"function\"==typeof t&&(this[l+1]=null===n?t:s.domainBind(n,t))}return this._setLength(o+1),o},P.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},P.prototype._resolveCallback=function(t,i){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(e(),!1);var r=v(t,this);if(!(r instanceof P))return this._fulfill(t);i&&this._propagateFrom(r,2);var n=r._target();if(n!==this){var o=n._bitField;if(0==(50397184&o)){var s=this._length();s>0&&n._migrateCallback0(this);for(var l=1;l<s;++l)n._migrateCallbackAt(this,l);this._setFollowing(),this._setLength(0),this._setFollowee(n)}else if(0!=(33554432&o))this._fulfill(n._value());else if(0!=(16777216&o))this._reject(n._reason());else{var a=new h(\"late cancellation observer\");n._attachExtraTrace(a),this._reject(a)}}else this._reject(e())}},P.prototype._rejectCallback=function(e,t,i){var r=s.ensureErrorObject(e),n=r===e;if(!n&&!i&&j.warnings()){var o=\"a promise was rejected with a non-error: \"+s.classString(e);this._warn(o,!0)}this._attachExtraTrace(r,!!t&&n),this._reject(e)},P.prototype._resolveFromExecutor=function(e){if(e!==f){var t=this;this._captureStackTrace(),this._pushContext();var i=!0,r=this._execute(e,function(e){t._resolveCallback(e)},function(e){t._rejectCallback(e,i)});i=!1,this._popContext(),void 0!==r&&t._rejectCallback(r,!0)}},P.prototype._settlePromiseFromHandler=function(e,t,i,r){var n=r._bitField;if(0==(65536&n)){var o;r._pushContext(),t===d?i&&\"number\"==typeof i.length?o=k(e).apply(this._boundValue(),i):(o=w).e=new _(\"cannot .spread() a non-array: \"+s.classString(i)):o=k(e).call(t,i);var l=r._popContext();0==(65536&(n=r._bitField))&&(o===p?r._reject(i):o===w?r._rejectCallback(o.e,!1):(j.checkForgottenReturns(o,l,\"\",r,this),r._resolveCallback(o)))}},P.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},P.prototype._followee=function(){return this._rejectionHandler0},P.prototype._setFollowee=function(e){this._rejectionHandler0=e},P.prototype._settlePromise=function(e,i,n,o){var s=e instanceof P,l=this._bitField,a=0!=(134217728&l);0!=(65536&l)?(s&&e._invokeInternalOnCancel(),n instanceof g&&n.isFinallyHandler()?(n.cancelPromise=e,k(i).call(n,o)===w&&e._reject(w.e)):i===t?e._fulfill(t.call(n)):n instanceof r?n._promiseCancelled(e):s||e instanceof m?e._cancel():n.cancel()):\"function\"==typeof i?s?(a&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(i,n,o,e)):i.call(n,o,e):n instanceof r?n._isResolved()||(0!=(33554432&l)?n._promiseFulfilled(o,e):n._promiseRejected(o,e)):s&&(a&&e._setAsyncGuaranteed(),0!=(33554432&l)?e._fulfill(o):e._reject(o))},P.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,i=e.promise,r=e.receiver,n=e.value;\"function\"==typeof t?i instanceof P?this._settlePromiseFromHandler(t,r,n,i):t.call(r,n,i):i instanceof P&&i._reject(n)},P.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},P.prototype._settlePromise0=function(e,t,i){var r=this._promise0,n=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,e,n,t)},P.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},P.prototype._fulfill=function(t){var i=this._bitField;if(!((117506048&i)>>>16)){if(t===this){var r=e();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=t,(65535&i)>0&&(0!=(134217728&i)?this._settlePromises():c.settlePromises(this))}},P.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return c.fatalError(e,s.isNode);(65535&t)>0?c.settlePromises(this):this._ensurePossibleRejectionHandled()}},P.prototype._fulfillPromises=function(e,t){for(var i=1;i<e;i++){var r=this._fulfillmentHandlerAt(i),n=this._promiseAt(i),o=this._receiverAt(i);this._clearCallbackDataAtIndex(i),this._settlePromise(n,r,o,t)}},P.prototype._rejectPromises=function(e,t){for(var i=1;i<e;i++){var r=this._rejectionHandlerAt(i),n=this._promiseAt(i),o=this._receiverAt(i);this._clearCallbackDataAtIndex(i),this._settlePromise(n,r,o,t)}},P.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!=(16842752&e)){var i=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,i,e),this._rejectPromises(t,i)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,e),this._fulfillPromises(t,r)}this._setLength(0)}this._clearCancellationData()},P.prototype._settledValue=function(){var e=this._bitField;return 0!=(33554432&e)?this._rejectionHandler0:0!=(16777216&e)?this._fulfillmentHandler0:void 0},P.defer=P.pending=function(){return j.deprecated(\"Promise.defer\",\"new Promise\"),{promise:new P(f),resolve:q,reject:E}},s.notEnumerableProp(P,\"_makeSelfResolutionError\",e),require(\"./method\")(P,f,v,i,j),require(\"./bind\")(P,f,v,j),require(\"./cancel\")(P,m,i,j),require(\"./direct_resolve\")(P),require(\"./synchronous_inspection\")(P),require(\"./join\")(P,m,v,f,c,n),P.Promise=P,P.version=\"3.5.1\",require(\"./map.js\")(P,m,i,v,f,j),require(\"./call_get.js\")(P),require(\"./using.js\")(P,i,v,y,f,j),require(\"./timers.js\")(P,f,j),require(\"./generators.js\")(P,i,f,v,r,j),require(\"./nodeify.js\")(P),require(\"./promisify.js\")(P,f),require(\"./props.js\")(P,m,v,i),require(\"./race.js\")(P,f,v,i),require(\"./reduce.js\")(P,m,i,v,f,j),require(\"./settle.js\")(P,m,j),require(\"./some.js\")(P,m,i),require(\"./filter.js\")(P,f),require(\"./each.js\")(P,f),require(\"./any.js\")(P),s.toFastProperties(P),s.toFastProperties(P.prototype),H({a:1}),H({b:2}),H({c:3}),H(1),H(function(){}),H(void 0),H(!1),H(new P(f)),j.setBounds(a.firstLineError,s.lastLineError),P};","node_modules/bluebird/js/release/util.js":"\"use strict\";var es5=require(\"./es5\"),canEvaluate=\"undefined\"==typeof navigator,errorObj={e:{}},tryCatchTarget,globalObject=\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:void 0!==this?this:null;function tryCatcher(){try{var r=tryCatchTarget;return tryCatchTarget=null,r.apply(this,arguments)}catch(r){return errorObj.e=r,errorObj}}function tryCatch(r){return tryCatchTarget=r,tryCatcher}var inherits=function(r,e){var t={}.hasOwnProperty;function n(){for(var n in this.constructor=r,this.constructor$=e,e.prototype)t.call(e.prototype,n)&&\"$\"!==n.charAt(n.length-1)&&(this[n+\"$\"]=e.prototype[n])}return n.prototype=e.prototype,r.prototype=new n,r.prototype};function isPrimitive(r){return null==r||!0===r||!1===r||\"string\"==typeof r||\"number\"==typeof r}function isObject(r){return\"function\"==typeof r||\"object\"==typeof r&&null!==r}function maybeWrapAsError(r){return isPrimitive(r)?new Error(safeToString(r)):r}function withAppended(r,e){var t,n=r.length,o=new Array(n+1);for(t=0;t<n;++t)o[t]=r[t];return o[t]=e,o}function getDataPropertyOrDefault(r,e,t){if(!es5.isES5)return{}.hasOwnProperty.call(r,e)?r[e]:void 0;var n=Object.getOwnPropertyDescriptor(r,e);return null!=n?null==n.get&&null==n.set?n.value:t:void 0}function notEnumerableProp(r,e,t){if(isPrimitive(r))return r;var n={value:t,configurable:!0,enumerable:!1,writable:!0};return es5.defineProperty(r,e,n),r}function thrower(r){throw r}var inheritedDataKeys=function(){var r=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var t=0;t<r.length;++t)if(r[t]===e)return!0;return!1};if(es5.isES5){var t=Object.getOwnPropertyNames;return function(r){for(var n=[],o=Object.create(null);null!=r&&!e(r);){var i;try{i=t(r)}catch(r){return n}for(var a=0;a<i.length;++a){var s=i[a];if(!o[s]){o[s]=!0;var c=Object.getOwnPropertyDescriptor(r,s);null!=c&&null==c.get&&null==c.set&&n.push(s)}}r=es5.getPrototypeOf(r)}return n}}var n={}.hasOwnProperty;return function(t){if(e(t))return[];var o=[];r:for(var i in t)if(n.call(t,i))o.push(i);else{for(var a=0;a<r.length;++a)if(n.call(r[a],i))continue r;o.push(i)}return o}}(),thisAssignmentPattern=/this\\s*\\.\\s*\\S+\\s*=/;function isClass(r){try{if(\"function\"==typeof r){var e=es5.names(r.prototype),t=es5.isES5&&e.length>1,n=e.length>0&&!(1===e.length&&\"constructor\"===e[0]),o=thisAssignmentPattern.test(r+\"\")&&es5.names(r).length>0;if(t||n||o)return!0}return!1}catch(r){return!1}}function toFastProperties(r){function e(){}e.prototype=r;for(var t=8;t--;)new e;return r}var rident=/^[a-z$_][a-z$_0-9]*$/i;function isIdentifier(r){return rident.test(r)}function filledRange(r,e,t){for(var n=new Array(r),o=0;o<r;++o)n[o]=e+o+t;return n}function safeToString(r){try{return r+\"\"}catch(r){return\"[no string representation]\"}}function isError(r){return r instanceof Error||null!==r&&\"object\"==typeof r&&\"string\"==typeof r.message&&\"string\"==typeof r.name}function markAsOriginatingFromRejection(r){try{notEnumerableProp(r,\"isOperational\",!0)}catch(r){}}function originatesFromRejection(r){return null!=r&&(r instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===r.isOperational)}function canAttachTrace(r){return isError(r)&&es5.propertyIsWritable(r,\"stack\")}var ensureErrorObject=\"stack\"in new Error?function(r){return canAttachTrace(r)?r:new Error(safeToString(r))}:function(r){if(canAttachTrace(r))return r;try{throw new Error(safeToString(r))}catch(r){return r}};function classString(r){return{}.toString.call(r)}function copyDescriptors(r,e,t){for(var n=es5.names(r),o=0;o<n.length;++o){var i=n[o];if(t(i))try{es5.defineProperty(e,i,es5.getDescriptor(r,i))}catch(r){}}}var asArray=function(r){return es5.isArray(r)?r:null};if(\"undefined\"!=typeof Symbol&&Symbol.iterator){var ArrayFrom=\"function\"==typeof Array.from?function(r){return Array.from(r)}:function(r){for(var e,t=[],n=r[Symbol.iterator]();!(e=n.next()).done;)t.push(e.value);return t};asArray=function(r){return es5.isArray(r)?r:null!=r&&\"function\"==typeof r[Symbol.iterator]?ArrayFrom(r):null}}var isNode=\"undefined\"!=typeof process&&\"[object process]\"===classString(process).toLowerCase(),hasEnvVariables=\"undefined\"!=typeof process&&void 0!==process.env;function env(r){return hasEnvVariables?process.env[r]:void 0}function getNativePromise(){if(\"function\"==typeof Promise)try{var r=new Promise(function(){});if(\"[object Promise]\"==={}.toString.call(r))return Promise}catch(r){}}function domainBind(r,e){return r.bind(e)}var ret={isClass:isClass,isIdentifier:isIdentifier,inheritedDataKeys:inheritedDataKeys,getDataPropertyOrDefault:getDataPropertyOrDefault,thrower:thrower,isArray:es5.isArray,asArray:asArray,notEnumerableProp:notEnumerableProp,isPrimitive:isPrimitive,isObject:isObject,isError:isError,canEvaluate:canEvaluate,errorObj:errorObj,tryCatch:tryCatch,inherits:inherits,withAppended:withAppended,maybeWrapAsError:maybeWrapAsError,toFastProperties:toFastProperties,filledRange:filledRange,toString:safeToString,canAttachTrace:canAttachTrace,ensureErrorObject:ensureErrorObject,originatesFromRejection:originatesFromRejection,markAsOriginatingFromRejection:markAsOriginatingFromRejection,classString:classString,copyDescriptors:copyDescriptors,hasDevTools:\"undefined\"!=typeof chrome&&chrome&&\"function\"==typeof chrome.loadTimes,isNode:isNode,hasEnvVariables:hasEnvVariables,env:env,global:globalObject,getNativePromise:getNativePromise,domainBind:domainBind};ret.isRecentNode=ret.isNode&&function(){var r=process.versions.node.split(\".\").map(Number);return 0===r[0]&&r[1]>10||r[0]>0}(),ret.isNode&&ret.toFastProperties(process);try{throw new Error}catch(r){ret.lastLineError=r}module.exports=ret;","node_modules/bluebird/js/release/es5.js":"var isES5=function(){\"use strict\";return void 0===this}();if(isES5)module.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:isES5,propertyIsWritable:function(e,r){var t=Object.getOwnPropertyDescriptor(e,r);return!(t&&!t.writable&&!t.set)}};else{var has={}.hasOwnProperty,str={}.toString,proto={}.constructor.prototype,ObjectKeys=function(e){var r=[];for(var t in e)has.call(e,t)&&r.push(t);return r},ObjectGetDescriptor=function(e,r){return{value:e[r]}},ObjectDefineProperty=function(e,r,t){return e[r]=t.value,e},ObjectFreeze=function(e){return e},ObjectGetPrototypeOf=function(e){try{return Object(e).constructor.prototype}catch(e){return proto}},ArrayIsArray=function(e){try{return\"[object Array]\"===str.call(e)}catch(e){return!1}};module.exports={isArray:ArrayIsArray,keys:ObjectKeys,names:ObjectKeys,defineProperty:ObjectDefineProperty,getDescriptor:ObjectGetDescriptor,freeze:ObjectFreeze,getPrototypeOf:ObjectGetPrototypeOf,isES5:isES5,propertyIsWritable:function(){return!0}}}","node_modules/bluebird/js/release/async.js":"\"use strict\";var firstLineError;try{throw new Error}catch(e){firstLineError=e}var schedule=require(\"./schedule\"),Queue=require(\"./queue\"),util=require(\"./util\");function Async(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new Queue(16),this._normalQueue=new Queue(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=schedule}function AsyncInvokeLater(e,t,s){this._lateQueue.push(e,t,s),this._queueTick()}function AsyncInvoke(e,t,s){this._normalQueue.push(e,t,s),this._queueTick()}function AsyncSettlePromises(e){this._normalQueue._pushOne(e),this._queueTick()}Async.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},Async.prototype.hasCustomScheduler=function(){return this._customScheduler},Async.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},Async.prototype.disableTrampolineIfNecessary=function(){util.hasDevTools&&(this._trampolineEnabled=!1)},Async.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},Async.prototype.fatalError=function(e,t){t?(process.stderr.write(\"Fatal \"+(e instanceof Error?e.stack:e)+\"\\n\"),process.exit(2)):this.throwLater(e)},Async.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),\"undefined\"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(e){throw new Error(\"No async scheduler available\\n\\n    See http://goo.gl/MqrFmX\\n\")}},util.hasDevTools?(Async.prototype.invokeLater=function(e,t,s){this._trampolineEnabled?AsyncInvokeLater.call(this,e,t,s):this._schedule(function(){setTimeout(function(){e.call(t,s)},100)})},Async.prototype.invoke=function(e,t,s){this._trampolineEnabled?AsyncInvoke.call(this,e,t,s):this._schedule(function(){e.call(t,s)})},Async.prototype.settlePromises=function(e){this._trampolineEnabled?AsyncSettlePromises.call(this,e):this._schedule(function(){e._settlePromises()})}):(Async.prototype.invokeLater=AsyncInvokeLater,Async.prototype.invoke=AsyncInvoke,Async.prototype.settlePromises=AsyncSettlePromises),Async.prototype._drainQueue=function(e){for(;e.length()>0;){var t=e.shift();if(\"function\"==typeof t){var s=e.shift(),i=e.shift();t.call(s,i)}else t._settlePromises()}},Async.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},Async.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},Async.prototype._reset=function(){this._isTickUsed=!1},module.exports=Async,module.exports.firstLineError=firstLineError;","node_modules/bluebird/js/release/errors.js":"\"use strict\";var _TypeError,_RangeError,es5=require(\"./es5\"),Objectfreeze=es5.freeze,util=require(\"./util\"),inherits=util.inherits,notEnumerableProp=util.notEnumerableProp;function subError(r,e){function o(t){if(!(this instanceof o))return new o(t);notEnumerableProp(this,\"message\",\"string\"==typeof t?t:e),notEnumerableProp(this,\"name\",r),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return inherits(o,Error),o}var Warning=subError(\"Warning\",\"warning\"),CancellationError=subError(\"CancellationError\",\"cancellation error\"),TimeoutError=subError(\"TimeoutError\",\"timeout error\"),AggregateError=subError(\"AggregateError\",\"aggregate error\");try{_TypeError=TypeError,_RangeError=RangeError}catch(r){_TypeError=subError(\"TypeError\",\"type error\"),_RangeError=subError(\"RangeError\",\"range error\")}for(var methods=\"join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse\".split(\" \"),i=0;i<methods.length;++i)\"function\"==typeof Array.prototype[methods[i]]&&(AggregateError.prototype[methods[i]]=Array.prototype[methods[i]]);es5.defineProperty(AggregateError.prototype,\"length\",{value:0,configurable:!1,writable:!0,enumerable:!0}),AggregateError.prototype.isOperational=!0;var level=0;function OperationalError(r){if(!(this instanceof OperationalError))return new OperationalError(r);notEnumerableProp(this,\"name\",\"OperationalError\"),notEnumerableProp(this,\"message\",r),this.cause=r,this.isOperational=!0,r instanceof Error?(notEnumerableProp(this,\"message\",r.message),notEnumerableProp(this,\"stack\",r.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}AggregateError.prototype.toString=function(){var r=Array(4*level+1).join(\" \"),e=\"\\n\"+r+\"AggregateError of:\\n\";level++,r=Array(4*level+1).join(\" \");for(var o=0;o<this.length;++o){for(var t=this[o]===this?\"[Circular AggregateError]\":this[o]+\"\",a=t.split(\"\\n\"),n=0;n<a.length;++n)a[n]=r+a[n];e+=(t=a.join(\"\\n\"))+\"\\n\"}return level--,e},inherits(OperationalError,Error);var errorTypes=Error.__BluebirdErrorTypes__;errorTypes||(errorTypes=Objectfreeze({CancellationError:CancellationError,TimeoutError:TimeoutError,OperationalError:OperationalError,RejectionError:OperationalError,AggregateError:AggregateError}),es5.defineProperty(Error,\"__BluebirdErrorTypes__\",{value:errorTypes,writable:!1,enumerable:!1,configurable:!1})),module.exports={Error:Error,TypeError:_TypeError,RangeError:_RangeError,CancellationError:errorTypes.CancellationError,OperationalError:errorTypes.OperationalError,TimeoutError:errorTypes.TimeoutError,AggregateError:errorTypes.AggregateError,Warning:Warning};","node_modules/bluebird/js/release/thenables.js":"\"use strict\";module.exports=function(t,r){var e=require(\"./util\"),n=e.errorObj,u=e.isObject;var c={}.hasOwnProperty;return function(l,o){if(u(l)){if(l instanceof t)return l;var a=function(t){try{return function(t){return t.then}(t)}catch(t){return n.e=t,n}}(l);if(a===n){o&&o._pushContext();var i=t.reject(a.e);return o&&o._popContext(),i}if(\"function\"==typeof a)return function(t){try{return c.call(t,\"_promise0\")}catch(t){return!1}}(l)?(i=new t(r),l._then(i._fulfill,i._reject,void 0,i,null),i):function(u,c,l){var o=new t(r),a=o;l&&l._pushContext(),o._captureStackTrace(),l&&l._popContext();var i=!0,f=e.tryCatch(c).call(u,function(t){o&&(o._resolveCallback(t),o=null)},function(t){o&&(o._rejectCallback(t,i,!0),o=null)});return i=!1,o&&f===n&&(o._rejectCallback(f.e,!0,!0),o=null),a}(l,a,o)}return l}};","node_modules/bluebird/js/release/promise_array.js":"\"use strict\";module.exports=function(e,t,s,i,r){var n=require(\"./util\");n.isArray;function l(s){var i=this._promise=new e(t);s instanceof e&&i._propagateFrom(s,3),i._setOnCancel(this),this._values=s,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return n.inherits(l,r),l.prototype.length=function(){return this._length},l.prototype.promise=function(){return this._promise},l.prototype._init=function t(r,l){var o=s(this._values,this._promise);if(o instanceof e){var a=(o=o._target())._bitField;if(this._values=o,0==(50397184&a))return this._promise._setAsyncGuaranteed(),o._then(t,this._reject,void 0,this,l);if(0==(33554432&a))return 0!=(16777216&a)?this._reject(o._reason()):this._cancel();o=o._value()}if(null!==(o=n.asArray(o)))0!==o.length?this._iterate(o):-5===l?this._resolveEmptyArray():this._resolve(function(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}(l));else{var _=i(\"expecting an array or an iterable object but got \"+n.classString(o)).reason();this._promise._rejectCallback(_,!1)}},l.prototype._iterate=function(t){var i=this.getActualLength(t.length);this._length=i,this._values=this.shouldCopyValues()?new Array(i):this._values;for(var r=this._promise,n=!1,l=null,o=0;o<i;++o){var a=s(t[o],r);l=a instanceof e?(a=a._target())._bitField:null,n?null!==l&&a.suppressUnhandledRejections():null!==l?0==(50397184&l)?(a._proxy(this,o),this._values[o]=a):n=0!=(33554432&l)?this._promiseFulfilled(a._value(),o):0!=(16777216&l)?this._promiseRejected(a._reason(),o):this._promiseCancelled(o):n=this._promiseFulfilled(a,o)}n||r._setAsyncGuaranteed()},l.prototype._isResolved=function(){return null===this._values},l.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},l.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},l.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},l.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},l.prototype._promiseCancelled=function(){return this._cancel(),!0},l.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},l.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var s=0;s<t.length;++s)t[s]instanceof e&&t[s].cancel()}},l.prototype.shouldCopyValues=function(){return!0},l.prototype.getActualLength=function(e){return e},l};","node_modules/bluebird/js/release/context.js":"\"use strict\";module.exports=function(t){var e=!1,o=[];function p(){this._trace=new p.CapturedTrace(r())}function r(){var t=o.length-1;if(t>=0)return o[t]}return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},p.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,o.push(this._trace))},p.prototype._popContext=function(){if(void 0!==this._trace){var t=o.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},p.CapturedTrace=null,p.create=function(){if(e)return new p},p.deactivateLongStackTraces=function(){},p.activateLongStackTraces=function(){var o=t.prototype._pushContext,n=t.prototype._popContext,i=t._peekContext,u=t.prototype._peekContext,a=t.prototype._promiseCreated;p.deactivateLongStackTraces=function(){t.prototype._pushContext=o,t.prototype._popContext=n,t._peekContext=i,t.prototype._peekContext=u,t.prototype._promiseCreated=a,e=!1},e=!0,t.prototype._pushContext=p.prototype._pushContext,t.prototype._popContext=p.prototype._popContext,t._peekContext=t.prototype._peekContext=r,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},p};","node_modules/bluebird/js/release/debuggability.js":"\"use strict\";module.exports=function(t,n){var e,r,o,i=t._getDomain,a=t._async,c=require(\"./errors\").Warning,s=require(\"./util\"),l=s.canAttachTrace,u=/[\\\\\\/]bluebird[\\\\\\/]js[\\\\\\/](release|debug|instrumented)/,f=/\\((?:timers\\.js):\\d+:\\d+\\)/,d=/[\\/<\\(](.+?):(\\d+):(\\d+)\\)?\\s*$/,p=null,h=null,_=!1,v=!(0==s.env(\"BLUEBIRD_DEBUG\")||!s.env(\"BLUEBIRD_DEBUG\")&&\"development\"!==s.env(\"NODE_ENV\")),g=!(0==s.env(\"BLUEBIRD_WARNINGS\")||!v&&!s.env(\"BLUEBIRD_WARNINGS\")),m=!(0==s.env(\"BLUEBIRD_LONG_STACK_TRACES\")||!v&&!s.env(\"BLUEBIRD_LONG_STACK_TRACES\")),y=0!=s.env(\"BLUEBIRD_W_FORGOTTEN_RETURN\")&&(g||!!s.env(\"BLUEBIRD_W_FORGOTTEN_RETURN\"));t.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},t.prototype._ensurePossibleRejectionHandled=function(){if(0==(524288&this._bitField)){this._setRejectionIsUnhandled();var t=this;setTimeout(function(){t._notifyUnhandledRejection()},1)}},t.prototype._notifyUnhandledRejectionIsHandled=function(){H(\"rejectionHandled\",e,void 0,this)},t.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},t.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),H(\"unhandledRejection\",r,t,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},t.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},t.prototype._warn=function(t,n,e){return O(t,n,e||this)},t.onPossiblyUnhandledRejection=function(t){var n=i();r=\"function\"==typeof t?null===n?t:s.domainBind(n,t):void 0},t.onUnhandledRejectionHandled=function(t){var n=i();e=\"function\"==typeof t?null===n?t:s.domainBind(n,t):void 0};var k=function(){};t.longStackTraces=function(){if(a.haveItemsQueued()&&!X.longStackTraces)throw new Error(\"cannot enable long stack traces after promises have been created\\n\\n    See http://goo.gl/MqrFmX\\n\");if(!X.longStackTraces&&W()){var e=t.prototype._captureStackTrace,r=t.prototype._attachExtraTrace;X.longStackTraces=!0,k=function(){if(a.haveItemsQueued()&&!X.longStackTraces)throw new Error(\"cannot enable long stack traces after promises have been created\\n\\n    See http://goo.gl/MqrFmX\\n\");t.prototype._captureStackTrace=e,t.prototype._attachExtraTrace=r,n.deactivateLongStackTraces(),a.enableTrampoline(),X.longStackTraces=!1},t.prototype._captureStackTrace=x,t.prototype._attachExtraTrace=D,n.activateLongStackTraces(),a.disableTrampolineIfNecessary()}},t.hasLongStackTraces=function(){return X.longStackTraces&&W()};var E=function(){try{if(\"function\"==typeof CustomEvent){var t=new CustomEvent(\"CustomEvent\");return s.global.dispatchEvent(t),function(t,n){var e=new CustomEvent(t.toLowerCase(),{detail:n,cancelable:!0});return!s.global.dispatchEvent(e)}}if(\"function\"==typeof Event){t=new Event(\"CustomEvent\");return s.global.dispatchEvent(t),function(t,n){var e=new Event(t.toLowerCase(),{cancelable:!0});return e.detail=n,!s.global.dispatchEvent(e)}}return(t=document.createEvent(\"CustomEvent\")).initCustomEvent(\"testingtheevent\",!1,!0,{}),s.global.dispatchEvent(t),function(t,n){var e=document.createEvent(\"CustomEvent\");return e.initCustomEvent(t.toLowerCase(),!1,!0,n),!s.global.dispatchEvent(e)}}catch(t){}return function(){return!1}}(),b=s.isNode?function(){return process.emit.apply(process,arguments)}:s.global?function(t){var n=\"on\"+t.toLowerCase(),e=s.global[n];return!!e&&(e.apply(s.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function T(t,n){return{promise:n}}var w={promiseCreated:T,promiseFulfilled:T,promiseRejected:T,promiseResolved:T,promiseCancelled:T,promiseChained:function(t,n,e){return{promise:n,child:e}},warning:function(t,n){return{warning:n}},unhandledRejection:function(t,n,e){return{reason:n,promise:e}},rejectionHandled:T},C=function(t){var n=!1;try{n=b.apply(null,arguments)}catch(t){a.throwLater(t),n=!0}var e=!1;try{e=E(t,w[t].apply(null,arguments))}catch(t){a.throwLater(t),e=!0}return e||n};function R(){return!1}function S(t,n,e){var r=this;try{t(n,e,function(t){if(\"function\"!=typeof t)throw new TypeError(\"onCancel must be a function, got: \"+s.toString(t));r._attachCancellationCallback(t)})}catch(t){return t}}function j(t){if(!this._isCancellable())return this;var n=this._onCancel();void 0!==n?s.isArray(n)?n.push(t):this._setOnCancel([n,t]):this._setOnCancel(t)}function U(){return this._onCancelField}function F(t){this._onCancelField=t}function N(){this._cancellationParent=void 0,this._onCancelField=void 0}function L(t,n){if(0!=(1&n)){this._cancellationParent=t;var e=t._branchesRemainingToCancel;void 0===e&&(e=0),t._branchesRemainingToCancel=e+1}0!=(2&n)&&t._isBound()&&this._setBoundTo(t._boundTo)}t.config=function(n){if(\"longStackTraces\"in(n=Object(n))&&(n.longStackTraces?t.longStackTraces():!n.longStackTraces&&t.hasLongStackTraces()&&k()),\"warnings\"in n){var e=n.warnings;X.warnings=!!e,y=X.warnings,s.isObject(e)&&\"wForgottenReturn\"in e&&(y=!!e.wForgottenReturn)}if(\"cancellation\"in n&&n.cancellation&&!X.cancellation){if(a.haveItemsQueued())throw new Error(\"cannot enable cancellation after promises are in use\");t.prototype._clearCancellationData=N,t.prototype._propagateFrom=L,t.prototype._onCancel=U,t.prototype._setOnCancel=F,t.prototype._attachCancellationCallback=j,t.prototype._execute=S,B=L,X.cancellation=!0}return\"monitoring\"in n&&(n.monitoring&&!X.monitoring?(X.monitoring=!0,t.prototype._fireEvent=C):!n.monitoring&&X.monitoring&&(X.monitoring=!1,t.prototype._fireEvent=R)),t},t.prototype._fireEvent=R,t.prototype._execute=function(t,n,e){try{t(n,e)}catch(t){return t}},t.prototype._onCancel=function(){},t.prototype._setOnCancel=function(t){},t.prototype._attachCancellationCallback=function(t){},t.prototype._captureStackTrace=function(){},t.prototype._attachExtraTrace=function(){},t.prototype._clearCancellationData=function(){},t.prototype._propagateFrom=function(t,n){};var B=function(t,n){0!=(2&n)&&t._isBound()&&this._setBoundTo(t._boundTo)};function I(){var n=this._boundTo;return void 0!==n&&n instanceof t?n.isFulfilled()?n.value():void 0:n}function x(){this._trace=new V(this._peekContext())}function D(t,n){if(l(t)){var e=this._trace;if(void 0!==e&&n&&(e=e._parent),void 0!==e)e.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=G(t);s.notEnumerableProp(t,\"stack\",r.message+\"\\n\"+r.stack.join(\"\\n\")),s.notEnumerableProp(t,\"__stackCleaned__\",!0)}}}function O(n,e,r){if(X.warnings){var o,i=new c(n);if(e)r._attachExtraTrace(i);else if(X.longStackTraces&&(o=t._peekContext()))o.attachExtraTrace(i);else{var a=G(i);i.stack=a.message+\"\\n\"+a.stack.join(\"\\n\")}C(\"warning\",i)||P(i,\"\",!0)}}function A(t){for(var n=[],e=0;e<t.length;++e){var r=t[e],o=\"    (No stack trace)\"===r||p.test(r),i=o&&$(r);o&&!i&&(_&&\" \"!==r.charAt(0)&&(r=\"    \"+r),n.push(r))}return n}function G(t){var n=t.stack,e=t.toString();return n=\"string\"==typeof n&&n.length>0?function(t){for(var n=t.stack.replace(/\\s+$/g,\"\").split(\"\\n\"),e=0;e<n.length;++e){var r=n[e];if(\"    (No stack trace)\"===r||p.test(r))break}return e>0&&\"SyntaxError\"!=t.name&&(n=n.slice(e)),n}(t):[\"    (No stack trace)\"],{message:e,stack:\"SyntaxError\"==t.name?n:A(n)}}function P(t,n,e){if(\"undefined\"!=typeof console){var r;if(s.isObject(t)){var i=t.stack;r=n+h(i,t)}else r=n+String(t);\"function\"==typeof o?o(r,e):\"function\"!=typeof console.log&&\"object\"!=typeof console.log||console.log(r)}}function H(t,n,e,r){var o=!1;try{\"function\"==typeof n&&(o=!0,\"rejectionHandled\"===t?n(r):n(e,r))}catch(t){a.throwLater(t)}\"unhandledRejection\"===t?C(t,e,r)||o||P(e,\"Unhandled rejection \"):C(t,r)}function q(t){var n;if(\"function\"==typeof t)n=\"[function \"+(t.name||\"anonymous\")+\"]\";else{n=t&&\"function\"==typeof t.toString?t.toString():s.toString(t);if(/\\[object [a-zA-Z0-9$_]+\\]/.test(n))try{n=JSON.stringify(t)}catch(t){}0===n.length&&(n=\"(empty array)\")}return\"(<\"+function(t){if(t.length<41)return t;return t.substr(0,38)+\"...\"}(n)+\">, no stack trace)\"}function W(){return\"function\"==typeof K}var $=function(){return!1},M=/[\\/<\\(]([^:\\/]+):(\\d+):(?:\\d+)\\)?\\s*$/;function Q(t){var n=t.match(M);if(n)return{fileName:n[1],line:parseInt(n[2],10)}}function V(t){this._parent=t,this._promisesCreated=0;var n=this._length=1+(void 0===t?0:t._length);K(this,V),n>32&&this.uncycle()}s.inherits(V,Error),n.CapturedTrace=V,V.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var n=[],e={},r=0,o=this;void 0!==o;++r)n.push(o),o=o._parent;for(r=(t=this._length=r)-1;r>=0;--r){var i=n[r].stack;void 0===e[i]&&(e[i]=r)}for(r=0;r<t;++r){var a=e[n[r].stack];if(void 0!==a&&a!==r){a>0&&(n[a-1]._parent=void 0,n[a-1]._length=1),n[r]._parent=void 0,n[r]._length=1;var c=r>0?n[r-1]:this;a<t-1?(c._parent=n[a+1],c._parent.uncycle(),c._length=c._parent._length+1):(c._parent=void 0,c._length=1);for(var s=c._length+1,l=r-2;l>=0;--l)n[l]._length=s,s++;return}}}},V.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var n=G(t),e=n.message,r=[n.stack],o=this;void 0!==o;)r.push(A(o.stack.split(\"\\n\"))),o=o._parent;!function(t){for(var n=t[0],e=1;e<t.length;++e){for(var r=t[e],o=n.length-1,i=n[o],a=-1,c=r.length-1;c>=0;--c)if(r[c]===i){a=c;break}for(c=a;c>=0;--c){var s=r[c];if(n[o]!==s)break;n.pop(),o--}n=r}}(r),function(t){for(var n=0;n<t.length;++n)(0===t[n].length||n+1<t.length&&t[n][0]===t[n+1][0])&&(t.splice(n,1),n--)}(r),s.notEnumerableProp(t,\"stack\",function(t,n){for(var e=0;e<n.length-1;++e)n[e].push(\"From previous event:\"),n[e]=n[e].join(\"\\n\");return e<n.length&&(n[e]=n[e].join(\"\\n\")),t+\"\\n\"+n.join(\"\\n\")}(e,r)),s.notEnumerableProp(t,\"__stackCleaned__\",!0)}};var K=function(){var t=/^\\s*at\\s*/,n=function(t,n){return\"string\"==typeof t?t:void 0!==n.name&&void 0!==n.message?n.toString():q(n)};if(\"number\"==typeof Error.stackTraceLimit&&\"function\"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,p=t,h=n;var e=Error.captureStackTrace;return $=function(t){return u.test(t)},function(t,n){Error.stackTraceLimit+=6,e(t,n),Error.stackTraceLimit-=6}}var r,o=new Error;if(\"string\"==typeof o.stack&&o.stack.split(\"\\n\")[0].indexOf(\"stackDetection@\")>=0)return p=/@/,h=n,_=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){r=\"stack\"in t}return\"stack\"in o||!r||\"number\"!=typeof Error.stackTraceLimit?(h=function(t,n){return\"string\"==typeof t?t:\"object\"!=typeof n&&\"function\"!=typeof n||void 0===n.name||void 0===n.message?q(n):n.toString()},null):(p=t,h=n,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(n){t.stack=n.stack}Error.stackTraceLimit-=6})}();\"undefined\"!=typeof console&&void 0!==console.warn&&(o=function(t){console.warn(t)},s.isNode&&process.stderr.isTTY?o=function(t,n){var e=n?\"\u001b[33m\":\"\u001b[31m\";console.warn(e+t+\"\u001b[0m\\n\")}:s.isNode||\"string\"!=typeof(new Error).stack||(o=function(t,n){console.warn(\"%c\"+t,n?\"color: darkorange\":\"color: red\")}));var X={warnings:g,longStackTraces:!1,cancellation:!1,monitoring:!1};return m&&t.longStackTraces(),{longStackTraces:function(){return X.longStackTraces},warnings:function(){return X.warnings},cancellation:function(){return X.cancellation},monitoring:function(){return X.monitoring},propagateFromFunction:function(){return B},boundValueFunction:function(){return I},checkForgottenReturns:function(t,n,e,r,o){if(void 0===t&&null!==n&&y){if(void 0!==o&&o._returnedNonUndefined())return;if(0==(65535&r._bitField))return;e&&(e+=\" \");var i=\"\",a=\"\";if(n._trace){for(var c=n._trace.stack.split(\"\\n\"),s=A(c),l=s.length-1;l>=0;--l){var u=s[l];if(!f.test(u)){var p=u.match(d);p&&(i=\"at \"+p[1]+\":\"+p[2]+\":\"+p[3]+\" \");break}}if(s.length>0){var h=s[0];for(l=0;l<c.length;++l)if(c[l]===h){l>0&&(a=\"\\n\"+c[l-1]);break}}}var _=\"a promise was created in a \"+e+\"handler \"+i+\"but was not returned from it, see http://goo.gl/rRqMUw\"+a;r._warn(_,!0,n)}},setBounds:function(t,n){if(W()){for(var e,r,o=t.stack.split(\"\\n\"),i=n.stack.split(\"\\n\"),a=-1,c=-1,s=0;s<o.length;++s)if(l=Q(o[s])){e=l.fileName,a=l.line;break}for(s=0;s<i.length;++s){var l;if(l=Q(i[s])){r=l.fileName,c=l.line;break}}a<0||c<0||!e||!r||e!==r||a>=c||($=function(t){if(u.test(t))return!0;var n=Q(t);return!!(n&&n.fileName===e&&a<=n.line&&n.line<=c)})}},warn:O,deprecated:function(t,n){var e=t+\" is deprecated and will be removed in a future version.\";return n&&(e+=\" Use \"+n+\" instead.\"),O(e)},CapturedTrace:V,fireDomEvent:E,fireGlobalEvent:b}};","node_modules/bluebird/js/release/finally.js":"\"use strict\";module.exports=function(t,e,n){var r=require(\"./util\"),i=t.CancellationError,a=r.errorObj,l=require(\"./catch_filter\")(n);function o(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function s(t){this.finallyHandler=t}function c(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function h(){return p.call(this,this.promise._target()._settledValue())}function u(t){if(!c(this,t))return a.e=t,a}function p(r){var l=this.promise,o=this.handler;if(!this.called){this.called=!0;var p=this.isFinallyHandler()?o.call(l._boundValue()):o.call(l._boundValue(),r);if(p===n)return p;if(void 0!==p){l._setReturnedNonUndefined();var f=e(p,l);if(f instanceof t){if(null!=this.cancelPromise){if(f._isCancelled()){var d=new i(\"late cancellation observer\");return l._attachExtraTrace(d),a.e=d,a}f.isPending()&&f._attachCancellationCallback(new s(this))}return f._then(h,u,void 0,this,void 0)}}}return l.isRejected()?(c(this),a.e=r,a):(c(this),r)}return o.prototype.isFinallyHandler=function(){return 0===this.type},s.prototype._resultCancelled=function(){c(this.finallyHandler)},t.prototype._passThrough=function(t,e,n,r){return\"function\"!=typeof t?this.then():this._then(n,r,void 0,new o(this,e,t),void 0)},t.prototype.lastly=t.prototype.finally=function(t){return this._passThrough(t,0,p,p)},t.prototype.tap=function(t){return this._passThrough(t,1,p)},t.prototype.tapCatch=function(e){var n=arguments.length;if(1===n)return this._passThrough(e,1,void 0,p);var i,a=new Array(n-1),o=0;for(i=0;i<n-1;++i){var s=arguments[i];if(!r.isObject(s))return t.reject(new TypeError(\"tapCatch statement predicate: expecting an object but got \"+r.classString(s)));a[o++]=s}a.length=o;var c=arguments[i];return this._passThrough(l(a,c,this),1,void 0,p)},o};","node_modules/bluebird/js/release/catch_filter.js":"\"use strict\";module.exports=function(r){var e=require(\"./util\"),t=require(\"./es5\").keys,n=e.tryCatch,u=e.errorObj;return function(i,o,l){return function(f){var a=l._boundValue();r:for(var c=0;c<i.length;++c){var s=i[c];if(s===Error||null!=s&&s.prototype instanceof Error){if(f instanceof s)return n(o).call(a,f)}else if(\"function\"==typeof s){var v=n(s).call(a,f);if(v===u)return v;if(v)return n(o).call(a,f)}else if(e.isObject(f)){for(var p=t(s),y=0;y<p.length;++y){var b=p[y];if(s[b]!=f[b])continue r}return n(o).call(a,f)}}return r}}};","node_modules/bluebird/js/release/nodeback.js":"\"use strict\";var util=require(\"./util\"),maybeWrapAsError=util.maybeWrapAsError,errors=require(\"./errors\"),OperationalError=errors.OperationalError,es5=require(\"./es5\");function isUntypedError(r){return r instanceof Error&&es5.getPrototypeOf(r)===Error.prototype}var rErrorKey=/^(?:name|message|stack|cause)$/;function wrapAsOperationalError(r){var e;if(isUntypedError(r)){(e=new OperationalError(r)).name=r.name,e.message=r.message,e.stack=r.stack;for(var a=es5.keys(r),o=0;o<a.length;++o){var t=a[o];rErrorKey.test(t)||(e[t]=r[t])}return e}return util.markAsOriginatingFromRejection(r),r}function nodebackForPromise(r,e){return function(a,o){if(null!==r){if(a){var t=wrapAsOperationalError(maybeWrapAsError(a));r._attachExtraTrace(t),r._reject(t)}else if(e){for(var n=arguments.length,s=new Array(Math.max(n-1,0)),i=1;i<n;++i)s[i-1]=arguments[i];r._fulfill(s)}else r._fulfill(o);r=null}}}module.exports=nodebackForPromise;","node_modules/bluebird/js/release/method.js":"\"use strict\";module.exports=function(t,e,r,n,o){var c=require(\"./util\"),a=c.tryCatch;t.method=function(r){if(\"function\"!=typeof r)throw new t.TypeError(\"expecting a function but got \"+c.classString(r));return function(){var n=new t(e);n._captureStackTrace(),n._pushContext();var c=a(r).apply(this,arguments),u=n._popContext();return o.checkForgottenReturns(c,u,\"Promise.method\",n),n._resolveFromSyncValue(c),n}},t.attempt=t.try=function(r){if(\"function\"!=typeof r)return n(\"expecting a function but got \"+c.classString(r));var u,i=new t(e);if(i._captureStackTrace(),i._pushContext(),arguments.length>1){o.deprecated(\"calling Promise.try with more than 1 argument\");var l=arguments[1],s=arguments[2];u=c.isArray(l)?a(r).apply(s,l):a(r).call(s,l)}else u=a(r)();var p=i._popContext();return o.checkForgottenReturns(u,p,\"Promise.try\",i),i._resolveFromSyncValue(u),i},t.prototype._resolveFromSyncValue=function(t){t===c.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}};","node_modules/bluebird/js/release/bind.js":"\"use strict\";module.exports=function(t,e,i,o){var n=!1,r=function(t,e){this._reject(e)},s=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(r,r,null,this,t)},u=function(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)},d=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(r){n||(n=!0,t.prototype._propagateFrom=o.propagateFromFunction(),t.prototype._boundValue=o.boundValueFunction());var _=i(r),a=new t(e);a._propagateFrom(this,1);var c=this._target();if(a._setBoundTo(_),_ instanceof t){var p={promiseRejectionQueued:!1,promise:a,target:c,bindingPromise:_};c._then(e,s,void 0,a,p),_._then(u,d,void 0,a,p),a._setOnCancel(_)}else a._resolveCallback(c);return a},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},t.bind=function(e,i){return t.resolve(i).bind(e)}};","node_modules/bluebird/js/release/cancel.js":"\"use strict\";module.exports=function(e,n,t,i){var l=require(\"./util\"),a=l.tryCatch,c=l.errorObj,o=e._async;e.prototype.break=e.prototype.cancel=function(){if(!i.cancellation())return this._warn(\"cancellation is disabled\");for(var e=this,n=e;e._isCancellable();){if(!e._cancelBy(n)){n._isFollowing()?n._followee().cancel():n._cancelBranched();break}var t=e._cancellationParent;if(null==t||!t._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),n=e,e=t}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),o.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(e,n){if(l.isArray(e))for(var t=0;t<e.length;++t)this._doInvokeOnCancel(e[t],n);else if(void 0!==e)if(\"function\"==typeof e){if(!n){var i=a(e).call(this._boundValue());i===c&&(this._attachExtraTrace(i.e),o.throwLater(i.e))}}else e._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),o.invoke(this._doInvokeOnCancel,this,e)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}};","node_modules/bluebird/js/release/direct_resolve.js":"\"use strict\";module.exports=function(t){function n(){return this.value}function e(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(e){return e instanceof t&&e.suppressUnhandledRejections(),this._then(n,void 0,void 0,{value:e},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(e,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,e,void 0,{reason:t},void 0);var n=arguments[1];return this.caught(t,function(){throw n})},t.prototype.catchReturn=function(e){if(arguments.length<=1)return e instanceof t&&e.suppressUnhandledRejections(),this._then(void 0,n,void 0,{value:e},void 0);var o=arguments[1];o instanceof t&&o.suppressUnhandledRejections();return this.caught(e,function(){return o})}};","node_modules/bluebird/js/release/synchronous_inspection.js":"\"use strict\";module.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var i=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError(\"cannot get fulfillment value of a non-fulfilled promise\\n\\n    See http://goo.gl/MqrFmX\\n\");return this._settledValue()},n=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError(\"cannot get rejection reason of a non-rejected promise\\n\\n    See http://goo.gl/MqrFmX\\n\");return this._settledValue()},o=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},r=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},l=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},s=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return l.call(this._target())},t.prototype.isRejected=function(){return r.call(this._target())},t.prototype.isFulfilled=function(){return o.call(this._target())},t.prototype.isResolved=function(){return s.call(this._target())},t.prototype.value=function(){return i.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),n.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e};","node_modules/bluebird/js/release/join.js":"\"use strict\";module.exports=function(e,n,r,t,o,i){var a,s=require(\"./util\"),c=s.canEvaluate,l=s.tryCatch,u=s.errorObj;if(c){for(var p=function(e){return new Function(\"value\",\"holder\",\"                             \\n            'use strict';                                                    \\n            holder.pIndex = value;                                           \\n            holder.checkFulfillment(this);                                   \\n            \".replace(/Index/g,e))},h=function(e){return new Function(\"promise\",\"holder\",\"                           \\n            'use strict';                                                    \\n            holder.pIndex = promise;                                         \\n            \".replace(/Index/g,e))},f=function(n){for(var r=new Array(n),t=0;t<r.length;++t)r[t]=\"this.p\"+(t+1);var i=r.join(\" = \")+\" = null;\",a=\"var promise;\\n\"+r.map(function(e){return\"                                                         \\n                promise = \"+e+\";                                      \\n                if (promise instanceof Promise) {                            \\n                    promise.cancel();                                        \\n                }                                                            \\n            \"}).join(\"\\n\"),s=r.join(\", \"),c=\"Holder$\"+n,p=\"return function(tryCatch, errorObj, Promise, async) {    \\n            'use strict';                                                    \\n            function [TheName](fn) {                                         \\n                [TheProperties]                                              \\n                this.fn = fn;                                                \\n                this.asyncNeeded = true;                                     \\n                this.now = 0;                                                \\n            }                                                                \\n                                                                             \\n            [TheName].prototype._callFunction = function(promise) {          \\n                promise._pushContext();                                      \\n                var ret = tryCatch(this.fn)([ThePassedArguments]);           \\n                promise._popContext();                                       \\n                if (ret === errorObj) {                                      \\n                    promise._rejectCallback(ret.e, false);                   \\n                } else {                                                     \\n                    promise._resolveCallback(ret);                           \\n                }                                                            \\n            };                                                               \\n                                                                             \\n            [TheName].prototype.checkFulfillment = function(promise) {       \\n                var now = ++this.now;                                        \\n                if (now === [TheTotal]) {                                    \\n                    if (this.asyncNeeded) {                                  \\n                        async.invoke(this._callFunction, this, promise);     \\n                    } else {                                                 \\n                        this._callFunction(promise);                         \\n                    }                                                        \\n                                                                             \\n                }                                                            \\n            };                                                               \\n                                                                             \\n            [TheName].prototype._resultCancelled = function() {              \\n                [CancellationCode]                                           \\n            };                                                               \\n                                                                             \\n            return [TheName];                                                \\n        }(tryCatch, errorObj, Promise, async);                               \\n        \";return p=p.replace(/\\[TheName\\]/g,c).replace(/\\[TheTotal\\]/g,n).replace(/\\[ThePassedArguments\\]/g,s).replace(/\\[TheProperties\\]/g,i).replace(/\\[CancellationCode\\]/g,a),new Function(\"tryCatch\",\"errorObj\",\"Promise\",\"async\",p)(l,u,e,o)},d=[],m=[],v=[],y=0;y<8;++y)d.push(f(y+1)),m.push(p(y+1)),v.push(h(y+1));a=function(e){this._reject(e)}}e.join=function(){var o,l=arguments.length-1;if(l>0&&\"function\"==typeof arguments[l]&&(o=arguments[l],l<=8&&c)){(j=new e(t))._captureStackTrace();for(var u=new(0,d[l-1])(o),p=m,h=0;h<l;++h){var f=r(arguments[h],j);if(f instanceof e){var y=(f=f._target())._bitField;0==(50397184&y)?(f._then(p[h],a,void 0,j,u),v[h](f,u),u.asyncNeeded=!1):0!=(33554432&y)?p[h].call(j,f._value(),u):0!=(16777216&y)?j._reject(f._reason()):j._cancel()}else p[h].call(j,f,u)}if(!j._isFateSealed()){if(u.asyncNeeded){var _=i();null!==_&&(u.fn=s.domainBind(_,u.fn))}j._setAsyncGuaranteed(),j._setOnCancel(u)}return j}for(var C=arguments.length,T=new Array(C),g=0;g<C;++g)T[g]=arguments[g];o&&T.pop();var j=new n(T).promise();return void 0!==o?j.spread(o):j}};","node_modules/bluebird/js/release/map.js":"\"use strict\";module.exports=function(t,e,i,r,n,s){var o=t._getDomain,u=require(\"./util\"),l=u.tryCatch,c=u.errorObj,h=t._async;function a(t,e,i,r){this.constructor$(t),this._promise._captureStackTrace();var s=o();this._callback=null===s?e:u.domainBind(s,e),this._preservedValues=r===n?new Array(this.length()):null,this._limit=i,this._inFlight=0,this._queue=[],h.invoke(this._asyncInit,this,void 0)}function _(e,r,n,s){if(\"function\"!=typeof r)return i(\"expecting a function but got \"+u.classString(r));var o=0;if(void 0!==n){if(\"object\"!=typeof n||null===n)return t.reject(new TypeError(\"options argument must be an object but it is \"+u.classString(n)));if(\"number\"!=typeof n.concurrency)return t.reject(new TypeError(\"'concurrency' must be a number but it is \"+u.classString(n.concurrency)));o=n.concurrency}return new a(e,r,o=\"number\"==typeof o&&isFinite(o)&&o>=1?o:0,s).promise()}u.inherits(a,e),a.prototype._asyncInit=function(){this._init$(void 0,-2)},a.prototype._init=function(){},a.prototype._promiseFulfilled=function(e,i){var n=this._values,o=this.length(),u=this._preservedValues,h=this._limit;if(i<0){if(n[i=-1*i-1]=e,h>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(h>=1&&this._inFlight>=h)return n[i]=e,this._queue.push(i),!1;null!==u&&(u[i]=e);var a=this._promise,_=this._callback,p=a._boundValue();a._pushContext();var f=l(_).call(p,e,i,o),v=a._popContext();if(s.checkForgottenReturns(f,v,null!==u?\"Promise.filter\":\"Promise.map\",a),f===c)return this._reject(f.e),!0;var y=r(f,this._promise);if(y instanceof t){var m=(y=y._target())._bitField;if(0==(50397184&m))return h>=1&&this._inFlight++,n[i]=y,y._proxy(this,-1*(i+1)),!1;if(0==(33554432&m))return 0!=(16777216&m)?(this._reject(y._reason()),!0):(this._cancel(),!0);f=y._value()}n[i]=f}return++this._totalResolved>=o&&(null!==u?this._filter(n,u):this._resolve(n),!0)},a.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,i=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(i[r],r)}},a.prototype._filter=function(t,e){for(var i=e.length,r=new Array(i),n=0,s=0;s<i;++s)t[s]&&(r[n++]=e[s]);r.length=n,this._resolve(r)},a.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(t,e){return _(this,t,e,null)},t.map=function(t,e,i,r){return _(t,e,i,r)}};","node_modules/bluebird/js/release/call_get.js":"\"use strict\";var cr=Object.create;if(cr){var callerCache=cr(null),getterCache=cr(null);callerCache[\" size\"]=getterCache[\" size\"]=0}module.exports=function(e){var t,n,r=require(\"./util\"),i=r.canEvaluate,o=r.isIdentifier,u=function(e){return new Function(\"ensureMethod\",\"                                    \\n        return function(obj) {                                               \\n            'use strict'                                                     \\n            var len = this.length;                                           \\n            ensureMethod(obj, 'methodName');                                 \\n            switch(len) {                                                    \\n                case 1: return obj.methodName(this[0]);                      \\n                case 2: return obj.methodName(this[0], this[1]);             \\n                case 3: return obj.methodName(this[0], this[1], this[2]);    \\n                case 0: return obj.methodName();                             \\n                default:                                                     \\n                    return obj.methodName.apply(obj, this);                  \\n            }                                                                \\n        };                                                                   \\n        \".replace(/methodName/g,e))(h)},a=function(e){return new Function(\"obj\",\"                                             \\n        'use strict';                                                        \\n        return obj.propertyName;                                             \\n        \".replace(\"propertyName\",e))},c=function(e,t,n){var r=n[e];if(\"function\"!=typeof r){if(!o(e))return null;if(r=t(e),n[e]=r,n[\" size\"]++,n[\" size\"]>512){for(var i=Object.keys(n),u=0;u<256;++u)delete n[i[u]];n[\" size\"]=i.length-256}}return r};function h(t,n){var i;if(null!=t&&(i=t[n]),\"function\"!=typeof i){var o=\"Object \"+r.classString(t)+\" has no method '\"+r.toString(n)+\"'\";throw new e.TypeError(o)}return i}function s(e){return h(e,this.pop()).apply(e,this)}function l(e){return e[this]}function f(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}t=function(e){return c(e,u,callerCache)},n=function(e){return c(e,a,getterCache)},e.prototype.call=function(e){for(var n=arguments.length,r=new Array(Math.max(n-1,0)),o=1;o<n;++o)r[o-1]=arguments[o];if(i){var u=t(e);if(null!==u)return this._then(u,void 0,void 0,r,void 0)}return r.push(e),this._then(s,void 0,void 0,r,void 0)},e.prototype.get=function(e){var t;if(\"number\"==typeof e)t=f;else if(i){var r=n(e);t=null!==r?r:l}else t=l;return this._then(t,void 0,void 0,e,void 0)}};","node_modules/bluebird/js/release/using.js":"\"use strict\";module.exports=function(t,e,i,r,s,n){var o=require(\"./util\"),u=require(\"./errors\").TypeError,p=require(\"./util\").inherits,l=o.errorObj,a=o.tryCatch,c={};function f(t){setTimeout(function(){throw t},0)}function h(e,r){var n=0,o=e.length,u=new t(s);return function s(){if(n>=o)return u._fulfill();var p=function(t){var e=i(t);return e!==t&&\"function\"==typeof t._isDisposable&&\"function\"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}(e[n++]);if(p instanceof t&&p._isDisposable()){try{p=i(p._getDisposer().tryDispose(r),e.promise)}catch(t){return f(t)}if(p instanceof t)return p._then(s,f,null,null,null)}s()}(),u}function _(t,e,i){this._data=t,this._promise=e,this._context=i}function v(t,e,i){this.constructor$(t,e,i)}function d(t){return _.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function y(t){this.length=t,this.promise=null,this[t-1]=null}_.prototype.data=function(){return this._data},_.prototype.promise=function(){return this._promise},_.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():c},_.prototype.tryDispose=function(t){var e=this.resource(),i=this._context;void 0!==i&&i._pushContext();var r=e!==c?this.doDispose(e,t):null;return void 0!==i&&i._popContext(),this._promise._unsetDisposable(),this._data=null,r},_.isDisposer=function(t){return null!=t&&\"function\"==typeof t.resource&&\"function\"==typeof t.tryDispose},p(v,_),v.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},y.prototype._resultCancelled=function(){for(var e=this.length,i=0;i<e;++i){var r=this[i];r instanceof t&&r.cancel()}},t.using=function(){var r=arguments.length;if(r<2)return e(\"you must pass at least 2 arguments to Promise.using\");var s,u=arguments[r-1];if(\"function\"!=typeof u)return e(\"expecting a function but got \"+o.classString(u));var p=!0;2===r&&Array.isArray(arguments[0])?(r=(s=arguments[0]).length,p=!1):(s=arguments,r--);for(var c=new y(r),f=0;f<r;++f){var v=s[f];if(_.isDisposer(v)){var D=v;(v=v.promise())._setDisposable(D)}else{var g=i(v);g instanceof t&&(v=g._then(d,null,null,{resources:c,index:f},void 0))}c[f]=v}var m=new Array(c.length);for(f=0;f<m.length;++f)m[f]=t.resolve(c[f]).reflect();var b=t.all(m).then(function(t){for(var e=0;e<t.length;++e){var i=t[e];if(i.isRejected())return l.e=i.error(),l;if(!i.isFulfilled())return void b.cancel();t[e]=i.value()}x._pushContext(),u=a(u);var r=p?u.apply(void 0,t):u(t),s=x._popContext();return n.checkForgottenReturns(r,s,\"Promise.using\",x),r}),x=b.lastly(function(){var e=new t.PromiseInspection(b);return h(c,e)});return c.promise=x,x._setOnCancel(c),x},t.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},t.prototype.disposer=function(t){if(\"function\"==typeof t)return new v(t,this,r());throw new u}};","node_modules/bluebird/js/release/timers.js":"\"use strict\";module.exports=function(t,n,e){var i=require(\"./util\"),o=t.TimeoutError;function r(t){this.handle=t}r.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(t){return c(+this).thenReturn(t)},c=t.delay=function(i,o){var c,u;return void 0!==o?(c=t.resolve(o)._then(a,null,null,i,void 0),e.cancellation()&&o instanceof t&&c._setOnCancel(o)):(c=new t(n),u=setTimeout(function(){c._fulfill()},+i),e.cancellation()&&c._setOnCancel(new r(u)),c._captureStackTrace()),c._setAsyncGuaranteed(),c};t.prototype.delay=function(t){return c(t,this)};function u(t){return clearTimeout(this.handle),t}function l(t){throw clearTimeout(this.handle),t}t.prototype.timeout=function(t,n){var a,c;t=+t;var s=new r(setTimeout(function(){a.isPending()&&function(t,n,e){var r;r=\"string\"!=typeof n?n instanceof Error?n:new o(\"operation timed out\"):new o(n),i.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._reject(r),null!=e&&e.cancel()}(a,n,c)},t));return e.cancellation()?(c=this.then(),(a=c._then(u,l,void 0,s,void 0))._setOnCancel(s)):a=this._then(u,l,void 0,s,void 0),a}};","node_modules/bluebird/js/release/generators.js":"\"use strict\";module.exports=function(e,t,i,n,r,o){var s=require(\"./errors\").TypeError,l=require(\"./util\"),a=l.errorObj,c=l.tryCatch,_=[];function u(t,n,r,s){if(o.cancellation()){var l=new e(i),a=this._finallyPromise=new e(i);this._promise=l.lastly(function(){return a}),l._captureStackTrace(),l._setOnCancel(this)}else{(this._promise=new e(i))._captureStackTrace()}this._stack=s,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers=\"function\"==typeof r?[r].concat(_):_,this._yieldedPromise=null,this._cancellationPhase=!1}l.inherits(u,r),u.prototype._isResolved=function(){return null===this._promise},u.prototype._cleanup=function(){this._promise=this._generator=null,o.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},u.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=c(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var i=new e.CancellationError(\"generator .return() sentinel\");e.coroutine.returnSentinel=i,this._promise._attachExtraTrace(i),this._promise._pushContext(),t=c(this._generator.throw).call(this._generator,i),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},u.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=c(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},u.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=c(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},u.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},u.prototype.promise=function(){return this._promise},u.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},u.prototype._continue=function(t){var i=this._promise;if(t===a)return this._cleanup(),this._cancellationPhase?i.cancel():i._rejectCallback(t.e,!1);var r=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?i.cancel():i._resolveCallback(r);var o=n(r,this._promise);if(o instanceof e||null!==(o=function(t,i,r){for(var o=0;o<i.length;++o){r._pushContext();var s=c(i[o])(t);if(r._popContext(),s===a){r._pushContext();var l=e.reject(a.e);return r._popContext(),l}var _=n(s,r);if(_ instanceof e)return _}return null}(o,this._yieldHandlers,this._promise))){var l=(o=o._target())._bitField;0==(50397184&l)?(this._yieldedPromise=o,o._proxy(this,null)):0!=(33554432&l)?e._async.invoke(this._promiseFulfilled,this,o._value()):0!=(16777216&l)?e._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()}else this._promiseRejected(new s(\"A value %s was yielded that could not be treated as a promise\\n\\n    See http://goo.gl/MqrFmX\\n\\n\".replace(\"%s\",String(r))+\"From coroutine:\\n\"+this._stack.split(\"\\n\").slice(1,-7).join(\"\\n\")))},e.coroutine=function(e,t){if(\"function\"!=typeof e)throw new s(\"generatorFunction must be a function\\n\\n    See http://goo.gl/MqrFmX\\n\");var i=Object(t).yieldHandler,n=u,r=(new Error).stack;return function(){var t=e.apply(this,arguments),o=new n(void 0,void 0,i,r),s=o.promise();return o._generator=t,o._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(e){if(\"function\"!=typeof e)throw new s(\"expecting a function but got \"+l.classString(e));_.push(e)},e.spawn=function(i){if(o.deprecated(\"Promise.spawn()\",\"Promise.coroutine()\"),\"function\"!=typeof i)return t(\"generatorFunction must be a function\\n\\n    See http://goo.gl/MqrFmX\\n\");var n=new u(i,this),r=n.promise();return n._run(e.spawn),r}};","node_modules/bluebird/js/release/nodeify.js":"\"use strict\";module.exports=function(t){var r=require(\"./util\"),a=t._async,e=r.tryCatch,o=r.errorObj;function n(t,n){if(!r.isArray(t))return i.call(this,t,n);var l=e(n).apply(this._boundValue(),[null].concat(t));l===o&&a.throwLater(l.e)}function i(t,r){var n=this._boundValue(),i=void 0===t?e(r).call(n,null):e(r).call(n,null,t);i===o&&a.throwLater(i.e)}function l(t,r){if(!t){var n=new Error(t+\"\");n.cause=t,t=n}var i=e(r).call(this._boundValue(),t);i===o&&a.throwLater(i.e)}t.prototype.asCallback=t.prototype.nodeify=function(t,r){if(\"function\"==typeof t){var a=i;void 0!==r&&Object(r).spread&&(a=n),this._then(a,l,void 0,this,t)}return this}};","node_modules/bluebird/js/release/promisify.js":"\"use strict\";module.exports=function(r,e){var t={},n=require(\"./util\"),a=require(\"./nodeback\"),i=n.withAppended,o=n.maybeWrapAsError,c=n.canEvaluate,s=require(\"./errors\").TypeError,u={__isPromisified__:!0},f=new RegExp(\"^(?:\"+[\"arity\",\"length\",\"name\",\"arguments\",\"caller\",\"callee\",\"prototype\",\"__isPromisified__\"].join(\"|\")+\")$\"),l=function(r){return n.isIdentifier(r)&&\"_\"!==r.charAt(0)&&\"constructor\"!==r};function p(r){return!f.test(r)}function m(r){try{return!0===r.__isPromisified__}catch(r){return!1}}function h(r,e,t){var a=n.getDataPropertyOrDefault(r,e+t,u);return!!a&&m(a)}function g(r,e,t,a){for(var i=n.inheritedDataKeys(r),o=[],c=0;c<i.length;++c){var u=i[c],f=r[u],p=a===l||l(u,f,r);\"function\"!=typeof f||m(f)||h(r,u,e)||!a(u,f,r,p)||o.push(u,f)}return function(r,e,t){for(var n=0;n<r.length;n+=2){var a=r[n];if(t.test(a))for(var i=a.replace(t,\"\"),o=0;o<r.length;o+=2)if(r[o]===i)throw new s(\"Cannot promisify an API that has normal methods with '%s'-suffix\\n\\n    See http://goo.gl/MqrFmX\\n\".replace(\"%s\",e))}}(o,e,t),o}var v=function(r){return r.replace(/([$])/,\"\\\\$\")},d=function(r){return n.filledRange(r,\"_arg\",\"\")};var b=c?function(c,s,u,f,l,p){var m=Math.max(0,function(r){return\"number\"==typeof r.length?Math.max(Math.min(r.length,1024),0):0}(f)-1),h=function(r){for(var e=[r],t=Math.max(0,r-1-3),n=r-1;n>=t;--n)e.push(n);for(n=r+1;n<=3;++n)e.push(n);return e}(m),g=\"string\"==typeof c||s===t;var v=\"string\"==typeof c?\"this != null ? this['\"+c+\"'] : fn\":\"fn\",b=\"'use strict';                                                \\n        var ret = function (Parameters) {                                    \\n            'use strict';                                                    \\n            var len = arguments.length;                                      \\n            var promise = new Promise(INTERNAL);                             \\n            promise._captureStackTrace();                                    \\n            var nodeback = nodebackForPromise(promise, \"+p+\");   \\n            var ret;                                                         \\n            var callback = tryCatch([GetFunctionCode]);                      \\n            switch(len) {                                                    \\n                [CodeForSwitchCase]                                          \\n            }                                                                \\n            if (ret === errorObj) {                                          \\n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\\n            }                                                                \\n            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \\n            return promise;                                                  \\n        };                                                                   \\n        notEnumerableProp(ret, '__isPromisified__', true);                   \\n        return ret;                                                          \\n    \".replace(\"[CodeForSwitchCase]\",function(){for(var r,e,t,n=\"\",a=0;a<h.length;++a)n+=\"case \"+h[a]+\":\"+(r=h[a],e=d(r).join(\", \"),t=r>0?\", \":\"\",(g?\"ret = callback.call(this, {{args}}, nodeback); break;\\n\":void 0===s?\"ret = callback({{args}}, nodeback); break;\\n\":\"ret = callback.call(receiver, {{args}}, nodeback); break;\\n\").replace(\"{{args}}\",e).replace(\", \",t));return n+=\"                                                             \\n        default:                                                             \\n            var args = new Array(len + 1);                                   \\n            var i = 0;                                                       \\n            for (var i = 0; i < len; ++i) {                                  \\n               args[i] = arguments[i];                                       \\n            }                                                                \\n            args[i] = nodeback;                                              \\n            [CodeForCall]                                                    \\n            break;                                                           \\n        \".replace(\"[CodeForCall]\",g?\"ret = callback.apply(this, args);\\n\":\"ret = callback.apply(receiver, args);\\n\")}()).replace(\"[GetFunctionCode]\",v);return b=b.replace(\"Parameters\",function(r){return n.filledRange(Math.max(r,3),\"_arg\",\"\")}(m)),new Function(\"Promise\",\"fn\",\"receiver\",\"withAppended\",\"maybeWrapAsError\",\"nodebackForPromise\",\"tryCatch\",\"errorObj\",\"notEnumerableProp\",\"INTERNAL\",b)(r,f,s,i,o,a,n.tryCatch,n.errorObj,n.notEnumerableProp,e)}:function(c,s,u,f,l,p){var m=function(){return this}(),h=c;function g(){var n=s;s===t&&(n=this);var u=new r(e);u._captureStackTrace();var f=\"string\"==typeof h&&this!==m?this[h]:c,l=a(u,p);try{f.apply(n,i(arguments,l))}catch(r){u._rejectCallback(o(r),!0,!0)}return u._isFateSealed()||u._setAsyncGuaranteed(),u}return\"string\"==typeof h&&(c=f),n.notEnumerableProp(g,\"__isPromisified__\",!0),g};function y(r,e,a,i,o){for(var c=new RegExp(v(e)+\"$\"),s=g(r,e,c,a),u=0,f=s.length;u<f;u+=2){var l=s[u],p=s[u+1],m=l+e;if(i===b)r[m]=b(l,t,l,p,e,o);else{var h=i(p,function(){return b(l,t,l,p,e,o)});n.notEnumerableProp(h,\"__isPromisified__\",!0),r[m]=h}}return n.toFastProperties(r),r}r.promisify=function(r,e){if(\"function\"!=typeof r)throw new s(\"expecting a function but got \"+n.classString(r));if(m(r))return r;var a=function(r,e,t){return b(r,e,void 0,r,null,t)}(r,void 0===(e=Object(e)).context?t:e.context,!!e.multiArgs);return n.copyDescriptors(r,a,p),a},r.promisifyAll=function(r,e){if(\"function\"!=typeof r&&\"object\"!=typeof r)throw new s(\"the target of promisifyAll must be an object or a function\\n\\n    See http://goo.gl/MqrFmX\\n\");var t=!!(e=Object(e)).multiArgs,a=e.suffix;\"string\"!=typeof a&&(a=\"Async\");var i=e.filter;\"function\"!=typeof i&&(i=l);var o=e.promisifier;if(\"function\"!=typeof o&&(o=b),!n.isIdentifier(a))throw new RangeError(\"suffix must be a valid identifier\\n\\n    See http://goo.gl/MqrFmX\\n\");for(var c=n.inheritedDataKeys(r),u=0;u<c.length;++u){var f=r[c[u]];\"constructor\"!==c[u]&&n.isClass(f)&&(y(f.prototype,a,i,o,t),y(f,a,i,o,t))}return y(r,a,i,o,t)}};","node_modules/bluebird/js/release/props.js":"\"use strict\";module.exports=function(t,e,n,r){var i,o=require(\"./util\"),s=o.isObject,u=require(\"./es5\");\"function\"==typeof Map&&(i=Map);var a=function(){var t=0,e=0;function n(n,r){this[t]=n,this[t+e]=r,t++}return function(r){e=r.size,t=0;var i=new Array(2*r.size);return r.forEach(n,i),i}}();function p(t){var e,n=!1;if(void 0!==i&&t instanceof i)e=a(t),n=!0;else{var r=u.keys(t),o=r.length;e=new Array(2*o);for(var s=0;s<o;++s){var p=r[s];e[s]=t[p],e[s+o]=p}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function f(e){var i,o=n(e);return s(o)?(i=o instanceof t?o._then(t.props,void 0,void 0,void 0,void 0):new p(o).promise(),o instanceof t&&i._propagateFrom(o,2),i):r(\"cannot await properties of a non-object\\n\\n    See http://goo.gl/MqrFmX\\n\")}o.inherits(p,e),p.prototype._init=function(){},p.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){var n;if(this._isMap)n=function(t){for(var e=new i,n=t.length/2|0,r=0;r<n;++r){var o=t[n+r],s=t[r];e.set(o,s)}return e}(this._values);else{n={};for(var r=this.length(),o=0,s=this.length();o<s;++o)n[this._values[o+r]]=this._values[o]}return this._resolve(n),!0}return!1},p.prototype.shouldCopyValues=function(){return!1},p.prototype.getActualLength=function(t){return t>>1},t.prototype.props=function(){return f(this)},t.props=function(t){return f(t)}};","node_modules/bluebird/js/release/race.js":"\"use strict\";module.exports=function(r,t,n,e){var i=require(\"./util\"),o=function(r){return r.then(function(t){return u(t,r)})};function u(u,a){var c=n(u);if(c instanceof r)return o(c);if(null===(u=i.asArray(u)))return e(\"expecting an array or an iterable object but got \"+i.classString(u));var f=new r(t);void 0!==a&&f._propagateFrom(a,3);for(var l=f._fulfill,v=f._reject,s=0,d=u.length;s<d;++s){var p=u[s];(void 0!==p||s in u)&&r.cast(p)._then(l,v,void 0,f,null)}return f}r.race=function(r){return u(r,void 0)},r.prototype.race=function(){return u(this,void 0)}};","node_modules/bluebird/js/release/reduce.js":"\"use strict\";module.exports=function(t,e,i,n,a,l){var s=t._getDomain,o=require(\"./util\"),r=o.tryCatch;function u(e,i,n,l){this.constructor$(e);var r=s();this._fn=null===r?i:o.domainBind(r,i),void 0!==n&&(n=t.resolve(n))._attachCancellationCallback(this),this._initialValue=n,this._currentCancellable=null,this._eachValues=l===a?Array(this._length):0===l?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function c(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function h(t,e,n,a){return\"function\"!=typeof e?i(\"expecting a function but got \"+o.classString(e)):new u(t,e,n,a).promise()}function _(e){this.accum=e,this.array._gotAccum(e);var i=n(this.value,this.array._promise);return i instanceof t?(this.array._currentCancellable=i,i._then(v,void 0,void 0,this,void 0)):v.call(this,i)}function v(e){var i,n=this.array,a=n._promise,s=r(n._fn);a._pushContext(),(i=void 0!==n._eachValues?s.call(a._boundValue(),e,this.index,this.length):s.call(a._boundValue(),this.accum,e,this.index,this.length))instanceof t&&(n._currentCancellable=i);var o=a._popContext();return l.checkForgottenReturns(i,o,void 0!==n._eachValues?\"Promise.each\":\"Promise.reduce\",a),i}o.inherits(u,e),u.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==a&&this._eachValues.push(t)},u.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},u.prototype._resultCancelled=function(e){if(e===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel())},u.prototype._iterate=function(e){var i,n;this._values=e;var a=e.length;if(void 0!==this._initialValue?(i=this._initialValue,n=0):(i=t.resolve(e[0]),n=1),this._currentCancellable=i,!i.isRejected())for(;n<a;++n){var l={accum:null,value:e[n],index:n,length:a,array:this};i=i._then(_,void 0,void 0,l,void 0)}void 0!==this._eachValues&&(i=i._then(this._eachComplete,void 0,void 0,this,void 0)),i._then(c,c,void 0,i,this)},t.prototype.reduce=function(t,e){return h(this,t,e,null)},t.reduce=function(t,e,i,n){return h(t,e,i,n)}};","node_modules/bluebird/js/release/settle.js":"\"use strict\";module.exports=function(e,t,i){var s=e.PromiseInspection;function r(e){this.constructor$(e)}require(\"./util\").inherits(r,t),r.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},r.prototype._promiseFulfilled=function(e,t){var i=new s;return i._bitField=33554432,i._settledValueField=e,this._promiseResolved(t,i)},r.prototype._promiseRejected=function(e,t){var i=new s;return i._bitField=16777216,i._settledValueField=e,this._promiseResolved(t,i)},e.settle=function(e){return i.deprecated(\".settle()\",\".reflect()\"),new r(e).promise()},e.prototype.settle=function(){return e.settle(this)}};","node_modules/bluebird/js/release/some.js":"\"use strict\";module.exports=function(t,e,i){var n=require(\"./util\"),r=require(\"./errors\").RangeError,s=require(\"./errors\").AggregateError,o=n.isArray,h={};function u(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function l(t,e){if((0|e)!==e||e<0)return i(\"expecting a positive integer\\n\\n    See http://goo.gl/MqrFmX\\n\");var n=new u(t),r=n.promise();return n.setHowMany(e),n.init(),r}n.inherits(u,e),u.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=o(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},u.prototype.init=function(){this._initialized=!0,this._init()},u.prototype.setUnwrap=function(){this._unwrap=!0},u.prototype.howMany=function(){return this._howMany},u.prototype.setHowMany=function(t){this._howMany=t},u.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},u.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},u.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(h),this._checkOutcome())},u.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new s,e=this.length();e<this._values.length;++e)this._values[e]!==h&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},u.prototype._fulfilled=function(){return this._totalResolved},u.prototype._rejected=function(){return this._values.length-this.length()},u.prototype._addRejected=function(t){this._values.push(t)},u.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},u.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},u.prototype._getRangeError=function(t){var e=\"Input array must contain at least \"+this._howMany+\" items but contains only \"+t+\" items\";return new r(e)},u.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(t,e){return l(t,e)},t.prototype.some=function(t){return l(this,t)},t._SomePromiseArray=u};","node_modules/bluebird/js/release/filter.js":"\"use strict\";module.exports=function(t,r){var e=t.map;t.prototype.filter=function(t,n){return e(this,t,n,r)},t.filter=function(t,n,i){return e(t,n,i,r)}};","node_modules/bluebird/js/release/each.js":"\"use strict\";module.exports=function(t,e){var i=t.reduce,n=t.all;function o(){return n(this)}t.prototype.each=function(t){return i(this,t,e,0)._then(o,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return i(this,t,e,e)},t.each=function(t,n){return i(t,n,e,0)._then(o,void 0,void 0,t,void 0)},t.mapSeries=function(t,n){return i(t,n,e,e)}};","node_modules/bluebird/js/release/any.js":"\"use strict\";module.exports=function(n){var r=n._SomePromiseArray;function t(n){var t=new r(n),e=t.promise();return t.setHowMany(1),t.setUnwrap(),t.init(),e}n.any=function(n){return t(n)},n.prototype.any=function(){return t(this)}};","node_modules/bluebird/js/release/schedule.js":"\"use strict\";var schedule,util=require(\"./util\"),noAsyncScheduler=function(){throw new Error(\"No async scheduler available\\n\\n    See http://goo.gl/MqrFmX\\n\")},NativePromise=util.getNativePromise();if(util.isNode&&\"undefined\"==typeof MutationObserver){var GlobalSetImmediate=global.setImmediate,ProcessNextTick=process.nextTick;schedule=util.isRecentNode?function(e){GlobalSetImmediate.call(global,e)}:function(e){ProcessNextTick.call(process,e)}}else if(\"function\"==typeof NativePromise&&\"function\"==typeof NativePromise.resolve){var nativePromise=NativePromise.resolve();schedule=function(e){nativePromise.then(e)}}else schedule=\"undefined\"==typeof MutationObserver||\"undefined\"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?\"undefined\"!=typeof setImmediate?function(e){setImmediate(e)}:\"undefined\"!=typeof setTimeout?function(e){setTimeout(e,0)}:noAsyncScheduler:function(){var e=document.createElement(\"div\"),t={attributes:!0},o=!1,i=document.createElement(\"div\");new MutationObserver(function(){e.classList.toggle(\"foo\"),o=!1}).observe(i,t);return function(n){var s=new MutationObserver(function(){s.disconnect(),n()});s.observe(e,t),o||(o=!0,i.classList.toggle(\"foo\"))}}();module.exports=schedule;","node_modules/bluebird/js/release/queue.js":"\"use strict\";function arrayMove(t,i,e,h,s){for(var n=0;n<s;++n)e[n+h]=t[n+i],t[n+i]=void 0}function Queue(t){this._capacity=t,this._length=0,this._front=0}Queue.prototype._willBeOverCapacity=function(t){return this._capacity<t},Queue.prototype._pushOne=function(t){var i=this.length();this._checkCapacity(i+1),this[this._front+i&this._capacity-1]=t,this._length=i+1},Queue.prototype.push=function(t,i,e){var h=this.length()+3;if(this._willBeOverCapacity(h))return this._pushOne(t),this._pushOne(i),void this._pushOne(e);var s=this._front+h-3;this._checkCapacity(h);var n=this._capacity-1;this[s+0&n]=t,this[s+1&n]=i,this[s+2&n]=e,this._length=h},Queue.prototype.shift=function(){var t=this._front,i=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,i},Queue.prototype.length=function(){return this._length},Queue.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},Queue.prototype._resizeTo=function(t){var i=this._capacity;this._capacity=t,arrayMove(this,0,this,i,this._front+this._length&i-1)},module.exports=Queue;","node_modules/mpath/lib/index.js":"var ignoreProperties=[\"__proto__\",\"constructor\",\"prototype\"];function _setArray(r,t,e,i,n,a){for(var o,s=0;s<r.length&&s<t.length;++s)o=r[s],Array.isArray(o)&&Array.isArray(t[s])?_setArray(o,t[s],e,i,n,a):o&&(i?i(o,e,a(t[s])):(o[n]&&(o=o[n]),o[e]=a(t[s])))}function K(r){return r}exports.get=function(r,t,e,i){var n;\"function\"==typeof e&&(e.length<2?(i=e,e=void 0):(n=e,e=void 0)),i||(i=K);var a=\"string\"==typeof r?r.split(\".\"):r;if(!Array.isArray(a))throw new TypeError(\"Invalid `path`. Must be either string or array\");for(var o,s=t,f=0;f<a.length;++f){if(o=a[f],Array.isArray(s)&&!/^\\d+$/.test(o)){var y=a.slice(f);return[].concat(s).map(function(r){return r?exports.get(y,r,e||n,i):i(void 0)})}if(n)s=n(s,o);else{var p=e&&s[e]?s[e]:s;s=p instanceof Map?p.get(o):p[o]}if(!s)return i(s)}return i(s)},exports.has=function(r,t){var e=\"string\"==typeof r?r.split(\".\"):r;if(!Array.isArray(e))throw new TypeError(\"Invalid `path`. Must be either string or array\");for(var i=e.length,n=t,a=0;a<i;++a){if(null==n||\"object\"!=typeof n||!(e[a]in n))return!1;n=n[e[a]]}return!0},exports.unset=function(r,t){var e=\"string\"==typeof r?r.split(\".\"):r;if(!Array.isArray(e))throw new TypeError(\"Invalid `path`. Must be either string or array\");for(var i=e.length,n=t,a=0;a<i;++a){if(null==n||\"object\"!=typeof n||!(e[a]in n))return!1;if(-1!==ignoreProperties.indexOf(e[a]))return!1;if(a===i-1)return delete n[e[a]],!0;n=n instanceof Map?n.get(e[a]):n[e[a]]}return!0},exports.set=function(r,t,e,i,n,a){var o;\"function\"==typeof i&&(i.length<2?(n=i,i=void 0):(o=i,i=void 0)),n||(n=K);var s=\"string\"==typeof r?r.split(\".\"):r;if(!Array.isArray(s))throw new TypeError(\"Invalid `path`. Must be either string or array\");if(null!=e){for(var f=0;f<s.length;++f)if(-1!==ignoreProperties.indexOf(s[f]))return;for(var y,p=a||/\\$/.test(r)&&!1!==a,l=e,u=(f=0,s.length-1);f<u;++f)if(\"$\"!=(y=s[f])){if(Array.isArray(l)&&!/^\\d+$/.test(y)){var g=s.slice(f);if(!p&&Array.isArray(t))for(var v=0;v<l.length&&v<t.length;++v)exports.set(g,t[v],l[v],i||o,n,p);else for(v=0;v<l.length;++v)exports.set(g,t,l[v],i||o,n,p);return}if(o)l=o(l,y);else{var h=i&&l[i]?l[i]:l;l=h instanceof Map?h.get(y):h[y]}if(!l)return}else if(f==u-1)break;if(y=s[u],i&&l[i]&&(l=l[i]),Array.isArray(l)&&!/^\\d+$/.test(y))if(!p&&Array.isArray(t))_setArray(l,t,y,o,i,n);else for(v=0;v<l.length;++v)item=l[v],item&&(o?o(item,y,n(t)):(item[i]&&(item=item[i]),item[y]=n(t)));else o?o(l,y,n(t)):l instanceof Map?l.set(y,n(t)):l[y]=n(t)}};","node_modules/mongoose/lib/cast/boolean.js":"\"use strict\";const CastError=require(\"../error/cast\");module.exports=function(e,r){if(null==e)return e;if(module.exports.convertToTrue.has(e))return!0;if(module.exports.convertToFalse.has(e))return!1;throw new CastError(\"boolean\",e,r)},module.exports.convertToTrue=new Set([!0,\"true\",1,\"1\",\"yes\"]),module.exports.convertToFalse=new Set([!1,\"false\",0,\"0\",\"no\"]);","node_modules/mongoose/lib/helpers/schema/cleanPositionalOperators.js":"\"use strict\";module.exports=function(e){return e.replace(/\\.\\$(\\[[^\\]]*\\])?\\./g,\".0.\").replace(/\\.(\\[[^\\]]*\\])?\\$$/g,\".0\")};","node_modules/mongoose/lib/schema/string.js":"\"use strict\";const SchemaType=require(\"../schematype\"),MongooseError=require(\"../error/index\"),SchemaStringOptions=require(\"../options/SchemaStringOptions\"),castString=require(\"../cast/string\"),utils=require(\"../utils\"),populateModelSymbol=require(\"../helpers/symbols\").populateModelSymbol,CastError=SchemaType.CastError;let Document;function SchemaString(t,e){this.enumValues=[],this.regExp=null,SchemaType.call(this,t,e,\"String\")}function handleSingle(t){return this.castForQuery(t)}function handleArray(t){const e=this;return Array.isArray(t)?t.map(function(t){return e.castForQuery(t)}):[this.castForQuery(t)]}SchemaString.schemaName=\"String\",SchemaString.prototype=Object.create(SchemaType.prototype),SchemaString.prototype.constructor=SchemaString,Object.defineProperty(SchemaString.prototype,\"OptionsConstructor\",{configurable:!1,enumerable:!1,writable:!1,value:SchemaStringOptions}),SchemaString._cast=castString,SchemaString.cast=function(t){return 0===arguments.length?this._cast:(!1===t&&(t=(t=>{if(null!=t&&\"string\"!=typeof t)throw new Error;return t})),this._cast=t,this._cast)},SchemaString.get=SchemaType.get,SchemaString._checkRequired=(t=>(t instanceof String||\"string\"==typeof t)&&t.length),SchemaString.checkRequired=SchemaType.checkRequired,SchemaString.prototype.enum=function(){if(this.enumValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.enumValidator},this),this.enumValidator=!1),void 0===arguments[0]||!1===arguments[0])return this;let t,e;utils.isObject(arguments[0])?(t=arguments[0].values,e=arguments[0].message):(t=arguments,e=MongooseError.messages.String.enum);for(let e=0;e<t.length;e++)void 0!==t[e]&&this.enumValues.push(this.cast(t[e]));const r=this.enumValues;return this.enumValidator=function(t){return void 0===t||~r.indexOf(t)},this.validators.push({validator:this.enumValidator,message:e,type:\"enum\",enumValues:r}),this},SchemaString.prototype.lowercase=function(t){return arguments.length>0&&!t?this:this.set(function(t,e){return\"string\"!=typeof t&&(t=e.cast(t)),t?t.toLowerCase():t})},SchemaString.prototype.uppercase=function(t){return arguments.length>0&&!t?this:this.set(function(t,e){return\"string\"!=typeof t&&(t=e.cast(t)),t?t.toUpperCase():t})},SchemaString.prototype.trim=function(t){return arguments.length>0&&!t?this:this.set(function(t,e){return\"string\"!=typeof t&&(t=e.cast(t)),t?t.trim():t})},SchemaString.prototype.minlength=function(t,e){if(this.minlengthValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.minlengthValidator},this)),null!==t&&void 0!==t){let r=e||MongooseError.messages.String.minlength;r=r.replace(/{MINLENGTH}/,t),this.validators.push({validator:this.minlengthValidator=function(e){return null===e||e.length>=t},message:r,type:\"minlength\",minlength:t})}return this},SchemaString.prototype.maxlength=function(t,e){if(this.maxlengthValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.maxlengthValidator},this)),null!==t&&void 0!==t){let r=e||MongooseError.messages.String.maxlength;r=r.replace(/{MAXLENGTH}/,t),this.validators.push({validator:this.maxlengthValidator=function(e){return null===e||e.length<=t},message:r,type:\"maxlength\",maxlength:t})}return this},SchemaString.prototype.match=function(t,e){const r=e||MongooseError.messages.String.match;return this.validators.push({validator:function(e){if(!t)return!1;return null==e||\"\"===e||t.test(e)},message:r,type:\"regexp\",regexp:t}),this},SchemaString.prototype.checkRequired=function(t,e){if(SchemaType._isRef(this,t,e,!0))return!!t;return(\"function\"==typeof this.constructor.checkRequired?this.constructor.checkRequired():SchemaString.checkRequired())(t)},SchemaString.prototype.cast=function(t,e,r){if(SchemaType._isRef(this,t,e,r)){if(null===t||void 0===t)return t;if(Document||(Document=require(\"./../document\")),t instanceof Document)return t.$__.wasPopulated=!0,t;if(\"string\"==typeof t)return t;if(Buffer.isBuffer(t)||!utils.isObject(t))throw new CastError(\"string\",t,this.path);const r=e.$__fullPath(this.path),n=new((e.ownerDocument?e.ownerDocument():e).populated(r,!0).options[populateModelSymbol])(t);return n.$__.wasPopulated=!0,n}const n=\"function\"==typeof this.constructor.cast?this.constructor.cast():SchemaString.cast();try{return n(t)}catch(e){throw new CastError(\"string\",t,this.path)}};const $conditionalHandlers=utils.options(SchemaType.prototype.$conditionalHandlers,{$all:handleArray,$gt:handleSingle,$gte:handleSingle,$lt:handleSingle,$lte:handleSingle,$options:String,$regex:handleSingle,$not:handleSingle});Object.defineProperty(SchemaString.prototype,\"$conditionalHandlers\",{configurable:!1,enumerable:!1,writable:!1,value:Object.freeze($conditionalHandlers)}),SchemaString.prototype.castForQuery=function(t,e){let r;if(2===arguments.length){if(!(r=this.$conditionalHandlers[t]))throw new Error(\"Can't use \"+t+\" with String.\");return r.call(this,e)}return e=t,\"[object RegExp]\"===Object.prototype.toString.call(e)?e:this._castForQuery(e)},module.exports=SchemaString;","node_modules/mongoose/lib/schema/number.js":"\"use strict\";const MongooseError=require(\"../error/index\"),SchemaNumberOptions=require(\"../options/SchemaNumberOptions\"),SchemaType=require(\"../schematype\"),castNumber=require(\"../cast/number\"),handleBitwiseOperator=require(\"./operators/bitwise\"),utils=require(\"../utils\"),populateModelSymbol=require(\"../helpers/symbols\").populateModelSymbol,CastError=SchemaType.CastError;let Document;function SchemaNumber(e,t){SchemaType.call(this,e,t,\"Number\")}function handleSingle(e){return this.cast(e)}function handleArray(e){const t=this;return Array.isArray(e)?e.map(function(e){return t.cast(e)}):[this.cast(e)]}SchemaNumber.get=SchemaType.get,SchemaNumber._cast=castNumber,SchemaNumber.cast=function(e){return 0===arguments.length?this._cast:(!1===e&&(e=(e=>{if(\"number\"!=typeof e)throw new Error;return e})),this._cast=e,this._cast)},SchemaNumber.schemaName=\"Number\",SchemaNumber.prototype=Object.create(SchemaType.prototype),SchemaNumber.prototype.constructor=SchemaNumber,SchemaNumber.prototype.OptionsConstructor=SchemaNumberOptions,SchemaNumber._checkRequired=(e=>\"number\"==typeof e||e instanceof Number),SchemaNumber.checkRequired=SchemaType.checkRequired,SchemaNumber.prototype.checkRequired=function(e,t){if(SchemaType._isRef(this,e,t,!0))return!!e;return(\"function\"==typeof this.constructor.checkRequired?this.constructor.checkRequired():SchemaNumber.checkRequired())(e)},SchemaNumber.prototype.min=function(e,t){if(this.minValidator&&(this.validators=this.validators.filter(function(e){return e.validator!==this.minValidator},this)),null!==e&&void 0!==e){let r=t||MongooseError.messages.Number.min;r=r.replace(/{MIN}/,e),this.validators.push({validator:this.minValidator=function(t){return null==t||t>=e},message:r,type:\"min\",min:e})}return this},SchemaNumber.prototype.max=function(e,t){if(this.maxValidator&&(this.validators=this.validators.filter(function(e){return e.validator!==this.maxValidator},this)),null!==e&&void 0!==e){let r=t||MongooseError.messages.Number.max;r=r.replace(/{MAX}/,e),this.validators.push({validator:this.maxValidator=function(t){return null==t||t<=e},message:r,type:\"max\",max:e})}return this},SchemaNumber.prototype.cast=function(e,t,r){if(SchemaType._isRef(this,e,t,r)){if(null===e||void 0===e)return e;if(Document||(Document=require(\"./../document\")),e instanceof Document)return e.$__.wasPopulated=!0,e;if(\"number\"==typeof e)return e;if(Buffer.isBuffer(e)||!utils.isObject(e))throw new CastError(\"number\",e,this.path);const r=t.$__fullPath(this.path),i=new((t.ownerDocument?t.ownerDocument():t).populated(r,!0).options[populateModelSymbol])(e);return i.$__.wasPopulated=!0,i}const i=e&&void 0!==e._id?e._id:e,o=\"function\"==typeof this.constructor.cast?this.constructor.cast():SchemaNumber.cast();try{return o(i)}catch(e){throw new CastError(\"number\",i,this.path)}},SchemaNumber.prototype.$conditionalHandlers=utils.options(SchemaType.prototype.$conditionalHandlers,{$bitsAllClear:handleBitwiseOperator,$bitsAnyClear:handleBitwiseOperator,$bitsAllSet:handleBitwiseOperator,$bitsAnySet:handleBitwiseOperator,$gt:handleSingle,$gte:handleSingle,$lt:handleSingle,$lte:handleSingle,$mod:handleArray}),SchemaNumber.prototype.castForQuery=function(e,t){let r;if(2===arguments.length){if(!(r=this.$conditionalHandlers[e]))throw new CastError(\"Can't use \"+e+\" with Number.\");return r.call(this,t)}return t=this._castForQuery(e)},module.exports=SchemaNumber;","node_modules/mongoose/lib/schema/boolean.js":"\"use strict\";const CastError=require(\"../error/cast\"),SchemaType=require(\"../schematype\"),castBoolean=require(\"../cast/boolean\"),utils=require(\"../utils\");function SchemaBoolean(e,o){SchemaType.call(this,e,o,\"Boolean\")}SchemaBoolean.schemaName=\"Boolean\",SchemaBoolean.prototype=Object.create(SchemaType.prototype),SchemaBoolean.prototype.constructor=SchemaBoolean,SchemaBoolean._cast=castBoolean,SchemaBoolean.cast=function(e){return 0===arguments.length?this._cast:(!1===e&&(e=(e=>{if(null!=e&&\"boolean\"!=typeof e)throw new Error;return e})),this._cast=e,this._cast)},SchemaBoolean._checkRequired=(e=>!0===e||!1===e),SchemaBoolean.checkRequired=SchemaType.checkRequired,SchemaBoolean.prototype.checkRequired=function(e){return this.constructor._checkRequired(e)},Object.defineProperty(SchemaBoolean,\"convertToTrue\",{get:()=>castBoolean.convertToTrue,set:e=>{castBoolean.convertToTrue=e}}),Object.defineProperty(SchemaBoolean,\"convertToFalse\",{get:()=>castBoolean.convertToFalse,set:e=>{castBoolean.convertToFalse=e}}),SchemaBoolean.prototype.cast=function(e){const o=\"function\"==typeof this.constructor.cast?this.constructor.cast():SchemaBoolean.cast();try{return o(e)}catch(o){throw new CastError(\"Boolean\",e,this.path)}},SchemaBoolean.$conditionalHandlers=utils.options(SchemaType.prototype.$conditionalHandlers,{}),SchemaBoolean.prototype.castForQuery=function(e,o){let t;return 2===arguments.length?(t=SchemaBoolean.$conditionalHandlers[e])?t.call(this,o):this._castForQuery(o):this._castForQuery(e)},module.exports=SchemaBoolean;","node_modules/mongoose/lib/schema/documentarray.js":"\"use strict\";const ArrayType=require(\"./array\"),CastError=require(\"../error/cast\"),EventEmitter=require(\"events\").EventEmitter,SchemaDocumentArrayOptions=require(\"../options/SchemaDocumentArrayOptions\"),SchemaType=require(\"../schematype\"),discriminator=require(\"../helpers/model/discriminator\"),get=require(\"../helpers/get\"),util=require(\"util\"),utils=require(\"../utils\"),getConstructor=require(\"../helpers/discriminator/getConstructor\"),arrayParentSymbol=require(\"../helpers/symbols\").arrayParentSymbol,arrayPathSymbol=require(\"../helpers/symbols\").arrayPathSymbol;let MongooseDocumentArray,Subdocument;function DocumentArrayPath(t,r,e,o){const n=_createConstructor(r,e);n.prototype.$basePath=t,ArrayType.call(this,t,n,e),this.schema=r,this.schemaOptions=o||{},this.$isMongooseDocumentArray=!0,this.Constructor=n,n.base=r.base;const s=this.defaultValue;\"defaultValue\"in this&&void 0===s||this.default(function(){let t=s.call(this);return Array.isArray(t)||(t=[t]),t});const a=this;this.$embeddedSchemaType=new SchemaType(t+\".$\",{required:get(this,\"schemaOptions.required\",!1)}),this.$embeddedSchemaType.cast=function(t,r,e){return a.cast(t,r,e)[0]},this.$embeddedSchemaType.$isMongooseDocumentArrayElement=!0,this.$embeddedSchemaType.caster=this.Constructor,this.$embeddedSchemaType.schema=this.schema}function _createConstructor(t,r,e){function o(){Subdocument.apply(this,arguments),this.$session(this.ownerDocument().$session())}Subdocument||(Subdocument=require(\"../types/embedded\"));const n=null!=e?e.prototype:Subdocument.prototype;o.prototype=Object.create(n),o.prototype.$__setSchema(t),o.schema=t,o.prototype.constructor=o,o.$isArraySubdocument=!0,o.events=new EventEmitter;for(const r in t.methods)o.prototype[r]=t.methods[r];for(const r in t.statics)o[r]=t.statics[r];for(const t in EventEmitter.prototype)o[t]=EventEmitter.prototype[t];return o.options=r,o}function scopePaths(t,r,e){if(!e||!r)return;const o=t.path+\".\",n=Object.keys(r);let s=n.length;const a={};let i,c,u;for(;s--;)if((c=n[s]).startsWith(o)){if(\"$\"===(u=c.substring(o.length)))continue;u.startsWith(\"$.\")&&(u=u.substr(2)),i||(i=!0),a[u]=r[c]}return i&&a||void 0}DocumentArrayPath.schemaName=\"DocumentArray\",DocumentArrayPath.options={castNonArrays:!0},DocumentArrayPath.prototype=Object.create(ArrayType.prototype),DocumentArrayPath.prototype.constructor=DocumentArrayPath,DocumentArrayPath.prototype.OptionsConstructor=SchemaDocumentArrayOptions,DocumentArrayPath.prototype.discriminator=function(t,r,e){\"function\"==typeof t&&(t=utils.getFunctionName(t));const o=_createConstructor(r=discriminator(this.casterConstructor,t,r,e),null,this.casterConstructor);o.baseCasterConstructor=this.casterConstructor;try{Object.defineProperty(o,\"name\",{value:t})}catch(t){}return this.casterConstructor.discriminators[t]=o,this.casterConstructor.discriminators[t]},DocumentArrayPath.prototype.doValidate=function(t,r,e,o){MongooseDocumentArray||(MongooseDocumentArray=require(\"../types/documentarray\"));const n=this;try{SchemaType.prototype.doValidate.call(this,t,function(s){if(s)return s.$isArrayValidatorError=!0,r(s);let a,i=t&&t.length;if(!i)return r();if(o&&o.updateValidator)return r();t.isMongooseDocumentArray||(t=new MongooseDocumentArray(t,n.path,e));function c(t){null!=t&&\"ValidationError\"!==(a=t).name&&(a.$isArrayValidatorError=!0),--i||r(a)}for(let e=0,o=i;e<o;++e){let o=t[e];if(null!=o){if(!(o instanceof Subdocument)){const r=getConstructor(n.casterConstructor,t[e]);o=t[e]=new r(o,t,void 0,void 0,e)}o.$__validate(c)}else--i||r(a)}},e)}catch(t){return t.$isArrayValidatorError=!0,r(t)}},DocumentArrayPath.prototype.doValidateSync=function(t,r){const e=SchemaType.prototype.doValidateSync.call(this,t,r);if(null!=e)return e.$isArrayValidatorError=!0,e;const o=t&&t.length;let n=null;if(o){for(let r=0,e=o;r<e;++r){let e=t[r];if(!e)continue;if(!(e instanceof Subdocument)){const o=getConstructor(this.casterConstructor,t[r]);e=t[r]=new o(e,t,void 0,void 0,r)}const o=e.validateSync();o&&null==n&&(n=o)}return n}},DocumentArrayPath.prototype.getDefault=function(t){let r=\"function\"==typeof this.defaultValue?this.defaultValue.call(t):this.defaultValue;if(null==r)return r;MongooseDocumentArray||(MongooseDocumentArray=require(\"../types/documentarray\")),Array.isArray(r)||(r=[r]);const e=(r=new MongooseDocumentArray(r,this.path,t))[arrayParentSymbol];r[arrayParentSymbol]=null;for(let t=0;t<r.length;++t){const e=getConstructor(this.casterConstructor,r[t]);r[t]=new e(r[t],r,void 0,void 0,t)}return r[arrayParentSymbol]=e,r},DocumentArrayPath.prototype.cast=function(t,r,e,o,n){let s,a,i;MongooseDocumentArray||(MongooseDocumentArray=require(\"../types/documentarray\"));const c={transform:!1,virtuals:!1};if(!Array.isArray(t)){if(!e&&!DocumentArrayPath.options.castNonArrays)throw new CastError(\"DocumentArray\",util.inspect(t),this.path);return r&&e&&r.markModified(this.path),this.cast([t],r,e,o)}for(t&&t.isMongooseDocumentArray||n&&n.skipDocumentArrayCast?t&&t.isMongooseDocumentArray&&(t=new MongooseDocumentArray(t,this.path,r)):t=new MongooseDocumentArray(t,this.path,r),i=t.length;i--;){if(!t[i])continue;const n=getConstructor(this.casterConstructor,t[i]);if(!t[i].$__||t[i]instanceof n||(t[i]=t[i].toObject({transform:!1,virtuals:t[i].schema===n.schema})),t[i]instanceof Subdocument)null==t[i].__index&&t[i].$setIndex(i);else if(null!=t[i])if(e)r?s||(s=scopePaths(this,r.$__.selected,e)):s=!0,a=new n(null,t,!0,s,i),t[i]=a.init(t[i]);else if(o&&\"function\"==typeof o.id&&(a=o.id(t[i]._id)),o&&a&&utils.deepEqual(a.toObject(c),t[i]))a.set(t[i]),t[i]=a;else try{a=new n(t[i],t,void 0,void 0,i),t[i]=a}catch(r){const e=util.inspect(t[i]);throw new CastError(\"embedded\",e,t[arrayPathSymbol],r)}}return t},DocumentArrayPath.prototype.clone=function(){const t=Object.assign({},this.options),r=new this.constructor(this.path,this.schema,t,this.schemaOptions);return r.validators=this.validators.slice(),r.Constructor.discriminators=Object.assign({},this.Constructor.discriminators),r},module.exports=DocumentArrayPath;","node_modules/mongoose/lib/schema/SingleNestedPath.js":"\"use strict\";const CastError=require(\"../error/cast\"),EventEmitter=require(\"events\").EventEmitter,ObjectExpectedError=require(\"../error/objectExpected\"),SchemaType=require(\"../schematype\"),$exists=require(\"./operators/exists\"),castToNumber=require(\"./operators/helpers\").castToNumber,discriminator=require(\"../helpers/model/discriminator\"),geospatial=require(\"./operators/geospatial\"),get=require(\"../helpers/get\"),getConstructor=require(\"../helpers/discriminator/getConstructor\"),internalToObjectOptions=require(\"../options\").internalToObjectOptions;let Subdocument;function SingleNestedPath(t,e,r){this.caster=_createConstructor(t),this.caster.path=e,this.caster.prototype.$basePath=e,this.schema=t,this.$isSingleNested=!0,SchemaType.call(this,e,r,\"Embedded\")}function _createConstructor(t,e){Subdocument||(Subdocument=require(\"../types/subdocument\"));const r=function(t,e,r){const o=this;this.$parent=r,Subdocument.apply(this,arguments),this.$session(this.ownerDocument().$session()),r&&(r.on(\"save\",function(){o.emit(\"save\",o),o.constructor.emit(\"save\",o)}),r.on(\"isNew\",function(t){o.isNew=t,o.emit(\"isNew\",t),o.constructor.emit(\"isNew\",t)}))},o=null!=e?e.prototype:Subdocument.prototype;(r.prototype=Object.create(o)).$__setSchema(t),r.prototype.constructor=r,r.schema=t,r.$isSingleNested=!0,r.events=new EventEmitter,r.prototype.toBSON=function(){return this.toObject(internalToObjectOptions)};for(const e in t.methods)r.prototype[e]=t.methods[e];for(const e in t.statics)r[e]=t.statics[e];for(const t in EventEmitter.prototype)r[t]=EventEmitter.prototype[t];return r}module.exports=SingleNestedPath,SingleNestedPath.prototype=Object.create(SchemaType.prototype),SingleNestedPath.prototype.constructor=SingleNestedPath,SingleNestedPath.prototype.$conditionalHandlers.$geoWithin=function(t){return{$geometry:this.castForQuery(t.$geometry)}},SingleNestedPath.prototype.$conditionalHandlers.$near=SingleNestedPath.prototype.$conditionalHandlers.$nearSphere=geospatial.cast$near,SingleNestedPath.prototype.$conditionalHandlers.$within=SingleNestedPath.prototype.$conditionalHandlers.$geoWithin=geospatial.cast$within,SingleNestedPath.prototype.$conditionalHandlers.$geoIntersects=geospatial.cast$geoIntersects,SingleNestedPath.prototype.$conditionalHandlers.$minDistance=castToNumber,SingleNestedPath.prototype.$conditionalHandlers.$maxDistance=castToNumber,SingleNestedPath.prototype.$conditionalHandlers.$exists=$exists,SingleNestedPath.prototype.cast=function(t,e,r,o){if(t&&t.$isSingleNested)return t;if(null!=t&&(\"object\"!=typeof t||Array.isArray(t)))throw new ObjectExpectedError(this.path,t);const s=getConstructor(this.caster,t);let i;const n=get(e,\"$__.selected\",{}),a=this.path,c=Object.keys(n).reduce((t,e)=>(e.startsWith(a+\".\")&&(t[e.substr(a.length+1)]=n[e]),t),{});return r?((i=new s(void 0,c,e)).init(t),i):0===Object.keys(t).length?new s({},c,e):new s(t,c,e,void 0,{priorDoc:o})},SingleNestedPath.prototype.castForQuery=function(t,e){let r;if(2===arguments.length){if(!(r=this.$conditionalHandlers[t]))throw new Error(\"Can't use \"+t);return r.call(this,e)}if(null==(e=t))return e;this.options.runSetters&&(e=this._applySetters(e));const o=getConstructor(this.caster,e);try{e=new o(e)}catch(t){if(!(t instanceof CastError))throw new CastError(\"Embedded\",e,this.path,t);throw t}return e},SingleNestedPath.prototype.doValidate=function(t,e,r,o){const s=getConstructor(this.caster,t);if(o&&o.skipSchemaValidators)return t instanceof s||(t=new s(t,null,r)),t.validate(e);SchemaType.prototype.doValidate.call(this,t,function(r){return r?e(r):t?void t.validate(e):e(null)},r)},SingleNestedPath.prototype.doValidateSync=function(t,e,r){if(!r||!r.skipSchemaValidators){const r=SchemaType.prototype.doValidateSync.call(this,t,e);if(r)return r}if(t)return t.validateSync()},SingleNestedPath.prototype.discriminator=function(t,e,r){return discriminator(this.caster,t,e,r),this.caster.discriminators[t]=_createConstructor(e,this.caster),this.caster.discriminators[t]},SingleNestedPath.prototype.clone=function(){const t=Object.assign({},this.options),e=new this.constructor(this.schema,this.path,t);return e.validators=this.validators.slice(),e.caster.discriminators=Object.assign({},this.caster.discriminators),e};","node_modules/mongoose/lib/schema/array.js":"\"use strict\";const $exists=require(\"./operators/exists\"),$type=require(\"./operators/type\"),MongooseError=require(\"../error/mongooseError\"),SchemaArrayOptions=require(\"../options/SchemaArrayOptions\"),SchemaType=require(\"../schematype\"),CastError=SchemaType.CastError,Mixed=require(\"./mixed\"),cast=require(\"../cast\"),get=require(\"../helpers/get\"),util=require(\"util\"),utils=require(\"../utils\"),castToNumber=require(\"./operators/helpers\").castToNumber,geospatial=require(\"./operators/geospatial\"),getDiscriminatorByValue=require(\"../helpers/discriminator/getDiscriminatorByValue\");let MongooseArray,EmbeddedDoc;function SchemaArray(e,t,r,s){EmbeddedDoc||(EmbeddedDoc=require(\"../types\").Embedded);let a,o,i=\"type\";if(s&&s.typeKey&&(i=s.typeKey),this.schemaOptions=s,t){let r={};utils.isPOJO(t)&&(t[i]?(delete(r=utils.clone(t))[i],t=t[i]):t=Mixed),t===Object&&(t=Mixed);const s=\"string\"==typeof t?t:utils.getFunctionName(t),a=require(\"./index.js\"),o=a.hasOwnProperty(s)?a[s]:t;this.casterConstructor=o,\"function\"!=typeof o||o.$isArraySubdocument||o.$isSchemaMap?this.caster=o:this.caster=new o(null,r),this.caster instanceof EmbeddedDoc||(this.caster.path=e)}if(this.$isMongooseArray=!0,SchemaType.call(this,e,r,\"Array\"),null!=this.defaultValue&&(a=this.defaultValue,o=\"function\"==typeof a),!(\"defaultValue\"in this)||void 0!==this.defaultValue){const e=function(){let e=[];return o?e=a.call(this):null!=a&&(e=e.concat(a)),e};e.$runBeforeSetters=!0,this.default(e)}}function cast$all(e){return Array.isArray(e)||(e=[e]),e=e.map(function(e){if(utils.isObject(e)){const t={};return t[this.path]=e,cast(this.casterConstructor.schema,t)[this.path]}return e},this),this.castForQuery(e)}function cast$elemMatch(e){const t=Object.keys(e),r=t.length;for(let s=0;s<r;++s){const r=t[s],a=e[r];r.startsWith(\"$\")&&a&&(e[r]=this.castForQuery(r,a))}const s=get(this,\"casterConstructor.schema.options.discriminatorKey\"),a=get(this,\"casterConstructor.schema.discriminators\",{});return null!=s&&null!=e[s]&&null!=a[e[s]]?cast(a[e[s]],e):cast(this.casterConstructor.schema,e)}SchemaArray.schemaName=\"Array\",SchemaArray.options={castNonArrays:!0},SchemaArray.prototype=Object.create(SchemaType.prototype),SchemaArray.prototype.constructor=SchemaArray,SchemaArray.prototype.OptionsConstructor=SchemaArrayOptions,SchemaArray._checkRequired=SchemaType.prototype.checkRequired,SchemaArray.checkRequired=SchemaType.checkRequired,SchemaArray.prototype.checkRequired=function(e,t){if(SchemaType._isRef(this,e,t,!0))return!!e;return(\"function\"==typeof this.constructor.checkRequired?this.constructor.checkRequired():SchemaArray.checkRequired())(e)},SchemaArray.prototype.enum=function(){let e=this;for(;;){const t=get(e,\"caster.instance\");if(\"Array\"!==t){if(\"String\"!==t)throw new Error(\"`enum` can only be set on an array of strings, not \"+t);break}e=e.caster}return e.caster.enum.apply(e.caster,arguments),this},SchemaArray.prototype.applyGetters=function(e,t){return this.caster.options&&this.caster.options.ref?e:SchemaType.prototype.applyGetters.call(this,e,t)},SchemaArray.prototype.cast=function(e,t,r){let s,a;if(MongooseArray||(MongooseArray=require(\"../types\").Array),Array.isArray(e)){if(!e.length&&t){const e=t.schema.indexedPaths(),r=this.path;for(s=0,a=e.length;s<a;++s){const t=e[s][0][r];if(\"2dsphere\"===t||\"2d\"===t)return}const o=this.path.endsWith(\".coordinates\")?this.path.substr(0,this.path.lastIndexOf(\".\")):null;if(null!=o)for(s=0,a=e.length;s<a;++s){if(\"2dsphere\"===e[s][0][o])return}}if(e&&e.isMongooseArray?e&&e.isMongooseArray&&(e=new MongooseArray(e,this.path,t)):e=new MongooseArray(e,this.path,t),null!=t&&null!=t.$__&&t.populated(this.path))return e;if(this.caster&&this.casterConstructor!==Mixed)try{for(s=0,a=e.length;s<a;s++)e[s]=this.caster.cast(e[s],t,r)}catch(t){throw new CastError(\"[\"+t.kind+\"]\",util.inspect(e),this.path,t)}return e}if(r||SchemaArray.options.castNonArrays)return t&&r&&t.markModified(this.path),this.cast([e],t,r);throw new CastError(\"Array\",util.inspect(e),this.path)},SchemaArray.prototype.discriminator=function(e,t){let r=this;for(;r.$isMongooseArray&&!r.$isMongooseDocumentArray;)if(null==(r=r.casterConstructor)||\"function\"==typeof r)throw new MongooseError(\"You can only add an embedded discriminator on a document array, \"+this.path+\" is a plain array\");return r.discriminator(e,t)},SchemaArray.prototype.clone=function(){const e=Object.assign({},this.options),t=new this.constructor(this.path,this.caster,e,this.schemaOptions);return t.validators=this.validators.slice(),t},SchemaArray.prototype.castForQuery=function(e,t){let r,s;if(2===arguments.length){if(!(r=this.$conditionalHandlers[e]))throw new Error(\"Can't use \"+e+\" with Array.\");s=r.call(this,t)}else{s=e;let t=this.casterConstructor;if(s&&t.discriminators&&t.schema&&t.schema.options&&t.schema.options.discriminatorKey)if(\"string\"==typeof s[t.schema.options.discriminatorKey]&&t.discriminators[s[t.schema.options.discriminatorKey]])t=t.discriminators[s[t.schema.options.discriminatorKey]];else{const e=getDiscriminatorByValue(t,s[t.schema.options.discriminatorKey]);e&&(t=e)}const r=this.casterConstructor.prototype;let a=r&&(r.castForQuery||r.cast);!a&&t.castForQuery&&(a=t.castForQuery);const o=this.caster;Array.isArray(s)?(this.setters.reverse().forEach(e=>{s=e.call(this,s,this)}),s=s.map(function(e){return utils.isObject(e)&&e.$elemMatch?e:a?e=a.call(o,e):null!=e?e=new t(e):e})):a?s=a.call(o,s):null!=s&&(s=new t(s))}return s};const handle=SchemaArray.prototype.$conditionalHandlers={};handle.$all=cast$all,handle.$options=String,handle.$elemMatch=cast$elemMatch,handle.$geoIntersects=geospatial.cast$geoIntersects,handle.$or=handle.$and=function(e){if(!Array.isArray(e))throw new TypeError(\"conditional $or/$and require array\");const t=[];for(let r=0;r<e.length;++r)t.push(cast(this.casterConstructor.schema,e[r]));return t},handle.$near=handle.$nearSphere=geospatial.cast$near,handle.$within=handle.$geoWithin=geospatial.cast$within,handle.$size=handle.$minDistance=handle.$maxDistance=castToNumber,handle.$exists=$exists,handle.$type=$type,handle.$eq=handle.$gt=handle.$gte=handle.$lt=handle.$lte=handle.$ne=handle.$regex=SchemaArray.prototype.castForQuery,handle.$nin=SchemaType.prototype.$conditionalHandlers.$nin,handle.$in=SchemaType.prototype.$conditionalHandlers.$in,module.exports=SchemaArray;","node_modules/mongoose/lib/schema/buffer.js":"\"use strict\";const MongooseBuffer=require(\"../types/buffer\"),SchemaBufferOptions=require(\"../options/SchemaBufferOptions\"),SchemaType=require(\"../schematype\"),handleBitwiseOperator=require(\"./operators/bitwise\"),utils=require(\"../utils\"),populateModelSymbol=require(\"../helpers/symbols\").populateModelSymbol,Binary=MongooseBuffer.Binary,CastError=SchemaType.CastError;let Document;function SchemaBuffer(e,t){SchemaType.call(this,e,t,\"Buffer\")}function handleSingle(e){return this.castForQuery(e)}SchemaBuffer.schemaName=\"Buffer\",SchemaBuffer.prototype=Object.create(SchemaType.prototype),SchemaBuffer.prototype.constructor=SchemaBuffer,SchemaBuffer.prototype.OptionsConstructor=SchemaBufferOptions,SchemaBuffer._checkRequired=(e=>!(!e||!e.length)),SchemaBuffer.checkRequired=SchemaType.checkRequired,SchemaBuffer.prototype.checkRequired=function(e,t){return SchemaType._isRef(this,e,t,!0)?!!e:this.constructor._checkRequired(e)},SchemaBuffer.prototype.cast=function(e,t,r){let o;if(SchemaType._isRef(this,e,t,r)){if(null===e||void 0===e)return e;if(Document||(Document=require(\"./../document\")),e instanceof Document)return e.$__.wasPopulated=!0,e;if(Buffer.isBuffer(e))return e;if(!utils.isObject(e))throw new CastError(\"buffer\",e,this.path);const r=t.$__fullPath(this.path);return(o=new((t.ownerDocument?t.ownerDocument():t).populated(r,!0).options[populateModelSymbol])(e)).$__.wasPopulated=!0,o}if(e&&e._id&&(e=e._id),e&&e.isMongooseBuffer)return e;if(Buffer.isBuffer(e))return e&&e.isMongooseBuffer||(e=new MongooseBuffer(e,[this.path,t]),null!=this.options.subtype&&(e._subtype=this.options.subtype)),e;if(e instanceof Binary){if(o=new MongooseBuffer(e.value(!0),[this.path,t]),\"number\"!=typeof e.sub_type)throw new CastError(\"buffer\",e,this.path);return o._subtype=e.sub_type,o}if(null===e)return e;const i=typeof e;if(\"string\"===i||\"number\"===i||Array.isArray(e)||\"object\"===i&&\"Buffer\"===e.type&&Array.isArray(e.data))return\"number\"===i&&(e=[e]),o=new MongooseBuffer(e,[this.path,t]),null!=this.options.subtype&&(o._subtype=this.options.subtype),o;throw new CastError(\"buffer\",e,this.path)},SchemaBuffer.prototype.subtype=function(e){return this.options.subtype=e,this},SchemaBuffer.prototype.$conditionalHandlers=utils.options(SchemaType.prototype.$conditionalHandlers,{$bitsAllClear:handleBitwiseOperator,$bitsAnyClear:handleBitwiseOperator,$bitsAllSet:handleBitwiseOperator,$bitsAnySet:handleBitwiseOperator,$gt:handleSingle,$gte:handleSingle,$lt:handleSingle,$lte:handleSingle}),SchemaBuffer.prototype.castForQuery=function(e,t){let r;if(2===arguments.length){if(!(r=this.$conditionalHandlers[e]))throw new Error(\"Can't use \"+e+\" with Buffer.\");return r.call(this,t)}t=e;const o=this._castForQuery(t);return o?o.toObject({transform:!1,virtuals:!1}):o},module.exports=SchemaBuffer;","node_modules/mongoose/lib/schema/date.js":"\"use strict\";const MongooseError=require(\"../error/index\"),SchemaDateOptions=require(\"../options/SchemaDateOptions\"),SchemaType=require(\"../schematype\"),castDate=require(\"../cast/date\"),utils=require(\"../utils\"),CastError=SchemaType.CastError;function SchemaDate(t,e){SchemaType.call(this,t,e,\"Date\")}function handleSingle(t){return this.cast(t)}SchemaDate.schemaName=\"Date\",SchemaDate.prototype=Object.create(SchemaType.prototype),SchemaDate.prototype.constructor=SchemaDate,SchemaDate.prototype.OptionsConstructor=SchemaDateOptions,SchemaDate._cast=castDate,SchemaDate.cast=function(t){return 0===arguments.length?this._cast:(!1===t&&(t=(t=>{if(null!=t&&!(t instanceof Date))throw new Error;return t})),this._cast=t,this._cast)},SchemaDate.prototype.expires=function(t){return this._index&&\"Object\"===this._index.constructor.name||(this._index={}),this._index.expires=t,utils.expires(this._index),this},SchemaDate._checkRequired=(t=>t instanceof Date),SchemaDate.checkRequired=SchemaType.checkRequired,SchemaDate.prototype.checkRequired=function(t,e){if(SchemaType._isRef(this,t,e,!0))return!!t;return(\"function\"==typeof this.constructor.checkRequired?this.constructor.checkRequired():SchemaDate.checkRequired())(t)},SchemaDate.prototype.min=function(t,e){if(this.minValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.minValidator},this)),t){let a=e||MongooseError.messages.Date.min;a=a.replace(/{MIN}/,t===Date.now?\"Date.now()\":t.toString());const r=this;this.validators.push({validator:this.minValidator=function(e){let a=t;\"function\"==typeof t&&t!==Date.now&&(a=a.call(this));const i=a===Date.now?a():r.cast(a);return null===e||e.valueOf()>=i.valueOf()},message:a,type:\"min\",min:t})}return this},SchemaDate.prototype.max=function(t,e){if(this.maxValidator&&(this.validators=this.validators.filter(function(t){return t.validator!==this.maxValidator},this)),t){let a=e||MongooseError.messages.Date.max;a=a.replace(/{MAX}/,t===Date.now?\"Date.now()\":t.toString());const r=this;this.validators.push({validator:this.maxValidator=function(e){let a=t;\"function\"==typeof a&&a!==Date.now&&(a=a.call(this));const i=a===Date.now?a():r.cast(a);return null===e||e.valueOf()<=i.valueOf()},message:a,type:\"max\",max:t})}return this},SchemaDate.prototype.cast=function(t){const e=\"function\"==typeof this.constructor.cast?this.constructor.cast():SchemaDate.cast();try{return e(t)}catch(e){throw new CastError(\"date\",t,this.path)}},SchemaDate.prototype.$conditionalHandlers=utils.options(SchemaType.prototype.$conditionalHandlers,{$gt:handleSingle,$gte:handleSingle,$lt:handleSingle,$lte:handleSingle}),SchemaDate.prototype.castForQuery=function(t,e){if(2!==arguments.length)return this._castForQuery(t);const a=this.$conditionalHandlers[t];if(!a)throw new Error(\"Can't use \"+t+\" with Date.\");return a.call(this,e)},module.exports=SchemaDate;","node_modules/mongoose/lib/schema/objectid.js":"\"use strict\";const SchemaObjectIdOptions=require(\"../options/SchemaObjectIdOptions\"),SchemaType=require(\"../schematype\"),castObjectId=require(\"../cast/objectid\"),oid=require(\"../types/objectid\"),utils=require(\"../utils\"),populateModelSymbol=require(\"../helpers/symbols\").populateModelSymbol,CastError=SchemaType.CastError;let Document;function ObjectId(e,t){const o=\"string\"==typeof e&&24===e.length&&/^[a-f0-9]+$/i.test(e),c=t&&t.suppressWarning;!o&&void 0!==e||c||(console.warn(\"mongoose: To create a new ObjectId please try `Mongoose.Types.ObjectId` instead of using `Mongoose.Schema.ObjectId`. Set the `suppressWarning` option if you're trying to create a hex char path in your schema.\"),console.trace()),SchemaType.call(this,e,t,\"ObjectID\")}function handleSingle(e){return this.cast(e)}function defaultId(){return new oid}function resetId(e){if(Document||(Document=require(\"./../document\")),this instanceof Document){if(void 0===e){const e=new oid;return this.$__._id=e,e}this.$__._id=e}return e}ObjectId.schemaName=\"ObjectId\",ObjectId.prototype=Object.create(SchemaType.prototype),ObjectId.prototype.constructor=ObjectId,ObjectId.prototype.OptionsConstructor=SchemaObjectIdOptions,ObjectId.get=SchemaType.get,ObjectId.prototype.auto=function(e){return e&&(this.default(defaultId),this.set(resetId)),this},ObjectId._checkRequired=(e=>e instanceof oid),ObjectId._cast=castObjectId,ObjectId.cast=function(e){return 0===arguments.length?this._cast:(!1===e&&(e=(e=>{if(!(e instanceof oid))throw new Error;return e})),this._cast=e,this._cast)},ObjectId.checkRequired=SchemaType.checkRequired,ObjectId.prototype.checkRequired=function(e,t){if(SchemaType._isRef(this,e,t,!0))return!!e;return(\"function\"==typeof this.constructor.checkRequired?this.constructor.checkRequired():ObjectId.checkRequired())(e)},ObjectId.prototype.cast=function(e,t,o){if(SchemaType._isRef(this,e,t,o)){if(null===e||void 0===e)return e;if(Document||(Document=require(\"./../document\")),e instanceof Document)return e.$__.wasPopulated=!0,e;if(e instanceof oid)return e;if(\"objectid\"===(e.constructor.name||\"\").toLowerCase())return new oid(e.toHexString());if(Buffer.isBuffer(e)||!utils.isObject(e))throw new CastError(\"ObjectId\",e,this.path);const o=t.$__fullPath(this.path),c=(t.ownerDocument?t.ownerDocument():t).populated(o,!0);let n=e;return t.$__.populated&&t.$__.populated[o]&&t.$__.populated[o].options&&t.$__.populated[o].options.options&&t.$__.populated[o].options.options.lean||((n=new c.options[populateModelSymbol](e)).$__.wasPopulated=!0),n}const c=\"function\"==typeof this.constructor.cast?this.constructor.cast():ObjectId.cast();try{return c(e)}catch(t){throw new CastError(\"ObjectId\",e,this.path)}},ObjectId.prototype.$conditionalHandlers=utils.options(SchemaType.prototype.$conditionalHandlers,{$gt:handleSingle,$gte:handleSingle,$lt:handleSingle,$lte:handleSingle}),defaultId.$runBeforeSetters=!0,module.exports=ObjectId;","node_modules/mongoose/lib/schema/mixed.js":"\"use strict\";const SchemaType=require(\"../schematype\"),symbols=require(\"./symbols\"),utils=require(\"../utils\");function Mixed(e,t){if(t&&t.default){const e=t.default;Array.isArray(e)&&0===e.length?t.default=Array:!t.shared&&utils.isObject(e)&&0===Object.keys(e).length&&(t.default=function(){return{}})}SchemaType.call(this,e,t,\"Mixed\"),this[symbols.schemaMixedSymbol]=!0}Mixed.schemaName=\"Mixed\",Mixed.prototype=Object.create(SchemaType.prototype),Mixed.prototype.constructor=Mixed,Mixed.get=SchemaType.get,Mixed.prototype.cast=function(e){return e},Mixed.prototype.castForQuery=function(e,t){return 2===arguments.length?t:e},module.exports=Mixed;","node_modules/mongoose/lib/schema/decimal128.js":"\"use strict\";const SchemaType=require(\"../schematype\"),CastError=SchemaType.CastError,Decimal128Type=require(\"../types/decimal128\"),castDecimal128=require(\"../cast/decimal128\"),utils=require(\"../utils\"),populateModelSymbol=require(\"../helpers/symbols\").populateModelSymbol;let Document;function Decimal128(e,t){SchemaType.call(this,e,t,\"Decimal128\")}function handleSingle(e){return this.cast(e)}Decimal128.schemaName=\"Decimal128\",Decimal128.prototype=Object.create(SchemaType.prototype),Decimal128.prototype.constructor=Decimal128,Decimal128._cast=castDecimal128,Decimal128.cast=function(e){return 0===arguments.length?this._cast:(!1===e&&(e=(e=>{if(null!=e&&!(e instanceof Decimal128Type))throw new Error;return e})),this._cast=e,this._cast)},Decimal128._checkRequired=(e=>e instanceof Decimal128Type),Decimal128.checkRequired=SchemaType.checkRequired,Decimal128.prototype.checkRequired=function(e,t){if(SchemaType._isRef(this,e,t,!0))return!!e;return(\"function\"==typeof this.constructor.checkRequired?this.constructor.checkRequired():Decimal128.checkRequired())(e)},Decimal128.prototype.cast=function(e,t,c){if(SchemaType._isRef(this,e,t,c)){if(null===e||void 0===e)return e;if(Document||(Document=require(\"./../document\")),e instanceof Document)return e.$__.wasPopulated=!0,e;if(e instanceof Decimal128Type)return e;if(Buffer.isBuffer(e)||!utils.isObject(e))throw new CastError(\"Decimal128\",e,this.path);const c=t.$__fullPath(this.path),i=(t.ownerDocument?t.ownerDocument():t).populated(c,!0);let o=e;return t.$__.populated&&t.$__.populated[c]&&t.$__.populated[c].options&&t.$__.populated[c].options.options&&t.$__.populated[c].options.options.lean||((o=new i.options[populateModelSymbol](e)).$__.wasPopulated=!0),o}const i=\"function\"==typeof this.constructor.cast?this.constructor.cast():Decimal128.cast();try{return i(e)}catch(t){throw new CastError(\"Decimal128\",e,this.path)}},Decimal128.prototype.$conditionalHandlers=utils.options(SchemaType.prototype.$conditionalHandlers,{$gt:handleSingle,$gte:handleSingle,$lt:handleSingle,$lte:handleSingle}),module.exports=Decimal128;","node_modules/mongoose/lib/schema/map.js":"\"use strict\";const MongooseMap=require(\"../types/map\"),SchemaMapOptions=require(\"../options/SchemaMapOptions\"),SchemaType=require(\"../schematype\");class Map extends SchemaType{constructor(e,s){super(e,s,\"Map\"),this.$isSchemaMap=!0}cast(e,s,t){if(e instanceof MongooseMap)return e;if(t){const t=new MongooseMap({},this.path,s,this.$__schemaType);if(e instanceof global.Map)for(const o of e.keys())t.$init(o,t.$__schemaType.cast(e.get(o),s,!0));else for(const o of Object.keys(e))t.$init(o,t.$__schemaType.cast(e[o],s,!0));return t}return new MongooseMap(e,this.path,s,this.$__schemaType)}}Map.prototype.OptionsConstructor=SchemaMapOptions,module.exports=Map;","node_modules/mongoose/lib/options/SchemaStringOptions.js":"\"use strict\";const SchemaTypeOptions=require(\"./SchemaTypeOptions\");class SchemaStringOptions extends SchemaTypeOptions{}const opts=require(\"./propertyOptions\");Object.defineProperty(SchemaStringOptions.prototype,\"enum\",opts),Object.defineProperty(SchemaStringOptions.prototype,\"match\",opts),Object.defineProperty(SchemaStringOptions.prototype,\"lowercase\",opts),Object.defineProperty(SchemaStringOptions.prototype,\"trim\",opts),Object.defineProperty(SchemaStringOptions.prototype,\"uppercase\",opts),Object.defineProperty(SchemaStringOptions.prototype,\"minlength\",opts),Object.defineProperty(SchemaStringOptions.prototype,\"maxlength\",opts),module.exports=SchemaStringOptions;","node_modules/mongoose/lib/cast/string.js":"\"use strict\";const CastError=require(\"../error/cast\");module.exports=function(r,t){if(null==r)return r;if(r._id&&\"string\"==typeof r._id)return r._id;if(r.toString&&r.toString!==Object.prototype.toString&&!Array.isArray(r))return r.toString();throw new CastError(\"string\",r,t)};","node_modules/mongoose/lib/options/SchemaNumberOptions.js":"\"use strict\";const SchemaTypeOptions=require(\"./SchemaTypeOptions\");class SchemaNumberOptions extends SchemaTypeOptions{}const opts=require(\"./propertyOptions\");Object.defineProperty(SchemaNumberOptions.prototype,\"min\",opts),Object.defineProperty(SchemaNumberOptions.prototype,\"max\",opts),module.exports=SchemaNumberOptions;","node_modules/mongoose/lib/cast/number.js":"\"use strict\";const assert=require(\"assert\");module.exports=function(r){return assert.ok(!isNaN(r)),null==r?r:\"\"===r?null:(\"string\"!=typeof r&&\"boolean\"!=typeof r||(r=Number(r)),assert.ok(!isNaN(r)),r instanceof Number?r.valueOf():\"number\"==typeof r?r:Array.isArray(r)||\"function\"!=typeof r.valueOf?r.toString&&!Array.isArray(r)&&r.toString()==Number(r)?Number(r):void assert.ok(!1):Number(r.valueOf()))};","node_modules/mongoose/lib/schema/operators/bitwise.js":"\"use strict\";const CastError=require(\"../../error/cast\");function handleBitwiseOperator(r){const t=this;return Array.isArray(r)?r.map(function(r){return _castNumber(t.path,r)}):Buffer.isBuffer(r)?r:_castNumber(t.path,r)}function _castNumber(r,t){const e=Number(t);if(isNaN(e))throw new CastError(\"number\",t,r);return e}module.exports=handleBitwiseOperator;","node_modules/mongoose/lib/options/SchemaDocumentArrayOptions.js":"\"use strict\";const SchemaTypeOptions=require(\"./SchemaTypeOptions\");class SchemaDocumentArrayOptions extends SchemaTypeOptions{}const opts=require(\"./propertyOptions\");Object.defineProperty(SchemaDocumentArrayOptions.prototype,\"excludeIndexes\",opts),module.exports=SchemaDocumentArrayOptions;","node_modules/mongoose/lib/helpers/model/discriminator.js":"\"use strict\";const defineKey=require(\"../document/compile\").defineKey,get=require(\"../get\"),utils=require(\"../../utils\"),CUSTOMIZABLE_DISCRIMINATOR_OPTIONS={toJSON:!0,toObject:!0,_id:!0,id:!0};module.exports=function(i,t,o,e,s){if(!o||!o.instanceOfSchema)throw new Error(\"You must pass a valid discriminator Schema\");if(i.schema.discriminatorMapping&&!i.schema.discriminatorMapping.isRoot)throw new Error('Discriminator \"'+t+'\" can only be a discriminator of the root model');if(s){const t=get(i.base,\"options.applyPluginsToDiscriminators\",!1);i.base._applyPlugins(o,{skipTopLevel:!t})}const n=i.schema.options.discriminatorKey,r=i.schema.path(n);if(null!=r)utils.hasUserDefinedProperty(r.options,\"select\")||(r.options.select=!0),r.options.$skipDiscriminatorCheck=!0;else{const t={};t[n]={default:void 0,select:!0,$skipDiscriminatorCheck:!0},t[n][i.schema.options.typeKey]=String,i.schema.add(t),defineKey(n,null,i.prototype,null,[n],i.schema.options)}if(o.path(n)&&!0!==o.path(n).options.$skipDiscriminatorCheck)throw new Error('Discriminator \"'+t+'\" cannot have field with name \"'+n+'\"');let a=t;if(\"string\"==typeof e&&e.length&&(a=e),function(t,o){if(t._baseSchema=o,o.paths._id&&o.paths._id.options&&!o.paths._id.options.auto){const i=t;utils.merge(t,i),delete t.paths._id,delete t.tree._id}const e=Object.keys(o.paths),s=[];for(let i=0;i<e.length;++i)t.nested[e[i]]&&s.push(e[i]);utils.merge(t,o,{omit:{discriminators:!0},omitNested:s.reduce((i,t)=>(i[\"tree.\"+t]=!0,i),{})});for(let i=0;i<s.length;++i)delete t.paths[s[i]];t.childSchemas.forEach(i=>{i.model.prototype.$__setSchema(i.schema)});const c={};c[n]={default:a,select:!0,set:function(i){if(i===a)return a;throw new Error(\"Can't set discriminator key \\\"\"+n+'\"')},$skipDiscriminatorCheck:!0},c[n][t.options.typeKey]=r?r.instance:String,t.add(c),t.discriminatorMapping={key:n,value:a,isRoot:!1},o.options.collection&&(t.options.collection=o.options.collection);const p=t.options.toJSON,l=t.options.toObject,m=t.options._id,d=t.options.id,h=Object.keys(t.options);t.options.discriminatorKey=o.options.discriminatorKey;for(let i=0;i<h.length;++i){const e=h[i];if(!CUSTOMIZABLE_DISCRIMINATOR_OPTIONS[e]&&!utils.deepEqual(t.options[e],o.options[e]))throw new Error(\"Can't customize discriminator option \"+e+\" (can only modify \"+Object.keys(CUSTOMIZABLE_DISCRIMINATOR_OPTIONS).join(\", \")+\")\")}t.options=utils.clone(o.options),p&&(t.options.toJSON=p),l&&(t.options.toObject=l),void 0!==m&&(t.options._id=m),t.options.id=d,t.s.hooks=i.schema.s.hooks.merge(t.s.hooks),t.plugins=Array.prototype.slice(o.plugins),t.callQueue=o.callQueue.concat(t.callQueue),delete t._requiredpaths}(o,i.schema),i.discriminators||(i.discriminators={}),i.schema.discriminatorMapping||(i.schema.discriminatorMapping={key:n,value:null,isRoot:!0}),i.schema.discriminators||(i.schema.discriminators={}),i.schema.discriminators[t]=o,i.discriminators[t])throw new Error('Discriminator with name \"'+t+'\" already exists');return o};","node_modules/mongoose/lib/helpers/discriminator/getConstructor.js":"\"use strict\";const getDiscriminatorByValue=require(\"./getDiscriminatorByValue\");module.exports=function(i,r){const s=i.schema.options.discriminatorKey;if(null!=r&&i.discriminators&&null!=r[s])if(i.discriminators[r[s]])i=i.discriminators[r[s]];else{const t=getDiscriminatorByValue(i,r[s]);t&&(i=t)}return i};","node_modules/mongoose/lib/types/embedded.js":"\"use strict\";const Document=require(\"../document_provider\")(),EventEmitter=require(\"events\").EventEmitter,immediate=require(\"../helpers/immediate\"),internalToObjectOptions=require(\"../options\").internalToObjectOptions,get=require(\"../helpers/get\"),utils=require(\"../utils\"),util=require(\"util\"),documentArrayParent=require(\"../helpers/symbols\").documentArrayParent,validatorErrorSymbol=require(\"../helpers/symbols\").validatorErrorSymbol;function EmbeddedDocument(t,e,r,o,n){e?(this.__parentArray=e,this[documentArrayParent]=e.$parent()):(this.__parentArray=void 0,this[documentArrayParent]=void 0),this.$setIndex(n),this.$isDocumentArrayElement=!0,Document.call(this,t,o,r);const i=this;this.on(\"isNew\",function(t){i.isNew=t}),i.on(\"save\",function(){i.constructor.emit(\"save\",i)})}EmbeddedDocument.prototype=Object.create(Document.prototype),EmbeddedDocument.prototype.constructor=EmbeddedDocument;for(const t in EventEmitter.prototype)EmbeddedDocument[t]=EventEmitter.prototype[t];function registerRemoveListener(t){let e=t.ownerDocument();function r(){e.removeListener(\"save\",r),e.removeListener(\"remove\",r),t.emit(\"remove\",t),t.constructor.emit(\"remove\",t),e=t=null}e.on(\"save\",r),e.on(\"remove\",r)}EmbeddedDocument.prototype.toBSON=function(){return this.toObject(internalToObjectOptions)},EmbeddedDocument.prototype.$setIndex=function(t){if(this.__index=t,null!=get(this,\"$__.validationError\",null)){const t=Object.keys(this.$__.validationError.errors);for(const e of t)this.invalidate(e,this.$__.validationError.errors[e])}},EmbeddedDocument.prototype.markModified=function(t){this.$__.activePaths.modify(t),this.__parentArray&&(this.isNew?this.__parentArray._markModified():this.__parentArray._markModified(this,t))},EmbeddedDocument.prototype.populate=function(){throw new Error('Mongoose does not support calling populate() on nested docs. Instead of `doc.arr[0].populate(\"path\")`, use `doc.populate(\"arr.0.path\")`')},EmbeddedDocument.prototype.save=function(t,e){return\"function\"==typeof t&&(e=t,t={}),(t=t||{}).suppressWarning||console.warn(\"mongoose: calling `save()` on a subdoc does **not** save the document to MongoDB, it only runs save middleware. Use `subdoc.save({ suppressWarning: true })` to hide this warning if you're sure this behavior is right for your app.\"),utils.promiseOrCallback(e,t=>{this.$__save(t)})},EmbeddedDocument.prototype.$__save=function(t){return immediate(()=>t(null,this))},EmbeddedDocument.prototype.$__remove=function(t){return t(null,this)},EmbeddedDocument.prototype.remove=function(t,e){if(\"function\"!=typeof t||e||(e=t,t=void 0),!this.__parentArray||t&&t.noop)return e&&e(null),this;let r;if(!this.willRemove){if(!(r=this._doc._id))throw new Error(\"For your own good, Mongoose does not know how to remove an EmbeddedDocument that has no _id\");this.__parentArray.pull({_id:r}),this.willRemove=!0,registerRemoveListener(this)}return e&&e(null),this},EmbeddedDocument.prototype.update=function(){throw new Error(\"The #update method is not available on EmbeddedDocuments\")},EmbeddedDocument.prototype.inspect=function(){return this.toObject({transform:!1,virtuals:!1,flattenDecimals:!1})},util.inspect.custom&&(EmbeddedDocument.prototype[util.inspect.custom]=EmbeddedDocument.prototype.inspect),EmbeddedDocument.prototype.invalidate=function(t,e,r){if(Document.prototype.invalidate.call(this,t,e,r),!this[documentArrayParent]||null==this.__index){if(e[validatorErrorSymbol]||\"ValidationError\"===e.name)return!0;throw e}const o=this.__index,n=[this.__parentArray.$path(),o,t].join(\".\");return this[documentArrayParent].invalidate(n,e,r),!0},EmbeddedDocument.prototype.$markValid=function(t){if(!this[documentArrayParent])return;const e=this.__index;if(void 0!==e){const r=[this.__parentArray.$path(),e,t].join(\".\");this[documentArrayParent].$markValid(r)}},EmbeddedDocument.prototype.$ignore=function(t){if(Document.prototype.$ignore.call(this,t),!this[documentArrayParent])return;const e=this.__index;if(void 0!==e){const r=[this.__parentArray.$path(),e,t].join(\".\");this[documentArrayParent].$ignore(r)}},EmbeddedDocument.prototype.$isValid=function(t){return void 0===this.__index||!this[documentArrayParent]||(!this[documentArrayParent].$__.validationError||!this[documentArrayParent].$__.validationError.errors[this.$__fullPath(t)])},EmbeddedDocument.prototype.ownerDocument=function(){if(this.$__.ownerDocument)return this.$__.ownerDocument;let t=this[documentArrayParent];if(!t)return this;for(;t[documentArrayParent]||t.$parent;)t=t[documentArrayParent]||t.$parent;return this.$__.ownerDocument=t,this.$__.ownerDocument},EmbeddedDocument.prototype.$__fullPath=function(t){if(!this.$__.fullPath){let e=this;if(!e[documentArrayParent])return t;const r=[];for(;e[documentArrayParent]||e.$parent;)e[documentArrayParent]?r.unshift(e.__parentArray.$path()):r.unshift(e.$basePath),e=e[documentArrayParent]||e.$parent;this.$__.fullPath=r.join(\".\"),this.$__.ownerDocument||(this.$__.ownerDocument=e)}return t?this.$__.fullPath+\".\"+t:this.$__.fullPath},EmbeddedDocument.prototype.parent=function(){return this[documentArrayParent]},EmbeddedDocument.prototype.parentArray=function(){return this.__parentArray},module.exports=EmbeddedDocument;","node_modules/mongoose/lib/options/SchemaArrayOptions.js":"\"use strict\";const SchemaTypeOptions=require(\"./SchemaTypeOptions\");class SchemaArrayOptions extends SchemaTypeOptions{}const opts=require(\"./propertyOptions\");Object.defineProperty(SchemaArrayOptions.prototype,\"enum\",opts),module.exports=SchemaArrayOptions;","node_modules/mongoose/lib/schema/operators/helpers.js":"\"use strict\";const SchemaNumber=require(\"../number\");function castToNumber(r){return SchemaNumber.cast()(r)}function castArraysOfNumbers(r,s){r.forEach(function(a,e){Array.isArray(a)?castArraysOfNumbers(a,s):r[e]=castToNumber.call(s,a)})}exports.castToNumber=castToNumber,exports.castArraysOfNumbers=castArraysOfNumbers;","node_modules/mongoose/lib/schema/operators/geospatial.js":"\"use strict\";const castArraysOfNumbers=require(\"./helpers\").castArraysOfNumbers,castToNumber=require(\"./helpers\").castToNumber;function cast$near(e){const t=require(\"../array\");return Array.isArray(e)?(castArraysOfNumbers(e,this),e):(_castMinMaxDistance(this,e),e&&e.$geometry?cast$geometry(e,this):t.prototype.castForQuery.call(this,e))}function cast$geometry(e,t){switch(e.$geometry.type){case\"Polygon\":case\"LineString\":case\"Point\":castArraysOfNumbers(e.$geometry.coordinates,t)}return _castMinMaxDistance(t,e),e}function cast$within(e){if(_castMinMaxDistance(this,e),e.$box||e.$polygon){const t=e.$box?\"$box\":\"$polygon\";e[t].forEach(e=>{if(!Array.isArray(e)){throw new TypeError(\"Invalid $within $box argument. Expected an array, received \"+e)}e.forEach((t,r)=>{e[r]=castToNumber.call(this,t)})})}else if(e.$center||e.$centerSphere){const t=e.$center?\"$center\":\"$centerSphere\";e[t].forEach((r,s)=>{Array.isArray(r)?r.forEach((e,t)=>{r[t]=castToNumber.call(this,e)}):e[t][s]=castToNumber.call(this,r)})}else e.$geometry&&cast$geometry(e,this);return e}function cast$geoIntersects(e){if(e.$geometry)return cast$geometry(e,this),e}function _castMinMaxDistance(e,t){t.$maxDistance&&(t.$maxDistance=castToNumber.call(e,t.$maxDistance)),t.$minDistance&&(t.$minDistance=castToNumber.call(e,t.$minDistance))}exports.cast$geoIntersects=cast$geoIntersects,exports.cast$near=cast$near,exports.cast$within=cast$within;","node_modules/mongoose/lib/helpers/discriminator/getDiscriminatorByValue.js":"\"use strict\";module.exports=function(i,r){let s=null;if(!i.discriminators)return s;for(const n in i.discriminators){const t=i.discriminators[n];if(t.schema&&t.schema.discriminatorMapping&&t.schema.discriminatorMapping.value==r){s=t;break}}return s};","node_modules/mongoose/lib/schema/operators/text.js":"\"use strict\";const CastError=require(\"../../error/cast\"),castBoolean=require(\"../../cast/boolean\"),castString=require(\"../../cast/string\");module.exports=function(e,t){if(null==e||\"object\"!=typeof e)throw new CastError(\"$text\",e,t);return null!=e.$search&&(e.$search=castString(e.$search,t+\".$search\")),null!=e.$language&&(e.$language=castString(e.$language,t+\".$language\")),null!=e.$caseSensitive&&(e.$caseSensitive=castBoolean(e.$caseSensitive,t+\".$castSensitive\")),null!=e.$diacriticSensitive&&(e.$diacriticSensitive=castBoolean(e.$diacriticSensitive,t+\".$diacriticSensitive\")),e};","node_modules/mongoose/lib/helpers/document/compile.js":"\"use strict\";const documentSchemaSymbol=require(\"../../helpers/symbols\").documentSchemaSymbol,get=require(\"../../helpers/get\"),getSymbol=require(\"../../helpers/symbols\").getSymbol,utils=require(\"../../utils\");let Document;function compile(e,t,r,n){Document=Document||require(\"../../document\");const o=Object.keys(e),i=o.length;let s,c;for(let l=0;l<i;++l){s=e[c=o[l]],defineKey(c,utils.isPOJO(s)&&Object.keys(s).length&&(!s[n.typeKey]||\"type\"===n.typeKey&&s.type.type)?s:null,t,r,o,n)}}function defineKey(e,t,r,n,o,i){Document=Document||require(\"../../document\");const s=(n?n+\".\":\"\")+e;n=n||\"\",t?Object.defineProperty(r,e,{enumerable:!0,configurable:!0,get:function(){const e=this;if(this.$__.getters||(this.$__.getters={}),!this.$__.getters[s]){const o=Object.create(Document.prototype,getOwnPropertyDescriptors(this));n||(o.$__.scope=this),o.$__.nestedPath=s,Object.defineProperty(o,\"schema\",{enumerable:!1,configurable:!0,writable:!1,value:r.schema}),Object.defineProperty(o,documentSchemaSymbol,{enumerable:!1,configurable:!0,writable:!1,value:r.schema}),Object.defineProperty(o,\"toObject\",{enumerable:!1,configurable:!0,writable:!1,value:function(){return utils.clone(e.get(s,null,{virtuals:get(this,\"schema.options.toObject.virtuals\",null)}))}}),Object.defineProperty(o,\"toJSON\",{enumerable:!1,configurable:!0,writable:!1,value:function(){return e.get(s,null,{virtuals:get(e,\"schema.options.toJSON.virtuals\",null)})}}),Object.defineProperty(o,\"$__isNested\",{enumerable:!1,configurable:!0,writable:!1,value:!0});const c=Object.freeze({minimize:!0,virtuals:!1,getters:!1,transform:!1});Object.defineProperty(o,\"$isEmpty\",{enumerable:!1,configurable:!0,writable:!1,value:function(){return 0===Object.keys(this.get(s,null,c)||{}).length}}),compile(t,o,s,i),this.$__.getters[s]=o}return this.$__.getters[s]},set:function(e){return e instanceof Document&&(e=e.toObject({transform:!1})),(this.$__.scope||this).$set(s,e)}}):Object.defineProperty(r,e,{enumerable:!0,configurable:!0,get:function(){return this[getSymbol].call(this.$__.scope||this,s)},set:function(e){return this.$set.call(this.$__.scope||this,s,e)}})}function getOwnPropertyDescriptors(e){const t={};return Object.getOwnPropertyNames(e).forEach(function(r){t[r]=Object.getOwnPropertyDescriptor(e,r),t[r].get?delete t[r]:t[r].enumerable=-1===[\"isNew\",\"$__\",\"errors\",\"_doc\",\"$locals\"].indexOf(r)}),t}exports.compile=compile,exports.defineKey=defineKey;","node_modules/mongoose/lib/error/objectExpected.js":"\"use strict\";const MongooseError=require(\"./\");function ObjectExpectedError(r,t){const e=Array.isArray(t)?\"array\":\"primitive value\";MongooseError.call(this,\"Tried to set nested object field `\"+r+`\\` to ${e} \\``+t+\"` and strict mode is set to throw.\"),this.name=\"ObjectExpectedError\",Error.captureStackTrace?Error.captureStackTrace(this):this.stack=(new Error).stack,this.path=r}ObjectExpectedError.prototype=Object.create(MongooseError.prototype),ObjectExpectedError.prototype.constructor=MongooseError,module.exports=ObjectExpectedError;","node_modules/mongoose/lib/options.js":"\"use strict\";exports.internalToObjectOptions={transform:!1,virtuals:!1,getters:!1,_skipDepopulateTopLevel:!0,depopulate:!0,flattenDecimals:!1};","node_modules/mongoose/lib/types/buffer.js":"\"use strict\";const Binary=require(\"../driver\").get().Binary,utils=require(\"../utils\"),Buffer=require(\"safe-buffer\").Buffer,proto=Buffer.from(\"\").constructor.prototype;function MongooseBuffer(t,e,r){let o,i,n,f,u;return o=0===arguments.length||null===arguments[0]||void 0===arguments[0]?0:t,Array.isArray(e)?(n=e[0],f=e[1]):i=e,u=\"number\"==typeof o||o instanceof Number?Buffer.alloc(o):Buffer.from(o,i,r),utils.decorate(u,MongooseBuffer.mixin),u.isMongooseBuffer=!0,u[MongooseBuffer.pathSymbol]=n,u[parentSymbol]=f,u._subtype=0,u}const pathSymbol=Symbol.for(\"mongoose#Buffer#_path\"),parentSymbol=Symbol.for(\"mongoose#Buffer#_parent\");MongooseBuffer.pathSymbol=pathSymbol,MongooseBuffer.mixin={_subtype:void 0,_markModified:function(){const t=this[parentSymbol];return t&&t.markModified(this[MongooseBuffer.pathSymbol]),this},write:function(){const t=proto.write.apply(this,arguments);return t>0&&this._markModified(),t},copy:function(t){const e=proto.copy.apply(this,arguments);return t&&t.isMongooseBuffer&&t._markModified(),e}},\"writeUInt8 writeUInt16 writeUInt32 writeInt8 writeInt16 writeInt32 writeFloat writeDouble fill utf8Write binaryWrite asciiWrite set writeUInt16LE writeUInt16BE writeUInt32LE writeUInt32BE writeInt16LE writeInt16BE writeInt32LE writeInt32BE writeFloatLE writeFloatBE writeDoubleLE writeDoubleBE\".split(\" \").forEach(function(t){proto[t]&&(MongooseBuffer.mixin[t]=function(){const e=proto[t].apply(this,arguments);return this._markModified(),e})}),MongooseBuffer.mixin.toObject=function(t){const e=\"number\"==typeof t?t:this._subtype||0;return new Binary(Buffer.from(this),e)},MongooseBuffer.mixin.toBSON=function(){return new Binary(this,this._subtype||0)},MongooseBuffer.mixin.equals=function(t){if(!Buffer.isBuffer(t))return!1;if(this.length!==t.length)return!1;for(let e=0;e<this.length;++e)if(this[e]!==t[e])return!1;return!0},MongooseBuffer.mixin.subtype=function(t){if(\"number\"!=typeof t)throw new TypeError(\"Invalid subtype. Expected a number\");this._subtype!==t&&this._markModified(),this._subtype=t},MongooseBuffer.Binary=Binary,module.exports=MongooseBuffer;","node_modules/mongoose/lib/options/SchemaBufferOptions.js":"\"use strict\";const SchemaTypeOptions=require(\"./SchemaTypeOptions\");class SchemaBufferOptions extends SchemaTypeOptions{}const opts=require(\"./propertyOptions\");Object.defineProperty(SchemaBufferOptions.prototype,\"subtype\",opts),module.exports=SchemaBufferOptions;","node_modules/mongoose/lib/options/SchemaDateOptions.js":"\"use strict\";const SchemaTypeOptions=require(\"./SchemaTypeOptions\");class SchemaDateOptions extends SchemaTypeOptions{}const opts=require(\"./propertyOptions\");Object.defineProperty(SchemaDateOptions.prototype,\"min\",opts),Object.defineProperty(SchemaDateOptions.prototype,\"max\",opts),Object.defineProperty(SchemaDateOptions.prototype,\"expires\",opts),module.exports=SchemaDateOptions;","node_modules/mongoose/lib/cast/date.js":"\"use strict\";const assert=require(\"assert\");module.exports=function(e){if(null==e||\"\"===e)return null;if(e instanceof Date)return assert.ok(!isNaN(e.valueOf())),e;let t;if(assert.ok(\"boolean\"!=typeof e),t=e instanceof Number||\"number\"==typeof e?new Date(e):\"string\"==typeof e&&!isNaN(Number(e))&&(Number(e)>=275761||Number(e)<-271820)?new Date(Number(e)):\"function\"==typeof e.valueOf?new Date(e.valueOf()):new Date(e),!isNaN(t.valueOf()))return t;assert.ok(!1)};","node_modules/mongoose/lib/options/SchemaObjectIdOptions.js":"\"use strict\";const SchemaTypeOptions=require(\"./SchemaTypeOptions\");class SchemaObjectIdOptions extends SchemaTypeOptions{}const opts=require(\"./propertyOptions\");Object.defineProperty(SchemaObjectIdOptions.prototype,\"auto\",opts),module.exports=SchemaObjectIdOptions;","node_modules/mongoose/lib/cast/objectid.js":"\"use strict\";const ObjectId=require(\"../driver\").get().ObjectId,assert=require(\"assert\");module.exports=function(t){if(null==t)return t;if(t instanceof ObjectId)return t;if(t._id){if(t._id instanceof ObjectId)return t._id;if(t._id.toString instanceof Function)return new ObjectId(t._id.toString())}if(t.toString instanceof Function)return new ObjectId(t.toString());assert.ok(!1)};","node_modules/mongoose/lib/cast/decimal128.js":"\"use strict\";const Decimal128Type=require(\"../types/decimal128\"),assert=require(\"assert\");module.exports=function(e){return null==e?e:\"object\"==typeof e&&\"string\"==typeof e.$numberDecimal?Decimal128Type.fromString(e.$numberDecimal):e instanceof Decimal128Type?e:\"string\"==typeof e?Decimal128Type.fromString(e):Buffer.isBuffer(e)?new Decimal128Type(e):\"number\"==typeof e?Decimal128Type.fromString(String(e)):\"function\"==typeof e.valueOf&&\"string\"==typeof e.valueOf()?Decimal128Type.fromString(e.valueOf()):void assert.ok(!1)};","node_modules/mongoose/lib/types/map.js":"\"use strict\";const Mixed=require(\"../schema/mixed\"),get=require(\"../helpers/get\"),util=require(\"util\"),utils=require(\"../utils\"),populateModelSymbol=require(\"../helpers/symbols\").populateModelSymbol;class MongooseMap extends Map{constructor(e,t,r,o){null!=e&&\"Object\"===e.constructor.name&&(e=Object.keys(e).reduce((t,r)=>t.concat([[r,e[r]]]),[])),super(e),this.$__parent=null!=r&&null!=r.$__?r:null,this.$__path=t,this.$__schemaType=null==o?new Mixed(t):o,this.$__runDeferred()}$init(e,t){checkValidKey(e),super.set(e,t),null!=t&&t.$isSingleNested&&(t.$basePath=this.$__path+\".\"+e)}$__set(e,t){super.set(e,t)}set(e,t){if(checkValidKey(e),null==this.$__schemaType)return this.$__deferred=this.$__deferred||[],void this.$__deferred.push({key:e,value:t});const r=this.$__path+\".\"+e,o=null!=this.$__parent&&this.$__parent.$__?this.$__parent.populated(r)||this.$__parent.populated(this.$__path):null;if(null!=o)null==t.$__&&(t=new o.options[populateModelSymbol](t)),t.$__.wasPopulated=!0;else try{t=this.$__schemaType.applySetters(t,this.$__parent,!1,this.get(e))}catch(e){if(null!=this.$__parent&&null!=this.$__parent.$__)return void this.$__parent.invalidate(r,e);throw e}super.set(e,t),null!=t&&t.$isSingleNested&&(t.$basePath=this.$__path+\".\"+e),null!=this.$__parent&&this.$__parent.$__&&this.$__parent.markModified(this.$__path+\".\"+e)}delete(e){this.set(e,void 0),super.delete(e)}toBSON(){return new Map(this)}toObject(e){if(get(e,\"flattenMaps\")){const e={},t=this.keys();for(const r of t)e[r]=this.get(r);return e}return new Map(this)}toJSON(){const e={},t=this.keys();for(const r of t)e[r]=this.get(r);return e}inspect(){return new Map(this)}$__runDeferred(){if(this.$__deferred){for(let e=0;e<this.$__deferred.length;++e)this.set(this.$__deferred[e].key,this.$__deferred[e].value);this.$__deferred=null}}}function checkValidKey(e){const t=typeof e;if(\"string\"!==t)throw new TypeError(`Mongoose maps only support string keys, got ${t}`);if(e.startsWith(\"$\"))throw new Error(`Mongoose maps do not support keys that start with \"$\", got \"${e}\"`);if(e.includes(\".\"))throw new Error(`Mongoose maps do not support keys that contain \".\", got \"${e}\"`);if(utils.specialProperties.has(e))throw new Error(`Mongoose maps do not support reserved key name \"${e}\"`)}util.inspect.custom&&Object.defineProperty(MongooseMap.prototype,util.inspect.custom,{enumerable:!1,writable:!1,configurable:!1,value:MongooseMap.prototype.inspect}),Object.defineProperty(MongooseMap.prototype,\"$__set\",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(MongooseMap.prototype,\"$__parent\",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(MongooseMap.prototype,\"$__path\",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(MongooseMap.prototype,\"$__schemaType\",{enumerable:!1,writable:!0,configurable:!1}),Object.defineProperty(MongooseMap.prototype,\"$isMongooseMap\",{enumerable:!1,writable:!1,configurable:!1,value:!0}),Object.defineProperty(MongooseMap.prototype,\"$__deferredCalls\",{enumerable:!1,writable:!1,configurable:!1,value:!0}),module.exports=MongooseMap;","node_modules/mongoose/lib/options/SchemaMapOptions.js":"\"use strict\";const SchemaTypeOptions=require(\"./SchemaTypeOptions\");class SchemaMapOptions extends SchemaTypeOptions{}const opts=require(\"./propertyOptions\");Object.defineProperty(SchemaMapOptions.prototype,\"of\",opts),module.exports=SchemaMapOptions;","node_modules/mongoose/lib/types/array.js":"\"use strict\";const CoreMongooseArray=require(\"./core_array\"),Document=require(\"../document\"),arrayAtomicsSymbol=require(\"../helpers/symbols\").arrayAtomicsSymbol,arrayParentSymbol=require(\"../helpers/symbols\").arrayParentSymbol,arrayPathSymbol=require(\"../helpers/symbols\").arrayPathSymbol,arraySchemaSymbol=require(\"../helpers/symbols\").arraySchemaSymbol,_basePush=Array.prototype.push;function MongooseArray(r,a,o){const e=new CoreMongooseArray;if(e[arrayAtomicsSymbol]={},Array.isArray(r)){const a=r.length;for(let o=0;o<a;++o)_basePush.call(e,r[o]);e[arrayAtomicsSymbol]=r[arrayAtomicsSymbol]||{}}return e[arrayPathSymbol]=a,e[arraySchemaSymbol]=void 0,o&&o instanceof Document&&(e[arrayParentSymbol]=o,e[arraySchemaSymbol]=o.schema.path(a)),e}module.exports=exports=MongooseArray;","node_modules/mongoose/lib/types/documentarray.js":"\"use strict\";const CoreMongooseArray=require(\"./core_array\"),Document=require(\"../document\"),ObjectId=require(\"./objectid\"),castObjectId=require(\"../cast/objectid\"),getDiscriminatorByValue=require(\"../helpers/discriminator/getDiscriminatorByValue\"),internalToObjectOptions=require(\"../options\").internalToObjectOptions,util=require(\"util\"),utils=require(\"../utils\"),arrayAtomicsSymbol=require(\"../helpers/symbols\").arrayAtomicsSymbol,arrayParentSymbol=require(\"../helpers/symbols\").arrayParentSymbol,arrayPathSymbol=require(\"../helpers/symbols\").arrayPathSymbol,arraySchemaSymbol=require(\"../helpers/symbols\").arraySchemaSymbol,documentArrayParent=require(\"../helpers/symbols\").documentArrayParent,_basePush=Array.prototype.push;class CoreDocumentArray extends CoreMongooseArray{get isMongooseDocumentArray(){return!0}toBSON(){return this.toObject(internalToObjectOptions)}_cast(r,t){let e=this[arraySchemaSymbol].casterConstructor;if((e.$isMongooseDocumentArray?r&&r.isMongooseDocumentArray:r instanceof e)||r&&r.constructor&&r.constructor.baseCasterConstructor===e)return r[documentArrayParent]&&r.__parentArray||(r[documentArrayParent]=this[arrayParentSymbol],r.__parentArray=this),r.$setIndex(t),r;if(void 0===r||null===r)return null;if((Buffer.isBuffer(r)||r instanceof ObjectId||!utils.isObject(r))&&(r={_id:r}),r&&e.discriminators&&e.schema&&e.schema.options&&e.schema.options.discriminatorKey)if(\"string\"==typeof r[e.schema.options.discriminatorKey]&&e.discriminators[r[e.schema.options.discriminatorKey]])e=e.discriminators[r[e.schema.options.discriminatorKey]];else{const t=getDiscriminatorByValue(e,r[e.schema.options.discriminatorKey]);t&&(e=t)}return e.$isMongooseDocumentArray?e.cast(r,this,void 0,void 0,t):new e(r,this,void 0,void 0,t)}id(r){let t,e,o;try{t=castObjectId(r).toString()}catch(r){t=null}for(let a=0,s=this.length;a<s;a++)if(this[a]&&null!==(o=this[a].get(\"_id\"))&&void 0!==o)if(o instanceof Document){if(e||(e=String(r)),e==o._id)return this[a]}else if(r instanceof ObjectId||o instanceof ObjectId){if(t==o)return this[a]}else if(utils.deepEqual(r,o))return this[a];return null}toObject(r){return[].concat(this.map(function(t){return null==t?null:\"function\"!=typeof t.toObject?t:t.toObject(r)}))}slice(){const r=super.slice.apply(this,arguments);return r[arrayParentSymbol]=this[arrayParentSymbol],r[arrayPathSymbol]=this[arrayPathSymbol],r}push(){const r=super.push.apply(this,arguments);return _updateParentPopulated(this),r}pull(){const r=super.pull.apply(this,arguments);return _updateParentPopulated(this),r}shift(){const r=super.shift.apply(this,arguments);return _updateParentPopulated(this),r}splice(){const r=super.splice.apply(this,arguments);return _updateParentPopulated(this),r}inspect(){return this.toObject()}create(r){let t=this[arraySchemaSymbol].casterConstructor;if(r&&t.discriminators&&t.schema&&t.schema.options&&t.schema.options.discriminatorKey)if(\"string\"==typeof r[t.schema.options.discriminatorKey]&&t.discriminators[r[t.schema.options.discriminatorKey]])t=t.discriminators[r[t.schema.options.discriminatorKey]];else{const e=getDiscriminatorByValue(t,r[t.schema.options.discriminatorKey]);e&&(t=e)}return new t(r,this)}notify(r){const t=this;return function e(o,a){let s=(a=a||t).length;for(;s--;)if(null!=a[s]){switch(r){case\"save\":o=t[s]}a[s].isMongooseArray?e(o,a[s]):a[s]&&a[s].emit(r,o)}}}}function _updateParentPopulated(r){const t=r[arrayParentSymbol];if(!t||null==t.$__.populated)return;const e=Object.keys(t.$__.populated).filter(t=>t.startsWith(r[arrayPathSymbol]+\".\"));for(const o of e){const e=o.slice((r[arrayPathSymbol]+\".\").length);Array.isArray(t.$__.populated[o].value)&&(t.$__.populated[o].value=r.map(r=>r.populated(e)))}}function MongooseDocumentArray(r,t,e){const o=new CoreDocumentArray;if(o[arrayAtomicsSymbol]={},o[arraySchemaSymbol]=void 0,Array.isArray(r)&&(r instanceof CoreDocumentArray&&r[arrayPathSymbol]===t&&r[arrayParentSymbol]===e&&(o[arrayAtomicsSymbol]=Object.assign({},r[arrayAtomicsSymbol])),r.forEach(r=>{_basePush.call(o,r)})),o[arrayPathSymbol]=t,e&&e instanceof Document){for(o[arrayParentSymbol]=e,o[arraySchemaSymbol]=e.schema.path(t);null!=o&&null!=o[arraySchemaSymbol]&&o[arraySchemaSymbol].$isMongooseArray&&!o[arraySchemaSymbol].$isMongooseDocumentArray;)o[arraySchemaSymbol]=o[arraySchemaSymbol].casterConstructor;o[arraySchemaSymbol]&&!o[arraySchemaSymbol].$isMongooseDocumentArray&&(o[arraySchemaSymbol]=o[arraySchemaSymbol].casterConstructor)}return o}util.inspect.custom&&(CoreDocumentArray.prototype[util.inspect.custom]=CoreDocumentArray.prototype.inspect),module.exports=MongooseDocumentArray;","node_modules/mongoose/lib/types/subdocument.js":"\"use strict\";const Document=require(\"../document\"),immediate=require(\"../helpers/immediate\"),internalToObjectOptions=require(\"../options\").internalToObjectOptions,utils=require(\"../utils\"),documentArrayParent=require(\"../helpers/symbols\").documentArrayParent;function Subdocument(t,e,o,i,n){this.$isSingleNested=!0;const r=null!=n&&n.priorDoc;let s=null;if(r&&(this._doc=Object.assign({},n.priorDoc._doc),delete this._doc[this.schema.options.discriminatorKey],s=Object.keys(n.priorDoc._doc||{}).filter(t=>t!==this.schema.options.discriminatorKey)),null!=o&&(n=Object.assign({},n,{isNew:o.isNew})),Document.call(this,t,e,i,n),r)for(const t of s)this.$__.activePaths.states.modify[t]||this.$__.activePaths.states.default[t]||this.$__.$setCalled.has(t)||delete this._doc[t]}function registerRemoveListener(t){let e=t.ownerDocument();function o(){e.removeListener(\"save\",o),e.removeListener(\"remove\",o),t.emit(\"remove\",t),t.constructor.emit(\"remove\",t),e=t=null}e.on(\"save\",o),e.on(\"remove\",o)}module.exports=Subdocument,Subdocument.prototype=Object.create(Document.prototype),Subdocument.prototype.toBSON=function(){return this.toObject(internalToObjectOptions)},Subdocument.prototype.save=function(t,e){return\"function\"==typeof t&&(e=t,t={}),(t=t||{}).suppressWarning||console.warn(\"mongoose: calling `save()` on a subdoc does **not** save the document to MongoDB, it only runs save middleware. Use `subdoc.save({ suppressWarning: true })` to hide this warning if you're sure this behavior is right for your app.\"),utils.promiseOrCallback(e,t=>{this.$__save(t)})},Subdocument.prototype.$__save=function(t){return immediate(()=>t(null,this))},Subdocument.prototype.$isValid=function(t){return this.$parent&&this.$basePath?this.$parent.$isValid([this.$basePath,t].join(\".\")):Document.prototype.$isValid.call(this,t)},Subdocument.prototype.markModified=function(t){if(Document.prototype.markModified.call(this,t),this.$parent&&this.$basePath){if(this.$parent.isDirectModified(this.$basePath))return;this.$parent.markModified([this.$basePath,t].join(\".\"),this)}},Subdocument.prototype.isModified=function(t,e){return this.$parent&&this.$basePath?((Array.isArray(t)||\"string\"==typeof t)&&(t=(t=Array.isArray(t)?t:t.split(\" \")).map(t=>[this.$basePath,t].join(\".\"))),this.$parent.isModified(t,e)):Document.prototype.isModified(t,e)},Subdocument.prototype.$markValid=function(t){Document.prototype.$markValid.call(this,t),this.$parent&&this.$basePath&&this.$parent.$markValid([this.$basePath,t].join(\".\"))},Subdocument.prototype.invalidate=function(t,e,o){if(e!==this.ownerDocument().$__.validationError&&Document.prototype.invalidate.call(this,t,e,o),this.$parent&&this.$basePath)this.$parent.invalidate([this.$basePath,t].join(\".\"),e,o);else if(\"cast\"===e.kind||\"CastError\"===e.name)throw e},Subdocument.prototype.$ignore=function(t){Document.prototype.$ignore.call(this,t),this.$parent&&this.$basePath&&this.$parent.$ignore([this.$basePath,t].join(\".\"))},Subdocument.prototype.ownerDocument=function(){if(this.$__.ownerDocument)return this.$__.ownerDocument;let t=this.$parent;if(!t)return this;for(;t.$parent||t[documentArrayParent];)t=t.$parent||t[documentArrayParent];return this.$__.ownerDocument=t,this.$__.ownerDocument},Subdocument.prototype.parent=function(){return this.$parent},Subdocument.prototype.$__remove=function(t){return t(null,this)},Subdocument.prototype.remove=function(t,e){\"function\"==typeof t&&(e=t,t=null),registerRemoveListener(this),t&&t.noop||this.$parent.set(this.$basePath,null),\"function\"==typeof e&&e(null)},Subdocument.prototype.populate=function(){throw new Error('Mongoose does not support calling populate() on nested docs. Instead of `doc.nested.populate(\"path\")`, use `doc.populate(\"nested.path\")`')};","node_modules/mongoose/lib/types/core_array.js":"\"use strict\";const Document=require(\"../document\"),EmbeddedDocument=require(\"./embedded\"),ObjectId=require(\"./objectid\"),cleanModifiedSubpaths=require(\"../helpers/document/cleanModifiedSubpaths\"),get=require(\"../helpers/get\"),internalToObjectOptions=require(\"../options\").internalToObjectOptions,utils=require(\"../utils\"),util=require(\"util\"),arrayAtomicsSymbol=require(\"../helpers/symbols\").arrayAtomicsSymbol,arrayParentSymbol=require(\"../helpers/symbols\").arrayParentSymbol,arrayPathSymbol=require(\"../helpers/symbols\").arrayPathSymbol,arraySchemaSymbol=require(\"../helpers/symbols\").arraySchemaSymbol,populateModelSymbol=require(\"../helpers/symbols\").populateModelSymbol,_basePush=Array.prototype.push,validatorsSymbol=Symbol(\"mongoose#MongooseCoreArray#validators\");class CoreMongooseArray extends Array{get isMongooseArray(){return!0}get validators(){return this[validatorsSymbol]}set validators(t){this[validatorsSymbol]=t}$__getAtomics(){const t=[],e=Object.keys(this[arrayAtomicsSymbol]);let s=e.length;const r=Object.assign({},internalToObjectOptions,{_isNested:!0});if(0===s)return t[0]=[\"$set\",this.toObject(r)],t;for(;s--;){const i=e[s];let a=this[arrayAtomicsSymbol][i];utils.isMongooseObject(a)?a=a.toObject(r):Array.isArray(a)?a=this.toObject.call(a,r):null!=a&&Array.isArray(a.$each)?a.$each=this.toObject.call(a.$each,r):null!=a&&\"function\"==typeof a.valueOf&&(a=a.valueOf()),\"$addToSet\"===i&&(a={$each:a}),t.push([i,a])}return t}$atomics(){return this[arrayAtomicsSymbol]}$parent(){return this[arrayParentSymbol]}$path(){return this[arrayPathSymbol]}$shift(){if(this._registerAtomic(\"$pop\",-1),this._markModified(),!this._shifted)return this._shifted=!0,[].shift.call(this)}$pop(){if(this._registerAtomic(\"$pop\",1),this._markModified(),!this._popped)return this._popped=!0,[].pop.call(this)}$schema(){return this[arraySchemaSymbol]}_cast(t){let e,s=!1;if(this[arrayParentSymbol]&&(s=this[arrayParentSymbol].populated(this[arrayPathSymbol],!0)),s&&null!==t&&void 0!==t){return e=s.options[populateModelSymbol],(Buffer.isBuffer(t)||t instanceof ObjectId||!utils.isObject(t))&&(t={_id:t}),t.schema&&t.schema.discriminatorMapping&&void 0!==t.schema.discriminatorMapping.key||(t=new e(t)),this[arraySchemaSymbol].caster.applySetters(t,this[arrayParentSymbol],!0)}return this[arraySchemaSymbol].caster.applySetters(t,this[arrayParentSymbol],!1)}_mapCast(t,e){return this._cast(t,this.length+e)}_markModified(t,e){const s=this[arrayParentSymbol];let r;return s&&(r=this[arrayPathSymbol],arguments.length&&(r=null!=e?r+\".\"+this.indexOf(t)+\".\"+e:r+\".\"+t),s.markModified(r,arguments.length>0?t:s)),this}_registerAtomic(t,e){if(\"$set\"===t)return this[arrayAtomicsSymbol]={$set:e},cleanModifiedSubpaths(this[arrayParentSymbol],this[arrayPathSymbol]),this._markModified(),this;const s=this[arrayAtomicsSymbol];if(\"$pop\"===t&&!(\"$pop\"in s)){const t=this;this[arrayParentSymbol].once(\"save\",function(){t._popped=t._shifted=null})}if(this[arrayAtomicsSymbol].$set||Object.keys(s).length&&!(t in s))return this[arrayAtomicsSymbol]={$set:this},this;let r;if(\"$pullAll\"===t||\"$addToSet\"===t)s[t]||(s[t]=[]),s[t]=s[t].concat(e);else if(\"$pullDocs\"===t){const t=s.$pull||(s.$pull={});e[0]instanceof EmbeddedDocument?(r=t.$or||(t.$or=[]),Array.prototype.push.apply(r,e.map(function(t){return t.toObject({transform:!1,virtuals:!1})}))):(r=t._id||(t._id={$in:[]})).$in=r.$in.concat(e)}else\"$push\"===t?(s.$push=s.$push||{$each:[]},s.$push.$each=s.$push.$each.concat(e)):s[t]=e;return this}addToSet(){_checkManualPopulation(this,arguments);let t=[].map.call(arguments,this._mapCast,this);const e=[];let s=\"\";return(t=this[arraySchemaSymbol].applySetters(t,this[arrayParentSymbol]))[0]instanceof EmbeddedDocument?s=\"doc\":t[0]instanceof Date&&(s=\"date\"),t.forEach(function(t){let r;const i=+t;switch(s){case\"doc\":r=this.some(function(e){return e.equals(t)});break;case\"date\":r=this.some(function(t){return+t===i});break;default:r=~this.indexOf(t)}r||([].push.call(this,t),this._registerAtomic(\"$addToSet\",t),this._markModified(),[].push.call(e,t))},this),e}hasAtomics(){return utils.isPOJO(this[arrayAtomicsSymbol])?Object.keys(this[arrayAtomicsSymbol]).length:0}includes(t,e){return-1!==this.indexOf(t,e)}indexOf(t,e){t instanceof ObjectId&&(t=t.toString()),e=null==e?0:e;const s=this.length;for(let r=e;r<s;++r)if(t==this[r])return r;return-1}inspect(){return JSON.stringify(this)}nonAtomicPush(){const t=[].map.call(arguments,this._mapCast,this),e=[].push.apply(this,t);return this._registerAtomic(\"$set\",this),this._markModified(),e}pop(){const t=[].pop.call(this);return this._registerAtomic(\"$set\",this),this._markModified(),t}pull(){const t=[].map.call(arguments,this._cast,this),e=this[arrayParentSymbol].get(this[arrayPathSymbol]);let s,r=e.length;for(;r--;)if((s=e[r])instanceof Document){t.some(function(t){return s.equals(t)})&&[].splice.call(e,r,1)}else~e.indexOf.call(t,s)&&[].splice.call(e,r,1);return t[0]instanceof EmbeddedDocument?this._registerAtomic(\"$pullDocs\",t.map(function(t){return t._id||t})):this._registerAtomic(\"$pullAll\",t),this._markModified(),cleanModifiedSubpaths(this[arrayParentSymbol],this[arrayPathSymbol])>0&&this._registerAtomic(\"$set\",this),this}push(){if(null==this[arraySchemaSymbol])return _basePush.apply(this,arguments);_checkManualPopulation(this,arguments);const t=this[arrayParentSymbol];let e=[].map.call(arguments,this._mapCast,this);e=this[arraySchemaSymbol].applySetters(e,t,void 0,void 0,{skipDocumentArrayCast:!0});const s=[].push.apply(this,e);return this._registerAtomic(\"$push\",e),this._markModified(),s}remove(){return this.pull.apply(this,arguments)}set(t,e){const s=this._cast(e,t);return this[t]=s,this._markModified(t),this}shift(){const t=[].shift.call(this);return this._registerAtomic(\"$set\",this),this._markModified(),t}sort(){const t=[].sort.apply(this,arguments);return this._registerAtomic(\"$set\",this),t}splice(){let t;if(_checkManualPopulation(this,Array.prototype.slice.call(arguments,2)),arguments.length){const e=[];for(let t=0;t<arguments.length;++t)e[t]=t<2?arguments[t]:this._cast(arguments[t],arguments[0]+(t-2));t=[].splice.apply(this,e),this._registerAtomic(\"$set\",this)}return t}toBSON(){return this.toObject(internalToObjectOptions)}toObject(t){return t&&t.depopulate?((t=utils.clone(t))._isNested=!0,this.map(function(e){return e instanceof Document?e.toObject(t):e})):this.slice()}unshift(){_checkManualPopulation(this,arguments);let t=[].map.call(arguments,this._cast,this);return t=this[arraySchemaSymbol].applySetters(t,this[arrayParentSymbol]),[].unshift.apply(this,t),this._registerAtomic(\"$set\",this),this._markModified(),this.length}}function _isAllSubdocs(t,e){if(!e)return!1;for(let s=0;s<t.length;++s){const r=t[s];if(null==r)return!1;const i=r.constructor;if(!(r instanceof Document)||i.modelName!==e&&i.baseModelName!==e)return!1}return!0}function _checkManualPopulation(t,e){const s=null==t?null:get(t[arraySchemaSymbol],\"caster.options.ref\",null);0===t.length&&e.length>0&&_isAllSubdocs(e,s)&&t[arrayParentSymbol].populated(t[arrayPathSymbol],[],{[populateModelSymbol]:e[0].constructor})}util.inspect.custom&&(CoreMongooseArray.prototype[util.inspect.custom]=CoreMongooseArray.prototype.inspect),module.exports=CoreMongooseArray;","node_modules/mongoose/lib/helpers/document/cleanModifiedSubpaths.js":"\"use strict\";module.exports=function(t,s,e){const o=(e=e||{}).skipDocArrays;let i=0;if(!t)return i;for(const e of Object.keys(t.$__.activePaths.states.modify)){if(o){const s=t.schema.path(e);if(s&&s.$isMongooseDocumentArray)continue}e.startsWith(s+\".\")&&(delete t.$__.activePaths.states.modify[e],++i)}return i};","node_modules/mongoose/lib/internal.js":"\"use strict\";const StateMachine=require(\"./statemachine\"),ActiveRoster=StateMachine.ctor(\"require\",\"modify\",\"init\",\"default\",\"ignore\");function InternalCache(){this.strictMode=void 0,this.selected=void 0,this.shardval=void 0,this.saveError=void 0,this.validationError=void 0,this.adhocPaths=void 0,this.removing=void 0,this.inserting=void 0,this.saving=void 0,this.version=void 0,this.getters={},this._id=void 0,this.populate=void 0,this.populated=void 0,this.wasPopulated=!1,this.scope=void 0,this.activePaths=new ActiveRoster,this.pathsToScopes={},this.cachedRequired={},this.session=null,this.$setCalled=new Set,this.ownerDocument=void 0,this.fullPath=void 0}module.exports=exports=InternalCache;","node_modules/mongoose/lib/error/objectParameter.js":"\"use strict\";const MongooseError=require(\"./\");function ObjectParameterError(r,t,e){MongooseError.call(this,'Parameter \"'+t+'\" to '+e+\"() must be an object, got \"+r.toString()),this.name=\"ObjectParameterError\",Error.captureStackTrace?Error.captureStackTrace(this):this.stack=(new Error).stack}ObjectParameterError.prototype=Object.create(MongooseError.prototype),ObjectParameterError.prototype.constructor=MongooseError,module.exports=ObjectParameterError;","node_modules/mongoose/lib/helpers/common.js":"\"use strict\";const Decimal128=require(\"../types/decimal128\"),ObjectId=require(\"../types/objectid\"),utils=require(\"../utils\");function flatten(t,e,s,n){let i;const r=(i=t&&utils.isMongooseObject(t)&&!Buffer.isBuffer(t)?Object.keys(t.toObject({transform:!1,virtuals:!1})):Object.keys(t||{})).length,o={};e=e?e+\".\":\"\";for(let a=0;a<r;++a){const r=i[a],f=t[r];o[e+r]=f;const c=n&&n.path&&n.path(e+r);if((!c||\"Mixed\"!==c.instance)&&shouldFlatten(f)){if(s&&s.skipArrays&&Array.isArray(f))continue;const t=flatten(f,e+r,s,n);for(const e in t)o[e]=t[e];Array.isArray(f)&&(o[e+r]=f)}}return o}function modifiedPaths(t,e,s){const n=Object.keys(t||{}),i=n.length;s=s||{},e=e?e+\".\":\"\";for(let r=0;r<i;++r){const i=n[r];let o=t[i];s[e+i]=!0,utils.isMongooseObject(o)&&!Buffer.isBuffer(o)&&(o=o.toObject({transform:!1,virtuals:!1})),shouldFlatten(o)&&modifiedPaths(o,e+i,s)}return s}function shouldFlatten(t){return t&&\"object\"==typeof t&&!(t instanceof Date)&&!(t instanceof ObjectId)&&(!Array.isArray(t)||t.length>0)&&!(t instanceof Buffer)&&!(t instanceof Decimal128)}exports.flatten=flatten,exports.modifiedPaths=modifiedPaths;","node_modules/mongoose/lib/helpers/document/getEmbeddedDiscriminatorPath.js":"\"use strict\";const get=require(\"../get\");module.exports=function e(n,t,i){const s=(i=i||{}).typeOnly,o=t.split(\".\");let c=null,l=\"adhocOrUndefined\";for(let t=0;t<o.length;++t){const r=o.slice(0,t+1).join(\".\");if(null!=(c=n.schema.path(r))){if(\"Mixed\"===c.instance)return s?\"real\":c;if(l=n.schema.pathType(r),(c.$isSingleNested||c.$isMongooseDocumentArrayElement)&&null!=c.schema.discriminators){const s=c.schema.discriminators,l=n.get(r+\".\"+get(c,\"schema.options.discriminatorKey\"));if(null==l||null==s[l])continue;const a=o.slice(t+1).join(\".\");return e(n.get(r),a,i)}}else l=\"adhocOrUndefined\"}return s?l:c};","node_modules/mongoose/lib/plugins/idGetter.js":"\"use strict\";function idGetter(){return null!=this._id?String(this._id):null}module.exports=function(t){!t.paths.id&&!t.options.noVirtualId&&t.options.id&&t.virtual(\"id\").get(idGetter)};","node_modules/mongoose/lib/helpers/projection/isDefiningProjection.js":"\"use strict\";module.exports=function(e){return null==e||(\"object\"!=typeof e||!(\"$meta\"in e||\"$slice\"in e))};","node_modules/mongoose/lib/helpers/projection/isExclusive.js":"\"use strict\";const isDefiningProjection=require(\"./isDefiningProjection\");module.exports=function(e){const i=Object.keys(e);let n=i.length,t=null;if(1===n&&\"_id\"===i[0])t=!!e[i[n]];else for(;n--;)if(\"_id\"!==i[n]&&isDefiningProjection(e[i[n]])){t=!e[i[n]];break}return t};","node_modules/mongoose/lib/statemachine.js":"\"use strict\";const utils=require(\"./utils\"),StateMachine=module.exports=exports=function(){};StateMachine.ctor=function(){const t=utils.args(arguments),e=function(){StateMachine.apply(this,arguments),this.paths={},this.states={},this.stateNames=t;let e,s=t.length;for(;s--;)e=t[s],this.states[e]={}};return e.prototype=new StateMachine,t.forEach(function(t){e.prototype[t]=function(e){this._changeState(e,t)}}),e},StateMachine.prototype._changeState=function(t,e){const s=this.states[this.paths[t]];s&&delete s[t],this.paths[t]=e,this.states[e][t]=!0},StateMachine.prototype.clear=function(t){const e=Object.keys(this.states[t]);let s,n=e.length;for(;n--;)s=e[n],delete this.states[t][s],delete this.paths[s]},StateMachine.prototype.some=function(){const t=this,e=arguments.length?arguments:this.stateNames;return Array.prototype.some.call(e,function(e){return Object.keys(t.states[e]).length})},StateMachine.prototype._iter=function(t){return function(){const e=arguments.length;let s=utils.args(arguments,0,e-1);const n=arguments[e-1];s.length||(s=this.stateNames);const a=this;return s.reduce(function(t,e){return t.concat(Object.keys(a.states[e]))},[])[t](function(t,e,s){return n(t,e,s)})}},StateMachine.prototype.forEach=function(){return this.forEach=this._iter(\"forEach\"),this.forEach.apply(this,arguments)},StateMachine.prototype.map=function(){return this.map=this._iter(\"map\"),this.map.apply(this,arguments)};","node_modules/mongoose/lib/browserDocument.js":"\"use strict\";const NodeJSDocument=require(\"./document\"),EventEmitter=require(\"events\").EventEmitter,MongooseError=require(\"./error/index\"),Schema=require(\"./schema\"),ObjectId=require(\"./types/objectid\"),ValidationError=MongooseError.ValidationError,applyHooks=require(\"./helpers/model/applyHooks\"),utils=require(\"./utils\");function Document(e,t,o,r,n){if(!(this instanceof Document))return new Document(e,t,o,r,n);if(utils.isObject(t)&&!t.instanceOfSchema&&(t=new Schema(t)),t=this.schema||t,!this.schema&&t.options._id&&void 0===(e=e||{})._id&&(e._id=new ObjectId),!t)throw new MongooseError.MissingSchemaError;this.$__setSchema(t),NodeJSDocument.call(this,e,o,r,n),applyHooks(this,t,{decorateDoc:!0});for(const e in t.methods)this[e]=t.methods[e];for(const e in t.statics)this[e]=t.statics[e]}Document.prototype=Object.create(NodeJSDocument.prototype),Document.prototype.constructor=Document,Document.events=new EventEmitter,Document.$emitter=new EventEmitter,utils.each([\"on\",\"once\",\"emit\",\"listeners\",\"removeListener\",\"setMaxListeners\",\"removeAllListeners\",\"addListener\"],function(e){Document[e]=function(){return Document.$emitter[e].apply(Document.$emitter,arguments)}}),Document.ValidationError=ValidationError,module.exports=exports=Document;","node_modules/mongoose/lib/cursor/QueryCursor.js":"\"use strict\";const Readable=require(\"stream\").Readable,eachAsync=require(\"../helpers/cursor/eachAsync\"),helpers=require(\"../queryhelpers\"),util=require(\"util\"),utils=require(\"../utils\");function QueryCursor(r,e){Readable.call(this,{objectMode:!0}),this.cursor=null,this.query=r;const t=this,o=r.model;this._mongooseOptions={},this._transforms=[],this.model=o,o.hooks.execPre(\"find\",r,()=>{this._transforms=this._transforms.concat(r._transforms.slice()),e.transform&&this._transforms.push(e.transform),(e=e||{}).batchSize&&(e.cursor=e.cursor||{},e.cursor.batchSize=e.batchSize),o.collection.find(r._conditions,e,function(r,e){if(t._error&&(e.close(function(){}),t.listeners(\"error\").length>0&&t.emit(\"error\",t._error)),r)return t.emit(\"error\",r);t.cursor=e,t.emit(\"cursor\",e)})})}function _next(r,e){let t=e;return r._transforms.length&&(t=function(t,o){if(t||null===o&&!r._mongooseOptions.transformNull)return e(t,o);e(t,r._transforms.reduce(function(e,t){return t.call(r,e)},o))}),r._error?process.nextTick(function(){t(r._error)}):r.cursor?r.cursor.next(function(e,o){if(e)return t(e);if(!o)return t(null,null);const n=r.query._mongooseOptions;if(!n.populate)return n.lean?t(null,o):_create(r,o,null,t);const s=helpers.preparePopulationOptionsMQ(r.query,r.query._mongooseOptions);s.__noPromise=!0,r.query.model.populate(o,s,function(e,o){return e?t(e):n.lean?t(null,o):_create(r,o,s,t)})}):void r.once(\"cursor\",function(){_next(r,e)})}function _waitForCursor(r,e){if(r.cursor)return e();r.once(\"cursor\",function(){e()})}function _create(r,e,t,o){const n=helpers.createModel(r.query.model,e,r.query._fields),s=t?{populated:t}:void 0;n.init(e,s,function(r){if(r)return o(r);o(null,n)})}util.inherits(QueryCursor,Readable),QueryCursor.prototype._read=function(){const r=this;_next(this,function(e,t){return e?r.emit(\"error\",e):t?void r.push(t):(r.push(null),void r.cursor.close(function(e){if(e)return r.emit(\"error\",e);setTimeout(function(){r.emit(\"close\")},0)}))})},QueryCursor.prototype.map=function(r){return this._transforms.push(r),this},QueryCursor.prototype._markError=function(r){return this._error=r,this},QueryCursor.prototype.close=function(r){return utils.promiseOrCallback(r,r=>{this.cursor.close(e=>{if(e)return r(e),this.listeners(\"error\").length>0&&this.emit(\"error\",e);this.emit(\"close\"),r(null)})},this.model.events)},QueryCursor.prototype.next=function(r){return utils.promiseOrCallback(r,r=>{_next(this,function(e,t){if(e)return r(e);r(null,t)})},this.model.events)},QueryCursor.prototype.eachAsync=function(r,e,t){const o=this;return\"function\"==typeof e&&(t=e,e={}),eachAsync(function(r){return _next(o,r)},r,e=e||{},t)},QueryCursor.prototype.addCursorFlag=function(r,e){const t=this;return _waitForCursor(this,function(){t.cursor.addCursorFlag(r,e)}),this},QueryCursor.prototype.transformNull=function(r){return 0===arguments.length&&(r=!0),this._mongooseOptions.transformNull=r,this},module.exports=QueryCursor;","node_modules/mongoose/lib/helpers/query/applyGlobalMaxTimeMS.js":"\"use strict\";const utils=require(\"../../utils\");module.exports=function(e,i){utils.hasUserDefinedProperty(e,\"maxTimeMS\")||(utils.hasUserDefinedProperty(i.db.options,\"maxTimeMS\")?e.maxTimeMS=i.db.options.maxTimeMS:utils.hasUserDefinedProperty(i.base.options,\"maxTimeMS\")&&(e.maxTimeMS=i.base.options.maxTimeMS))};","node_modules/mongoose/lib/helpers/schema/applyWriteConcern.js":"\"use strict\";const get=require(\"../get\");module.exports=function(t,e){const n=get(t,\"options.writeConcern\",{});\"w\"in e||null==n.w||(e.w=n.w),\"j\"in e||null==n.j||(e.j=n.j),\"wtimeout\"in e||null==n.wtimeout||(e.wtimeout=n.wtimeout)};","node_modules/mongoose/lib/helpers/update/castArrayFilters.js":"\"use strict\";const castFilterPath=require(\"../query/castFilterPath\"),cleanPositionalOperators=require(\"../schema/cleanPositionalOperators\"),getPath=require(\"../schema/getPath\"),modifiedPaths=require(\"./modifiedPaths\");module.exports=function(t){const r=t.options.arrayFilters;if(!Array.isArray(r))return;const e=t.getUpdate(),o=t.schema,n=o.options.strictQuery,s=modifiedPaths(e),i=Object.keys(s).reduce((t,r)=>{const e=r.match(/\\$\\[[^\\]]+\\]/g);if(null==e)return t;for(const o of e){const e=r.indexOf(o);if(e!==r.lastIndexOf(o))throw new Error(`Path '${r}' contains the same array filter multiple times`);t[o.substring(2,o.length-1)]=r.substr(0,e-1).replace(/\\$\\[[^\\]]+\\]/g,\"0\")}return t},{});for(const e of r){if(null==e)throw new Error(`Got null array filter in ${r}`);const s=Object.keys(e)[0];if(null==e[s])continue;const a=s.indexOf(\".\");let l=-1===a?i[s]+\".0\":i[s.substr(0,a)]+\".0\"+s.substr(a);if(null==l)throw new Error(`Filter path not found for ${s}`);l=cleanPositionalOperators(l);const c=getPath(o,l);if(null==c){if(!n)return;throw new Error(`Could not find path \"${l}\" in schema`)}\"object\"==typeof e[s]?e[s]=castFilterPath(t,c,e[s]):e[s]=c.castForQuery(e[s])}};","node_modules/mongoose/lib/helpers/query/castUpdate.js":"\"use strict\";const CastError=require(\"../../error/cast\"),StrictModeError=require(\"../../error/strict\"),ValidationError=require(\"../../error/validation\"),castNumber=require(\"../../cast/number\"),cast=require(\"../../cast\"),getEmbeddedDiscriminatorPath=require(\"./getEmbeddedDiscriminatorPath\"),handleImmutable=require(\"./handleImmutable\"),utils=require(\"../../utils\");function walkUpdatePath(t,e,r,s,a,i,n){const o=s.strict,c=n?n+\".\":\"\",l=Object.keys(e);let u,p,d,h,$=l.length,f=!1,m=null;for(h=void 0===s.useNestedStrict?t.options.useNestedStrict:s.useNestedStrict;$--;)if(d=e[p=l[$]],\"$pull\"!==r||null==(u=t._getSchema(c+p))||null==u.schema)if(d&&\"Object\"===d.constructor.name){if(u=t._getSchema(c+p),handleImmutable(u,o,e,p,c+p,a))continue;if(u&&u.caster&&r in castOps)if(\"$each\"in d){f=!0;try{e[p]={$each:castUpdateVal(u,d.$each,r,p,a,c+p)}}catch(t){m=_handleCastError(t,a,p,m)}null!=d.$slice&&(e[p].$slice=0|d.$slice),d.$sort&&(e[p].$sort=d.$sort),(d.$position||0===d.$position)&&(e[p].$position=d.$position)}else{try{e[p]=castUpdateVal(u,d,r,p,a,c+p)}catch(t){m=_handleCastError(t,a,p,m)}if(s.omitUndefined&&void 0===e[p]){delete e[p];continue}f=!0}else if(\"$currentDate\"===r||r in castOps&&u){try{e[p]=castUpdateVal(u,d,r,p,a,c+p)}catch(t){m=_handleCastError(t,a,p,m)}if(s.omitUndefined&&void 0===e[p]){delete e[p];continue}f=!0}else{const n=c+p,l=t._getPathType(n);let u=o;if(h&&l&&l.schema&&\"strict\"in l.schema.options&&(u=l.schema.options.strict),\"undefined\"===l.pathType){if(\"throw\"===u)throw new StrictModeError(n);if(u){delete e[p];continue}}f|=walkUpdatePath(t,d,r,s,a,i,c+p)||utils.isObject(d)&&0===Object.keys(d).length}}else{const l=\"$each\"===p||\"$or\"===p||\"$and\"===p||\"$in\"===p?n:c+p;if(u=t._getSchema(l),\"$setOnInsert\"!==r&&handleImmutable(u,o,e,p,c+p,a))continue;let $=t._getPathType(l);if(null==u){const r=getEmbeddedDiscriminatorPath(t,e,i,l);null!=r.schematype&&(u=r.schematype,$=r.type)}let y=o;if(h&&$&&$.schema&&\"strict\"in $.schema.options&&(y=$.schema.options.strict),y&&!u&&!/real|nested/.test($.pathType)){if(\"throw\"===y&&null==t.virtuals[l])throw new StrictModeError(c+p);delete e[p]}else{if(\"$rename\"===r){f=!0;continue}try{e[p]=castUpdateVal(u,d,r,p,a,c+p)}catch(t){m=_handleCastError(t,a,p,m)}if(!Array.isArray(e[p])||\"$addToSet\"!==r&&\"$push\"!==r||\"$each\"===p||u&&u.caster&&!u.caster.$isMongooseArray&&(e[p]={$each:e[p]}),s.omitUndefined&&void 0===e[p]){delete e[p];continue}f=!0}}else e[p]=cast(u.schema,e[p],s,a),f=!0;if(null!=m)throw m;return f}function _handleCastError(t,e,r,s){if(\"object\"!=typeof e||!e.options.multipleCastError)throw t;return(s=s||new ValidationError).addError(r,t),s}module.exports=function(t,e,r,s,a){if(!e)return;const i=Object.keys(e);let n=i.length;const o={};let c,l,u=!1;const p=r.overwrite;for(a=a||{};n--;){const t=i[n];\"$\"===t[0]||p?\"$set\"===t&&o.$set||(o[t]=e[t]):(o.$set||(e.$set?o.$set=e.$set:o.$set={}),o.$set[t]=e[t],i.splice(n,1),~i.indexOf(\"$set\")||i.push(\"$set\"))}for(n=i.length,p&&(c=!0);n--;){const e=i[n];if(l=o[e],u=u||e.startsWith(\"$\"),!l||\"object\"!=typeof l||Buffer.isBuffer(l)||p&&!u){if(!p||!o||\"object\"!=typeof o){throw new Error(\"Invalid atomic update value for \"+e+\". Expected an object, received \"+typeof l)}walkUpdatePath(t,o,\"$set\",r,s,a)}else c|=walkUpdatePath(t,l,e,r,s,a);e.startsWith(\"$\")&&utils.isEmptyObject(l)&&delete o[e]}return c&&o};const numberOps={$pop:1,$inc:1},noCastOps={$unset:1},castOps={$push:1,$addToSet:1,$set:1,$setOnInsert:1},overwriteOps={$set:1,$setOnInsert:1};function castUpdateVal(t,e,r,s,a,i){if(!t){if(r in numberOps)try{return castNumber(e)}catch(t){throw new CastError(\"number\",e,i)}return e}if(t.caster&&r in castOps&&(utils.isObject(e)||Array.isArray(e))&&!overwriteOps[r]){let r=0,s=t;for(;s.$isMongooseArray;)++r,s=s.caster;let i=0,n=e;for(;Array.isArray(n);)++i,n=n[0];const o=r-i;for(;i<r;)e=[e],++i;let c=t.applySetters(Array.isArray(e)?e:[e],a);for(let t=0;t<o;++t)c=c[0];return c}if(r in noCastOps)return e;if(r in numberOps){if(null==e)throw new CastError(\"number\",e,t.path);if(\"$inc\"===r)return t.castForQueryWrapper({val:e,context:a});try{return castNumber(e)}catch(r){throw new CastError(\"number\",e,t.path)}}return\"$currentDate\"===r?\"object\"==typeof e?{$type:e.$type}:Boolean(e):/^\\$/.test(s)?t.castForQueryWrapper({$conditional:s,val:e,context:a}):overwriteOps[r]?t.castForQueryWrapper({val:e,context:a,$skipQueryCastForUpdate:null!=e&&t.$isMongooseArray&&null!=t.$fullPath&&!t.$fullPath.match(/\\d+$/)}):t.castForQueryWrapper({val:e,context:a})}","node_modules/mongoose/lib/helpers/query/completeMany.js":"\"use strict\";const helpers=require(\"../../queryhelpers\");function completeMany(e,t,s,n,l,c){const o=[];let r=t.length;const i=r;let u=null;function p(e){null!=e&&(u=u||e),null==u?--r||process.nextTick(()=>c(u,o)):--r||process.nextTick(()=>c(u))}for(let c=0;c<i;++c){o[c]=helpers.createModel(e,t[c],s,n);try{o[c].init(t[c],l,p)}catch(u){p(u)}o[c].$session(l.session)}}module.exports=completeMany;","node_modules/mongoose/lib/helpers/query/hasDollarKeys.js":"\"use strict\";module.exports=function(t){const e=Object.keys(t),r=e.length;for(let t=0;t<r;++t)if(e[t].startsWith(\"$\"))return!0;return!1};","node_modules/mongoose/lib/queryhelpers.js":"\"use strict\";const checkEmbeddedDiscriminatorKeyProjection=require(\"./helpers/discriminator/checkEmbeddedDiscriminatorKeyProjection\"),get=require(\"./helpers/get\"),getDiscriminatorByValue=require(\"./helpers/discriminator/getDiscriminatorByValue\"),isDefiningProjection=require(\"./helpers/projection/isDefiningProjection\"),utils=require(\"./utils\");function makeLean(e){return function(t){t.options||(t.options={}),t.options.lean=e}}exports.preparePopulationOptions=function(e,t){const n=utils.object.vals(e.options.populate);return null!=t.lean&&n.filter(e=>null==get(e,\"options.lean\")).forEach(makeLean(t.lean)),n},exports.preparePopulationOptionsMQ=function(e,t){const n=utils.object.vals(e._mongooseOptions.populate);null!=t.lean&&n.filter(e=>null==get(e,\"options.lean\")).forEach(makeLean(t.lean));const o=get(e,\"options.session\",null);null!=o&&n.forEach(e=>{null!=e.options?\"session\"in e.options||(e.options.session=o):e.options={session:o}});const i=e._fieldsForExec();return n.forEach(e=>{e._queryProjection=i}),n},exports.createModel=function(e,t,n,o){e.hooks.execPreSync(\"createModel\",t);const i=e.schema?e.schema.discriminatorMapping:null,s=i&&i.isRoot?i.key:null,r=t[s];if(s&&r&&e.discriminators){const t=e.discriminators[r]||getDiscriminatorByValue(e,r);if(t){const e=utils.clone(o);return exports.applyPaths(e,t.schema),new t(void 0,e,!0)}}return new e(void 0,n,{skipId:!0,isNew:!1,willInit:!0})},exports.applyPaths=function(e,t){let n,o,i,s;if(e)for(i=(o=Object.keys(e)).length;i--;)if(\"+\"!==o[i][0]&&(s=e[o[i]],isDefiningProjection(s))){n=0===s;break}const r=[],l=[],c=[],u=function(t,i){const s=\"+\"+t,c=e&&s in e;if(c&&delete e[s],\"boolean\"!=typeof i.selected)return;if(c)return delete e[s],void(!1===n&&o.length>1&&!~o.indexOf(t)&&(e[t]=1));const u=t.split(\".\");let a=\"\";for(let e=0;e<u.length;++e)if(a+=a.length?\".\"+u[e]:u[e],-1!==l.indexOf(a))return;if(!n&&get(i,\"options.$skipDiscriminatorCheck\",!1)){let t=\"\";for(let n=0;n<u.length;++n){t+=(0===t.length?\"\":\".\")+u[n];const o=get(e,t,!1);if(o&&\"object\"!=typeof o)return}}return(i.selected?r:l).push(t),t};switch(function t(o,i){i||(i=\"\");if(-1!==c.indexOf(o))return[];c.push(o);const s=[];o.eachPath(function(o,l){i&&(o=i+\".\"+o);const c=u(o,l);if(null!=c&&s.push(c),l.schema){const i=t(l.schema,o);!1===n&&checkEmbeddedDiscriminatorKeyProjection(e,o,l.schema,r,i)}});c.pop();return s}(t),n){case!0:for(let t=0;t<l.length;++t)e[l[t]]=0;break;case!1:t&&t.paths._id&&t.paths._id.options&&!1===t.paths._id.options.select&&(e._id=0);for(let t=0;t<r.length;++t)e[r[t]]=1;break;case void 0:if(null==e)break;for(const t of Object.keys(e||{}))t.startsWith(\"+\")&&delete e[t];for(let t=0;t<l.length;++t)e[l[t]]=0}},exports.handleDeleteWriteOpResult=function(e){return function(t,n){if(t)return e(t);const o=Object.assign({},n.result);return null!=get(n,\"result.n\",null)&&(o.deletedCount=n.result.n),null!=n.deletedCount&&(o.deletedCount=n.deletedCount),e(null,o)}};","node_modules/mongoose/lib/helpers/projection/isInclusive.js":"\"use strict\";const isDefiningProjection=require(\"./isDefiningProjection\");module.exports=function(n){if(null==n)return!1;const t=Object.keys(n),e=t.length;if(0===e)return!1;for(let i=0;i<e;++i){const e=t[i];if(!e.startsWith(\"+\")&&(isDefiningProjection(n[e])&&n[e]))return!0}return!1};","node_modules/mongoose/lib/helpers/query/selectPopulatedFields.js":"\"use strict\";function isPathInFields(e,l){const t=l.split(\".\"),s=t.length;let n=t[0];for(let l=1;l<s;++l){if(null!=e[n])return!0;n+=\".\"+t[l]}return null!=e[n]}module.exports=function(e){const l=e._mongooseOptions;if(null!=l.populate){const t=Object.keys(l.populate),s=e._userProvidedFields||{};if(e.selectedInclusively())for(let l=0;l<t.length;++l)isPathInFields(s,t[l])?0===s[t[l]]&&delete e._fields[t[l]]:e.select(t[l]);else if(e.selectedExclusively())for(let l=0;l<t.length;++l)null==s[t[l]]&&delete e._fields[t[l]]}};","node_modules/mongoose/lib/helpers/setDefaultsOnInsert.js":"\"use strict\";const modifiedPaths=require(\"./common\").modifiedPaths;function isModified(t,e){if(t[e])return!0;const n=e.split(\".\");let s=n[0];for(let e=1;e<n.length;++e){if(t[s])return!0;s+=\".\"+n[e]}return!1}module.exports=function(t,e,n,s){const i=Object.keys(n||{}),o={},r={},f=i.length,c={};let l=!1;if(!(s=s||{}).upsert||!s.setDefaultsOnInsert)return n;for(let t=0;t<f;++t)i[t].startsWith(\"$\")&&(modifiedPaths(n[i[t]],\"\",c),l=!0);l||modifiedPaths(n,\"\",c);const d=Object.keys(t),u=d.length;for(let e=0;e<u;++e){const n=d[e],s=t[n];if(s&&\"object\"==typeof s){const t=Object.keys(s),e=t.length;let n=!1;for(let s=0;s<e;++s)if(t[s].startsWith(\"$\")){n=!0;break}if(n)continue}o[n]=!0,c[n]=!0}return s&&s.overwrite&&!l?n:(e.eachPath(function(t,e){const s=e.path.endsWith(\".$*\")||-1!==e.path.indexOf(\".$*.\");if(e.$isSingleNested&&!s)e.schema.eachPath(function(e,s){if(\"_id\"===e&&s.auto)return;const i=s.getDefault(null,!0);isModified(c,t+\".\"+e)||void 0===i||((n=n||{}).$setOnInsert=n.$setOnInsert||{},n.$setOnInsert[t+\".\"+e]=i,r[t+\".\"+e]=i)});else{const s=e.getDefault(null,!0);isModified(c,t)||void 0===s||((n=n||{}).$setOnInsert=n.$setOnInsert||{},n.$setOnInsert[t]=s,r[t]=s)}}),n)};","node_modules/mongoose/lib/helpers/updateValidators.js":"\"use strict\";const ValidationError=require(\"../error/validation\"),cleanPositionalOperators=require(\"./schema/cleanPositionalOperators\"),flatten=require(\"./common\").flatten,modifiedPaths=require(\"./common\").modifiedPaths;module.exports=function(t,n,e,o,l){let r;const u=Object.keys(e||{});let i={},a={};const s={},c={},f=u.length;let h=!1;const d={};let p,$,g;for(g=0;g<f;++g)if(u[g].startsWith(\"$\")){if(h=!0,\"$push\"===u[g]||\"$addToSet\"===u[g]){r=Object.keys(e[u[g]]);for(let t=0;t<r.length;++t)(p=e[u[g]][r[t]])&&p.$each?c[r[t]]=(c[r[t]]||[]).concat(p.$each):c[r[t]]=(c[r[t]]||[]).concat([p]);continue}modifiedPaths(e[u[g]],\"\",d);const t=flatten(e[u[g]],null,null,n),o=Object.keys(t),l=o.length;for(let n=0;n<l;++n){const e=cleanPositionalOperators(o[n]);$=u[g],e.includes(\"$\")||(\"$set\"===$||\"$setOnInsert\"===$||\"$pull\"===$||\"$pullAll\"===$?(a[e]=t[o[n]],s[e]=\"$pull\"===$||\"$pullAll\"===$):\"$unset\"===$&&(a[e]=void 0),i[e]=!0)}}h||(modifiedPaths(e,\"\",d),a=flatten(e,null,null,n),i=Object.keys(a));const m=Object.keys(a),y=m.length,O=[],V=[],b=[],j=o&&\"query\"===o.context?t:null;function k(t,e){const o=n._getSchema(m[t]);if(null!=o)if(e&&Array.isArray(e.$in))e.$in.forEach((t,n)=>{O.push(function(e){o.doValidate(t,function(t){t&&(t.path=m[n]+\".$in.\"+n,V.push(t)),e(null)},j,{updateValidator:!0})})});else{if(s[m[t]]&&o.$isMongooseArray)return;o.$isMongooseDocumentArrayElement&&null!=e&&null!=e.$__?(b.push(m[t]),O.push(function(n){o.doValidate(e,function(o){if(o)return o.path=m[t],V.push(o),n(null);e.validate(function(e){if(e)if(e.errors)for(const n of Object.keys(e.errors)){const o=e.errors[n];o.path=m[t]+\".\"+n,V.push(o)}else e.path=m[t],V.push(e);n(null)})},j,{updateValidator:!0})})):O.push(function(n){for(const e of b)if(m[t].startsWith(e+\".\"))return n(null);o.doValidate(e,function(e){e&&(e.path=m[t],V.push(e)),n(null)},j,{updateValidator:!0})})}}for(g=0;g<y;++g)k(g,a[m[g]]);const q=Object.keys(c),A=q.length;for(g=0;g<A;++g)!function(e){let l=n._getSchema(q[e]);if(l&&l.$isMongooseDocumentArray)O.push(function(n){l.doValidate(c[q[e]],function(t){t&&(t.path=q[e],V.push(t)),n(null)},o&&\"query\"===o.context?t:null)});else{l=n._getSchema(q[e]+\".0\");for(let n=0;n<c[q[e]].length;++n)!function(n){O.push(function(r){l.doValidate(c[q[e]][n],function(t){t&&(t.path=q[e],V.push(t)),r(null)},o&&\"query\"===o.context?t:null,{updateValidator:!0})})}(n)}}(g);if(null==l)return function(t){let n=O.length;if(0===n)return P(t);for(const e of O)e(function(){--n<=0&&P(t)})};{let t=O.length;if(0===t)return P(l);for(const n of O)n(function(){--t<=0&&P(l)})}function P(t){if(V.length){const n=new ValidationError(null);for(let t=0;t<V.length;++t)n.addError(V[t].path,V[t]);return t(n)}t(null)}};","node_modules/mongoose/lib/helpers/query/wrapThunk.js":"\"use strict\";module.exports=function(t){return function(n){++this._executionCount,t.call(this,n)}};","node_modules/mongoose/lib/helpers/cursor/eachAsync.js":"\"use strict\";const utils=require(\"../../utils\");function asyncQueue(){const n=[];let t=null,u=0;return function(l){if(0===n.length&&null==t)return t=u++,l(e);n.push(l)};function e(){if(t=null,n.length>0){t=u++,n.shift()(e)}}}module.exports=function(n,t,u,e){const l=u.parallel||1,r=asyncQueue(),i=function(n,u){const e=t(n);e&&\"function\"==typeof e.then?e.then(function(){u(null)},function(n){u(n||new Error(\"`eachAsync()` promise rejected without error\"))}):u(null)};return utils.promiseOrCallback(e,t=>{!function(t){let u=!1,e=null;for(let n=0;n<l;++n)r(o);function o(l){if(u||e)return l();n(function(n,c){return u||e?l():null!=n?(e=n,t(n),l()):null==c?(u=!0,t(null),l()):(l(),void i(c,function(n){if(null!=n)return e=n,t(n);setTimeout(()=>r(o),0)}))})}}(t)})};","node_modules/mongoose/lib/helpers/discriminator/checkEmbeddedDiscriminatorKeyProjection.js":"\"use strict\";module.exports=function(t,e,s,i,c){const n=Object.keys(t).reduce((t,s)=>t||s.startsWith(e+\".\"),!1),o=e+\".\"+s.options.discriminatorKey;n||1!==c.length||c[0]!==o||i.splice(i.indexOf(o),1)};","node_modules/mongoose/lib/helpers/query/castFilterPath.js":"\"use strict\";module.exports=function(t,e,r){const n=t;if(!Object.keys(r).some(function(t){return t.startsWith(\"$\")&&\"$id\"!==t&&\"$ref\"!==t}))return e.castForQueryWrapper({val:r,context:n});const o=Object.keys(r);let c=o.length;for(;c--;){const t=o[c],s=r[t];if(\"$not\"===t){if(s&&e&&!e.caster){const o=Object.keys(s);if(o.length&&o[0].startsWith(\"$\"))for(const t in s)s[t]=e.castForQueryWrapper({$conditional:t,val:s[t],context:n});else r[t]=e.castForQueryWrapper({$conditional:t,val:s,context:n});continue}}else r[t]=e.castForQueryWrapper({$conditional:t,val:s,context:n})}return r};","node_modules/mongoose/lib/helpers/schema/getPath.js":"\"use strict\";module.exports=function(t,e){let n=t.path(e);if(null!=n)return n;const o=e.split(\".\");let s=\"\",l=!1;for(const e of o)/^\\d+$/.test(e)&&l||(s=0===s.length?e:s+\".\"+e,null!=(n=t.path(s))&&n.schema&&(t=n.schema,s=\"\",n.$isMongooseDocumentArray&&(l=!0)));return n};","node_modules/mongoose/lib/helpers/update/modifiedPaths.js":"\"use strict\";const _modifiedPaths=require(\"../common\").modifiedPaths;module.exports=function(t){const o=Object.keys(t),s={},e={};for(const i of o)i.startsWith(\"$\")?_modifiedPaths(t[i],\"\",s):e[i]=t[i];return _modifiedPaths(e,\"\",s),s};","node_modules/mongoose/lib/helpers/query/getEmbeddedDiscriminatorPath.js":"\"use strict\";const cleanPositionalOperators=require(\"../schema/cleanPositionalOperators\"),get=require(\"../get\");module.exports=function(e,t,n,l){const i=l.split(\".\");let o=null,s=\"adhocOrUndefined\";n=n||{},t=t||{};for(let t=0;t<i.length;++t){const l=cleanPositionalOperators(i.slice(0,t+1).join(\".\"));if(null!=(o=e.path(l))&&(s=e.pathType(l),(o.$isSingleNested||o.$isMongooseDocumentArrayElement)&&null!=o.schema.discriminators)){const e=o.schema.discriminators,a=get(o,\"schema.options.discriminatorKey\"),c=l+\".\"+a,r=c.replace(/\\.\\d+\\./,\".\");let u=null;c in n&&(u=n[c]),r in n&&(u=n[r]);const m=l.replace(/\\.\\d+$/,\"\");if(o.$isMongooseDocumentArrayElement&&null!=get(n[m],\"$elemMatch.\"+a)&&(u=n[m].$elemMatch[a]),null==u||null==e[u])continue;const p=i.slice(t+1).join(\".\");if(null!=(o=e[u].path(p))){s=e[u]._getPathType(p);break}}}return{type:s,schematype:o}};","node_modules/mongoose/lib/helpers/query/handleImmutable.js":"\"use strict\";const StrictModeError=require(\"../../error/strict\");module.exports=function(t,r,e,i,o,n){if(null==t||!t.options||!t.options.immutable)return!1;let u=t.options.immutable;if(\"function\"==typeof u&&(u=u.call(n,n)),!u)return!1;if(!1===r)return!1;if(\"throw\"===r)throw new StrictModeError(null,`Field ${o} is immutable and strict = 'throw'`);return delete e[i],!0};","node_modules/mongoose/lib/cursor/ChangeStream.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter;class ChangeStream extends EventEmitter{constructor(e,t,r){super(),this.driverChangeStream=null,this.closed=!1,e.collection.buffer?e.collection.addQueue(()=>{this.closed||(this.driverChangeStream=e.collection.watch(t,r),this._bindEvents(),this.emit(\"ready\"))}):(this.driverChangeStream=e.collection.watch(t,r),this._bindEvents(),this.emit(\"ready\"))}_bindEvents(){this.driverChangeStream.on(\"close\",()=>{this.closed=!0}),[\"close\",\"change\",\"end\",\"error\"].forEach(e=>{this.driverChangeStream.on(e,t=>this.emit(e,t))})}_queue(e){this.once(\"ready\",()=>e())}close(){this.closed=!0,this.driverChangeStream&&this.driverChangeStream.close()}}module.exports=ChangeStream;","node_modules/mongoose/lib/options/removeOptions.js":"\"use strict\";const utils=require(\"../utils\");class RemoveOptions{constructor(s){null!=s&&Object.assign(this,utils.clone(s))}}module.exports=RemoveOptions;","node_modules/mongoose/lib/options/saveOptions.js":"\"use strict\";const utils=require(\"../utils\");class SaveOptions{constructor(s){null!=s&&Object.assign(this,utils.clone(s))}}module.exports=SaveOptions;","node_modules/mongoose/lib/helpers/model/applyMethods.js":"\"use strict\";const get=require(\"../get\");module.exports=function e(o,t){function s(e,t){Object.defineProperty(o.prototype,e,{get:function(){const o={};for(const s in t.methods[e])o[s]=t.methods[e][s].bind(this);return o},configurable:!0})}for(const e of Object.keys(t.methods)){const r=t.methods[e];if(t.tree.hasOwnProperty(e))throw new Error('You have a method and a property in your schema both named \"'+e+'\"');t.reserved[e]&&!get(t,`methodOptions.${e}.suppressWarning`,!1)&&console.warn(`mongoose: the method name \"${e}\" is used by mongoose `+\"internally, overwriting it may cause bugs. If you're sure you know what you're doing, you can suppress this error by using \"+`\\`schema.method('${e}', fn, { suppressWarning: true })\\`.`),\"function\"==typeof r?o.prototype[e]=r:s(e,t)}o.$appliedMethods=!0;for(const o of Object.keys(t.paths)){const s=t.paths[o];s.$isSingleNested&&!s.caster.$appliedMethods&&e(s.caster,s.schema),s.$isMongooseDocumentArray&&!s.Constructor.$appliedMethods&&e(s.Constructor,s.schema)}};","node_modules/mongoose/lib/helpers/model/applyStaticHooks.js":"\"use strict\";const middlewareFunctions=require(\"../query/applyQueryMiddleware\").middlewareFunctions,utils=require(\"../../utils\");module.exports=function(n,e,t){e=e.filter(n=>-1!==middlewareFunctions.indexOf(n.name)?!!n.model:!1!==n.model),n.$__insertMany=e.createWrapper(\"insertMany\",n.$__insertMany,n,{useErrorHandlers:!0,numCallbackParams:1});for(const l of Object.keys(t))if(e.hasHooks(l)){const t=n[l];n[l]=function(){const r=arguments.length,u=r>0?arguments[r-1]:null,i=\"function\"==typeof u?u:null,o=Array.prototype.slice.call(arguments,0,null==i?r:r-1);return utils.promiseOrCallback(i,r=>{e.execPre(l,n,o,function(u){if(null!=u)return r(u);let i=0;const s=t.apply(n,o.concat(c));function c(t,u){if(!(i++>0))return null!=t?r(t):void e.execPost(l,n,[u],function(n){if(null!=n)return r(n);r(null,u)})}null!=s&&\"function\"==typeof s.then&&s.then(n=>c(null,n),n=>c(n))})},n.events)}}};","node_modules/mongoose/lib/helpers/model/applyStatics.js":"\"use strict\";module.exports=function(t,s){for(const c in s.statics)t[c]=s.statics[c]};","node_modules/mongoose/lib/helpers/populate/assignVals.js":"\"use strict\";const assignRawDocsToIdStructure=require(\"./assignRawDocsToIdStructure\"),get=require(\"../get\"),getVirtual=require(\"./getVirtual\"),leanPopulateMap=require(\"./leanPopulateMap\"),mpath=require(\"mpath\"),sift=require(\"sift\").default,utils=require(\"../../utils\");function numDocs(t){return Array.isArray(t)?t.some(t=>Array.isArray(t))?t.map(t=>numDocs(t)):t.length:null==t?0:1}function valueFilter(t,e,r){if(Array.isArray(t)){const a=[],l=t.length;for(let i=0;i<l;++i){const l=t[i];if((isPopulatedObject(l)||r.retainNullValues&&null==l)&&(maybeRemoveId(l,e),a.push(l),e.originalLimit&&a.length>=e.originalLimit))break}for(;t.length>a.length;)Array.prototype.pop.apply(t,[]);for(let e=0;e<a.length;++e)t[e]=a[e];return t}return isPopulatedObject(t)?(maybeRemoveId(t,e),t):t instanceof Map?t:!0===r.justOne?null==t?t:null:!1===r.justOne?[]:t}function maybeRemoveId(t,e){e.excludeId&&(\"function\"==typeof t.$__setValue?delete t._doc._id:delete t._id)}function isPopulatedObject(t){return null!=t&&(Array.isArray(t)||t.$isMongooseMap||null!=t.$__||leanPopulateMap.has(t))}module.exports=function(t){const e=get(t,\"allOptions.options.options\"),r=Object.assign({},t.options,e,{justOne:t.justOne});r.$nullIfNotFound=t.isVirtual;const a=[].concat(t.rawIds);assignRawDocsToIdStructure(t.rawIds,t.rawDocs,t.rawOrder,r);const l=t.docs,i=t.rawIds,n=t.options,s=t.count&&t.isVirtual;function u(e){return s?e:!0===t.justOne&&Array.isArray(e)?valueFilter(e[0],n,r):!1!==t.justOne||Array.isArray(e)?valueFilter(e,n,r):valueFilter([e],n,r)}for(let e=0;e<l.length;++e){const r=utils.getValue(t.path,l[e]);if(null==r&&!getVirtual(t.originalModel.schema,t.path))continue;let n;n=s?numDocs(i[e]):Array.isArray(t.match)?Array.isArray(i[e])?sift(t.match[e],i[e]):sift(t.match[e],[i[e]])[0]:i[e];const o=t.originalModel.schema,c=null!=get(l[e],\"$__\",null);let p=c?r instanceof Map:utils.isPOJO(r);if(p=p&&get(o._getSchema(t.path),\"$isSchemaMap\"),!t.isVirtual&&p){const t=r instanceof Map?Array.from(r.keys()):Object.keys(r);n=n.reduce((e,r,a)=>(e.set(t[a],r),e),new Map)}if(t.isVirtual&&c){l[e].populated(t.path,t.justOne?a[0]:a,t.allOptions),mpath.set(t.path,n,l[e],u);continue}const d=t.path.split(\".\");let f=l[e];for(let t=0;t<d.length-1&&(!Array.isArray(f)||utils.isArrayIndex(d[t]));++t)if(null==f[d[t]]&&(f[d[t]]={}),\"object\"!=typeof(f=f[d[t]]))return;l[e].$__&&l[e].populated(t.path,t.allIds[e],t.allOptions),utils.setValue(t.path,n,l[e],u,!1)}};","node_modules/mongoose/lib/helpers/model/castBulkWrite.js":"\"use strict\";const applyTimestampsToChildren=require(\"../update/applyTimestampsToChildren\"),applyTimestampsToUpdate=require(\"../update/applyTimestampsToUpdate\"),cast=require(\"../../cast\"),castUpdate=require(\"../query/castUpdate\"),setDefaultsOnInsert=require(\"../setDefaultsOnInsert\");module.exports=function(e,t,s){const a=e.base.now();return t.insertOne?a=>{const n=new e(t.insertOne.document);null!=e.schema.options.timestamps&&n.initializeTimestamps(),null!=s.session&&n.$session(s.session),t.insertOne.document=n,t.insertOne.document.validate({__noPromise:!0},function(e){if(e)return a(e,null);a(null)})}:t.updateOne?(t=t.updateOne,s=>{try{if(!t.filter)throw new Error(\"Must provide a filter object.\");if(!t.update)throw new Error(\"Must provide an update object.\");if(t.filter=cast(e.schema,t.filter),t.update=castUpdate(e.schema,t.update,{strict:e.schema.options.strict,overwrite:!1}),t.setDefaultsOnInsert&&setDefaultsOnInsert(t.filter,e.schema,t.update,{setDefaultsOnInsert:!0,upsert:t.upsert}),null!=e.schema.$timestamps){const s=e.schema.$timestamps.createdAt,n=e.schema.$timestamps.updatedAt;applyTimestampsToUpdate(a,s,n,t.update,{})}applyTimestampsToChildren(a,t.update,e.schema)}catch(e){return s(e,null)}s(null)}):t.updateMany?(t=t.updateMany,s=>{try{if(!t.filter)throw new Error(\"Must provide a filter object.\");if(!t.update)throw new Error(\"Must provide an update object.\");if(t.filter=cast(e.schema,t.filter),t.update=castUpdate(e.schema,t.update,{strict:e.schema.options.strict,overwrite:!1}),t.setDefaultsOnInsert&&setDefaultsOnInsert(t.filter,e.schema,t.update,{setDefaultsOnInsert:!0,upsert:t.upsert}),null!=e.schema.$timestamps){const s=e.schema.$timestamps.createdAt,n=e.schema.$timestamps.updatedAt;applyTimestampsToUpdate(a,s,n,t.update,{})}applyTimestampsToChildren(a,t.update,e.schema)}catch(e){return s(e,null)}s(null)}):t.replaceOne?a=>{try{t.replaceOne.filter=cast(e.schema,t.replaceOne.filter)}catch(e){return a(e,null)}const n=new e(t.replaceOne.replacement,null,!0);null!=e.schema.options.timestamps&&n.initializeTimestamps(),null!=s.session&&n.$session(s.session),t.replaceOne.replacement=n,t.replaceOne.replacement.validate({__noPromise:!0},function(e){if(e)return a(e,null);a(null)})}:t.deleteOne?s=>{try{t.deleteOne.filter=cast(e.schema,t.deleteOne.filter)}catch(e){return s(e,null)}s(null)}:t.deleteMany?s=>{try{t.deleteMany.filter=cast(e.schema,t.deleteMany.filter)}catch(e){return s(e,null)}s(null)}:e=>{e(new Error(\"Invalid op passed to `bulkWrite()`\"),null)}};","node_modules/mongoose/lib/helpers/each.js":"\"use strict\";module.exports=function(n,t,l){if(0===n.length)return l();let u=n.length,e=null;for(const o of n)t(o,function(n){if(null==e)return null!=n?l(e=n):--u<=0?l():void 0})};","node_modules/mongoose/lib/helpers/populate/getModelsMapForPopulate.js":"\"use strict\";const MongooseError=require(\"../../error/index\"),get=require(\"../get\"),getDiscriminatorByValue=require(\"../discriminator/getDiscriminatorByValue\"),isPathExcluded=require(\"../projection/isPathExcluded\"),getSchemaTypes=require(\"./getSchemaTypes\"),getVirtual=require(\"./getVirtual\"),normalizeRefPath=require(\"./normalizeRefPath\"),util=require(\"util\"),utils=require(\"../../utils\"),modelSymbol=require(\"../symbols\").modelSymbol,populateModelSymbol=require(\"../symbols\").populateModelSymbol,schemaMixedSymbol=require(\"../../schema/symbols\").schemaMixedSymbol;function handleRefFunction(e,t){return\"function\"!=typeof e||e[modelSymbol]?e:e.call(t,t)}function convertTo_id(e,t){if(null!=e&&null!=e.$__)return e._id;if(Array.isArray(e)){for(let t=0;t<e.length;++t)null!=e[t]&&null!=e[t].$__&&(e[t]=e[t]._id);return e.isMongooseArray&&e.$schema()?e.$schema().cast(e,e.$parent()):[].concat(e)}if(null!=e&&\"Object\"===e.constructor.name&&(null==t||null==t[schemaMixedSymbol])){const t=[];for(const o of Object.keys(e))t.push(e[o]);return t}return e instanceof Map?Array.from(e.values()):e}module.exports=function(e,t,o){let l,r;const n=t.length,i={},s=[],a=o.model&&o.model.modelName||o.model;let u,c,p,m,h,f,d;const y=o.model;let g=!1;const A=e.schema;for(l=0;l<n;l++){if(r=t[l],(u=getSchemaTypes(A,r,o.path))&&u.$isUnderneathDocArray&&null!=get(o,\"options.sort\"))return new MongooseError(\"Cannot populate with `sort` on path \"+o.path+\" because it is a subproperty of a document array\");h=null;let n=!1;if(Array.isArray(u))for(let e=0;e<u.length;++e){let t;try{const o=P(r,u[e]);t=o.modelNames,n=o.isRefPath}catch(e){return e}if(t){h=h||[];for(let e=0;e<t.length;++e)-1===h.indexOf(t[e])&&h.push(t[e])}}else{try{const e=P(r,u);h=e.modelNames,n=e.isRefPath}catch(e){return e}if(!h)continue}const a=getVirtual(e.schema,o.path),c=null==a?null:a.virtual;let d,b=!1;if(c&&c.options){const e=a.nestedSchemaPath?a.nestedSchemaPath+\".\":\"\";d=\"function\"==typeof c.options.localField?e+c.options.localField.call(r,r):e+c.options.localField,b=c.options.count}else d=o.path;let S=c&&c.options?c.options.foreignField:\"_id\",_=null;if(\"justOne\"in o&&void 0!==o.justOne)_=o.justOne;else if(c&&c.options&&c.options.refPath){const e=normalizeRefPath(c.options.refPath,r,o.path);_=!!c.options.justOne,g=!0;const t=utils.getValue(e,r);h=Array.isArray(t)?t:[t]}else if(c&&c.options&&c.options.ref){let e;e=\"function\"==typeof c.options.ref?c.options.ref.call(r,r):c.options.ref,_=!!c.options.justOne,g=!0,h||(h=[].concat(e))}else u&&!u[schemaMixedSymbol]&&(_=!u.$isMongooseArray);if(!h)continue;if(c&&(!d||!S))return new MongooseError(\"If you are populating a virtual, you must set the localField and foreignField options\");o.isVirtual=g,o.virtual=c,\"function\"==typeof d&&(d=d.call(r,r)),\"function\"==typeof S&&(S=S.call(r));const V=A._getPathType(d),M=\"real\"===V?A.path(d):V.schema,q=M&&M.getters?M.getters:[];let j;const v=get(o,\"options\",{}),F=\"getters\"in v?v.getters:o.isVirtual&&get(c,\"options.getters\",!1);if(q.length>0&&F){const t=null!=r.$__?r:e.hydrate(r),o=utils.getValue(d,r);if(Array.isArray(o)){const e=utils.getValue(d.split(\".\").slice(0,-1),t);j=o.map((t,o)=>M.applyGetters(t,e[o]))}else j=M.applyGetters(o,t)}else j=convertTo_id(utils.getValue(d,r),u);const R=String(utils.getValue(S,r));o._docs[R]=Array.isArray(j)?j.slice():j;let x=get(o,\"match\",null)||get(m,\"match\",null)||get(o,\"virtual.options.options.match\",null);const $=\"function\"==typeof x;$&&(x=x.call(r,r));let O=h.length;for(;O--;){if(null==(f=h[O]))continue;const t=null!=o.connection?o.connection:e.db;try{p=y&&y[modelSymbol]?y:f[modelSymbol]?f:t.model(f)}catch(e){return e}let l=j;const a=Array.isArray(j)?utils.array.flatten(j):[];n&&Array.isArray(j)&&a.length===h.length&&(l=a.filter((e,t)=>h[t]===f)),i[f]?(i[f].localField.add(d),i[f].foreignField.add(S),i[f].docs.push(r),i[f].ids.push(l),i[f].allIds.push(j),$&&i[f].match.push(x)):(m={model:p},g&&c.options&&c.options.options&&(m.options=utils.clone(c.options.options)),utils.merge(m,o),o[populateModelSymbol]=p,i[f]={model:p,options:m,match:$?[x]:x,docs:[r],ids:[l],allIds:[j],localField:new Set([d]),foreignField:new Set([S]),justOne:_,isVirtual:g,virtual:c,count:b,[populateModelSymbol]:p},s.push(i[f]))}}function P(t,l){let r,n,i=!1;l&&l.caster&&(l=l.caster),l&&l.$isSchemaMap&&(l=l.$__schemaType),!l&&e.discriminators&&(n=e.schema.discriminatorMapping.key),c=l&&l.options&&l.options.refPath;const s=normalizeRefPath(c,t,o.path);if(a)r=[a];else if(s){if(null!=o._queryProjection&&isPathExcluded(o._queryProjection,s))throw new MongooseError(\"refPath `\"+s+\"` must not be excluded in projection, got \"+util.inspect(o._queryProjection));r=A.virtuals.hasOwnProperty(s)&&null==t.$__?[A.virtuals[s].applyGetters(void 0,t)]:utils.getValue(s,t),Array.isArray(r)&&(r=utils.array.flatten(r)),i=!0}else{let s,a=e;if(!l&&n){if(d=utils.getValue(n,t)){const t=getDiscriminatorByValue(e,d);if(null!=t)a=t;else try{a=e.db.model(d)}catch(e){return e}(s=a.schema._getSchema(o.path))&&s.caster&&(s=s.caster)}}else s=l;const u=getVirtual(a.schema,o.path),c=null==u?null:u.virtual;let p,m;null!=(p=get(s,\"options.ref\"))?r=[p=handleRefFunction(p,t)]:null!=(p=get(c,\"options.ref\"))?(p=handleRefFunction(p,t),r=Array.isArray(p)?p:[p],g=!0):null!=(m=get(s,\"options.refPath\"))?(i=!0,m=normalizeRefPath(m,t,o.path),r=utils.getValue(m,t),Array.isArray(r)&&(r=utils.array.flatten(r))):r=n?null:[e.modelName]}return r?(Array.isArray(r)||(r=[r]),{modelNames:r,isRefPath:i}):{modelNames:r,isRefPath:i}}return s};","node_modules/mongoose/lib/helpers/projection/isPathSelectedInclusive.js":"\"use strict\";module.exports=function(e,t){const n=t.split(\".\");let r,l,f,i=\"\";for(let o=0;o<n.length;++o)if(e[i+=i.length?\".\":\"\"+n[o]]){for(f=(l=Object.keys(e)).length,r=0;r<f;++r)0!==l[o].indexOf(i+\".\")||l[o].indexOf(t);return!0}return!1};","node_modules/mongoose/lib/helpers/populate/leanPopulateMap.js":"\"use strict\";module.exports=new WeakMap;","node_modules/mongoose/lib/helpers/parallelLimit.js":"\"use strict\";function parallelLimit(l,t,n){let e=0,i=0,r=null;if(t<=0)throw new Error(\"Limit must be positive\");if(0===l.length)return n(null,[]);for(let n=0;n<l.length&&n<t;++n)u();function u(){var t;l[i+e]((t=i+e,(f,s)=>{if(--e,++i,null==r){if(null!=f)return n(r=f);if(o[t]=s,i===l.length)return n(null,o);i+e<l.length&&u()}})),++e}const o=[]}module.exports=parallelLimit;","node_modules/mongoose/lib/cursor/AggregationCursor.js":"\"use strict\";const MongooseError=require(\"../error/mongooseError\"),Readable=require(\"stream\").Readable,eachAsync=require(\"../helpers/cursor/eachAsync\"),util=require(\"util\"),utils=require(\"../utils\");function AggregationCursor(r){Readable.call(this,{objectMode:!0}),this.cursor=null,this.agg=r,this._transforms=[];const o=r._model;delete r.options.cursor.useMongooseAggCursor,this._mongooseOptions={},_init(o,this,r)}function _init(r,o,t){r.collection.buffer?r.collection.emitter.once(\"queue\",function(){r.hooks.execPre(\"aggregate\",t,function(){o.cursor=r.collection.aggregate(t._pipeline,t.options||{}),o.emit(\"cursor\",o.cursor)})}):r.hooks.execPre(\"aggregate\",t,function(){o.cursor=r.collection.aggregate(t._pipeline,t.options||{}),o.emit(\"cursor\",o.cursor)})}if(util.inherits(AggregationCursor,Readable),AggregationCursor.prototype._read=function(){const r=this;_next(this,function(o,t){return o?r.emit(\"error\",o):t?void r.push(t):(r.push(null),void r.cursor.close(function(o){if(o)return r.emit(\"error\",o);setTimeout(function(){r.emit(\"close\")},0)}))})},null!=Symbol.asyncIterator){const r=\"Mongoose does not support using async iterators with an existing aggregation cursor. See http://bit.ly/mongoose-async-iterate-aggregation\";AggregationCursor.prototype[Symbol.asyncIterator]=function(){throw new MongooseError(r)}}function _waitForCursor(r,o){if(r.cursor)return o();r.once(\"cursor\",function(){o()})}function _next(r,o){let t=o;return r._transforms.length&&(t=function(t,e){if(t||null===e&&!r._mongooseOptions.transformNull)return o(t,e);o(t,r._transforms.reduce(function(r,o){return o(r)},e))}),r._error?process.nextTick(function(){t(r._error)}):r.cursor?r.cursor.next(function(r,o){return r?t(r):o?void t(null,o):t(null,null)}):void r.once(\"cursor\",function(){_next(r,o)})}AggregationCursor.prototype.map=function(r){return this._transforms.push(r),this},AggregationCursor.prototype._markError=function(r){return this._error=r,this},AggregationCursor.prototype.close=function(r){return utils.promiseOrCallback(r,r=>{this.cursor.close(o=>{if(o)return r(o),this.listeners(\"error\").length>0&&this.emit(\"error\",o);this.emit(\"close\"),r(null)})})},AggregationCursor.prototype.next=function(r){return utils.promiseOrCallback(r,r=>{_next(this,r)})},AggregationCursor.prototype.eachAsync=function(r,o,t){const e=this;return\"function\"==typeof o&&(t=o,o={}),eachAsync(function(r){return _next(e,r)},r,o=o||{},t)},AggregationCursor.prototype.transformNull=function(r){return 0===arguments.length&&(r=!0),this._mongooseOptions.transformNull=r,this},AggregationCursor.prototype.addCursorFlag=function(r,o){const t=this;return _waitForCursor(this,function(){t.cursor.addCursorFlag(r,o)}),this},module.exports=AggregationCursor;","node_modules/mongoose/lib/helpers/populate/assignRawDocsToIdStructure.js":"\"use strict\";const modelSymbol=require(\"../symbols\").modelSymbol;function assignRawDocsToIdStructure(l,o,t,u,s){const n=[],r=u.sort&&l.length>1,e=u.$nullIfNotFound;let c,a,h;for(let d=0;d<l.length;++d)h=l[d],Array.isArray(h)?(assignRawDocsToIdStructure(h,o,t,u,!0),n.push(h)):null!==h||r?(c=o[a=String(h)],u.clone&&(c=c.constructor.hydrate(c._doc)),s?c?r?n[t[a]]=c:n.push(c):null!=h&&null!=h[modelSymbol]?n.push(h):n.push(u.retainNullValues||e?null:h):n[d]=c||null):n.push(h);l.length=0,n.length&&n.forEach(function(o,t){l[t]=o})}module.exports=assignRawDocsToIdStructure;","node_modules/mongoose/lib/helpers/populate/getVirtual.js":"\"use strict\";function getVirtual(t,i){if(t.virtuals[i])return{virtual:t.virtuals[i],path:void 0};const e=i.split(\".\");let r=\"\",s=\"\";for(let i=0;i<e.length;++i)if(r+=(r.length>0?\".\":\"\")+e[i],t.virtuals[r]){if(i===e.length-1)return{virtual:t.virtuals[r],path:s}}else if(!t.nested[r]){if(!t.paths[r]||!t.paths[r].schema)return null;{t=t.paths[r].schema;const l=e.slice(i+1).join(\".\");if(t.virtuals[l]){if(i===e.length-2)return{virtual:t.virtuals[l],nestedSchemaPath:[s,r].filter(t=>!!t).join(\".\")};continue}if(i+1<e.length&&t.discriminators)for(const i of Object.keys(t.discriminators)){const e=getVirtual(t.discriminators[i],l);if(null!=e){const t=[s,r,e.nestedSchemaPath].filter(t=>!!t).join(\".\");return{virtual:e.virtual,nestedSchemaPath:t}}}s+=(s.length>0?\".\":\"\")+r,r=\"\"}}}module.exports=getVirtual;","node_modules/sift/lib/index.js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var _typeof=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&\"function\"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?\"symbol\":typeof r};function isFunction(r){return\"function\"==typeof r}function isArray(r){return\"[object Array]\"===Object.prototype.toString.call(r)}function comparable(r){return r instanceof Date?r.getTime():isArray(r)?r.map(comparable):r&&\"function\"==typeof r.toJSON?r.toJSON():r}function get(r,n){return isFunction(r.get)?r.get(n):r[n]}function or(r){return function(n,t){if(!isArray(t)||!t.length)return r(n,t);for(var e=0,o=t.length;e<o;e++)if(r(n,get(t,e)))return!0;return!1}}function and(r){return function(n,t){if(!isArray(t)||!t.length)return r(n,t);for(var e=0,o=t.length;e<o;e++)if(!r(n,get(t,e)))return!1;return!0}}function validate(r,n,t,e){return r.v(r.a,n,t,e)}exports.default=sift,exports.indexOf=indexOf,exports.compare=compare;var OPERATORS={$eq:or(function(r,n){return r(n)}),$ne:and(function(r,n){return!r(n)}),$gt:or(function(r,n){return compare(comparable(n),r)>0}),$gte:or(function(r,n){return compare(comparable(n),r)>=0}),$lt:or(function(r,n){return compare(comparable(n),r)<0}),$lte:or(function(r,n){return compare(comparable(n),r)<=0}),$mod:or(function(r,n){return n%r[0]==r[1]}),$in:function(r,n){if(!(n instanceof Array)){var t=comparable(n);if(t===n&&\"object\"===(void 0===n?\"undefined\":_typeof(n)))for(o=r.length;o--;)if(String(r[o])===String(n)&&\"[object Object]\"!==String(n))return!0;if(void 0===t)for(o=r.length;o--;)if(null==r[o])return!0;for(o=r.length;o--;){var e=validate(createRootValidator(get(r,o),void 0),n,o,r);if(e&&\"[object Object]\"!==String(e)&&\"[object Object]\"!==String(n))return!0}return!!~r.indexOf(t)}for(var o=n.length;o--;)if(~r.indexOf(comparable(get(n,o))))return!0;return!1},$nin:function(r,n,t,e){return!OPERATORS.$in(r,n,t,e)},$not:function(r,n,t,e){return!validate(r,n,t,e)},$type:function(r,n){return void 0!=n&&(n instanceof r||n.constructor==r)},$all:function(r,n,t,e){return OPERATORS.$and(r,n,t,e)},$size:function(r,n){return!!n&&r===n.length},$or:function(r,n,t,e){for(var o=0,i=r.length;o<i;o++)if(validate(get(r,o),n,t,e))return!0;return!1},$nor:function(r,n,t,e){return!OPERATORS.$or(r,n,t,e)},$and:function(r,n,t,e){for(var o=0,i=r.length;o<i;o++)if(!validate(get(r,o),n,t,e))return!1;return!0},$regex:or(function(r,n){return\"string\"==typeof n&&r.test(n)}),$where:function(r,n,t,e){return r.call(n,n,t,e)},$elemMatch:function(r,n,t,e){return isArray(n)?!!~search(n,r):validate(r,n,t,e)},$exists:function(r,n,t,e){return e.hasOwnProperty(t)===r}},prepare={$eq:function(r){return r instanceof RegExp?function(n){return\"string\"==typeof n&&r.test(n)}:r instanceof Function?r:isArray(r)&&!r.length?function(r){return isArray(r)&&!r.length}:null===r?function(r){return null==r}:function(n){return 0===compare(comparable(n),comparable(r))}},$ne:function(r){return prepare.$eq(r)},$and:function(r){return r.map(parse)},$all:function(r){return prepare.$and(r)},$or:function(r){return r.map(parse)},$nor:function(r){return r.map(parse)},$not:function(r){return parse(r)},$regex:function(r,n){return new RegExp(r,n.$options)},$where:function(r){return\"string\"==typeof r?new Function(\"obj\",\"return \"+r):r},$elemMatch:function(r){return parse(r)},$exists:function(r){return!!r}};function search(r,n){for(var t=0;t<r.length;t++){get(r,t);if(validate(n,get(r,t)))return t}return-1}function createValidator(r,n){return{a:r,v:n}}function nestedValidator(r,n){var t=[];if(findValues(n,r.k,0,n,t),1===t.length){var e=t[0];return validate(r.nv,e[0],e[1],e[2])}for(var o=r&&r.q&&void 0!==r.q.$ne,i=o,a=0;a<t.length;a++){var u=t[a],f=validate(r.nv,u[0],u[1],u[2]);o?i&=f:i|=f}return i}function findValues(r,n,t,e,o){if(t!==n.length&&void 0!=r){var i=get(n,t);if(isArray(r)&&isNaN(Number(i)))for(var a=0,u=r.length;a<u;a++)findValues(get(r,a),n,t,r,o);else findValues(get(r,i),n,t+1,r,o)}else o.push([r,n[t-1],e])}function createNestedValidator(r,n,t){return{a:{k:r,nv:n,q:t},v:nestedValidator}}function isVanillaObject(r){return r&&r.constructor===Object}function parse(r){(r=comparable(r))&&isVanillaObject(r)||(r={$eq:r});var n=[];for(var t in r){var e=r[t];if(\"$options\"!==t)if(OPERATORS[t])prepare[t]&&(e=prepare[t](e,r)),n.push(createValidator(comparable(e),OPERATORS[t]));else{if(36===t.charCodeAt(0))throw new Error(\"Unknown operation \"+t);n.push(createNestedValidator(t.split(\".\"),parse(e),e))}}return 1===n.length?n[0]:createValidator(n,OPERATORS.$and)}function createRootValidator(r,n){var t=parse(r);return n&&(t={a:t,v:function(r,t,e,o){return validate(r,n(t),e,o)}}),t}function sift(r,n,t){isFunction(n)&&(t=n,n=void 0);var e=createRootValidator(r,t);function o(r,n,t){return validate(e,r,n,t)}return n?n.filter(o):o}function indexOf(r,n,t){return search(n,createRootValidator(r,t))}function compare(r,n){if(r===n)return 0;if((void 0===r?\"undefined\":_typeof(r))===(void 0===n?\"undefined\":_typeof(n))){if(r>n)return 1;if(r<n)return-1}}","node_modules/mongoose/lib/helpers/projection/isPathExcluded.js":"\"use strict\";const isDefiningProjection=require(\"./isDefiningProjection\");module.exports=function(i,e){if(\"_id\"===e)return 0===i._id;const n=Object.keys(i);let o=null;for(const s of n)if(isDefiningProjection(i[s])){o=1===i[e]?\"inclusive\":\"exclusive\";break}return\"inclusive\"===o?1!==i[e]:\"exclusive\"===o&&0===i[e]};","node_modules/mongoose/lib/helpers/populate/getSchemaTypes.js":"\"use strict\";const Mixed=require(\"../../schema/mixed\"),get=require(\"../get\"),leanPopulateMap=require(\"./leanPopulateMap\"),mpath=require(\"mpath\"),populateModelSymbol=require(\"../symbols\").populateModelSymbol;module.exports=function(e,t,n){const r=e.path(n),s=t;if(r)return r;const l=n.split(\".\");for(let e=0;e<l.length;++e)\"$\"===l[e]&&(l[e]=\"0\");return function e(n,r,l,a){let c,o,i=n.length+1;for(;i--;){if(o=n.slice(0,i).join(\".\"),null==(c=r.path(o)))continue;if(c.caster){if(c.caster instanceof Mixed)return c.caster;let s=null;if(null!=t&&null!=c.schema&&null!=c.schema.discriminators){const e=c.schema.discriminators,t=o+\".\"+c.schema.options.discriminatorKey,n=l&&mpath.get(t,l)||[];s=Object.keys(e).reduce(function(t,r){return-1!==n.indexOf(r)&&t.push(e[r]),t},[])}if(i!==n.length&&c.schema){let t;if(\"$\"===n[i])return i+1===n.length?c:((t=e(n.slice(i+1),r,l?mpath.get(o,l):null,a.concat(n.slice(0,i))))&&(t.$isUnderneathDocArray=t.$isUnderneathDocArray||!c.schema.$isSingleNested),t);if(null!=s&&s.length>0){t=[];for(let r=0;r<s.length;++r){const u=e(n.slice(i),s[r],l?mpath.get(o,l):null,a.concat(n.slice(0,i)));null!=u&&(u.$isUnderneathDocArray=u.$isUnderneathDocArray||!c.schema.$isSingleNested,u.$isUnderneathDocArray&&(t.$isUnderneathDocArray=!0),t.push(u))}return t}return(t=e(n.slice(i),c.schema,l?mpath.get(o,l):null,a.concat(n.slice(0,i))))&&(t.$isUnderneathDocArray=t.$isUnderneathDocArray||!c.schema.$isSingleNested),t}if(i!==n.length&&c.$isMongooseArray&&c.casterConstructor.$isMongooseArray){let t=c;for(;t.$isMongooseArray&&!t.$isMongooseDocumentArray;)t=t.casterConstructor;return e(n.slice(i),t.schema,null,a.concat(n.slice(0,i)))}}const u=a.concat([o]).join(\".\");if(s.$__&&s.populated(u)&&i<n.length){const r=t.$__.populated[u].options[populateModelSymbol];if(null!=r){const t=e(n.slice(i),r.schema,l?mpath.get(o,l):null,a.concat(n.slice(0,i)));return t&&(t.$isUnderneathDocArray=t.$isUnderneathDocArray||!r.schema.$isSingleNested),t}}const h=get(s,o);if(null!=h){const t=Array.isArray(h)&&h.length>0?leanPopulateMap.get(h[0]):leanPopulateMap.get(h),r=null!=t?t.schema:null;if(null!=r){const t=e(n.slice(i),r,l?mpath.get(o,l):null,a.concat(n.slice(0,i)));return t&&(t.$isUnderneathDocArray=t.$isUnderneathDocArray||!r.$isSingleNested),t}}return c}}(l,e,t,[])};","node_modules/mongoose/lib/helpers/populate/normalizeRefPath.js":"\"use strict\";module.exports=function(t,n,e){if(null==t)return t;\"function\"==typeof t&&(t=t.call(n,n,e));const r=/(\\.\\d+$|\\.\\d+\\.)/g;if(r.test(e)){const n=e.split(r);if(\"\"===n[n.length-1])throw new Error(\"Can't populate individual element in an array\");let l=\"\",o=t;for(let t=0;t<n.length;t+=2){const e=n[t];if(!o.startsWith(e+\".\")){if(t===n.length-1){l+=o,o=\"\";break}throw new Error(\"Could not normalize ref path, chunk \"+e+\" not in populated path\")}l+=o.substr(0,e.length)+n[t+1],o=o.substr(e.length+1)}return l}return t};","node_modules/mongoose/lib/connection.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter,Schema=require(\"./schema\"),Collection=require(\"./driver\").get().Collection,STATES=require(\"./connectionstate\"),MongooseError=require(\"./error/index\"),PromiseProvider=require(\"./promise_provider\"),applyPlugins=require(\"./helpers/schema/applyPlugins\"),get=require(\"./helpers/get\"),mongodb=require(\"mongodb\"),utils=require(\"./utils\"),parseConnectionString=require(\"mongodb/lib/core\").parseConnectionString,noPasswordAuthMechanisms=[\"MONGODB-X509\"];function Connection(e){this.base=e,this.collections={},this.models={},this.config={autoIndex:!0},this.replica=!1,this.options=null,this.otherDbs=[],this.relatedDbs={},this.states=STATES,this._readyState=STATES.disconnected,this._closeCalled=!1,this._hasOpened=!1,this.plugins=[]}function _wrapConnHelper(e){return function(){const t=arguments.length>0?arguments[arguments.length-1]:null,o=\"function\"==typeof t?Array.prototype.slice.call(arguments,0,arguments.length-1):Array.prototype.slice.call(arguments);return utils.promiseOrCallback(t,t=>{this.readyState===STATES.connecting?this.once(\"open\",function(){e.apply(this,o.concat([t]))}):e.apply(this,o.concat([t]))})}}Connection.prototype.__proto__=EventEmitter.prototype,Object.defineProperty(Connection.prototype,\"readyState\",{get:function(){return this._readyState},set:function(e){if(!(e in STATES))throw new Error(\"Invalid connection state: \"+e);if(this._readyState!==e){this._readyState=e;for(let t=0;t<this.otherDbs.length;t++)this.otherDbs[t].readyState=e;for(const t in this.relatedDbs)this.relatedDbs[t].readyState=e;STATES.connected===e&&(this._hasOpened=!0),this.emit(STATES[e])}}}),Connection.prototype.get=function(e){return get(this.options,e)},Connection.prototype.set=function(e,t){return this.options=this.options||{},this.options[e]=t,t},Connection.prototype.collections,Connection.prototype.name,Object.defineProperty(Connection.prototype,\"plugins\",{configurable:!1,enumerable:!0,writable:!0}),Object.defineProperty(Connection.prototype,\"host\",{configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(Connection.prototype,\"port\",{configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(Connection.prototype,\"user\",{configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(Connection.prototype,\"pass\",{configurable:!0,enumerable:!0,writable:!0}),Connection.prototype.db,Connection.prototype.config,Connection.prototype.createCollection=_wrapConnHelper(function(e,t,o){\"function\"==typeof t&&(o=t,t={}),this.db.createCollection(e,t,o)}),Connection.prototype.startSession=_wrapConnHelper(function(e,t){\"function\"==typeof e&&(t=e,e=null),t(null,this.client.startSession(e))}),Connection.prototype.dropCollection=_wrapConnHelper(function(e,t){this.db.dropCollection(e,t)}),Connection.prototype.dropDatabase=_wrapConnHelper(function(e){for(const e of Object.keys(this.models))delete this.models[e].$init;this.db.dropDatabase(e)}),Connection.prototype.error=function(e,t){return t?(t(e),null):(this.listeners(\"error\").length>0&&this.emit(\"error\",e),Promise.reject(e))},Connection.prototype.onOpen=function(){this.readyState=STATES.connected;for(const e in this.collections)utils.object.hasOwnProperty(this.collections,e)&&this.collections[e].onOpen();this.emit(\"open\")},Connection.prototype.openUri=function(e,t,o){if(this.readyState=STATES.connecting,this._closeCalled=!1,\"function\"==typeof t&&(o=t,t=null),-1!==[\"string\",\"number\"].indexOf(typeof t))throw new MongooseError(\"Mongoose 5.x no longer supports `mongoose.connect(host, dbname, port)` or `mongoose.createConnection(host, dbname, port)`. See http://mongoosejs.com/docs/connections.html for supported connection syntax\");if(\"string\"!=typeof e)throw new MongooseError(\"The `uri` parameter to `openUri()` must be a \"+`string, got \"${typeof e}\". Make sure the first parameter to `+\"`mongoose.connect()` or `mongoose.createConnection()` is a string.\");const n=PromiseProvider.get(),i=this;if(t){const e=(t=utils.clone(t)).config&&null!=t.config.autoIndex?t.config.autoIndex:t.autoIndex;null!=e&&(this.config.autoIndex=!1!==e,delete t.config,delete t.autoIndex),\"autoCreate\"in t&&(this.config.autoCreate=!!t.autoCreate,delete t.autoCreate),\"useCreateIndex\"in t&&(this.config.useCreateIndex=!!t.useCreateIndex,delete t.useCreateIndex),\"useFindAndModify\"in t&&(this.config.useFindAndModify=!!t.useFindAndModify,delete t.useFindAndModify),(t.user||t.pass)&&(t.auth=t.auth||{},t.auth.user=t.user,t.auth.password=t.pass,this.user=t.user,this.pass=t.pass),delete t.user,delete t.pass,null!=t.bufferCommands&&(t.bufferMaxEntries=0,this.config.bufferCommands=t.bufferCommands,delete t.bufferCommands),null!=t.useMongoClient&&handleUseMongoClient(t)}else t={};this._connectionOptions=t;const s=t.dbName;null!=s&&(this.$dbName=s),delete t.dbName,\"promiseLibrary\"in t||(t.promiseLibrary=PromiseProvider.get()),\"useNewUrlParser\"in t||(\"useNewUrlParser\"in this.base.options?t.useNewUrlParser=this.base.options.useNewUrlParser:t.useNewUrlParser=!1),utils.hasUserDefinedProperty(t,\"useUnifiedTopology\")||(utils.hasUserDefinedProperty(this.base.options,\"useUnifiedTopology\")?t.useUnifiedTopology=this.base.options.useUnifiedTopology:t.useUnifiedTopology=!1);const r=new n((o,n)=>{parseConnectionString(e,t,(e,t)=>{if(e)return n(e);s?this.name=s:t.defaultDatabase?this.name=t.defaultDatabase:this.name=get(t,\"auth.db\",null),this.host=get(t,\"hosts.0.host\",\"localhost\"),this.port=get(t,\"hosts.0.port\",27017),this.user=this.user||get(t,\"auth.username\"),this.pass=this.pass||get(t,\"auth.password\"),o()})}),c=()=>{i.readyState!==STATES.connected&&(i.readyState=STATES.connected,i.emit(\"reconnect\"),i.emit(\"reconnected\"))},l=new n((o,n)=>{const r=new mongodb.MongoClient(e,t);i.client=r,r.connect(function(e){if(e)return i.readyState=STATES.disconnected,n(e);const l=null!=s?r.db(s):r.db();i.db=l;const a=get(l,\"s.topology.s.description.type\",\"\");if(t.useUnifiedTopology)if(\"Single\"===a){const e=Array.from(l.s.topology.s.servers.values())[0];e.s.pool.on(\"close\",()=>{i.readyState=STATES.disconnected}),e.s.topology.on(\"serverHeartbeatSucceeded\",()=>{c()}),e.s.pool.on(\"reconnect\",()=>{c()}),e.s.pool.on(\"timeout\",()=>{i.emit(\"timeout\")})}else a.startsWith(\"ReplicaSet\")&&l.on(\"close\",function(){\"ReplicaSetWithPrimary\"!==get(l,\"s.topology.s.description.type\",\"\")&&(i.readyState=STATES.disconnected)});l.on(\"reconnect\",function(){c()}),l.s.topology.on(\"reconnectFailed\",function(){i.emit(\"reconnectFailed\")}),l.s.topology.on(\"left\",function(e){i.emit(\"left\",e)}),l.s.topology.on(\"joined\",function(e){i.emit(\"joined\",e)}),l.s.topology.on(\"fullsetup\",function(e){i.emit(\"fullsetup\",e)}),null!=get(l,\"s.topology.s.coreTopology.s.pool\")&&l.s.topology.s.coreTopology.s.pool.on(\"attemptReconnect\",function(){i.emit(\"attemptReconnect\")}),t.useUnifiedTopology&&a.startsWith(\"ReplicaSet\")||l.on(\"close\",function(){i.readyState=STATES.disconnected}),r.on(\"left\",function(){i.readyState===STATES.connected&&\"ReplicaSetNoPrimary\"===get(l,\"s.topology.s.coreTopology.s.replicaSetState.topologyType\")&&(i.readyState=STATES.disconnected)}),l.on(\"timeout\",function(){i.emit(\"timeout\")}),delete i.then,delete i.catch,i.readyState=STATES.connected;for(const e in i.collections)utils.object.hasOwnProperty(i.collections,e)&&i.collections[e].onOpen();o(i),i.emit(\"open\")})});return this.$initialConnection=n.all([l,r]).then(e=>e[0]).catch(e=>{throw this.listeners(\"error\").length>0&&process.nextTick(()=>this.emit(\"error\",e)),e}),this.then=function(e,t){return this.$initialConnection.then(e,t)},this.catch=function(e){return this.$initialConnection.catch(e)},null!=o&&(this.$initialConnection=this.$initialConnection.then(()=>o(null,this),e=>o(e))),this};const handleUseMongoClient=function(e){console.warn(\"WARNING: The `useMongoClient` option is no longer necessary in mongoose 5.x, please remove it.\");const t=(new Error).stack;console.warn(t.substr(t.indexOf(\"\\n\")+1)),delete e.useMongoClient};Connection.prototype.close=function(e,t){return\"function\"==typeof e&&(t=e,e=!1),this.$wasForceClosed=!!e,utils.promiseOrCallback(t,t=>{this._close(e,t)})},Connection.prototype._close=function(e,t){const o=this;switch(this._closeCalled=!0,this.readyState){case STATES.disconnected:t();break;case STATES.connected:this.readyState=STATES.disconnecting,this.doClose(e,function(n){if(n)return t(n);o.onClose(e),t(null)});break;case STATES.connecting:this.once(\"open\",function(){o.close(t)});break;case STATES.disconnecting:this.once(\"close\",function(){t()})}return this},Connection.prototype.onClose=function(e){this.readyState=STATES.disconnected;for(const t in this.collections)utils.object.hasOwnProperty(this.collections,t)&&this.collections[t].onClose(e);this.emit(\"close\",e)},Connection.prototype.collection=function(e,t){return(t=t?utils.clone(t):{}).$wasForceClosed=this.$wasForceClosed,e in this.collections||(this.collections[e]=new Collection(e,this,t)),this.collections[e]},Connection.prototype.plugin=function(e,t){return this.plugins.push([e,t]),this},Connection.prototype.model=function(e,t,o){if(!(this instanceof Connection))throw new MongooseError(\"`connection.model()` should not be run with `new`. If you are doing `new db.model(foo)(bar)`, use `db.model(foo)(bar)` instead\");let n;if(\"function\"==typeof e&&(e=(n=e).name),\"string\"==typeof t&&(o=t,t=!1),utils.isObject(t)&&!t.instanceOfSchema&&(t=new Schema(t)),t&&!t.instanceOfSchema)throw new Error(\"The 2nd parameter to `mongoose.model()` should be a schema or a POJO\");if(this.models[e]&&!o){if(t&&t.instanceOfSchema&&t!==this.models[e].schema)throw new MongooseError.OverwriteModelError(e);return this.models[e]}const i={cache:!1,connection:this};let s;if(t&&t.instanceOfSchema)return applyPlugins(t,this.plugins,null,\"$connectionPluginsApplied\"),s=this.base.model(n||e,t,o,i),this.models[e]||(this.models[e]=s),s.init(function(){}),s;if(this.models[e]&&o){return t=(s=this.models[e]).prototype.schema,s.__subclass(this,t,o)}if(!(s=this.base.models[e]))throw new MongooseError.MissingSchemaError(e);return this!==s.prototype.db||o&&o!==s.collection.name?(this.models[e]=s.__subclass(this,t,o),this.models[e]):(this.models[e]||(this.models[e]=s),s)},Connection.prototype.deleteModel=function(e){if(\"string\"==typeof e){const t=this.model(e);if(null==t)return this;delete this.models[e],delete this.collections[t.collection.name],delete this.base.modelSchemas[e]}else{if(!(e instanceof RegExp))throw new Error('First parameter to `deleteModel()` must be a string or regexp, got \"'+e+'\"');{const t=e,o=this.modelNames();for(const e of o)t.test(e)&&this.deleteModel(e)}}return this},Connection.prototype.modelNames=function(){return Object.keys(this.models)},Connection.prototype.shouldAuthenticate=function(){return null!=this.user&&(null!=this.pass||this.authMechanismDoesNotRequirePassword())},Connection.prototype.authMechanismDoesNotRequirePassword=function(){return!this.options||!this.options.auth||noPasswordAuthMechanisms.indexOf(this.options.auth.authMechanism)>=0},Connection.prototype.optionsProvideAuthenticationData=function(e){return e&&e.user&&(e.pass||this.authMechanismDoesNotRequirePassword())},Connection.STATES=STATES,module.exports=Connection;","backend/node_modules/events/models/event.js":"\"use strict\";exports.name=\"Event\",exports.setUp=((e,t)=>{const i=new t.Schema({type:{type:String,trim:!0,required:!0},severity:{type:String,enum:[\"debug\",\"info\",\"success\",\"warning\",\"error\"],default:\"info\"},time:{type:Number,default:Date.now},user:{type:Object},data:{type:Object}},{id:!1});i.statics.TOPIC_PREFIX=\"events\",i.index({time:-1}),i.index({severity:1,time:-1}),i.index({type:1,time:-1}),i.index({\"user._id\":1,time:-1}),t.model(exports.name,i)});","backend/node_modules/events/routes.js":"\"use strict\";module.exports=((e,n)=>{const{express:t,user:s,Event:o}=n,g=s.auth(\"EVENTS:VIEW\");t.get(\"/events\",g,t.crud.browseRoute.bind(null,e,o)),t.get(\"/events/types\",g,function(e,t){t.send(Object.keys(n.types).sort())}),t.get(\"/events/pending\",g,function(e,t){t.send(n.getPendingEvents())}),t.post(\"/events/pending\",s.auth(\"SUPER\"),function(e,t){const s=n.getPendingEvents().length;n.insertEvents();const o=n.getPendingEvents().length;t.send({beforeCount:s,afterCount:o})})});","node_modules/csv/lib/index.js":"var generate,parse,stringify,transform;generate=require(\"csv-generate\"),parse=require(\"csv-parse\"),transform=require(\"stream-transform\"),stringify=require(\"csv-stringify\"),module.exports.generate=generate,module.exports.parse=parse,module.exports.transform=transform,module.exports.stringify=stringify;","node_modules/deep-equal/index.js":"var objectKeys=require(\"object-keys\"),isArguments=require(\"is-arguments\"),is=require(\"object-is\"),isRegex=require(\"is-regex\"),flags=require(\"regexp.prototype.flags\"),isDate=require(\"is-date-object\"),getTime=Date.prototype.getTime;function deepEqual(e,r,t){var i=t||{};return!(i.strict?!is(e,r):e!==r)||(!e||!r||\"object\"!=typeof e&&\"object\"!=typeof r?i.strict?is(e,r):e==r:objEquiv(e,r,i))}function isUndefinedOrNull(e){return null===e||void 0===e}function isBuffer(e){return!(!e||\"object\"!=typeof e||\"number\"!=typeof e.length)&&(\"function\"==typeof e.copy&&\"function\"==typeof e.slice&&!(e.length>0&&\"number\"!=typeof e[0]))}function objEquiv(e,r,t){var i,n;if(typeof e!=typeof r)return!1;if(isUndefinedOrNull(e)||isUndefinedOrNull(r))return!1;if(e.prototype!==r.prototype)return!1;if(isArguments(e)!==isArguments(r))return!1;var u=isRegex(e),f=isRegex(r);if(u!==f)return!1;if(u||f)return e.source===r.source&&flags(e)===flags(r);if(isDate(e)&&isDate(r))return getTime.call(e)===getTime.call(r);var o=isBuffer(e),s=isBuffer(r);if(o!==s)return!1;if(o||s){if(e.length!==r.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==r[i])return!1;return!0}if(typeof e!=typeof r)return!1;try{var l=objectKeys(e),g=objectKeys(r)}catch(e){return!1}if(l.length!==g.length)return!1;for(l.sort(),g.sort(),i=l.length-1;i>=0;i--)if(l[i]!=g[i])return!1;for(i=l.length-1;i>=0;i--)if(!deepEqual(e[n=l[i]],r[n],t))return!1;return!0}module.exports=deepEqual;","node_modules/h5.modbus/lib/index.js":"\"use strict\";exports.Master=require(\"./Master\"),exports.Slave=require(\"./Slave\"),exports.ExceptionCode=require(\"./ExceptionCode\"),exports.FunctionCode=require(\"./FunctionCode\"),exports.helpers=require(\"./helpers\"),exports.ApplicationDataUnit=require(\"./ApplicationDataUnit\"),exports.RemoteClient=require(\"./RemoteClient\"),exports.Transaction=require(\"./Transaction\"),exports.InvalidFrameError=require(\"./InvalidFrameError\"),exports.ResponseTimeoutError=require(\"./ResponseTimeoutError\"),exports.Transport=require(\"./Transport\"),exports.IpTransport=require(\"./transports/IpTransport\"),exports.AsciiTransport=require(\"./transports/AsciiTransport\"),exports.RtuTransport=require(\"./transports/RtuTransport\"),exports.Connection=require(\"./Connection\"),exports.TcpConnection=require(\"./connections/TcpConnection\"),exports.UdpConnection=require(\"./connections/UdpConnection\"),exports.SerialConnection=require(\"./connections/SerialConnection\"),exports.WebSocketConnection=require(\"./connections/WebSocketConnection\"),exports.Listener=require(\"./Listener\"),exports.TcpListener=require(\"./listeners/TcpListener\"),exports.UdpListener=require(\"./listeners/UdpListener\"),exports.SerialListener=require(\"./listeners/SerialListener\"),exports.WebSocketListener=require(\"./listeners/WebSocketListener\");const messages=require(\"./messages\");function createByType(e,s,t,r,o){if(r&&\"function\"==typeof r.destroy)return r;r&&\"object\"==typeof r?r=(o=r).type:o||(o={}),r||(r=s);const n=t[r.toLowerCase()];if(\"function\"!=typeof n)throw new Error(`Unknown ${e} type: ${r}.`);return\"function\"==typeof n.fromOptions?n.fromOptions(o):new n(o)}exports.Message=require(\"./Message\"),exports.Request=require(\"./Request\"),exports.Response=require(\"./Response\"),exports.requests=messages.requests,exports.responses=messages.responses,exports.ReadDiscreteInputsRequest=messages.ReadDiscreteInputsRequest,exports.ReadDiscreteInputsResponse=messages.ReadDiscreteInputsResponse,exports.ReadCoilsRequest=messages.ReadCoilsRequest,exports.ReadCoilsResponse=messages.ReadCoilsResponse,exports.WriteSingleCoilRequest=messages.WriteSingleCoilRequest,exports.WriteSingleCoilResponse=messages.WriteSingleCoilResponse,exports.WriteMultipleCoilsRequest=messages.WriteMultipleCoilsRequest,exports.WriteMultipleCoilsResponse=messages.WriteMultipleCoilsResponse,exports.ReadInputRegistersRequest=messages.ReadInputRegistersRequest,exports.ReadInputRegistersResponse=messages.ReadInputRegistersResponse,exports.ReadHoldingRegistersRequest=messages.ReadHoldingRegistersRequest,exports.ReadHoldingRegistersResponse=messages.ReadHoldingRegistersResponse,exports.WriteSingleRegisterRequest=messages.WriteSingleRegisterRequest,exports.WriteSingleRegisterResponse=messages.WriteSingleRegisterResponse,exports.WriteMultipleRegistersRequest=messages.WriteMultipleRegistersRequest,exports.WriteMultipleRegistersResponse=messages.WriteMultipleRegistersResponse,exports.ExceptionResponse=messages.ExceptionResponse,exports.createMaster=function(e){return e||(e={}),e.transport=exports.createTransport(e.transport),e.connection=exports.createConnection(e.connection),new exports.Master(e)},exports.createSlave=function(e){return e||(e={}),e.transport=exports.createTransport(e.transport),e.listener=exports.createListener(e.listener),new exports.Slave(e)},exports.connections={tcp:exports.TcpConnection,udp:exports.UdpConnection,serial:exports.SerialConnection,ws:exports.WebSocketConnection},exports.createConnection=function(e,s){return createByType(\"connection\",\"tcp\",exports.connections,e,s)},exports.listeners={tcp:exports.TcpListener,udp:exports.UdpListener,serial:exports.SerialListener,ws:exports.WebSocketListener},exports.createListener=function(e,s){return createByType(\"listener\",\"tcp\",exports.listeners,e,s)},exports.transports={ip:exports.IpTransport,ascii:exports.AsciiTransport,rtu:exports.RtuTransport},exports.createTransport=function(e,s){return createByType(\"transport\",\"ip\",exports.transports,e,s)};","backend/node_modules/modbus/Tag.js":"\"use strict\";const _=require(\"lodash\"),deepEqual=require(\"deep-equal\"),deltaUtils=require(\"./deltaUtils\"),scaleFunctions=require(\"./scaleFunctions\");function Tag(t,e,i,s){this.broker=t,this.modbus=e,this.broadcastable=!_.includes(e.config.broadcastFilter,i.split(\".\")[0]),this.bits=null,this.bitMask=null,this.master=s.master,this.address=s.address,this.deltaAddress=null,this.name=i,this.description=s.description,this.kind=\"string\"==typeof s.kind?s.kind:\"virtual\",\"number\"==typeof s.code?this.code=s.code:(this.code=deltaUtils.getFunctionCode(s.kind),-1===this.code&&(this.code=3)),\"virtual\"===this.kind?this.setUpVirtualization():\"string\"==typeof this.address&&(this.deltaAddress=this.address,this.code=deltaUtils.getFunctionCode(this.deltaAddress),this.address=deltaUtils.getStartingAddress(this.deltaAddress)),this.type=\"string\"==typeof s.type?s.type:3===this.code?\"uint16\":\"bool\",this.unit=\"number\"==typeof s.unit?s.unit:-1,this.readable=!!s.readable,this.writable=!!s.writable,this.rawMin=numberOrNull(s.rawMin),this.rawMax=numberOrNull(s.rawMax),this.scaleUnit=\"string\"==typeof s.scaleUnit?s.scaleUnit:null,this.scaleFunction=\"string\"==typeof s.scaleFunction?s.scaleFunction:null,this.scaleMin=numberOrNull(s.scaleMin),this.scaleMax=numberOrNull(s.scaleMax),this.scale=scaleFunctions.create(this),this.archive=\"string\"==typeof s.archive?s.archive:null,this.lastChangeTime=0,this.oldValue=null}function createBitMask(t,e){let i=0;for(var s=t;s<=e;++s)i+=1<<s;return i}function numberOrNull(t){return t=parseFloat(t),isNaN(t)?null:t}Tag.prototype.toJSON=function(){return{name:this.name,description:this.description,master:this.master,unit:this.unit,kind:this.kind,type:this.type,address:this.deltaAddress?this.deltaAddress:this.address,readable:this.isReadable(),writable:this.isWritable(),rawMin:this.rawMin,rawMax:this.rawMax,scaleUnit:this.scaleUnit,scaleFunction:this.scaleFunction,scaleMin:this.scaleMin,scaleMax:this.scaleMax,archive:this.archive,lastChangeTime:this.lastChangeTime,value:this.getValue()}},Tag.prototype.isConnected=function(){const t=this.modbus.masters[this.master];return!!t&&t.isConnected()},Tag.prototype.isReadable=function(){return this.readable&&null!==this.address},Tag.prototype.isWritable=function(){return this.writable&&(null!==this.address||\"setting\"===this.kind||\"memory\"===this.kind)},Tag.prototype.getValue=function(){return this.modbus.values[this.name]},Tag.prototype.setValue=function(t,e){t=this.rawValueToValue(t);const i=this.modbus.values[this.name];return!deepEqual(t,i)&&(this.lastChangeTime=e||Date.now(),this.oldValue=i,this.modbus.values[this.name]=t,this.broker.publish(`tagValueChanged.${this.name}`,{tag:this,time:this.lastChangeTime,oldValue:this.oldValue,newValue:t}),!0)},Tag.prototype.writeValue=function(t,e){if(!this.isWritable())return e(new Error(\"TAG_WRITE_NOT_WRITABLE\"));const i=this.checkBeforeWrite(t);if(-1===i)return e(new Error(\"TAG_WRITE_ILLEGAL\"));if(i>0)return setTimeout(this.writeValue.bind(this,t,e),i);switch(this.kind){case\"output\":return this.writeOutputValue(t,e);case\"register\":return this.writeRegisterValue(t,e);case\"virtual\":return this.writeVirtualValue(t,e);case\"setting\":return this.writeSettingValue(t,e);case\"memory\":return this.writeMemoryValue(t,e);default:return e(new Error(\"TAG_WRITE_UNSUPPORTED\"))}},Tag.prototype.checkBeforeWrite=function(t){const e={tag:this,allowWrite:!0,writeDelay:0,newValue:t};return this.broker.publish(`beforeWriteTagValue.${this.name}`,e),e.allowWrite?e.writeDelay:-1},Tag.prototype.writeOutputValue=function(t,e){const i=this.modbus.masters[this.master].writeSingleCoil(this.address,!!t,{unit:this.unit});i.once(\"complete\",(s,a)=>this.handleWriteResponse(i,s,a,!!t,e))},Tag.prototype.writeRegisterValue=function(t,e){const i=this.modbus.masters[this.master];let s;try{s=this.createValueBuffer(this.valueToRawValue(t))}catch(t){return void e(t)}const a=i.writeMultipleRegisters(this.address,s,{unit:this.unit});a.once(\"complete\",(i,s)=>this.handleWriteResponse(a,i,s,t,e))},Tag.prototype.writeVirtualValue=function(t,e){if(null===this.bitMask)return void e(new Error(\"TAG_WRITE_NO_BIT_MASK\"));if(\"string\"!=typeof this.address)return void e(new Error(\"TAG_WRITE_NO_REFERENCE_TAG\"));const i=this.modbus.tags[this.address.split(\"&\")[0]];if(!i)return void e(new Error(\"TAG_WRITE_UNKNOWN_REFERENCE_TAG\"));const s=this.valueToRawValue(t)<<this.bits[0],a=i.getValue()&~this.bitMask|s;i.writeValue(a,e)},Tag.prototype.writeSettingValue=function(t,e){const i={_id:this.name},s={$set:{value:this.valueToRawValue(t),time:Date.now()}};this.modbus.config.settingsCollection().updateOne(i,s,{upsert:!0,w:1},t=>{e(t),t||this.setValue(s.$set.value)})},Tag.prototype.writeMemoryValue=function(t,e){this.setValue(this.valueToRawValue(t)),setImmediate(e)},Tag.prototype.handleWriteResponse=function(t,e,i,s,a){e?a(e):i.isException()?a(new Error(i.toString())):(a(),this.isReadable()||this.setValue(s))},Tag.prototype.createValueBuffer=function(t){let e;switch(this.type){case\"double\":(e=new Buffer(8)).writeDoubleBE(t,0);break;case\"float\":(e=new Buffer(4)).writeFloatBE(t,0);break;case\"uint32\":(e=new Buffer(4)).writeUInt32BE(Math.round(t),0);break;case\"int32\":(e=new Buffer(4)).writeInt32BE(Math.round(t),0);break;case\"uint16\":case\"uint8\":(e=new Buffer(2)).writeUInt16BE(Math.round(t),0);break;case\"int16\":case\"int8\":(e=new Buffer(2)).writeInt16BE(Math.round(t),0);break;default:(e=new Buffer(2)).writeInt16BE(t?1:0,0)}return e},Tag.prototype.rawValueToValue=function(t){if(null===t)return null;if(null!==this.rawMin&&t<this.rawMin)return null;if(null!==this.rawMax&&t>this.rawMax)return null;var e=this.scale.rawValueToValue(t);return\"bool\"===this.type?!!e:e},Tag.prototype.valueToRawValue=function(t){switch(void 0===t&&(t=null),this.type){case\"double\":case\"float\":t=parseFloat(t);break;case\"bool\":t=!!t;break;case\"string\":case\"text\":t=String(t);break;case\"object\":try{\"string\"==typeof t?t=JSON.parse(t):_.isPlainObject(t)||Array.isArray(t)||(t=null)}catch(e){t=null}break;default:t=parseFloat(t)}const e=this.scale.valueToRawValue(t);return null!==this.rawMin&&e<this.rawMin?this.rawMin:null!==this.rawMax&&e>this.rawMax?this.rawMax:e},Tag.prototype.setUpVirtualization=function(){if(\"string\"!=typeof this.address||-1===this.address.indexOf(\".\"))return;const t=this.address.split(\"&\"),e=t[0];if(void 0===this.modbus.tags[e])throw new Error(`Invalid address for [${this.name}]. Reference tag [${e}] does not exist.`);const i=t[1].split(\"-\").map(t=>+t).filter(t=>!isNaN(t));if(i.length>1&&i[0]>=i[1])throw new Error(`Invalid address for [${this.name}]. Start bit should be lower than the end bit.`);this.bits=1===i.length?[i[0],i[0]]:i,this.bitMask=createBitMask(this.bits[0],this.bits[1]);const s=`tagValueChanged.${e}`;this.broker.subscribe(s,t=>{null===t.newValue?this.setValue(null):\"number\"==typeof t.newValue&&this.setValue((t.newValue&this.bitMask)>>this.bits[0])})},module.exports=Tag;","backend/node_modules/modbus/virtuals.js":"\"use strict\";const _=require(\"lodash\");module.exports=function(s,t){!function(){const e=t.tags[\"masters.controlProcess\"];if(_.isUndefined(e))return t.warn(\"masters.controlProcess tag is not defined!\");const n=[];_.forEach(t.config.controlMasters,function(s){const e=t.masters[s];_.isObject(e)&&n.push(`masters.${s}`)});const o=function(s,e){let n=!0;for(let e=0,o=s.length;e<o;++e)if(!t.values[s[e]]){n=!1;break}e.setValue(n)}.bind(null,n,e);n.forEach(t=>{s.broker.subscribe(`tagValueChanged.${t}`,o)})}()};","backend/node_modules/modbus/safeGuards.js":"\"use strict\";module.exports=function(t,e){};","node_modules/csv-generate/lib/index.js":"var Generator,stream,util,indexOf=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};stream=require(\"stream\"),util=require(\"util\"),module.exports=function(){var t,e,n,o;return 2===arguments.length?(o=arguments[0],t=arguments[1]):1===arguments.length?\"function\"==typeof arguments[0]?(o={},t=arguments[0]):o=arguments[0]:0===arguments.length&&(o={}),n=new Generator(o),t&&(e=[],n.on(\"readable\",function(){var t,i;for(i=[];t=n.read();)i.push(e.push(o.objectMode?t:t.toString()));return i}),n.on(\"error\",t),n.on(\"end\",function(){return t(null,o.objectMode?e:e.join(\"\"))})),n},Generator=function(t){var e,n,o,i,r,s,h,u,l,a,f,p,d;for(this.options=null!=t?t:{},stream.Readable.call(this,this.options),null==(n=this.options).columns&&(n.columns=8),null==(o=this.options).max_word_length&&(o.max_word_length=16),null==(i=this.options).fixed_size&&(i.fixed_size=!1),null==(r=this.options).end&&(r.end=null),null==(s=this.options).seed&&(s.seed=!1),null==(h=this.options).length&&(h.length=-1),null==(u=this.options).delimiter&&(u.delimiter=\",\"),this._={fixed_size_buffer:\"\",count_written:0,count_created:0},\"number\"==typeof this.options.columns&&(this.options.columns=new Array(this.options.columns)),e=Object.keys(Generator).filter(function(t){return\"super_\"!==t}),l=a=0,f=(p=this.options.columns).length;a<f;l=++a)if(null==(d=p[l])&&(d=\"ascii\"),\"string\"==typeof d){if(indexOf.call(e,d)<0)throw Error('Invalid column type: got \"'+d+'\", default values are '+JSON.stringify(e));this.options.columns[l]=Generator[d]}return this},util.inherits(Generator,stream.Readable),module.exports.Generator=Generator,Generator.prototype.random=function(){return this.options.seed?this.options.seed=this.options.seed*Math.PI*100%100/100:Math.random()},Generator.prototype.end=function(){return this.push(null)},Generator.prototype._read=function(t){var e,n,o,i,r,s,h,u,l,a,f,p,d,c;for(e=[],(a=this._.fixed_size_buffer.length)&&e.push(this._.fixed_size_buffer);;){if(this._.count_created===this.options.length||this.options.end&&Date.now()>this.options.end){if(e.length)if(this.options.objectMode)for(o=0,s=e.length;o<s;o++)f=e[o],this._.count_written++,this.push(f);else this._.count_written++,this.push(e.join(\"\"));return this.push(null)}for(f=[],i=0,h=(c=this.options.columns).length;i<h;i++)n=c[i],f.push(\"\"+n(this));if(this.options.objectMode)for(p=0,r=0,u=f.length;r<u;r++)p+=f[r].length;else p=(f=(0===this._.count_created?\"\":\"\\n\")+f.join(this.options.delimiter)).length;if(this._.count_created++,a+p>t){if(this.options.objectMode)for(e.push(f),d=0,l=e.length;d<l;d++)f=e[d],this._.count_written++,this.push(f);else this.options.fixed_size?(this._.fixed_size_buffer=f.substr(t-a),e.push(f.substr(0,t-a))):e.push(f),this._.count_written++,this.push(e.join(\"\"));break}a+=p,e.push(f)}},Generator.ascii=function(t){var e,n,o,i;for(n=[],o=0,i=Math.ceil(t.random()*t.options.max_word_length);0<=i?o<i:o>i;0<=i?++o:--o)e=Math.floor(32*t.random()),n.push(String.fromCharCode(e+(e<16?65:81)));return n.join(\"\")},Generator.int=function(t){return Math.floor(t.random()*Math.pow(2,52))},Generator.bool=function(t){return Math.floor(2*t.random())};","node_modules/csv-parse/lib/index.js":"var Parser,StringDecoder,isObjLiteral,stream,util;stream=require(\"stream\"),util=require(\"util\"),StringDecoder=require(\"string_decoder\").StringDecoder,module.exports=function(){var t,i,n,s,e,o,r;if(3===arguments.length){if(s=arguments[0],o=arguments[1],\"function\"!=typeof(t=arguments[2]))throw Error(\"Invalid callback argument: \"+JSON.stringify(t));if(\"string\"!=typeof s&&!Buffer.isBuffer(arguments[0]))return t(Error(\"Invalid data argument: \"+JSON.stringify(s)))}else if(2===arguments.length){if(\"string\"==typeof arguments[0]||Buffer.isBuffer(arguments[0])?s=arguments[0]:isObjLiteral(arguments[0])?o=arguments[0]:e=\"Invalid first argument: \"+JSON.stringify(arguments[0]),\"function\"==typeof arguments[1]?t=arguments[1]:isObjLiteral(arguments[1])?o?e=\"Invalid arguments: got options twice as first and second arguments\":o=arguments[1]:e=\"Invalid first argument: \"+JSON.stringify(arguments[1]),e){if(t)return t(Error(e));throw Error(e)}}else 1===arguments.length&&(\"function\"==typeof arguments[0]?t=arguments[0]:o=arguments[0]);return null==o&&(o={}),r=new Parser(o),null!=s&&process.nextTick(function(){return r.write(s),r.end()}),t&&(i=!1,n=o.objname?{}:[],r.on(\"readable\",function(){var t,i;for(i=[];t=r.read();)o.objname?i.push(n[t[0]]=t[1]):i.push(n.push(t));return i}),r.on(\"error\",function(n){return i=!0,t(n)}),r.on(\"end\",function(){if(!i)return t(null,n)})),r},Parser=function(t){var i,n,s,e,o,r,l,h,u,_,a,p,m,f,c,d,g,w,y;for(w in null==t&&(t={}),this.options={},t)y=t[w],this.options[w]=y;return this.options.objectMode=!0,stream.Transform.call(this,this.options),null==(i=this.options).rowDelimiter&&(i.rowDelimiter=null),\"string\"==typeof this.options.rowDelimiter&&(this.options.rowDelimiter=[this.options.rowDelimiter]),null==(n=this.options).delimiter&&(n.delimiter=\",\"),void 0===this.options.quote||this.options.quote||(this.options.quote=\"\"),null==(_=this.options).quote&&(_.quote='\"'),null==(a=this.options).escape&&(a.escape='\"'),null==(p=this.options).columns&&(p.columns=null),null==(m=this.options).comment&&(m.comment=\"\"),null==(f=this.options).objname&&(f.objname=!1),null==(c=this.options).trim&&(c.trim=!1),null==(d=this.options).ltrim&&(d.ltrim=!1),null==(g=this.options).rtrim&&(g.rtrim=!1),null==(s=this.options).auto_parse&&(s.auto_parse=!1),null==(e=this.options).auto_parse_date&&(e.auto_parse_date=!1),!0===this.options.auto_parse_date&&(this.options.auto_parse_date=function(t){var i;return i=Date.parse(t),isNaN(i)||(t=new Date(i)),t}),null==(o=this.options).relax&&(o.relax=!1),null==(r=this.options).relax_column_count&&(r.relax_column_count=!1),null==(l=this.options).skip_empty_lines&&(l.skip_empty_lines=!1),null==(h=this.options).max_limit_on_data_read&&(h.max_limit_on_data_read=128e3),null==(u=this.options).skip_lines_with_empty_values&&(u.skip_lines_with_empty_values=!1),this.lines=0,this.count=0,this.skipped_line_count=0,this.empty_line_count=0,this.is_int=/^(\\-|\\+)?([1-9]+[0-9]*)$/,this.is_float=function(t){return t-parseFloat(t)+1>=0},this._={decoder:new StringDecoder,quoting:!1,commenting:!1,field:null,nextChar:null,closingQuote:0,line:[],chunks:[],rawBuf:\"\",buf:\"\",rowDelimiterLength:this.options.rowDelimiter?Math.max.apply(Math,this.options.rowDelimiter.map(function(t){return t.length})):void 0},this},util.inherits(Parser,stream.Transform),module.exports.Parser=Parser,Parser.prototype._transform=function(t,i,n){var s;return t instanceof Buffer&&(t=this._.decoder.write(t)),(s=this.__write(t,!1))?this.emit(\"error\",s):n()},Parser.prototype._flush=function(t){var i;return(i=this.__write(this._.decoder.end(),!0))?this.emit(\"error\",i):this._.quoting?void this.emit(\"error\",new Error(\"Quoted field not terminated at line \"+(this.lines+1))):this._.line.length>0&&(i=this.__push(this._.line))?t(i):t()},Parser.prototype.__push=function(t){var i,n,s,e,o,r,l,h,u;if(!this.options.skip_lines_with_empty_values||\"\"!==t.join(\"\").trim()){if(u=null,!0===this.options.columns)return this.options.columns=t,void\"\";if(\"function\"==typeof this.options.columns)return n=(h=function(t,i){try{return[null,t.call(null,i)]}catch(t){return[t]}}(this.options.columns,t))[0],i=h[1],n||(this.options.columns=i,void\"\");if(!this._.line_length&&t.length>0&&(this._.line_length=this.options.columns?this.options.columns.length:t.length),1===t.length&&\"\"===t[0])this.empty_line_count++;else if(t.length!==this._.line_length){if(!this.options.relax_column_count)return null!=this.options.columns?Error(\"Number of columns on line \"+this.lines+\" does not match header\"):Error(\"Number of columns is inconsistent on line \"+this.lines);this.count++,this.skipped_line_count++}else this.count++;if(null!=this.options.columns){for(l={},e=o=0,r=t.length;o<r;e=++o)s=t[e],!1!==this.options.columns[e]&&(l[this.options.columns[e]]=s);u=this.options.objname?[l[this.options.objname],l]:l}else u=t;if(!(this.count<this.options.from||this.count>this.options.to))return this.options.raw?(this.push({raw:this._.rawBuf,row:u}),this._.rawBuf=\"\"):this.push(u),null}},Parser.prototype.__write=function(t,i){var n,s,e,o,r,l,h,u,_,a,p,m,f,c,d,g,w,y,x,b,D,q,v,O,C,j,N,S,E;for(E=this,d=function(t){return\"function\"==typeof E.is_int?E.is_int(t):E.is_int.test(t)},c=function(t){return function(i){return\"function\"==typeof t.is_float?t.is_float(i):t.is_float.test(i)}}(this),e=function(t){return function(i){return t.options.auto_parse?\"function\"==typeof t.options.auto_parse?t.options.auto_parse(i):(d(i)?i=parseInt(i):c(i)?i=parseFloat(i):t.options.auto_parse_date&&(i=t.options.auto_parse_date(i)),i):i}}(this),w=this.options.trim||this.options.ltrim,N=this.options.trim||this.options.rtrim,t=this._.buf+t,g=t.length,h=0,0===this.lines&&65279===t.charCodeAt(0)&&h++;h<g&&(i||(C=t.substr(h,g-h),!(!this.options.rowDelimiter&&h+3>g||!this._.commenting&&g-h<this.options.comment.length&&this.options.comment.substr(0,g-h)===C||this.options.rowDelimiter&&g-h<this._.rowDelimiterLength&&this.options.rowDelimiter.some(function(t){return t.substr(0,g-h)===C})||this.options.rowDelimiter&&this._.quoting&&g-h<this.options.quote.length+this._.rowDelimiterLength&&this.options.rowDelimiter.some(function(t){return function(i){return(t.options.quote+i).substr(0,g-h)===C}}(this))||g-h<=this.options.delimiter.length&&this.options.delimiter.substr(0,g-h)===C||g-h<=this.options.escape.length&&this.options.escape.substr(0,g-h)===C)));)if(o=this._.nextChar?this._.nextChar:t.charAt(h),this._.nextChar=g>h+1?t.charAt(h+1):\"\",this.options.raw&&(this._.rawBuf+=o),null==this.options.rowDelimiter&&(y=h,j=null,this._.quoting||\"\\n\"!==o&&\"\\r\"!==o?!this._.quoting||o!==this.options.quote||\"\\n\"!==(x=this._.nextChar)&&\"\\r\"!==x||(j=this._.nextChar,y+=2,this.raw&&(rawBuf+=this._.nextChar)):(j=o,y+=1),j&&(\"\\r\"===j&&\"\\n\"===t.charAt(y)&&(j+=\"\\n\"),this.options.rowDelimiter=[j],this._.rowDelimiterLength=j.length)),this._.commenting||o!==this.options.escape||(l=this.options.escape===this.options.quote,_=this._.nextChar===this.options.escape,p=this._.nextChar===this.options.quote,l&&null==this._.field&&!this._.quoting||!_&&!p)){if(!this._.commenting&&o===this.options.quote)if(this._.quoting){if(s=this.options.rowDelimiter&&this.options.rowDelimiter.some(function(i){return t.substr(h+1,i.length)===i}),n=t.substr(h+1,this.options.delimiter.length)===this.options.delimiter,a=this._.nextChar===this.options.comment,!this._.nextChar||s||n||a){this._.quoting=!1,this._.closingQuote=this.options.quote.length,h++,i&&h===g&&(this._.line.push(e(this._.field||\"\")),this._.field=null);continue}if(!this.options.relax)return Error(\"Invalid closing quote at line \"+(this.lines+1)+\"; found \"+JSON.stringify(this._.nextChar)+\" instead of delimiter \"+JSON.stringify(this.options.delimiter));this._.quoting=!1,this._.field&&(this._.field=\"\"+this.options.quote+this._.field)}else{if(!this._.field){this._.quoting=!0,h++;continue}if(null!=this._.field&&!this.options.relax)return Error(\"Invalid opening quote at line \"+(this.lines+1))}if(((m=this.options.rowDelimiter&&this.options.rowDelimiter.some(function(i){return t.substr(h,i.length)===i}))||i&&h===g-1)&&this.lines++,S=!1,this._.commenting||this._.quoting||!this.options.comment||t.substr(h,this.options.comment.length)!==this.options.comment?this._.commenting&&m&&(S=!0,this._.commenting=!1):this._.commenting=!0,u=t.substr(h,this.options.delimiter.length)===this.options.delimiter,this._.commenting||this._.quoting||!u&&!m)this._.commenting||this._.quoting||\" \"!==o&&\"\\t\"!==o?this._.commenting?h++:(null==this._.field&&(this._.field=\"\"),this._.field+=o,h++):(null==this._.field&&(this._.field=\"\"),w&&!this._.field||(this._.field+=o),h++);else{if(m&&(f=this.options.rowDelimiter.filter(function(i){return t.substr(h,i.length)===i})[0].length),m&&0===this._.line.length&&null==this._.field&&(S||this.options.skip_empty_lines)){h+=f,this._.nextChar=t.charAt(h);continue}if(N&&(this._.closingQuote||(this._.field=null!=(b=this._.field)?b.trimRight():void 0)),this._.line.push(e(this._.field||\"\")),this._.closingQuote=0,this._.field=null,u&&(h+=this.options.delimiter.length,this._.nextChar=t.charAt(h),i&&!this._.nextChar&&(m=!0,this._.line.push(\"\"))),m){if(r=this.__push(this._.line))return r;this._.line=[],h+=f,this._.nextChar=t.charAt(h);continue}}if(!this._.commenting&&(null!=(D=this._.field)?D.length:void 0)>this.options.max_limit_on_data_read)return Error(\"Field exceeds max_limit_on_data_read setting (\"+this.options.max_limit_on_data_read+\") \"+JSON.stringify(this.options.delimiter));if(!this._.commenting&&(null!=(q=this._.line)?q.length:void 0)>this.options.max_limit_on_data_read)return Error(\"Row delimiter not found in the file \"+JSON.stringify(this.options.rowDelimiter))}else h++,o=this._.nextChar,this._.nextChar=t.charAt(h+1),null==this._.field&&(this._.field=\"\"),this._.field+=o,this.options.raw&&(this._.rawBuf+=o),h++;if(i){if(null!=this._.field&&(N&&(this._.closingQuote||(this._.field=null!=(v=this._.field)?v.trimRight():void 0)),this._.line.push(e(this._.field||\"\")),this._.field=null),(null!=(O=this._.field)?O.length:void 0)>this.options.max_limit_on_data_read)return Error(\"Delimiter not found in the file \"+JSON.stringify(this.options.delimiter));if(0===g&&this.lines++,this._.line.length>this.options.max_limit_on_data_read)return Error(\"Row delimiter not found in the file \"+JSON.stringify(this.options.rowDelimiter))}return this._.buf=t.substr(h),null},isObjLiteral=function(t){var i;return i=t,\"object\"==typeof t&&null!==t&&!Array.isArray(t)&&function(){for(;null!==Object.getPrototypeOf(i=Object.getPrototypeOf(i)););return Object.getPrototypeOf(t===i)}()};","node_modules/stream-transform/lib/index.js":"var Transformer,stream,util,slice=[].slice;stream=require(\"stream\"),util=require(\"util\"),module.exports=function(){var r,n,t,i,e,s,o,l,u,a,h,f,m,p;for(a={},s=o=0,u=arguments.length;o<u;s=++o)if(m=typeof(r=arguments[s]),null===r?m=\"null\":\"object\"===m&&Array.isArray(r)&&(m=\"array\"),0!==s){if(\"object\"===m)for(l in r)p=r[l],a[l]=p;else if(\"function\"===m)e&&s===arguments.length-1?n=r:e=r;else if(\"null\"!==m)throw new Error(\"Invalid arguments\")}else\"function\"===m?e=r:null!==m&&(t=r);return f=new Transformer(a,e),i=!1,t&&process.nextTick(function(){var r,n,e;for(n=0,r=t.length;n<r&&(e=t[n],!i);n++)f.write(e);return f.end()}),(n||a.consume)&&(h=[],f.on(\"readable\",function(){var r,t;for(t=[];r=f.read();)n?t.push(h.push(r)):t.push(void 0);return t}),f.on(\"error\",function(r){if(i=!0,n)return n(r)}),f.on(\"end\",function(){if(n&&!i)return n(null,h)})),f},Transformer=function(r,n){var t;return this.options=null!=r?r:{},this.transform=n,this.options.objectMode=!0,null==(t=this.options).parallel&&(t.parallel=100),stream.Transform.call(this,this.options),this.running=0,this.started=0,this.finished=0,this},util.inherits(Transformer,stream.Transform),module.exports.Transformer=Transformer,Transformer.prototype._transform=function(r,n,t){var i,e,s,o;this.started++,this.running++,this.running<this.options.parallel&&(t(),t=null);try{if(s=this.transform.length,null!=this.options.params&&s--,1===s)this._done(null,[this.transform.call(null,r,this.options.params)],t);else{if(2!==s)throw Error(\"Invalid handler arguments\");o=this,i=function(){var r,n;return n=arguments[0],r=2<=arguments.length?slice.call(arguments,1):[],o._done(n,r,t)},this.transform.call(null,r,i,this.options.params)}return!1}catch(r){return e=r,this._done(e)}},Transformer.prototype._flush=function(r){return this._ending=function(){if(0===this.running)return r()},this._ending()},Transformer.prototype._done=function(r,n,t){var i,e,s;if(this.running--,r)return this.emit(\"error\",r);for(this.finished++,e=0,s=n.length;e<s;e++)\"number\"==typeof(i=n[e])&&(i=\"\"+i),null!=i&&this.push(i);return t&&t(),this._ending?this._ending():void 0};","node_modules/csv-stringify/lib/index.js":"var Stringifier,get,stream,util;stream=require(\"stream\"),util=require(\"util\"),get=require(\"lodash.get\"),module.exports=function(){var t,i,e,o,r;return 3===arguments.length?(e=arguments[0],o=arguments[1],t=arguments[2]):2===arguments.length?(Array.isArray(arguments[0])?e=arguments[0]:o=arguments[0],\"function\"==typeof arguments[1]?t=arguments[1]:o=arguments[1]):1===arguments.length&&(\"function\"==typeof arguments[0]?t=arguments[0]:Array.isArray(arguments[0])?e=arguments[0]:o=arguments[0]),null==o&&(o={}),r=new Stringifier(o),e&&process.nextTick(function(){var t,i,o;for(i=0,o=e.length;i<o;i++)t=e[i],r.write(t);return r.end()}),t&&(i=[],r.on(\"readable\",function(){var t,e;for(e=[];t=r.read();)e.push(i.push(t));return e}),r.on(\"error\",function(i){return t(i)}),r.on(\"end\",function(){return t(null,i.join(\"\"))})),r},Stringifier=function(t){var i,e,o,r,n,s,u,l,p,h,f,a,c,m,y,d,g;for(y in null==t&&(t={}),d={},t)g=t[y],d[y]=g;switch(stream.Transform.call(this,d),this.options=d,null==(i=this.options).delimiter&&(i.delimiter=\",\"),null==(e=this.options).quote&&(e.quote='\"'),null==(u=this.options).quoted&&(u.quoted=!1),null==(l=this.options).quotedEmpty&&(l.quotedEmpty=void 0),null==(p=this.options).quotedString&&(p.quotedString=!1),null==(h=this.options).eof&&(h.eof=!0),null==(f=this.options).escape&&(f.escape='\"'),null==(a=this.options).columns&&(a.columns=null),null==(c=this.options).header&&(c.header=!1),null==(m=this.options).formatters&&(m.formatters={}),null==(o=this.options.formatters).date&&(o.date=function(t){return\"\"+t.getTime()}),null==(r=this.options.formatters).bool&&(r.bool=function(t){return t?\"1\":\"\"}),null==(n=this.options.formatters).object&&(n.object=function(t){return JSON.stringify(t)}),null==(s=this.options).rowDelimiter&&(s.rowDelimiter=\"\\n\"),null==this.countWriten&&(this.countWriten=0),this.options.rowDelimiter){case\"auto\":this.options.rowDelimiter=null;break;case\"unix\":this.options.rowDelimiter=\"\\n\";break;case\"mac\":this.options.rowDelimiter=\"\\r\";break;case\"windows\":this.options.rowDelimiter=\"\\r\\n\";break;case\"unicode\":this.options.rowDelimiter=\"\\u2028\"}return this},util.inherits(Stringifier,stream.Transform),module.exports.Stringifier=Stringifier,Stringifier.prototype.headers=function(){var t,i,e;if(this.options.header&&this.options.columns)return\"object\"==typeof(e=this.options.columns)&&(e=function(){var o;for(t in o=[],e)i=e[t],o.push(i);return o}()),e=this.options.eof?this.stringify(e)+this.options.rowDelimiter:this.stringify(e),stream.Transform.prototype.write.call(this,e)},Stringifier.prototype.end=function(t,i,e){return 0===this.countWriten&&this.headers(),stream.Transform.prototype.end.apply(this,arguments)},Stringifier.prototype.write=function(t,i,e){var o,r,n;if(null!=t){if(!(n=\"object\"!=typeof t)){0!==this.countWriten||Array.isArray(t)||null==(o=this.options).columns&&(o.columns=Object.keys(t));try{this.emit(\"record\",t,this.countWriten)}catch(t){return r=t,this.emit(\"error\",r)}this.options.eof?t=this.stringify(t)+this.options.rowDelimiter:(t=this.stringify(t),(this.options.header||this.countWriten)&&(t=this.options.rowDelimiter+t))}return\"number\"==typeof t&&(t=\"\"+t),0===this.countWriten&&this.headers(),n||this.countWriten++,stream.Transform.prototype.write.call(this,t,i,e)}},Stringifier.prototype._transform=function(t,i,e){return this.push(t),e()},Stringifier.prototype.stringify=function(t){var i,e,o,r,n,s,u,l,p,h,f,a,c,m,y,d,g,w,b,q;if(\"object\"!=typeof t)return t;if(\"object\"!=typeof(o=this.options.columns)||null===o||Array.isArray(o)||(o=Object.keys(o)),l=this.options.delimiter,y=this.options.quote,p=this.options.escape,Array.isArray(t))o&&t.splice(o.length);else{if(i=[],o)for(f=a=0,d=o.length;0<=d?a<d:a>d;f=0<=d?++a:--a)e=o[f],q=get(t,e),i[f]=void 0===q||null===q?\"\":q;else for(e in t)i.push(t[e]);t=i,i=null}if(Array.isArray(t)){for(m=\"\",f=c=0,g=t.length;0<=g?c<g:c>g;f=0<=g?++c:--c)\"string\"==typeof(h=t[f])||(\"number\"==typeof h?h=\"\"+h:\"boolean\"==typeof h?h=this.options.formatters.bool(h):h instanceof Date?h=this.options.formatters.date(h):\"object\"==typeof h&&null!==h&&(h=this.options.formatters.object(h))),h?(u=h.indexOf(l)>=0,s=h.indexOf(y)>=0,r=h.indexOf(p)>=0&&p!==y,n=h.indexOf(\"\\r\")>=0||h.indexOf(\"\\n\")>=0,(b=s||u||n||this.options.quoted||this.options.quotedString&&\"string\"==typeof t[f])&&r&&(w=\"\\\\\"===p?new RegExp(p+p,\"g\"):new RegExp(p,\"g\"),h=h.replace(w,p+p)),s&&(w=new RegExp(y,\"g\"),h=h.replace(w,p+y)),b&&(h=y+h+y),m+=h):(this.options.quotedEmpty||null==this.options.quotedEmpty&&\"\"===t[f]&&this.options.quotedString)&&(m+=y+y),f!==t.length-1&&(m+=l);t=m}return t};","node_modules/lodash.get/index.js":"var FUNC_ERROR_TEXT=\"Expected a function\",HASH_UNDEFINED=\"__lodash_hash_undefined__\",INFINITY=1/0,funcTag=\"[object Function]\",genTag=\"[object GeneratorFunction]\",symbolTag=\"[object Symbol]\",reIsDeepProp=/\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,reIsPlainProp=/^\\w*$/,reLeadingDot=/^\\./,rePropName=/[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g,reRegExpChar=/[\\\\^$.*+?()[\\]{}|]/g,reEscapeChar=/\\\\(\\\\)?/g,reIsHostCtor=/^\\[object .+?Constructor\\]$/,freeGlobal=\"object\"==typeof global&&global&&global.Object===Object&&global,freeSelf=\"object\"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function(\"return this\")();function getValue(t,e){return null==t?void 0:t[e]}function isHostObject(t){var e=!1;if(null!=t&&\"function\"!=typeof t.toString)try{e=!!(t+\"\")}catch(t){}return e}var arrayProto=Array.prototype,funcProto=Function.prototype,objectProto=Object.prototype,coreJsData=root[\"__core-js_shared__\"],maskSrcKey=function(){var t=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||\"\");return t?\"Symbol(src)_1.\"+t:\"\"}(),funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectToString=objectProto.toString,reIsNative=RegExp(\"^\"+funcToString.call(hasOwnProperty).replace(reRegExpChar,\"\\\\$&\").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g,\"$1.*?\")+\"$\"),Symbol=root.Symbol,splice=arrayProto.splice,Map=getNative(root,\"Map\"),nativeCreate=getNative(Object,\"create\"),symbolProto=Symbol?Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function Hash(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{}}function hashDelete(t){return this.has(t)&&delete this.__data__[t]}function hashGet(t){var e=this.__data__;if(nativeCreate){var r=e[t];return r===HASH_UNDEFINED?void 0:r}return hasOwnProperty.call(e,t)?e[t]:void 0}function hashHas(t){var e=this.__data__;return nativeCreate?void 0!==e[t]:hasOwnProperty.call(e,t)}function hashSet(t,e){return this.__data__[t]=nativeCreate&&void 0===e?HASH_UNDEFINED:e,this}function ListCache(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}function listCacheClear(){this.__data__=[]}function listCacheDelete(t){var e=this.__data__,r=assocIndexOf(e,t);return!(r<0)&&(r==e.length-1?e.pop():splice.call(e,r,1),!0)}function listCacheGet(t){var e=this.__data__,r=assocIndexOf(e,t);return r<0?void 0:e[r][1]}function listCacheHas(t){return assocIndexOf(this.__data__,t)>-1}function listCacheSet(t,e){var r=this.__data__,a=assocIndexOf(r,t);return a<0?r.push([t,e]):r[a][1]=e,this}function MapCache(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}function mapCacheClear(){this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}function mapCacheDelete(t){return getMapData(this,t).delete(t)}function mapCacheGet(t){return getMapData(this,t).get(t)}function mapCacheHas(t){return getMapData(this,t).has(t)}function mapCacheSet(t,e){return getMapData(this,t).set(t,e),this}function assocIndexOf(t,e){for(var r=t.length;r--;)if(eq(t[r][0],e))return r;return-1}function baseGet(t,e){for(var r=0,a=(e=isKey(e,t)?[e]:castPath(e)).length;null!=t&&r<a;)t=t[toKey(e[r++])];return r&&r==a?t:void 0}function baseIsNative(t){return!(!isObject(t)||isMasked(t))&&(isFunction(t)||isHostObject(t)?reIsNative:reIsHostCtor).test(toSource(t))}function baseToString(t){if(\"string\"==typeof t)return t;if(isSymbol(t))return symbolToString?symbolToString.call(t):\"\";var e=t+\"\";return\"0\"==e&&1/t==-INFINITY?\"-0\":e}function castPath(t){return isArray(t)?t:stringToPath(t)}function getMapData(t,e){var r=t.__data__;return isKeyable(e)?r[\"string\"==typeof e?\"string\":\"hash\"]:r.map}function getNative(t,e){var r=getValue(t,e);return baseIsNative(r)?r:void 0}function isKey(t,e){if(isArray(t))return!1;var r=typeof t;return!(\"number\"!=r&&\"symbol\"!=r&&\"boolean\"!=r&&null!=t&&!isSymbol(t))||(reIsPlainProp.test(t)||!reIsDeepProp.test(t)||null!=e&&t in Object(e))}function isKeyable(t){var e=typeof t;return\"string\"==e||\"number\"==e||\"symbol\"==e||\"boolean\"==e?\"__proto__\"!==t:null===t}function isMasked(t){return!!maskSrcKey&&maskSrcKey in t}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var stringToPath=memoize(function(t){t=toString(t);var e=[];return reLeadingDot.test(t)&&e.push(\"\"),t.replace(rePropName,function(t,r,a,o){e.push(a?o.replace(reEscapeChar,\"$1\"):r||t)}),e});function toKey(t){if(\"string\"==typeof t||isSymbol(t))return t;var e=t+\"\";return\"0\"==e&&1/t==-INFINITY?\"-0\":e}function toSource(t){if(null!=t){try{return funcToString.call(t)}catch(t){}try{return t+\"\"}catch(t){}}return\"\"}function memoize(t,e){if(\"function\"!=typeof t||e&&\"function\"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);var r=function(){var a=arguments,o=e?e.apply(this,a):a[0],n=r.cache;if(n.has(o))return n.get(o);var i=t.apply(this,a);return r.cache=n.set(o,i),i};return r.cache=new(memoize.Cache||MapCache),r}function eq(t,e){return t===e||t!=t&&e!=e}memoize.Cache=MapCache;var isArray=Array.isArray;function isFunction(t){var e=isObject(t)?objectToString.call(t):\"\";return e==funcTag||e==genTag}function isObject(t){var e=typeof t;return!!t&&(\"object\"==e||\"function\"==e)}function isObjectLike(t){return!!t&&\"object\"==typeof t}function isSymbol(t){return\"symbol\"==typeof t||isObjectLike(t)&&objectToString.call(t)==symbolTag}function toString(t){return null==t?\"\":baseToString(t)}function get(t,e,r){var a=null==t?void 0:baseGet(t,e);return void 0===a?r:a}module.exports=get;","node_modules/object-keys/index.js":"\"use strict\";var slice=Array.prototype.slice,isArgs=require(\"./isArguments\"),origKeys=Object.keys,keysShim=origKeys?function(e){return origKeys(e)}:require(\"./implementation\"),originalKeys=Object.keys;keysShim.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return isArgs(e)?originalKeys(slice.call(e)):originalKeys(e)}):Object.keys=keysShim;return Object.keys||keysShim},module.exports=keysShim;","node_modules/is-arguments/index.js":"\"use strict\";var hasToStringTag=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.toStringTag,toStr=Object.prototype.toString,isStandardArguments=function(t){return!(hasToStringTag&&t&&\"object\"==typeof t&&Symbol.toStringTag in t)&&\"[object Arguments]\"===toStr.call(t)},isLegacyArguments=function(t){return!!isStandardArguments(t)||null!==t&&\"object\"==typeof t&&\"number\"==typeof t.length&&t.length>=0&&\"[object Array]\"!==toStr.call(t)&&\"[object Function]\"===toStr.call(t.callee)},supportsStandardArguments=function(){return isStandardArguments(arguments)}();isStandardArguments.isLegacyArguments=isLegacyArguments,module.exports=supportsStandardArguments?isStandardArguments:isLegacyArguments;","node_modules/object-is/index.js":"\"use strict\";var NumberIsNaN=function(r){return r!=r};module.exports=function(r,u){return 0===r&&0===u?1/r==1/u:r===u||!(!NumberIsNaN(r)||!NumberIsNaN(u))};","node_modules/is-regex/index.js":"\"use strict\";var has=require(\"has\"),regexExec=RegExp.prototype.exec,gOPD=Object.getOwnPropertyDescriptor,tryRegexExecCall=function(e){try{var t=e.lastIndex;return e.lastIndex=0,regexExec.call(e),!0}catch(e){return!1}finally{e.lastIndex=t}},toStr=Object.prototype.toString,regexClass=\"[object RegExp]\",hasToStringTag=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.toStringTag;module.exports=function(e){if(!e||\"object\"!=typeof e)return!1;if(!hasToStringTag)return toStr.call(e)===regexClass;var t=gOPD(e,\"lastIndex\");return!(!t||!has(t,\"value\"))&&tryRegexExecCall(e)};","node_modules/regexp.prototype.flags/index.js":"\"use strict\";var define=require(\"define-properties\"),implementation=require(\"./implementation\"),getPolyfill=require(\"./polyfill\"),shim=require(\"./shim\"),flagsBound=Function.call.bind(implementation);define(flagsBound,{getPolyfill:getPolyfill,implementation:implementation,shim:shim}),module.exports=flagsBound;","node_modules/is-date-object/index.js":"\"use strict\";var getDay=Date.prototype.getDay,tryDateObject=function(t){try{return getDay.call(t),!0}catch(t){return!1}},toStr=Object.prototype.toString,dateClass=\"[object Date]\",hasToStringTag=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.toStringTag;module.exports=function(t){return\"object\"==typeof t&&null!==t&&(hasToStringTag?tryDateObject(t):toStr.call(t)===dateClass)};","node_modules/object-keys/isArguments.js":"\"use strict\";var toStr=Object.prototype.toString;module.exports=function(t){var e=toStr.call(t),o=\"[object Arguments]\"===e;return o||(o=\"[object Array]\"!==e&&null!==t&&\"object\"==typeof t&&\"number\"==typeof t.length&&t.length>=0&&\"[object Function]\"===toStr.call(t.callee)),o};","node_modules/has/src/index.js":"\"use strict\";var bind=require(\"function-bind\");module.exports=bind.call(Function.call,Object.prototype.hasOwnProperty);","node_modules/function-bind/index.js":"\"use strict\";var implementation=require(\"./implementation\");module.exports=Function.prototype.bind||implementation;","node_modules/function-bind/implementation.js":"\"use strict\";var ERROR_MESSAGE=\"Function.prototype.bind called on incompatible \",slice=Array.prototype.slice,toStr=Object.prototype.toString,funcType=\"[object Function]\";module.exports=function(t){var n=this;if(\"function\"!=typeof n||toStr.call(n)!==funcType)throw new TypeError(ERROR_MESSAGE+n);for(var o,e=slice.call(arguments,1),r=Math.max(0,n.length-e.length),c=[],i=0;i<r;i++)c.push(\"$\"+i);if(o=Function(\"binder\",\"return function (\"+c.join(\",\")+\"){ return binder.apply(this,arguments); }\")(function(){if(this instanceof o){var r=n.apply(this,e.concat(slice.call(arguments)));return Object(r)===r?r:this}return n.apply(t,e.concat(slice.call(arguments)))}),n.prototype){var p=function(){};p.prototype=n.prototype,o.prototype=new p,p.prototype=null}return o};","node_modules/define-properties/index.js":"\"use strict\";var keys=require(\"object-keys\"),hasSymbols=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol(\"foo\"),toStr=Object.prototype.toString,concat=Array.prototype.concat,origDefineProperty=Object.defineProperty,isFunction=function(e){return\"function\"==typeof e&&\"[object Function]\"===toStr.call(e)},arePropertyDescriptorsSupported=function(){var e={};try{for(var r in origDefineProperty(e,\"x\",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}},supportsDescriptors=origDefineProperty&&arePropertyDescriptorsSupported(),defineProperty=function(e,r,t,o){(!(r in e)||isFunction(o)&&o())&&(supportsDescriptors?origDefineProperty(e,r,{configurable:!0,enumerable:!1,value:t,writable:!0}):e[r]=t)},defineProperties=function(e,r){var t=arguments.length>2?arguments[2]:{},o=keys(r);hasSymbols&&(o=concat.call(o,Object.getOwnPropertySymbols(r)));for(var n=0;n<o.length;n+=1)defineProperty(e,o[n],r[o[n]],t[o[n]])};defineProperties.supportsDescriptors=!!supportsDescriptors,module.exports=defineProperties;","node_modules/regexp.prototype.flags/implementation.js":"\"use strict\";var toObject=Object,TypeErr=TypeError;module.exports=function(){if(null!=this&&this!==toObject(this))throw new TypeErr(\"RegExp.prototype.flags getter called on non-object\");var t=\"\";return this.global&&(t+=\"g\"),this.ignoreCase&&(t+=\"i\"),this.multiline&&(t+=\"m\"),this.dotAll&&(t+=\"s\"),this.unicode&&(t+=\"u\"),this.sticky&&(t+=\"y\"),t};","node_modules/regexp.prototype.flags/polyfill.js":"\"use strict\";var implementation=require(\"./implementation\"),supportsDescriptors=require(\"define-properties\").supportsDescriptors,gOPD=Object.getOwnPropertyDescriptor,TypeErr=TypeError;module.exports=function(){if(!supportsDescriptors)throw new TypeErr(\"RegExp.prototype.flags requires a true ES5 environment that supports property descriptors\");if(\"gim\"===/a/gim.flags){var e=gOPD(RegExp.prototype,\"flags\");if(e&&\"function\"==typeof e.get&&\"boolean\"==typeof/a/.dotAll)return e.get}return implementation};","node_modules/regexp.prototype.flags/shim.js":"\"use strict\";var supportsDescriptors=require(\"define-properties\").supportsDescriptors,getPolyfill=require(\"./polyfill\"),gOPD=Object.getOwnPropertyDescriptor,defineProperty=Object.defineProperty,TypeErr=TypeError,getProto=Object.getPrototypeOf,regex=/a/;module.exports=function(){if(!supportsDescriptors||!getProto)throw new TypeErr(\"RegExp.prototype.flags requires a true ES5 environment that supports property descriptors\");var e=getPolyfill(),r=getProto(regex),t=gOPD(r,\"flags\");return t&&t.get===e||defineProperty(r,\"flags\",{configurable:!0,enumerable:!1,get:e}),e};","node_modules/h5.modbus/lib/Master.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter,InvalidFrameError=require(\"./InvalidFrameError\"),ResponseTimeoutError=require(\"./ResponseTimeoutError\"),Transaction=require(\"./Transaction\"),messages=require(\"./messages\");class Master extends EventEmitter{constructor(t){super(),this.onConnectionOpen=this.onConnectionOpen.bind(this),this.onConnectionClose=this.onConnectionClose.bind(this),this.onConnectionError=this.onConnectionError.bind(this),this.onConnectionData=this.onConnectionData.bind(this),this.connection=this.setUpConnection(t.connection),this.transport=this.setUpTransport(t.transport),this.suppressTransactionErrors=!0===t.suppressTransactionErrors,this.retryOnException=!1!==t.retryOnException,this.maxConcurrentTransactions=t.maxConcurrentTransactions||1,this.defaultUnit=t.defaultUnit>0?t.defaultUnit:0,this.defaultMaxRetries=t.defaultMaxRetries>=0?t.defaultMaxRetries:1,this.defaultTimeout=t.defaultTimeout>0?t.defaultTimeout:100,this.repeatableTransactions=new Map,this.transactionQueue=[],this.runningTransactionCache=new Map,this.runningTransactions=new Map,this.runningRequests=new Map,this.lastRunningTransaction=null,this.connected=this.connection.isOpen(),this.nextRequestId=0}destroy(t){this.removeAllListeners(),this.destroyTransport(t),this.destroyConnection(t),this.destroyTransactions()}isOpen(){return this.connected}execute(t){const n=this.createTransaction(t);return n.isRepeatable()&&this.addRepeatableTransaction(n),this.transactionQueue.push(n),this.runQueuedTransactions(),n}readDiscreteInputs(t,n,e){return this.request(new messages.ReadDiscreteInputsRequest(t,n),e)}readCoils(t,n,e){return this.request(new messages.ReadCoilsRequest(t,n),e)}writeSingleCoil(t,n,e){return this.request(new messages.WriteSingleCoilRequest(t,n),e)}writeMultipleCoils(t,n,e){return this.request(new messages.WriteMultipleCoilsRequest(t,n),e)}readInputRegisters(t,n,e){return this.request(new messages.ReadInputRegistersRequest(t,n),e)}readHoldingRegisters(t,n,e){return this.request(new messages.ReadHoldingRegistersRequest(t,n),e)}writeSingleRegister(t,n,e){return this.request(new messages.WriteSingleRegisterRequest(t,n),e)}writeMultipleRegisters(t,n,e){return this.request(new messages.WriteMultipleRegistersRequest(t,n),e)}request(t,n){let e=n,s=null;\"function\"==typeof n?(s=n,e={request:t}):null==n?e={request:t}:e.request=t;const i=this.execute(e);return s&&i.on(\"complete\",s),i}createTransaction(t){const n=t&&\"function\"==typeof t.bind?t:new Transaction(this.applyTransactionDefaults(t));return n.bind(this.onTransactionDestroy.bind(this,n)),this.suppressTransactionErrors&&n.on(\"error\",()=>{}),n.on(\"timeout\",this.onTransactionTimeout.bind(this)),n}applyTransactionDefaults(t){return t||(t={}),null==t.unit&&(t.unit=this.defaultUnit),null==t.maxRetries&&(t.maxRetries=this.defaultMaxRetries),null==t.timeout&&(t.timeout=this.defaultTimeout),t}addRepeatableTransaction(t){if(this.repeatableTransactions.has(t.id))throw new Error(`Transaction ID must be unique per each Master. [${t.id}] already exists.`);this.repeatableTransactions.set(t.id,t)}destroyTransactions(){this.transactionQueue.forEach(t=>t.destroy()),this.repeatableTransactions.forEach(t=>t.destroy()),this.runningTransactions.forEach(t=>t.destroy()),this.repeatableTransactions=null,this.transactionQueue=null,this.runningTransactions=null}setUpTransport(t){return t.add(this),this.on(\"adu\",this.handleAdu.bind(this)),t}destroyTransport(t){t&&this.transport.destroy(),this.transport=null}setUpConnection(t){return t.on(\"open\",this.onConnectionOpen),t.on(\"close\",this.onConnectionClose),t.on(\"error\",this.onConnectionError),t.on(\"data\",this.onConnectionData),t}destroyConnection(t){const n=this.connection;null!==n&&(n.removeListener(\"open\",this.onConnectionOpen),n.removeListener(\"close\",this.onConnectionClose),n.removeListener(\"error\",this.onConnectionError),n.removeListener(\"data\",this.onConnectionData),t&&n.destroy(),this.connection=null)}onConnectionOpen(){this.connected=!0,this.transport.add(this),this.queueRepeatableTransactions(),this.runQueuedTransactions(),this.emit(\"open\")}onConnectionClose(){this.connected&&(this.connected=!1,this.emit(\"close\"))}onConnectionError(t){this.emit(\"error\",t)}onConnectionData(t){this.emit(\"data\",t)}onTransactionTimeout(t){this.handleResult(t,null,new ResponseTimeoutError,null),this.emit(\"timeout\",t)}onTransactionDestroy(t){this.repeatableTransactions.delete(t.id);const n=this.runningTransactions.get(t);n&&(this.runningRequests.delete(n.requestId),this.runningTransactions.delete(t),n.destroy(),this.lastRunningTransaction===n&&(this.lastRunningTransaction=null)),this.runningTransactionCache.delete(t);const e=this.transactionQueue.indexOf(t);-1!==e&&this.transactionQueue.splice(e,1)}queueRepeatableTransactions(){this.repeatableTransactions.forEach(t=>this.transactionQueue.push(t))}runQueuedTransactions(){for(;this.transactionQueue.length>0&&this.runningTransactions.size<this.maxConcurrentTransactions;)this.runTransaction(this.transactionQueue.shift())}runTransaction(t){let n=this.runningTransactionCache.get(t);n||(n=new RunningTransaction(t,this.transport,this.connection)),this.startRunningTransaction(n)}startRunningTransaction(t){const n=this.getNextRequestId();this.runningTransactions.set(t.transaction,t),this.runningRequests.set(n,t),this.lastRunningTransaction=t,setImmediate(t.start.bind(t,n))}getNextRequestId(){return 65535===this.nextRequestId?this.nextRequestId=1:this.nextRequestId+=1,this.nextRequestId}handleAdu(t){let n=null;try{n=t.toResponse()}catch(t){this.emit(\"error\",t)}n&&this.handleResult(t.id,t,null,n)}handleResult(t,n,e,s){const i=this.findRunningTransaction(t);if(!i)return;const r=i.transaction;this.runningTransactions.delete(r),this.runningRequests.delete(i.requestId),this.lastRunningTransaction=null,e||(e=i.validate(n)),e?this.handleTransactionError(i,e):this.handleTransactionResponse(i,n,s),this.runQueuedTransactions()}handleTransactionError(t,n){t.handleError(n);const e=t.transaction;t.shouldRetry()?this.scheduleReExecution(t):t.isRepeatable()?this.scheduleExecution(t):e.destroy()}handleTransactionResponse(t,n,e){const s=n.isException();t.handleResponse(s,e);const i=t.transaction;s&&this.retryOnException&&t.shouldRetry()?this.scheduleReExecution(t):t.isRepeatable()?this.scheduleExecution(t):i.destroy()}scheduleExecution(t){this.cacheRunningTransaction(t),t.scheduleExecution(()=>{this.isOpen()&&(this.transactionQueue.push(t.transaction),this.runQueuedTransactions())})}scheduleReExecution(t){this.cacheRunningTransaction(t),this.transactionQueue.unshift(t.transaction)}findRunningTransaction(t){return 0===this.runningRequests.size?null:null===t?this.lastRunningTransaction:this.runningRequests.get(t)||null}cacheRunningTransaction(t){this.runningTransactionCache.set(t.transaction,t)}}class RunningTransaction{constructor(t,n,e){this.requestId=-1,this.transaction=t,this.transport=n,this.connection=e,this.frame=null,this.failures=0,this.timeoutTimer=null,this.executionTimer=null}destroy(){this.stopTimeout(),this.executionTimer&&(clearTimeout(this.executionTimer),this.executionTimer=null),this.transaction=null,this.transport=null,this.connection=null,this.frame=null,this.pdu=null}isRepeatable(){return this.transaction.isRepeatable()}shouldRetry(){return this.failures<=this.transaction.maxRetries}start(t){this.frame&&this.transport.update(this.frame,t)||(this.frame=this.transport.encode(t,this.transaction.unit,this.transaction.request.toBuffer())),this.requestId=t,this.timeoutTimer=setTimeout(this.onTimeout.bind(this),this.transaction.timeout),this.connection.write(this.frame),this.transaction.emit(\"request\",t)}scheduleExecution(t){this.failures=0,0===this.transaction.interval?t():this.executionTimer=setTimeout(t,this.transaction.interval)}validate(t){const n=this.transaction.unit,e=t.unit;if(e!==n)return new InvalidFrameError(`Invalid unit in a response to request [${t.id}] of transaction [${this.transaction.id}]. `+`Expected [${n}], but got [${e}].`);const s=this.transaction.request.functionCode,i=t.getRealFunctionCode();return i!==s?new InvalidFrameError(`Invalid function code in a response to request [${t.id}] of transaction [${this.transaction.id}]. `+`Expected [${s}], but got [${i}].`):null}handleResponse(t,n){this.stopTimeout(),t?this.failures+=1:this.failures=0,this.transaction.emit(\"response\",n),this.transaction.emit(\"complete\",null,n)}handleError(t){this.stopTimeout(),this.failures+=1,this.transaction.emit(\"error\",t),this.transaction.emit(\"complete\",t,null)}onTimeout(){this.stopTimeout(),this.transaction.emit(\"timeout\",this.requestId)}stopTimeout(){this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}module.exports=Master;","node_modules/h5.modbus/lib/Slave.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter,ExceptionCode=require(\"./ExceptionCode\"),FunctionCode=require(\"./FunctionCode\"),Response=require(\"./Response\"),ExceptionResponse=require(\"./messages/ExceptionResponse\"),responses=require(\"./messages\").responses;class Slave extends EventEmitter{constructor(e){super(),this.onRemoteClient=this.onRemoteClient.bind(this),this.listener=this.setUpListener(e.listener),this.transport=this.setUpTransport(e.transport),this.requestHandler=this.setUpRequestHandler(e.requestHandler),this.suppressClientErrors=!1!==e.suppressClientErrors,this.maxClients=e.maxClients||0,this.clients=new Set}destroy(e){this.removeAllListeners(),this.destroyTransport(e),this.destroyListener(e),this.clients.clear()}setUpRequestHandler(e){if(!e)throw new Error(\"The `requestHandler` option must be specified!\");return e}setUpTransport(e){if(!e)throw new Error(\"The `transport` option must be specified!\");return e}destroyTransport(e){this.transport&&(e&&this.transport.destroy(),this.transport=null)}setUpListener(e){if(!e)throw new Error(\"The `listener` option must be specified!\");return e.on(\"client\",this.onRemoteClient),e}destroyListener(e){this.listener&&(this.listener.removeListener(\"client\",this.onRemoteClient),e&&this.listener.destroy(),this.listener=null)}onRemoteClient(e){this.hasMaxClients()?e.destroy():(e.on(\"adu\",this.handleAdu.bind(this,e)),e.on(\"close\",()=>this.clients.delete(e)),this.suppressClientErrors&&e.on(\"error\",()=>{}),this.transport.add(e),this.clients.add(e))}hasMaxClients(){return this.maxClients>0&&this.clients.size===this.maxClients}handleAdu(e,t){let s=null;try{s=t.toRequest()}catch(t){e.emit(\"error\",t)}s&&this.handleRequest(e,t,s)}handleRequest(e,t,s){this.emit(\"request\",{client:e,adu:t,request:s}),this.requestHandler(t.unit,s,this.createRespondCallback(e,t,s))}createRespondCallback(e,t,s){return n=>{if(!this.transport)return;const r=this.createResponse(t.functionCode,n),i=r.toBuffer(),o=this.transport.encode(t.id,t.unit,i);this.emit(\"response\",{client:e,adu:t,request:s,response:r}),e.write(o)}}createResponse(e,t){if(null==t)throw new Error(\"Invalid response result. Expected an ExceptionCode, a Response, a Response options object or a Response Buffer, \"+`but got [${t}].`);if(\"number\"==typeof t)return new ExceptionResponse(e,t);if(t instanceof Response){if(t.functionCode!==e)throw new Error(\"Invalid response result. \"+`Expected a Response with function code ${FunctionCode[e]} (${e}), `+`but got ${FunctionCode[t.functionCode]} (${t.functionCode}).`);return t}if(t instanceof Error)return new ExceptionResponse(e,ExceptionCode.SlaveDeviceFailure);const s=responses[e];if(!s)throw new Error(\"Invalid response result. Expected an options object or Buffer for an implemented MODBUS function code, \"+`but ${FunctionCode[e]} (${e}) is not implemented.`);return Buffer.isBuffer(t)?s.fromBuffer(t):s.fromOptions(t)}}module.exports=Slave;","node_modules/h5.modbus/lib/ExceptionCode.js":"\"use strict\";const ExceptionCode={IllegalFunctionCode:1,IllegalDataAddress:2,IllegalDataValue:3,SlaveDeviceFailure:4,Acknowledge:5,SlaveDeviceBusy:6,NegativeAcknowledge:7,MemoryParityError:8,GatewayPathUnavailable:10,GatewayTargetDeviceFailedToRespond:11};Object.keys(ExceptionCode).forEach(e=>{ExceptionCode[ExceptionCode[e]]=e}),module.exports=ExceptionCode;","node_modules/h5.modbus/lib/FunctionCode.js":"\"use strict\";const FunctionCode={ReadDiscreteInputs:2,ReadCoils:1,WriteSingleCoil:5,WriteMultipleCoils:15,ReadInputRegisters:4,ReadHoldingRegisters:3,WriteSingleRegister:6,WriteMultipleRegisters:16,ReadWriteMultipleRegisters:23,MaskWriteRegister:22,ReadFifoQueue:24,ReadFileRecord:20,WriteFileRecord:21,ReadExceptionStatus:7,Diagnostic:8,GetComEventCounter:11,GetComEventLog:12,ReportServerId:17,ReadDeviceIdentification:43,Exception:128};Object.keys(FunctionCode).forEach(e=>{FunctionCode[FunctionCode[e]]=e}),module.exports=FunctionCode;","node_modules/h5.modbus/lib/helpers.js":"\"use strict\";const inspect=require(\"util\").inspect,POWER=[1,2,4,8,16,32,64,128];function ModbusHelpers(){}function formatMessage(e,r,t){return`${ModbusHelpers.formatFunctionCode(e)} (${t?\"RES\":\"REQ\"}) ${r}`}ModbusHelpers.toBitArray=function(e,r,t){const n=new Array(t),o=e.length;let s=0;for(;r<o;++r){const o=e[r];for(let e=0;e<8&&s!==t;++e)n[s++]=0!=(o&POWER[e])}return n},ModbusHelpers.formatFunctionCode=function(e){return`0x${e>15?\"\":\"0\"}${e.toString(16).toUpperCase()}`},ModbusHelpers.formatRequest=function(e,r){return formatMessage(e.functionCode,r,!1)},ModbusHelpers.formatResponse=function(e,r){return formatMessage(e.functionCode,r,!0)},ModbusHelpers.assertFunctionCode=function(e,r){if(e!==r)throw new Error(`Invalid function code. Expected [${r}], got [${e}].`)},ModbusHelpers.assertBufferLength=function(e,r){if(e.length<r)throw new Error(`Invalid buffer. Expected at least [${r}] bytes, got [${e.length}].`)},ModbusHelpers.prepareAddress=function(e,r){const t=ModbusHelpers.prepareNumericOption(e,0,0,65535,\"A starting address\"),n=t+r;if(n>0&&n>65536)throw new Error(`The sum of the starting address and quantity must be an integer between 1 and 65536, but got [${n}].`);return t},ModbusHelpers.prepareQuantity=function(e,r){return ModbusHelpers.prepareNumericOption(e,1,1,r,\"Quantity\")},ModbusHelpers.prepareRegisterValue=function(e){if(Buffer.isBuffer(e)){if(e.length<2)throw new Error(`Register value must be a 2 byte Buffer, but got: ${inspect(e)}`);return e.readUInt16BE(0,!0)}const r=ModbusHelpers.prepareNumericOption(e,0,-32768,65535,\"Register value\");return r>=0?r:r+65536},ModbusHelpers.prepareRegisterValues=function(e){let r=e;if(Array.isArray(e)){r=new Buffer(2*e.length);for(let t=0;t<e.length;++t){const n=ModbusHelpers.prepareNumericOption(e[t],0,-32768,65535,\"Register value\");r.writeUInt16BE(n>=0?n:n+65536,2*t,!0)}}if(!Buffer.isBuffer(r)){const e=typeof r,t=\"object\"===e?inspect(r):e;throw new Error(`Invalid register values. Expected a Buffer, but got [${t}].`)}if(r.length%2!=0||r.length<2||r.length>246)throw new Error(\"Invalid register values. \"+`Expected a Buffer of even length between 2 and 246 bytes, but got [${r.length}].`);return r},ModbusHelpers.prepareNumericOption=function(e,r,t,n,o){if(null==e)return r;const s=Math.floor(e);if(isNaN(s)||s<t||s>n)throw new Error(`${o} must be a number between ${t} and ${n}, but got [${e}].`);return s},module.exports=ModbusHelpers;","node_modules/h5.modbus/lib/ApplicationDataUnit.js":"\"use strict\";const InvalidFrameError=require(\"./InvalidFrameError\"),FunctionCode=require(\"./FunctionCode\"),messages=require(\"./messages\");class ApplicationDataUnit{constructor(e,t,o,n){this.id=e,this.unit=t,this.functionCode=o[0],this.protocolDataUnit=o,this.checksum=n}isException(){return this.functionCode>FunctionCode.Exception}getRealFunctionCode(){return this.isException()?this.functionCode-FunctionCode.Exception:this.functionCode}toRequest(){if(!messages.requests[this.functionCode])throw new InvalidFrameError(`Unsupported request function code: ${this.functionCode}`);return messages.requests[this.functionCode].fromBuffer(this.protocolDataUnit)}toResponse(){const e=this.isException()?FunctionCode.Exception:this.functionCode;if(!messages.responses[e])throw new InvalidFrameError(`Unsupported response function code: ${e}`);return messages.responses[e].fromBuffer(this.protocolDataUnit)}}module.exports=ApplicationDataUnit;","node_modules/h5.modbus/lib/RemoteClient.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter;class RemoteClient extends EventEmitter{constructor(e){super(),this.remoteInfo=e}destroy(){this.emit(\"close\"),this.removeAllListeners()}write(e){this.emit(\"write\",e)}}module.exports=RemoteClient;","node_modules/h5.modbus/lib/Transaction.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter,requests=require(\"./messages\").requests;let TID=0;class Transaction extends EventEmitter{constructor(t){super(),this.id=\"string\"==typeof t.id?t.id:`T~${++TID}`,this.unit=t.unit>=0?t.unit:1,this.maxRetries=t.maxRetries>=0?t.maxRetries:1,this.timeout=t.timeout>0?t.timeout:100,this.interval=t.interval>=0?t.interval:-1,this.request=\"function\"==typeof t.request.toBuffer?t.request:requests[t.request.functionCode].fromOptions(t.request),this.onDestroy=null}destroy(){this.removeAllListeners(),this.onDestroy&&(this.onDestroy(),this.onDestroy=null)}isRepeatable(){return this.interval>=0}bind(t){if(this.onDestroy)throw new Error(`Transaction [${this.id}] is already bound to another Master.`);this.onDestroy=t}}module.exports=Transaction;","node_modules/h5.modbus/lib/InvalidFrameError.js":"\"use strict\";class InvalidFrameError extends Error{constructor(r){super(),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=r||\"Received an invalid MODBUS frame.\"}}module.exports=InvalidFrameError;","node_modules/h5.modbus/lib/ResponseTimeoutError.js":"\"use strict\";class ResponseTimeoutError extends Error{constructor(e){super(),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e||\"No response was received from the slave in the specified time.\"}}module.exports=ResponseTimeoutError;","node_modules/h5.modbus/lib/Transport.js":"\"use strict\";class Transport{constructor(){}destroy(){throw new Error(\"@abstract\")}encode(r,t,o){throw new Error(\"@abstract\")}decode(r){throw new Error(\"@abstract\")}update(r,t){throw new Error(\"@abstract\")}add(r){throw new Error(\"@abstract\")}}module.exports=Transport;","node_modules/h5.modbus/lib/transports/IpTransport.js":"\"use strict\";const inspect=require(\"util\").inspect,buffers=require(\"h5.buffers\"),InvalidFrameError=require(\"../InvalidFrameError\"),ApplicationDataUnit=require(\"../ApplicationDataUnit\"),Transport=require(\"../Transport\"),IP_FRAME_MIN_LENGTH=8;class IpTransport extends Transport{constructor(e){super(),e||(e={}),this.maxBufferLength=e.maxBufferLength||1e3,this.eeToState=new Map}destroy(){this.eeToState.forEach(e=>e.destroy()),this.eeToState=null}encode(e,t,r){const s=new Buffer(7+r.length);return s.writeUInt16BE(e,0,!0),s.writeUInt16BE(0,2,!0),s.writeUInt16BE(r.length+1,4,!0),s.writeUInt8(t,6,!0),r.copy(s,7),s}decode(e){if(e.length<IP_FRAME_MIN_LENGTH)throw new InvalidFrameError(`MODBUS IP frames must have at least ${IP_FRAME_MIN_LENGTH} bytes, `+`but got [${e.length}]: ${inspect(e)}`);const t=new IpTransportState(null,this.maxBufferLength,null);t.pushData(e),t.readHeader();const r=t.validateHeader();if(r)throw r;return t.createAdu()}update(e,t){return e.length>=2&&(e.writeUInt16BE(65535&t,0,!0),!0)}add(e){if(this.eeToState.has(e))return;const t=new IpTransportState(e,this.maxBufferLength,()=>this.eeToState.delete(e));this.eeToState.set(e,t)}}class IpTransportState{constructor(e,t,r){this.ee=e,this.maxBufferLength=t,this.onDestroy=r,this.onClose=this.destroy.bind(this),this.onData=this.onData.bind(this),this.id=-1,this.version=-1,this.length=-1,this.unit=-1,this.buffer=new buffers.BufferQueueReader,e&&(e.on(\"close\",this.onClose),e.on(\"data\",this.onData))}destroy(){this.ee&&(this.ee.removeListener(\"close\",this.onClose),this.ee.removeListener(\"data\",this.onData),this.ee=null),this.buffer&&(this.buffer.skip(this.buffer.length),this.buffer=null),this.onDestroy&&(this.onDestroy(),this.onDestroy=null)}pushData(e){this.buffer.push(e)}readHeader(){this.id=this.buffer.shiftUInt16(!1),this.version=this.buffer.shiftUInt16(!1),this.length=this.buffer.shiftUInt16(!1)-1,this.unit=this.buffer.shiftByte()}validateHeader(){return 0!==this.version?new InvalidFrameError(\"Invalid version specified in a header of a MODBUS IP frame. \"+`Expected [0], but got [${this.version}].`):this.length<2?new InvalidFrameError(\"Invalid length specified in a header of a MODBUS IP frame. \"+`Expected at least [2], but got [${this.length}].`):null}createAdu(){return new ApplicationDataUnit(this.id,this.unit,this.buffer.shiftBuffer(this.length),null)}resetHeader(){this.id=-1,this.version=-1,this.length=-1,this.unit=-1}onData(e){this.pushData(e),this.handleIncompleteFrame()}hasCompleteFrame(){return-1!==this.id&&this.buffer.length>=this.length}isReadable(){return-1===this.id&&this.buffer.length>=7}skipFrame(){this.length>0&&this.buffer.skip(this.length)}handleIncompleteFrame(){this.isReadable()&&this.readHeader(),this.hasCompleteFrame()?this.handleCompleteFrame():this.isBufferOverflow()&&this.handleBufferOverflow()}handleCompleteFrame(){const e=this.validateHeader();if(e)return this.skipFrame(),this.resetHeader(),void this.ee.emit(\"error\",e);this.ee.emit(\"adu\",this.createAdu()),this.resetHeader(),this.buffer.length>0&&this.handleIncompleteFrame()}isBufferOverflow(){return this.buffer.length>this.maxBufferLength}handleBufferOverflow(){this.resetHeader(),this.ee.emit(\"bufferOverflow\",this.buffer.shiftBuffer(this.buffer.length))}}module.exports=IpTransport;","node_modules/h5.modbus/lib/transports/AsciiTransport.js":"\"use strict\";const inspect=require(\"util\").inspect,buffers=require(\"h5.buffers\"),InvalidFrameError=require(\"../InvalidFrameError\"),ApplicationDataUnit=require(\"../ApplicationDataUnit\"),Transport=require(\"../Transport\"),ASCII_FRAME_MIN_LENGTH=9,ASCII_FRAME_START=58,ASCII_FRAME_CR=13,ASCII_FRAME_LF=10;class AsciiTransport extends Transport{constructor(e){super(),e||(e={}),this.maxBufferLength=e.maxBufferLength||1e3,this.eeToState=new Map}destroy(){this.eeToState.forEach(e=>e.destroy()),this.eeToState=null}encode(e,t,n){const r=new Buffer(3+2*n.length+2+2),o=lrc(t,n);let i=0;r[i++]=ASCII_FRAME_START,r[i++]=encodeNibble(high(t)),r[i++]=encodeNibble(low(t));for(let e=0;e<n.length;++e)r[i++]=encodeNibble(high(n[e])),r[i++]=encodeNibble(low(n[e]));return r[i++]=encodeNibble(high(o)),r[i++]=encodeNibble(low(o)),r[i++]=ASCII_FRAME_CR,r[i]=ASCII_FRAME_LF,r}decode(e){if(e.length<ASCII_FRAME_MIN_LENGTH)throw new InvalidFrameError(`MODBUS ASCII frames must have at least ${ASCII_FRAME_MIN_LENGTH} bytes, `+`but got [${e.length}]: ${inspect(e)}`);if(e[0]!==ASCII_FRAME_START||e[e.length-2]!==ASCII_FRAME_CR||e[e.length-1]!==ASCII_FRAME_LF)throw new InvalidFrameError(`MODBUS ASCII frames must begin with [:] and end with [CR] followed by [LF], but got: ${inspect(e)}`);const t=decodeBytes(e.slice(1,e.length-2)),n=t.pop(),r=lrc(0,t);if(r!==n)throw new InvalidFrameError(`Checksum mismatch. Expected [${n}], but got [${r}].`);const o=t.shift(),i=new Buffer(t);return new ApplicationDataUnit(null,o,i,n)}update(e,t){return!0}add(e){if(this.eeToState.has(e))return;const t={buffer:new buffers.BufferQueueReader,onClose:this.onClose.bind(this,e),onTimeout:this.onTimeout.bind(this,e),onData:this.onData.bind(this,e),destroy:()=>{t.buffer.skip(t.buffer.length),t.buffer=null,e.removeListener(\"close\",t.onClose),e.removeListener(\"onTimeout\",t.onTimeout),e.removeListener(\"data\",t.onData),t.onClose=null,t.onTimeout=null,t.onData=null,this.eeToState.delete(e)}};e.on(\"close\",t.onClose),e.on(\"timeout\",t.onTimeout),e.on(\"data\",t.onData),this.eeToState.set(e,t)}onClose(e){const t=this.eeToState.get(e);t&&t.destroy()}onTimeout(e,t){const n=this.eeToState.get(e);n&&n.buffer.skip(n.buffer.length)}onData(e,t){const n=this.eeToState.get(e);if(!n)return;const r=n.buffer;this.isValidChunk(r,t)?(r.push(t),this.hasCompleteFrame(r)?this.handleCompleteFrame(e,r):this.isBufferOverflow(r)&&this.handleBufferOverflow(e,r)):e.emit(\"error\",new InvalidFrameError(`Invalid data chunk. Expected the first byte to be [:], but got: ${inspect(t)}`))}isValidChunk(e,t){return e.length>0||t[0]===ASCII_FRAME_START}hasCompleteFrame(e){return e.readByte(e.length-2)===ASCII_FRAME_CR&&e.readByte(e.length-1)===ASCII_FRAME_LF}handleCompleteFrame(e,t){let n=null;try{n=this.decode(t.shiftBuffer(t.length))}catch(t){e.emit(\"error\",t)}null!==n&&e.emit(\"adu\",n)}isBufferOverflow(e){return e.length>this.maxBufferLength}handleBufferOverflow(e,t){e.emit(\"bufferOverflow\",t.shiftBuffer(t.length))}}function encodeNibble(e){return e+(e<10?48:55)}function decodeNibble(e){return e-(e<65?48:55)}function decodeByte(e,t){return(decodeNibble(e)<<4)+(decodeNibble(t)<<0)}function decodeBytes(e){const t=e.length/2,n=new Array(t);for(let r=0,o=0;r<t;++r)n[r]=decodeByte(e[o++],e[o++]);return n}function high(e){return(240&e)>>>4&255}function low(e){return(15&e)>>>0&255}function lrc(e,t){let n=255&e;for(let e=0;e<t.length;++e)n=n+t[e]&255;return 1+(255^n)&255}module.exports=AsciiTransport;","node_modules/h5.modbus/lib/transports/RtuTransport.js":"\"use strict\";const inspect=require(\"util\").inspect,buffers=require(\"h5.buffers\"),InvalidFrameError=require(\"../InvalidFrameError\"),ApplicationDataUnit=require(\"../ApplicationDataUnit\"),Transport=require(\"../Transport\"),RTU_FRAME_MIN_LENGTH=5,CRC_TABLE=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];class RtuTransport extends Transport{constructor(e){super(),e||(e={}),this.handleEndOfFrame=this.handleEndOfFrame.bind(this),this.eofTimeout=e.eofTimeout>0?e.eofTimeout:0,this.eeToState=new Map}destroy(){this.eeToState.forEach(e=>e.destroy()),this.eeToState=null}encode(e,t,r){const n=new Buffer(1+r.length+2),o=crc16(t,r);return n[0]=t,r.copy(n,1),n.writeUInt16LE(o,1+r.length,!0),n}decode(e){if(e.length<RTU_FRAME_MIN_LENGTH)throw new InvalidFrameError(`MODBUS RTU frames must have at least ${RTU_FRAME_MIN_LENGTH} bytes, `+`but got [${e.length}]: ${inspect(e)}`);const t=e[0],r=e.slice(1,e.length-2),n=e.readUInt16LE(e.length-2,!0),o=crc16(t,r);if(o!==n)throw new InvalidFrameError(`Checksum mismatch. Expected [${n}], but got [${o}].`);return new ApplicationDataUnit(null,t,r,n)}update(e,t){return!0}add(e){if(this.eeToState.has(e))return;const t={buffer:new buffers.BufferQueueReader,eofTimer:null,onClose:this.onClose.bind(this,e),onData:this.onData.bind(this,e),destroy:()=>{t.buffer.skip(t.buffer.length),t.buffer=null,t.eofTimer&&(clearTimeout(t.eofTimer),t.eofTimer=null),e.removeListener(\"close\",t.onClose),e.removeListener(\"data\",t.onData),t.onClose=null,t.onData=null,this.eeToState.delete(e)}};e.on(\"close\",t.onClose),e.on(\"data\",t.onData),this.eeToState.set(e,t)}onClose(e){const t=this.eeToState.get(e);t&&t.destroy()}onData(e,t){const r=this.eeToState.get(e);r&&(r.buffer.push(t),this.eofTimeout<=0?this.handleEndOfFrame(e):(clearTimeout(r.eofTimer),r.eofTimer=setTimeout(this.handleEndOfFrame,this.eofTimeout,e)))}handleEndOfFrame(e){const t=this.eeToState.get(e);if(!t)return;t.eofTimer=null;let r=null;try{r=this.decode(t.buffer.shiftBuffer(t.buffer.length))}catch(t){e.emit(\"error\",t)}null!==r&&e.emit(\"adu\",r)}}function crc16(e,t){let r,n=65535;-1!==e&&(r=255&(n^e),n>>=8,n^=CRC_TABLE[r]);for(let e=0,o=t.length;e<o;++e)r=255&(n^t[e]),n>>=8,n^=CRC_TABLE[r];return n}module.exports=RtuTransport;","node_modules/h5.modbus/lib/Connection.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter;class Connection extends EventEmitter{constructor(){super()}destroy(){throw new Error(\"@abstract\")}isOpen(){throw new Error(\"@abstract\")}write(t){throw new Error(\"@abstract\")}}module.exports=Connection;","node_modules/h5.modbus/lib/connections/TcpConnection.js":"\"use strict\";const Socket=require(\"net\").Socket,Connection=require(\"../Connection\");class TcpConnection extends Connection{constructor(t){super(),this.onSocketConnect=this.onSocketConnect.bind(this),this.onSocketClose=this.onSocketClose.bind(this),this.onSocketError=this.onSocketError.bind(this),this.onSocketReadable=this.onSocketReadable.bind(this),t||(t={}),this.socketOptions=Object.assign({port:502,host:\"localhost\"},t.socketOptions),this.socket=this.setUpSocket(t.socket),this.autoReconnect=!1!==t.autoReconnect,this.minConnectTime=t.minConnectTime||2500,this.maxReconnectTime=t.maxReconnectTime||5e3,this.noActivityTime=t.noActivityTime||0,this.closeOnDestroy=!1!==t.closeOnDestroy,this.suppressErrorsAfterDestroy=!1!==t.suppressErrorsAfterDestroy,this.connected=\"open\"===this.socket.readyState,this.connecting=\"opening\"===this.socket.readyState,this.shouldReconnect=this.autoReconnect,this.connectionAttempts=0,this.lastDataEventTime=0,this.reconnectTimer=null,this.minConnectTimeTimer=null,this.noActivityTimer=null,this.isOpen()?this.onSocketConnect(!0):this.isOpening()?this.connectionAttempts+=1:!1!==t.autoOpen&&this.open()}destroy(){this.removeAllListeners(),this.destroySocket(),null!==this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),null!==this.minConnectTimeTimer&&(clearTimeout(this.minConnectTimeTimer),this.minConnectTimeTimer=null),null!==this.noActivityTimer&&(clearInterval(this.noActivityTimer),this.noActivityTimer=null)}isOpen(){return this.connected}isOpening(){return this.connecting}open(){this.isOpen()||this.isOpening()||(clearTimeout(this.reconnectTimer),this.reconnectTimer=null,this.connecting=!0,this.shouldReconnect=this.autoReconnect,this.connectionAttempts+=1,null===this.socket&&(this.socket=this.setUpSocket(null)),this.socket.connect(this.socketOptions))}close(){this.doClose(!1)}write(t){if(this.emit(\"write\",t),this.isOpen())try{this.socket.write(t)}catch(t){this.emit(\"error\",t)}}setUpSocket(t){return t||(t=new Socket),t.on(\"connect\",this.onSocketConnect),t.on(\"close\",this.onSocketClose),t.on(\"error\",this.onSocketError),t.on(\"readable\",this.onSocketReadable),t.setNoDelay(!1!==this.socketOptions.noDelay),t}destroySocket(){const t=this.socket;null!==t&&(this.socket=null,t.removeListener(\"connect\",this.onSocketConnect),t.removeListener(\"close\",this.onSocketClose),t.removeListener(\"error\",this.onSocketError),t.removeListener(\"readable\",this.onSocketReadable),this.suppressErrorsAfterDestroy&&t.on(\"error\",()=>{}),this.closeOnDestroy&&t.destroy())}onSocketConnect(t){this.connecting=!1,this.connected=!0,clearTimeout(this.minConnectTimeTimer),this.minConnectTimeTimer=setTimeout(this.onAfterMinConnectTime.bind(this),this.minConnectTime),t||this.emit(\"open\"),this.socket.read(0)}onSocketClose(){null!==this.minConnectTimeTimer&&(clearTimeout(this.minConnectTimeTimer),this.minConnectTimeTimer=null),null!==this.noActivityTimer&&(clearInterval(this.noActivityTimer),this.noActivityTimer=null),this.connecting=!1,this.connected=!1,this.reconnect(),this.emit(\"close\")}onSocketError(t){this.emit(\"error\",t)}onSocketReadable(){const t=this.socket.read();null!==t&&(this.lastDataEventTime=Date.now(),this.emit(\"data\",t))}onAfterMinConnectTime(){this.connectionAttempts=0,this.minConnectTimeTimer=null,this.setUpNoActivityTimer()}setUpNoActivityTimer(){this.noActivityTime>0&&null===this.noActivityTimer&&(this.noActivityTimer=setInterval(this.checkActivity.bind(this),this.noActivityTime))}checkActivity(){Date.now()-this.lastDataEventTime>this.noActivityTime&&(this.connected=!1,this.doClose(!0))}reconnect(){if(!this.shouldReconnect)return;let t=250*this.connectionAttempts;t>this.maxReconnectTime&&(t=this.maxReconnectTime),this.reconnectTimer=setTimeout(this.open.bind(this),t)}doClose(t){this.shouldReconnect=t,null!==this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),null!==this.socket&&this.socket.destroy()}}module.exports=TcpConnection;","node_modules/h5.modbus/lib/connections/UdpConnection.js":"\"use strict\";const net=require(\"net\"),dns=require(\"dns\"),dgram=require(\"dgram\"),Connection=require(\"../Connection\"),BindState={Binding:1,Bound:2},DnsState={Unresolved:0,Resolving:1,Resolved:2};class UdpConnection extends Connection{constructor(t){super(),this.onSocketListening=this.onSocketListening.bind(this),this.onSocketClose=this.onSocketClose.bind(this),this.onSocketError=this.onSocketError.bind(this),this.onSocketMessage=this.onSocketMessage.bind(this),t||(t={}),this.socketOptions=Object.assign({port:502,host:\"localhost\"},t.socketOptions),this.socket=this.setUpSocket(t.socket),this.closeOnDestroy=!1!==t.closeOnDestroy,this.suppressErrorsAfterDestroy=!1!==t.suppressErrorsAfterDestroy,this.dnsState=this.getInitialDnsState(),this.resolveDns(),!1!==t.autoOpen&&this.open()}destroy(){this.removeAllListeners(),this.destroySocket()}isOpen(){return null!==this.socket&&this.socket._bindState===BindState.Bound}isOpening(){return null!==this.socket&&this.socket._bindState===BindState.Binding}open(){if(this.dnsState!==DnsState.Resolved)return this.once(\"lookup\",this.open.bind(this)),void this.resolveDns();this.isOpen()||this.isOpening()||(null===this.socket&&(this.socket=this.setUpSocket(null)),this.socket.bind({port:this.socketOptions.localPort,address:this.socketOptions.localAddress,exclusive:!0===this.socketOptions.exclusive}))}close(){null!==this.socket&&this.socket.close()}write(t){if(this.emit(\"write\",t),this.isOpen())try{this.socket.send(t,0,t.length,this.socketOptions.port,this.socketOptions.host)}catch(t){this.emit(\"error\",t)}}setUpSocket(t){return t||(t=dgram.createSocket({type:6===this.socketOptions.family?\"udp6\":\"udp4\",reuseAddr:!0===this.socketOptions.reuseAddress})),t.on(\"listening\",this.onSocketListening),t.on(\"close\",this.onSocketClose),t.on(\"error\",this.onSocketError),t.on(\"message\",this.onSocketMessage),t}destroySocket(){const t=this.socket;null!==t&&(this.socket=null,t.removeListener(\"open\",this.onSocketListening),t.removeListener(\"close\",this.onSocketClose),t.removeListener(\"error\",this.onSocketError),t.removeListener(\"message\",this.onSocketMessage),this.suppressErrorsAfterDestroy&&t.on(\"error\",()=>{}),this.closeOnDestroy&&t.close())}getInitialDnsState(){return this.socketOptions.host?6===this.socketOptions.family&&net.isIPv6(this.socketOptions.host)?(this.socketOptions.host=expandIpv6(this.socketOptions.host),DnsState.Resolved):4===this.socketOptions.family&&net.isIPv4(this.socketOptions.host)?DnsState.Resolved:DnsState.Unresolved:(this.socketOptions.host=\"localhost\",DnsState.Unresolved)}resolveDns(){this.dnsState===DnsState.Unresolved&&(this.dnsState=DnsState.Resolving,dns.lookup(this.socketOptions.host,this.socketOptions.family,(t,s)=>{this.dnsState=DnsState.Resolved,t?this.emit(\"error\",t):this.socketOptions.host=6===this.socketOptions.family?expandIpv6(s):s,this.emit(\"lookup\",t,s,this.socketOptions.family)}))}onSocketListening(){this.emit(\"open\")}onSocketClose(){this.emit(\"close\")}onSocketError(t){this.emit(\"error\",t)}onSocketMessage(t,s){s.address===this.socketOptions.host&&s.port===this.socketOptions.port&&this.emit(\"data\",t)}}function expandIpv6(t){if(39===t.length)return t;const s=t.split(\"::\");let e=s[0].split(\":\"),o=1===s.length?[]:s[1].split(\":\");1===e.length&&\"\"===e[0]&&(e=[]),1===o.length&&\"\"===o[0]&&(o=[]);const i=8-(e.length+o.length),n=[];let r,h;for(r=0,h=e.length;r<h;++r)n.push(padIpv6(e[r]));for(r=0;r<i;++r)n.push(\"0000\");for(r=0,h=o.length;r<h;++r)n.push(padIpv6(o[r]));return n.join(\":\").toLowerCase()}function padIpv6(t){for(;t.length<4;)t=`0${t}`;return t}module.exports=UdpConnection;","node_modules/h5.modbus/lib/connections/SerialConnection.js":"\"use strict\";const Connection=require(\"../Connection\");let SerialPort=null;class SerialConnection extends Connection{constructor(e){super(),this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onError=this.onError.bind(this),this.onReadable=this.onReadable.bind(this),this.serialPortOptions=Object.assign({path:\"win32\"===process.platform?\"COM1\":\"/dev/ttys0\"},e.serialPortOptions,{autoOpen:!1}),this.serialPort=this.setUpSerialPort(e.serialPort),this.closeOnDestroy=!1!==e.closeOnDestroy,this.suppressErrorsAfterDestroy=!1!==e.suppressErrorsAfterDestroy,!1!==e.autoOpen&&this.open()}destroy(){this.removeAllListeners(),this.destroySerialPort()}isOpen(){return null!==this.serialPort&&this.serialPort.isOpen}isOpening(){return null!==this.serialPort&&this.serialPort.opening}open(){this.isOpen()||this.isOpening()||(null===this.serialPort&&(this.serialPort=this.setUpSocket(null)),this.serialPort.open())}close(){null!==this.serialPort&&this.serialPort.close()}write(e){if(this.emit(\"write\",e),null!==this.serialPort)try{this.serialPort.write(e)}catch(e){this.emit(\"error\",e)}}setUpSerialPort(e){return e||(null===SerialPort&&(SerialPort=require(\"serialport\")),e=new SerialPort(this.serialPortOptions.path,this.serialPortOptions)),e.on(\"open\",this.onOpen),e.on(\"close\",this.onClose),e.on(\"error\",this.onError),e.on(\"readable\",this.onReadable),e}destroySerialPort(){const e=this.serialPort;null!==e&&(e.removeListener(\"open\",this.onOpen),e.removeListener(\"close\",this.onClose),e.removeListener(\"error\",this.onError),e.removeListener(\"readable\",this.onReadable),this.suppressErrorsAfterDestroy&&e.on(\"error\",()=>{}),this.closeOnDestroy&&e.close(),this.serialPort=null)}onOpen(){this.emit(\"open\")}onClose(){this.emit(\"close\")}onError(e){this.emit(\"error\",e)}onReadable(){if(!this.serialPort)return;const e=this.serialPort.read();e&&this.emit(\"data\",e)}}module.exports=SerialConnection;","node_modules/h5.modbus/lib/connections/WebSocketConnection.js":"\"use strict\";const Connection=require(\"../Connection\");let WebSocket=null;const ReadyState={Connecting:0,Open:1,Closing:2,Closed:3};class WebSocketConnection extends Connection{constructor(t){super(),this.onSocketOpen=this.onSocketOpen.bind(this),this.onSocketClose=this.onSocketClose.bind(this),this.onSocketError=this.onSocketError.bind(this),this.onSocketMessage=this.onSocketMessage.bind(this),this.onOpeningError=this.onOpeningError.bind(this),t||(t={}),this.socketOptions=Object.assign({url:\"ws://localhost:502/\"},t.socketOptions),this.socketFactory=null,this.socket=this.setUpSocket(t.socket),this.autoReconnect=!1!==t.autoReconnect,this.minConnectTime=t.minConnectTime||2500,this.maxReconnectTime=t.maxReconnectTime||5e3,this.noActivityTime=t.noActivityTime||0,this.closeOnDestroy=!1!==t.closeOnDestroy,this.suppressErrorsAfterDestroy=!1!==t.suppressErrorsAfterDestroy,this.connected=this.socket.readyState===ReadyState.Open,this.connecting=this.socket.readyState===ReadyState.Connecting,this.shouldReconnect=this.autoReconnect,this.connectionAttempts=0,this.lastDataEventTime=0,this.reconnectTimer=null,this.minConnectTimeTimer=null,this.noActivityTimer=null,this.sendOptions={binary:!0,mask:!!t.mask,compress:!!t.compress},this.isOpen()?this.onSocketOpen(!0):this.isOpening()?(this.connectionAttempts+=1,this.on(\"error\",this.onOpeningError)):!1!==t.autoOpen&&this.open()}destroy(){this.removeAllListeners(),this.destroySocket(this.suppressErrorsAfterDestroy,this.closeOnDestroy),null!==this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),null!==this.minConnectTimeTimer&&(clearTimeout(this.minConnectTimeTimer),this.minConnectTimeTimer=null),null!==this.noActivityTimer&&(clearInterval(this.noActivityTimer),this.noActivityTimer=null)}isOpen(){return this.connected}isOpening(){return this.connecting}open(){this.isOpen()||this.isOpening()||(clearTimeout(this.reconnectTimer),this.reconnectTimer=null,this.on(\"error\",this.onOpeningError),this.connecting=!0,this.shouldReconnect=this.autoReconnect,this.connectionAttempts+=1,this.socket=this.setUpSocket(this.socketFactory?this.socketFactory():null))}close(){this.doClose(!1)}write(t){if(this.emit(\"write\",t),this.isOpen())try{this.socket.send(t,this.sendOptions)}catch(t){this.emit(\"error\",t)}}setUpSocket(t){if(t)\"function\"==typeof t&&(this.socketFactory=t,t=t());else{WebSocket||(WebSocket=require(\"ws\"));const e=Object.assign({},this.socketOptions);\"function\"==typeof e.agent&&(e.agent=e.agent()),t=new WebSocket(e.url,null,e)}return t.on(\"open\",this.onSocketOpen),t.on(\"close\",this.onSocketClose),t.on(\"error\",this.onSocketError),t.on(\"message\",this.onSocketMessage),t}destroySocket(t,e){const i=this.socket;null!==i&&(this.socket=null,i.removeListener(\"open\",this.onSocketOpen),i.removeListener(\"close\",this.onSocketClose),i.removeListener(\"error\",this.onSocketError),i.removeListener(\"message\",this.onSocketMessage),t&&i.on(\"error\",()=>{}),e&&i.terminate())}onSocketOpen(t){this.removeListener(\"error\",this.onOpeningError),this.connecting=!1,this.connected=!0,clearTimeout(this.minConnectTimeTimer),this.minConnectTimeTimer=setTimeout(this.onAfterMinConnectTime.bind(this),this.minConnectTime),t||this.emit(\"open\")}onSocketClose(){null!==this.minConnectTimeTimer&&(clearTimeout(this.minConnectTimeTimer),this.minConnectTimeTimer=null),null!==this.noActivityTimer&&(clearInterval(this.noActivityTimer),this.noActivityTimer=null),this.connecting=!1,this.connected=!1,this.destroySocket(!1,!1),this.reconnect(),this.emit(\"close\")}onSocketError(t){this.emit(\"error\",t)}onOpeningError(){this.removeListener(\"error\",this.onOpeningError),this.onSocketClose()}onSocketMessage(t,e){e.binary&&(this.lastDataEventTime=Date.now(),this.emit(\"data\",t))}onAfterMinConnectTime(){this.connectionAttempts=0,this.minConnectTimeTimer=null,this.setUpNoActivityTimer()}setUpNoActivityTimer(){this.noActivityTime>0&&null===this.noActivityTimer&&(this.noActivityTimer=setInterval(this.checkActivity.bind(this),this.noActivityTime))}checkActivity(){Date.now()-this.lastDataEventTime>this.noActivityTime&&(this.connected=!1,this.doClose(!0))}reconnect(){if(!this.shouldReconnect)return;let t=250*this.connectionAttempts;t>this.maxReconnectTime&&(t=this.maxReconnectTime),this.reconnectTimer=setTimeout(this.open.bind(this),t)}doClose(t){this.removeListener(\"error\",this.onOpeningError),this.shouldReconnect=t,null!==this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),null!==this.socket&&this.socket.terminate()}}module.exports=WebSocketConnection;","node_modules/h5.modbus/lib/Listener.js":"\"use strict\";const EventEmitter=require(\"events\").EventEmitter;class Listener extends EventEmitter{constructor(){super()}destroy(){throw new Error(\"@abstract\")}isOpen(){throw new Error(\"@abstract\")}}module.exports=Listener;","node_modules/h5.modbus/lib/listeners/TcpListener.js":"\"use strict\";const Server=require(\"net\").Server,Listener=require(\"../Listener\"),RemoteClient=require(\"../RemoteClient\");require(\"./monkeyPatch\");class TcpListener extends Listener{constructor(e){super(),this.onServerListening=this.onServerListening.bind(this),this.onServerClose=this.onServerClose.bind(this),this.onServerError=this.onServerError.bind(this),this.onServerConnection=this.onServerConnection.bind(this),e||(e={}),this.serverOptions=Object.assign({port:502},e.serverOptions),this.server=this.setUpServer(e.server),this.closeOnDestroy=!1!==e.closeOnDestroy,this.suppressErrorsAfterDestroy=!1!==e.suppressErrorsAfterDestroy,this.socketListeners=new Map,this.clients=new Map,!1!==e.autoOpen&&this.open()}destroy(){this.removeAllListeners(),this.destroyClients(),this.destroyServer()}isOpen(){return null!==this.server&&(\"boolean\"==typeof this.server.listening?this.server.listening:void 0===this.server._handle||!!this.server._handle)}isOpening(){return null!==this.server&&!!this.server.binding}open(){this.isOpen()||this.isOpening()||(null===this.server&&(this.server=this.setUpServer(null)),this.server.listen(this.serverOptions))}close(){null!==this.server&&(this.destroyClients(),this.server.close())}setUpServer(e){return e||(e=new Server(this.serverOptions)),e.on(\"listening\",this.onServerListening),e.on(\"close\",this.onServerClose),e.on(\"error\",this.onServerError),e.on(\"connection\",this.onServerConnection),e}destroyServer(){const e=this.server;null!==e&&(this.server=null,e.removeListener(\"listening\",this.onServerListening),e.removeListener(\"close\",this.onServerClose),e.removeListener(\"error\",this.onServerError),e.removeListener(\"connection\",this.onServerConnection),this.suppressErrorsAfterDestroy&&e.on(\"error\",()=>{}),this.closeOnDestroy&&e.close())}onServerListening(){this.emit(\"open\")}onServerClose(){this.destroyClients(),this.emit(\"close\")}onServerError(e){this.emit(\"error\",e)}onServerConnection(e){this.setUpClient(e)}setUpClient(e){const r=new RemoteClient({address:e.remoteAddress,port:e.remotePort,family:e.remoteFamily});r.on(\"close\",this.onClientClose.bind(this,e)),r.on(\"write\",this.onClientWrite.bind(this,e));const s={close:r.destroy.bind(r),error:r.emit.bind(r,\"error\"),readable:function(){const s=e.read();null!==s&&r.emit(\"data\",s)}};e.on(\"close\",s.close),e.on(\"error\",s.error),e.on(\"readable\",s.readable),e.setNoDelay(!1!==this.serverOptions.noDelay),this.socketListeners.set(e,s),this.clients.set(e,r),this.emit(\"client\",r)}destroyClients(){this.clients.forEach(e=>e.destroy())}onClientWrite(e,r){const s=this.clients.get(e);if(s)try{e.write(r)}catch(e){s.emit(\"error\",e)}}onClientClose(e){if(!this.clients.get(e))return;const r=this.socketListeners.get(e);e.removeListener(\"close\",r.close),e.removeListener(\"error\",r.error),e.removeListener(\"readable\",r.readable),this.suppressErrorsAfterDestroy&&e.on(\"error\",()=>{}),e.destroy(),this.socketListeners.delete(e),this.clients.delete(e)}}module.exports=TcpListener;","node_modules/h5.modbus/lib/listeners/UdpListener.js":"\"use strict\";const dgram=require(\"dgram\"),Listener=require(\"../Listener\"),RemoteClient=require(\"../RemoteClient\"),BIND_STATE_BINDING=1,BIND_STATE_BOUND=2;class UdpListener extends Listener{constructor(e){super(),this.onSocketListening=this.onSocketListening.bind(this),this.onSocketClose=this.onSocketClose.bind(this),this.onSocketError=this.onSocketError.bind(this),this.onSocketMessage=this.onSocketMessage.bind(this),e||(e={}),this.socketOptions=Object.assign({port:502},e.socketOptions),this.socket=this.setUpSocket(e.socket),this.clientTimeout=e.clientTimeout>0?e.clientTimeout:3e4,this.closeOnDestroy=!1!==e.closeOnDestroy,this.suppressErrorsAfterDestroy=!1!==e.suppressErrorsAfterDestroy,this.clients=new Map,!1!==e.autoOpen&&this.open()}destroy(){this.removeAllListeners(),this.destroyClients(),this.destroySocket()}isOpen(){return null!==this.socket&&this.socket._bindState===BIND_STATE_BOUND}isOpening(){return null!==this.socket&&this.socket._bindState===BIND_STATE_BINDING}open(){this.isOpen()||this.isOpening()||(null===this.socket&&(this.socket=this.setUpSocket(null)),this.socket.bind({port:this.socketOptions.port,address:this.socketOptions.host,exclusive:!0===this.socketOptions.exclusive}))}close(){null!==this.socket&&(this.destroyClients(),this.socket.close())}setUpSocket(e){return e||(e=dgram.createSocket({type:6===this.socketOptions.family?\"udp6\":\"udp4\",reuseAddr:!0===this.socketOptions.reuseAddress})),e.on(\"listening\",this.onSocketListening),e.on(\"close\",this.onSocketClose),e.on(\"error\",this.onSocketError),e.on(\"message\",this.onSocketMessage),e}destroySocket(){const e=this.socket;null!==e&&(this.socket=null,e.removeListener(\"listening\",this.onSocketListening),e.removeListener(\"close\",this.onSocketClose),e.removeListener(\"error\",this.onSocketError),e.removeListener(\"message\",this.onSocketMessage),this.suppressErrorsAfterDestroy&&e.on(\"error\",()=>{}),this.closeOnDestroy&&e.close())}onSocketListening(){this.emit(\"open\")}onSocketClose(){this.destroyClients(),this.emit(\"close\")}onSocketError(e){this.emit(\"error\",e)}onSocketMessage(e,t){const s=this.setUpClient(t);s.rescheduleTimeout(),s.emit(\"data\",e)}getRemoteClientKey(e){return`${e.address}@${e.port}`}setUpClient(e){const t=this.getRemoteClientKey(e),s=this.clients.get(t);if(s)return s;const i={address:e.address,port:e.port,family:e.family},o=new UdpRemoteClient(i,this.clientTimeout);return this.clients.set(t,o),this.emit(\"client\",o),o}destroyClients(){this.clients.forEach(e=>e.destroy())}onClientWrite(e,t){const s=this.clients.get(e);if(s)try{this.socket.send(t,0,t.length,s.remoteInfo.port,s.remoteInfo.address)}catch(e){s.emit(\"error\",e)}}onClientDestroy(e){this.clients.delete(e)}}class UdpRemoteClient extends RemoteClient{constructor(e,t){super(e),this.timeout=t,this.timeoutTimer=null}destroy(){this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null),super.destroy()}rescheduleTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=setTimeout(this.destroy.bind(this),this.timeout)}}module.exports=UdpListener;","node_modules/h5.modbus/lib/listeners/SerialListener.js":"\"use strict\";const Listener=require(\"../Listener\"),RemoteClient=require(\"../RemoteClient\");let SerialPort=null;class SerialListener extends Listener{constructor(e){super(),this.onSerialOpen=this.onSerialOpen.bind(this),this.onSerialClose=this.onSerialClose.bind(this),this.onSerialError=this.onSerialError.bind(this),this.onSerialReadable=this.onSerialReadable.bind(this),e||(e={}),this.serialPortOptions=Object.assign({path:\"win32\"===process.platform?\"COM1\":\"/dev/ttys0\"},e.serialPortOptions,{autoOpen:!1}),this.serialPort=this.setUpSerialPort(e.serialPort),this.closeOnDestroy=!1!==e.closeOnDestroy,this.suppressErrorsAfterDestroy=!1!==e.suppressErrorsAfterDestroy,this.client=null,this.setUpClientTimer=null,this.isOpen()?this.setUpClientTimer=setImmediate(this.setUpClient.bind(this)):!1!==e.autoOpen&&this.open()}destroy(){null!==this.setUpClientTimer&&(clearImmediate(this.setUpClientTimer),this.setUpClientTimer=null),this.removeAllListeners(),this.destroyClient(),this.destroySerialPort()}isOpen(){return null!==this.serialPort&&this.serialPort.isOpen}isOpening(){return null!==this.serialPort&&this.serialPort.opening}open(){this.isOpen()||this.isOpening()||(null===this.serialPort&&(this.serialPort=this.setUpSerialPort(null)),this.serialPort.open())}close(){null!==this.serialPort&&(this.destroyClient(),this.serialPort.close())}setUpSerialPort(e){return e||(null===SerialPort&&(SerialPort=require(\"serialport\")),e=new SerialPort(this.serialPortOptions.path,this.serialPortOptions)),e.on(\"open\",this.onSerialOpen),e.on(\"close\",this.onSerialClose),e.on(\"error\",this.onSerialError),e.on(\"readable\",this.onSerialReadable),e}destroySerialPort(){const e=this.serialPort;null!==e&&(e.removeListener(\"open\",this.onSerialOpen),e.removeListener(\"close\",this.onSerialClose),e.removeListener(\"error\",this.onSerialError),e.removeListener(\"readable\",this.onSerialReadable),this.suppressErrorsAfterDestroy&&e.on(\"error\",()=>{}),this.closeOnDestroy&&e.close(),this.serialPort=null)}onSerialOpen(){this.emit(\"open\"),this.setUpClient()}onSerialClose(){this.destroyClient(),this.emit(\"close\")}onSerialError(e){this.emit(\"error\",e)}onSerialReadable(){if(!this.client||!this.serialPort)return;const e=this.serialPort.read();e&&this.client.emit(\"data\",e)}setUpClient(){null!==this.setUpClientTimer&&(clearImmediate(this.setUpClientTimer),this.setUpClientTimer=null),this.destroyClient(),this.client=new RemoteClient({path:this.serialPort.path}),this.client.on(\"close\",this.onClientClose.bind(this)),this.client.on(\"write\",this.onClientWrite.bind(this)),this.emit(\"client\",this.client)}destroyClient(){null!==this.client&&this.client.destroy()}onClientWrite(e){if(null!==this.serialPort)try{this.serialPort.write(e)}catch(e){this.client.emit(\"error\",e)}}onClientClose(){this.client=null}}module.exports=SerialListener;","node_modules/h5.modbus/lib/listeners/WebSocketListener.js":"\"use strict\";const fs=require(\"fs\"),http=require(\"http\"),https=require(\"https\"),Listener=require(\"../Listener\"),RemoteClient=require(\"../RemoteClient\");require(\"./monkeyPatch\");let WebSocketServer=null;class WebSocketListener extends Listener{constructor(e){super(),this.onServerListening=this.onServerListening.bind(this),this.onServerClose=this.onServerClose.bind(this),this.onServerError=this.onServerError.bind(this),this.onServerConnection=this.onServerConnection.bind(this),e||(e={}),this.serverOptions=Object.assign({port:502},e.serverOptions),this.httpServer=null,this.wsServer=null,this.closeOnDestroy=!1!==e.closeOnDestroy,this.suppressErrorsAfterDestroy=!1!==e.suppressErrorsAfterDestroy,this.socketListeners=new Map,this.clients=new Map,this.setUpServers(e.server),!1!==e.autoOpen&&this.open()}destroy(){this.removeAllListeners(),this.destroyClients(),this.destroyServers()}isOpen(){return null!==this.httpServer&&(\"boolean\"==typeof this.httpServer.listening?this.httpServer.listening:void 0===this.httpServer._handle||!!this.httpServer._handle)}isOpening(){return null!==this.httpServer&&!!this.httpServer.binding}open(){this.isOpen()||this.isOpening()||(null===this.httpServer&&this.setUpServers(null),this.httpServer.listen(this.serverOptions))}close(){null!==this.wsServer&&(this.destroyClients(),this.wsServer.close())}setUpServers(e){let r=null;if(e)r=e._server;else{const t=this.serverOptions;r=t.server?t.server:this.createHttpServer(t),WebSocketServer||(WebSocketServer=require(\"ws\").Server),e=new WebSocketServer({server:r,path:t.path,verifyClient:t.verifyClient,handleProtocols:t.handleProtocols,perMessageDeflate:t.perMessageDeflate,maxPayload:t.maxPayload,disableHixie:!0,clientTracking:!1})}r.on(\"listening\",this.onServerListening),r.on(\"close\",this.onServerClose),e.on(\"error\",this.onServerError),e.on(\"connection\",this.onServerConnection),this.wsServer=e,this.httpServer=r}createHttpServer(e){if(!e.key||!e.cert||!e.pfx)return http.createServer();const r=/\\.(pem|crt|pfx)$/;return[\"key\",\"cert\",\"pfx\"].forEach(t=>{const s=e[t];\"string\"==typeof s&&r.test(s)&&(e[t]=fs.readFileSync(s))}),https.createServer(e)}destroyServers(){const e=this.wsServer;if(null===e)return;const r=this.httpServer;this.wsServer=null,this.httpServer=null,r.removeListener(\"listening\",this.onServerListening),r.removeListener(\"close\",this.onServerClose),e.removeListener(\"error\",this.onServerError),e.removeListener(\"connection\",this.onServerConnection),this.suppressErrorsAfterDestroy&&(e.on(\"error\",()=>{}),r.on(\"error\",()=>{})),this.closeOnDestroy&&(e.close(),r.close())}onServerListening(){this.emit(\"open\")}onServerClose(){this.destroyClients(),this.emit(\"close\")}onServerError(e){this.emit(\"error\",e)}onServerConnection(e){this.setUpClient(e)}setUpClient(e){const r=e.upgradeReq.socket,t=new WebSocketRemoteClient({address:r.remoteAddress,port:r.remotePort,family:r.remoteFamily});t.on(\"close\",this.onClientClose.bind(this,e)),t.on(\"write\",this.onClientWrite.bind(this,e));const s={close:t.destroy.bind(t),error:t.emit.bind(t,\"error\"),message:function(e,r){r.binary&&(t.masked=r.masked,t.emit(\"data\",e))}};e.on(\"close\",s.close),e.on(\"error\",s.error),e.on(\"message\",s.message),this.socketListeners.set(e,s),this.clients.set(e,t),this.emit(\"client\",t)}destroyClients(){this.clients.forEach(e=>e.destroy())}onClientWrite(e,r){const t=this.clients.get(e);if(t)try{e.send(r,{binary:!0,mask:t.masked})}catch(e){t.emit(\"error\",e)}}onClientClose(e){if(!this.clients.get(e))return;const r=this.socketListeners.get(e);e.removeListener(\"close\",r.close),e.removeListener(\"error\",r.error),e.removeListener(\"message\",r.message),this.suppressErrorsAfterDestroy&&e.on(\"error\",()=>{}),e.terminate(),this.socketListeners.delete(e),this.clients.delete(e)}}class WebSocketRemoteClient extends RemoteClient{constructor(e){super(e),this.masked=!0}}module.exports=WebSocketListener;","node_modules/h5.modbus/lib/messages/index.js":"\"use strict\";const FunctionCode=require(\"../FunctionCode\"),requests={},responses={};exports.requests=requests,exports.responses=responses,exports.ReadDiscreteInputsRequest=requests[FunctionCode.ReadDiscreteInputs]=require(\"./ReadDiscreteInputsRequest\"),exports.ReadDiscreteInputsResponse=responses[FunctionCode.ReadDiscreteInputs]=require(\"./ReadDiscreteInputsResponse\"),exports.ReadCoilsRequest=requests[FunctionCode.ReadCoils]=require(\"./ReadCoilsRequest\"),exports.ReadCoilsResponse=responses[FunctionCode.ReadCoils]=require(\"./ReadCoilsResponse\"),exports.WriteSingleCoilRequest=requests[FunctionCode.WriteSingleCoil]=require(\"./WriteSingleCoilRequest\"),exports.WriteSingleCoilResponse=responses[FunctionCode.WriteSingleCoil]=require(\"./WriteSingleCoilResponse\"),exports.WriteMultipleCoilsRequest=requests[FunctionCode.WriteMultipleCoils]=require(\"./WriteMultipleCoilsRequest\"),exports.WriteMultipleCoilsResponse=responses[FunctionCode.WriteMultipleCoils]=require(\"./WriteMultipleCoilsResponse\"),exports.ReadInputRegistersRequest=requests[FunctionCode.ReadInputRegisters]=require(\"./ReadInputRegistersRequest\"),exports.ReadInputRegistersResponse=responses[FunctionCode.ReadInputRegisters]=require(\"./ReadInputRegistersResponse\"),exports.ReadHoldingRegistersRequest=requests[FunctionCode.ReadHoldingRegisters]=require(\"./ReadHoldingRegistersRequest\"),exports.ReadHoldingRegistersResponse=responses[FunctionCode.ReadHoldingRegisters]=require(\"./ReadHoldingRegistersResponse\"),exports.WriteSingleRegisterRequest=requests[FunctionCode.WriteSingleRegister]=require(\"./WriteSingleRegisterRequest\"),exports.WriteSingleRegisterResponse=responses[FunctionCode.WriteSingleRegister]=require(\"./WriteSingleRegisterResponse\"),exports.WriteMultipleRegistersRequest=requests[FunctionCode.WriteMultipleRegisters]=require(\"./WriteMultipleRegistersRequest\"),exports.WriteMultipleRegistersResponse=responses[FunctionCode.WriteMultipleRegisters]=require(\"./WriteMultipleRegistersResponse\"),exports.ExceptionResponse=responses[FunctionCode.Exception]=require(\"./ExceptionResponse\");","node_modules/h5.modbus/lib/Message.js":"\"use strict\";class Message{constructor(r){this.functionCode=r}static fromOptions(r){throw new Error(\"@abstract\")}static fromBuffer(r){throw new Error(\"@abstract\")}toBuffer(){throw new Error(\"@abstract\")}toString(){throw new Error(\"@abstract\")}}module.exports=Message;","node_modules/h5.modbus/lib/Request.js":"\"use strict\";const Message=require(\"./Message\");class Request extends Message{constructor(e){super(e)}}module.exports=Request;","node_modules/h5.modbus/lib/Response.js":"\"use strict\";const Message=require(\"./Message\");class Response extends Message{constructor(e){super(e)}isException(){return!1}}module.exports=Response;","node_modules/h5.modbus/lib/messages/ReadDiscreteInputsRequest.js":"\"use strict\";const helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Request=require(\"../Request\");class ReadDiscreteInputsRequest extends Request{constructor(e,t){super(FunctionCode.ReadDiscreteInputs),this.quantity=helpers.prepareQuantity(t,2e3),this.startingAddress=helpers.prepareAddress(e,this.quantity)}static fromOptions(e){return new ReadDiscreteInputsRequest(e.startingAddress,e.quantity)}static fromBuffer(e){return helpers.assertBufferLength(e,5),helpers.assertFunctionCode(e[0],FunctionCode.ReadDiscreteInputs),new ReadDiscreteInputsRequest(e.readUInt16BE(1,!0),e.readUInt16BE(3,!0))}get endingAddress(){return this.startingAddress+this.quantity}toBuffer(){const e=new Buffer(5);return e[0]=this.functionCode,e.writeUInt16BE(this.startingAddress,1,!0),e.writeUInt16BE(this.quantity,3,!0),e}toString(){return helpers.formatRequest(this,`Read ${this.quantity} inputs starting from address ${this.startingAddress}`)}}module.exports=ReadDiscreteInputsRequest;","node_modules/h5.modbus/lib/messages/ReadDiscreteInputsResponse.js":"\"use strict\";const buffers=require(\"h5.buffers\"),helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Response=require(\"../Response\");class ReadDiscreteInputsResponse extends Response{constructor(e){if(super(FunctionCode.ReadDiscreteInputs),0===e.length||e.length>2e3)throw new Error(`Invalid states array. Expected length between 1 and 2000, got [${e.length}].`);this.states=e}static fromOptions(e){return new ReadDiscreteInputsResponse(e.states)}static fromBuffer(e){helpers.assertFunctionCode(e[0],FunctionCode.ReadDiscreteInputs);const t=helpers.toBitArray(e,2,8*e[1]);return new ReadDiscreteInputsResponse(t)}get quantity(){return this.states.length}toBuffer(){return(new buffers.BufferBuilder).pushByte(this.functionCode).pushByte(Math.ceil(this.states.length/8)).pushBits(this.states).toBuffer()}toString(){return helpers.formatResponse(this,`${this.quantity} inputs: ${this.states.map(Number).join(\", \")}`)}isOn(e){if(e<0||e>=this.quantity)throw new RangeError(`Offset out of bounds: ${e}`);return!!this.states[e]}isOff(e){if(e<0||e>=this.quantity)throw new RangeError(`Offset out of bounds: ${e}`);return!this.states[e]}}module.exports=ReadDiscreteInputsResponse;","node_modules/h5.modbus/lib/messages/ReadCoilsRequest.js":"\"use strict\";const helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Request=require(\"../Request\");class ReadCoilsRequest extends Request{constructor(e,t){super(FunctionCode.ReadCoils),this.quantity=helpers.prepareQuantity(t,2e3),this.startingAddress=helpers.prepareAddress(e,this.quantity)}static fromOptions(e){return new ReadCoilsRequest(e.startingAddress,e.quantity)}static fromBuffer(e){return helpers.assertBufferLength(e,5),helpers.assertFunctionCode(e[0],FunctionCode.ReadCoils),new ReadCoilsRequest(e.readUInt16BE(1,!0),e.readUInt16BE(3,!0))}get endingAddress(){return this.startingAddress+this.quantity}toBuffer(){const e=new Buffer(5);return e[0]=this.functionCode,e.writeUInt16BE(this.startingAddress,1,!0),e.writeUInt16BE(this.quantity,3,!0),e}toString(){return helpers.formatRequest(this,`Read ${this.quantity} coils starting from address ${this.startingAddress}`)}}module.exports=ReadCoilsRequest;","node_modules/h5.modbus/lib/messages/ReadCoilsResponse.js":"\"use strict\";const buffers=require(\"h5.buffers\"),helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Response=require(\"../Response\");class ReadCoilsResponse extends Response{constructor(e){if(super(FunctionCode.ReadCoils),0===e.length||e.length>2e3)throw new Error(`Invalid states array. Expected length between 1 and 2000, got [${e.length}].`);this.states=e}static fromOptions(e){return new ReadCoilsResponse(e.states)}static fromBuffer(e){helpers.assertFunctionCode(e[0],FunctionCode.ReadCoils);const t=helpers.toBitArray(e,2,8*e[1]);return new ReadCoilsResponse(t)}get quantity(){return this.states.length}toBuffer(){return(new buffers.BufferBuilder).pushByte(this.functionCode).pushByte(Math.ceil(this.states.length/8)).pushBits(this.states).toBuffer()}toString(){return helpers.formatResponse(this,`${this.quantity} coils: ${this.states.map(Number).join(\", \")}`)}isOn(e){if(e<0||e>=this.states.length)throw new RangeError(`Offset out of bounds: ${e}`);return!!this.states[e]}isOff(e){if(e<0||e>=this.states.length)throw new RangeError(`Offset out of bounds: ${e}`);return!this.states[e]}}module.exports=ReadCoilsResponse;","node_modules/h5.modbus/lib/messages/WriteSingleCoilRequest.js":"\"use strict\";const helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Request=require(\"../Request\");class WriteSingleCoilRequest extends Request{constructor(e,t){super(FunctionCode.WriteSingleCoil),this.address=helpers.prepareAddress(e,1),this.state=!!t}static fromOptions(e){return new WriteSingleCoilRequest(e.address,e.state)}static fromBuffer(e){return helpers.assertBufferLength(e,5),helpers.assertFunctionCode(e[0],FunctionCode.WriteSingleCoil),new WriteSingleCoilRequest(e.readUInt16BE(1,!0),65280===e.readUInt16BE(3,!0))}toBuffer(){const e=new Buffer(5);return e[0]=this.functionCode,e.writeUInt16BE(this.address,1,!0),e.writeUInt16BE(this.state?65280:0,3,!0),e}toString(){return helpers.formatRequest(this,`Set coil at address ${this.address} to ${this.state?\"ON\":\"OFF\"}.`)}}module.exports=WriteSingleCoilRequest;","node_modules/h5.modbus/lib/messages/WriteSingleCoilResponse.js":"\"use strict\";const helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Response=require(\"../Response\");class WriteSingleCoilResponse extends Response{constructor(e,s){super(FunctionCode.WriteSingleCoil),this.address=helpers.prepareAddress(e,1),this.state=!!s}static fromOptions(e){return new WriteSingleCoilResponse(e.address,e.state)}static fromBuffer(e){return helpers.assertBufferLength(e,5),helpers.assertFunctionCode(e[0],FunctionCode.WriteSingleCoil),new WriteSingleCoilResponse(e.readUInt16BE(1,!0),65280===e.readUInt16BE(3,!0))}toBuffer(){const e=new Buffer(5);return e[0]=this.functionCode,e.writeUInt16BE(this.address,1,!0),e.writeUInt16BE(this.state?65280:0,3,!0),e}toString(){return helpers.formatResponse(this,`Coil at address ${this.address} was set to ${this.state?\"ON\":\"OFF\"}.`)}}module.exports=WriteSingleCoilResponse;","node_modules/h5.modbus/lib/messages/WriteMultipleCoilsRequest.js":"\"use strict\";const buffers=require(\"h5.buffers\"),helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Request=require(\"../Request\");class WriteMultipleCoilsRequest extends Request{constructor(t,e){if(super(FunctionCode.WriteMultipleCoils),e.length<1||e.length>1968)throw new Error(`Invalid coil states. Expected an array with 1 to 1968 elements, but got [${e.length}].`);this.startingAddress=helpers.prepareAddress(t,e.length),this.states=e}static fromOptions(t){return new WriteMultipleCoilsRequest(t.startingAddress,t.states)}static fromBuffer(t){const e=new buffers.BufferReader(t);helpers.assertFunctionCode(e.shiftByte(),FunctionCode.WriteMultipleCoils);const s=e.shiftUInt16(),r=e.shiftUInt16();e.skip(1);const i=e.shiftBits(r);return new WriteMultipleCoilsRequest(s,i)}get endingAddress(){return this.startingAddress+this.quantity}get quantity(){return this.states.length}toBuffer(){return(new buffers.BufferBuilder).pushByte(15).pushUInt16(this.startingAddress).pushUInt16(this.states.length).pushByte(Math.ceil(this.states.length/8)).pushBits(this.states).toBuffer()}toString(){if(1===this.quantity)return helpers.formatRequest(this,`Set coil at address ${this.startingAddress} to ${this.states[0]?\"ON\":\"OFF\"}.`);const t=this.states.map(t=>t?\"1\":\"0\").join(\", \");return helpers.formatRequest(this,`Set ${this.quantity} coils starting at address ${this.startingAddress} to: ${t}`)}}module.exports=WriteMultipleCoilsRequest;","node_modules/h5.modbus/lib/messages/WriteMultipleCoilsResponse.js":"\"use strict\";const helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Response=require(\"../Response\");class WriteMultipleCoilsResponse extends Response{constructor(e,t){super(FunctionCode.WriteMultipleCoils),this.quantity=helpers.prepareQuantity(t,1968),this.startingAddress=helpers.prepareAddress(e,this.quantity)}static fromOptions(e){return new WriteMultipleCoilsResponse(e.startingAddress,e.quantity)}static fromBuffer(e){return helpers.assertBufferLength(e,5),helpers.assertFunctionCode(e[0],FunctionCode.WriteMultipleCoils),new WriteMultipleCoilsResponse(e.readUInt16BE(1,!0),e.readUInt16BE(3,!0))}get endingAddress(){return this.startingAddress+this.quantity}toBuffer(){const e=new Buffer(5);return e[0]=this.functionCode,e.writeUInt16BE(this.startingAddress,1,!0),e.writeUInt16BE(this.quantity,3,!0),e}toString(){return 1===this.quantity?helpers.formatResponse(this,`Set coil at address ${this.startingAddress}.`):helpers.formatResponse(this,`Set ${this.quantity} coils starting at address ${this.startingAddress}.`)}}module.exports=WriteMultipleCoilsResponse;","node_modules/h5.modbus/lib/messages/ReadInputRegistersRequest.js":"\"use strict\";const helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Request=require(\"../Request\");class ReadInputRegistersRequest extends Request{constructor(t,e){super(FunctionCode.ReadInputRegisters),this.quantity=helpers.prepareQuantity(e,125),this.startingAddress=helpers.prepareAddress(t,this.quantity)}static fromOptions(t){return new ReadInputRegistersRequest(t.startingAddress,t.quantity)}static fromBuffer(t){return helpers.assertBufferLength(t,5),helpers.assertFunctionCode(t[0],FunctionCode.ReadInputRegisters),new ReadInputRegistersRequest(t.readUInt16BE(1,!0),t.readUInt16BE(3,!0))}get endingAddress(){return this.startingAddress+this.quantity}get startingIndex(){return 2*this.startingAddress}get endingIndex(){return this.startingIndex+2*this.quantity}toBuffer(){const t=new Buffer(5);return t[0]=this.functionCode,t.writeUInt16BE(this.startingAddress,1,!0),t.writeUInt16BE(this.quantity,3,!0),t}toString(){return helpers.formatRequest(this,`Read ${this.quantity} input registers starting from address ${this.startingAddress}`)}}module.exports=ReadInputRegistersRequest;","node_modules/h5.modbus/lib/messages/ReadInputRegistersResponse.js":"\"use strict\";const inspect=require(\"util\").inspect,helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Response=require(\"../Response\");class ReadInputRegistersResponse extends Response{constructor(e){if(super(FunctionCode.ReadInputRegisters),e.length%2!=0||e.length<2||e.length>250)throw new Error(`The length of the data buffer must be an even number between 2 and 250, but got [${e.length}].`);this.data=e,this.quantity=e.length/2}static fromOptions(e){return new ReadInputRegistersResponse(e.data)}static fromBuffer(e){helpers.assertBufferLength(e,4),helpers.assertFunctionCode(e[0],FunctionCode.ReadInputRegisters);const t=e[1],s=e.slice(2,t+2);return new ReadInputRegistersResponse(s)}toBuffer(){const e=new Buffer(2+this.data.length);return e[0]=this.functionCode,e[1]=this.data.length,this.data.copy(e,2),e}toString(){return helpers.formatResponse(this,`${this.quantity} input registers: ${inspect(this.data)}`)}}module.exports=ReadInputRegistersResponse;","node_modules/h5.modbus/lib/messages/ReadHoldingRegistersRequest.js":"\"use strict\";const helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Request=require(\"../Request\");class ReadHoldingRegistersRequest extends Request{constructor(e,t){super(FunctionCode.ReadHoldingRegisters),this.quantity=helpers.prepareQuantity(t,125),this.startingAddress=helpers.prepareAddress(e,this.quantity)}static fromOptions(e){return new ReadHoldingRegistersRequest(e.startingAddress,e.quantity)}static fromBuffer(e){return helpers.assertBufferLength(e,5),helpers.assertFunctionCode(e[0],FunctionCode.ReadHoldingRegisters),new ReadHoldingRegistersRequest(e.readUInt16BE(1,!0),e.readUInt16BE(3,!0))}get endingAddress(){return this.startingAddress+this.quantity}get startingIndex(){return 2*this.startingAddress}get endingIndex(){return this.startingIndex+2*this.quantity}toBuffer(){const e=new Buffer(5);return e[0]=this.functionCode,e.writeUInt16BE(this.startingAddress,1,!0),e.writeUInt16BE(this.quantity,3,!0),e}toString(){return helpers.formatRequest(this,`Read ${this.quantity} holding registers starting from address ${this.startingAddress}`)}}module.exports=ReadHoldingRegistersRequest;","node_modules/h5.modbus/lib/messages/ReadHoldingRegistersResponse.js":"\"use strict\";const inspect=require(\"util\").inspect,helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Response=require(\"../Response\");class ReadHoldingRegistersResponse extends Response{constructor(e){if(super(FunctionCode.ReadHoldingRegisters),e.length%2!=0||e.length<2||e.length>250)throw new Error(`The length of the data buffer must be an even number between 2 and 250, but got [${e.length}].`);this.data=e,this.quantity=e.length/2}static fromOptions(e){return new ReadHoldingRegistersResponse(e.data)}static fromBuffer(e){helpers.assertBufferLength(e,4),helpers.assertFunctionCode(e[0],FunctionCode.ReadHoldingRegisters);const t=e[1],s=e.slice(2,t+2);return new ReadHoldingRegistersResponse(s)}toBuffer(){const e=new Buffer(2+this.data.length);return e[0]=this.functionCode,e[1]=this.data.length,this.data.copy(e,2),e}toString(){return helpers.formatResponse(this,`${this.quantity} holding registers: ${inspect(this.data)}`)}}module.exports=ReadHoldingRegistersResponse;","node_modules/h5.modbus/lib/messages/WriteSingleRegisterRequest.js":"\"use strict\";const helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Request=require(\"../Request\");class WriteSingleRegisterRequest extends Request{constructor(e,t){super(FunctionCode.WriteSingleRegister),this.address=helpers.prepareAddress(e,1),this.value=helpers.prepareRegisterValue(t)}static fromOptions(e){return new WriteSingleRegisterRequest(e.address,e.value)}static fromBuffer(e){return helpers.assertBufferLength(e,5),helpers.assertFunctionCode(e[0],FunctionCode.WriteSingleRegister),new WriteSingleRegisterRequest(e.readUInt16BE(1,!0),e.readUInt16BE(3,!0))}toBuffer(){const e=new Buffer(5);return e[0]=this.functionCode,e.writeUInt16BE(this.address,1,!0),e.writeUInt16BE(this.value,3,!0),e}toString(){return helpers.formatRequest(this,`Set register at address ${this.address} to: ${this.value}`)}}module.exports=WriteSingleRegisterRequest;","node_modules/h5.modbus/lib/messages/WriteSingleRegisterResponse.js":"\"use strict\";const helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Response=require(\"../Response\");class WriteSingleRegisterResponse extends Response{constructor(e,s){super(FunctionCode.WriteSingleRegister),this.address=helpers.prepareAddress(e,1),this.value=helpers.prepareRegisterValue(s)}static fromOptions(e){return new WriteSingleRegisterResponse(e.address,e.value)}static fromBuffer(e){return helpers.assertBufferLength(e,5),helpers.assertFunctionCode(e[0],FunctionCode.WriteSingleRegister),new WriteSingleRegisterResponse(e.readUInt16BE(1,!0),e.readUInt16BE(3,!0))}toBuffer(){const e=new Buffer(5);return e[0]=this.functionCode,e.writeUInt16BE(this.address,1,!0),e.writeUInt16BE(this.value,3,!0),e}toString(){return helpers.formatResponse(this,`Register at address ${this.address} was set to: ${this.value}`)}}module.exports=WriteSingleRegisterResponse;","node_modules/h5.modbus/lib/messages/WriteMultipleRegistersRequest.js":"\"use strict\";const inspect=require(\"util\").inspect,helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Request=require(\"../Request\");class WriteMultipleRegistersRequest extends Request{constructor(e,t){super(FunctionCode.WriteMultipleRegisters),this.values=helpers.prepareRegisterValues(t),this.startingAddress=helpers.prepareAddress(e,this.quantity)}static fromOptions(e){return new WriteMultipleRegistersRequest(e.startingAddress,e.values)}static fromBuffer(e){helpers.assertBufferLength(e,6+(e[5]||2)),helpers.assertFunctionCode(e[0],FunctionCode.WriteMultipleRegisters);const t=e.readUInt16BE(1,!0),s=e[5],r=e.slice(6,6+s);return new WriteMultipleRegistersRequest(t,r)}get endingAddress(){return this.startingAddress+this.quantity}get quantity(){return this.values.length/2}toBuffer(){const e=new Buffer(6+this.values.length);return e[0]=this.functionCode,e.writeUInt16BE(this.startingAddress,1,!0),e.writeUInt16BE(this.quantity,3,!0),e[5]=this.values.length,this.values.copy(e,6),e}toString(){return 1===this.quantity?helpers.formatRequest(this,`Set register at address ${this.startingAddress} to ${this.values.readUInt16BE(0)}.`):helpers.formatRequest(this,`Set ${this.quantity} registers starting at address ${this.startingAddress} to: ${inspect(this.values)}`)}}module.exports=WriteMultipleRegistersRequest;","node_modules/h5.modbus/lib/messages/WriteMultipleRegistersResponse.js":"\"use strict\";const helpers=require(\"../helpers\"),FunctionCode=require(\"../FunctionCode\"),Response=require(\"../Response\");class WriteMultipleRegistersResponse extends Response{constructor(e,t){super(FunctionCode.WriteMultipleRegisters),this.quantity=helpers.prepareQuantity(t,123),this.startingAddress=helpers.prepareAddress(e,this.quantity)}static fromOptions(e){return new WriteMultipleRegistersResponse(e.startingAddress,e.quantity)}static fromBuffer(e){return helpers.assertBufferLength(e,5),helpers.assertFunctionCode(e[0],FunctionCode.WriteMultipleRegisters),new WriteMultipleRegistersResponse(e.readUInt16BE(1,!0),e.readUInt16BE(3,!0))}get endingAddress(){return this.startingAddress+this.quantity}toBuffer(){const e=new Buffer(5);return e[0]=this.functionCode,e.writeUInt16BE(this.startingAddress,1,!0),e.writeUInt16BE(this.quantity,3,!0),e}toString(){return 1===this.quantity?helpers.formatResponse(this,`Set register at address ${this.startingAddress}.`):helpers.formatResponse(this,`Set ${this.quantity} registers starting at address ${this.startingAddress}.`)}}module.exports=WriteMultipleRegistersResponse;","node_modules/h5.modbus/lib/messages/ExceptionResponse.js":"\"use strict\";const ExceptionCode=require(\"../ExceptionCode\"),FunctionCode=require(\"../FunctionCode\"),Response=require(\"../Response\"),helpers=require(\"../helpers\"),CODE_TO_MESSAGE_MAP={[ExceptionCode.IllegalFunctionCode]:\"Illegal Function Code: The function code received in the query is not an allowable action for the server (or slave).\",[ExceptionCode.IllegalDataAddress]:\"Illegal Data Address: The data address received in the query is not an allowable address for the server (or slave).\",[ExceptionCode.IllegalDataValue]:\"Illegal Data Value: A value contained in the query data field is not an allowable value for the server (or slave).\",[ExceptionCode.SlaveDeviceFailure]:\"Slave Device Failure: An unrecoverable error occurred while the server (or slave) was attempting to perform the requested action.\",[ExceptionCode.Acknowledge]:\"Acknowledge: The server (or slave) has accepted the request and is processing it, but a long duration of time will be required to do so.\",[ExceptionCode.SlaveDeviceBusy]:\"Slave Device Busy: The server (or slave) is engaged in processing a longduration program command.\",[ExceptionCode.NegativeAcknowledge]:\"Negative Acknowledge: The server (or slave) cannot perform the program function received in the query.\",[ExceptionCode.MemoryParityError]:\"Memory Parity Error: The server (or slave) attempted to read record file, but detected a parity error in the memory.\",[ExceptionCode.GatewayPathUnavailable]:\"Gateway Path Unavailable: Gateway was unable to allocate an internal communication path from the input port to the output port for processing the request.\",[ExceptionCode.GatewayTargetDeviceFailedToRespond]:\"Gateway Target Device Failed To Respond: No response was obtained from the target device.\"};class ExceptionResponse extends Response{constructor(e,o){super(e),this.exceptionCode=o}static fromOptions(e){return new ExceptionResponse(e.functionCode,e.exceptionCode)}static fromBuffer(e){if(helpers.assertBufferLength(e,2),e[0]<=FunctionCode.Exception)throw new Error(\"Invalid function code. \"+`Expected an integer greater than ${FunctionCode.Exception}, got [${e[0]}].`);return new ExceptionResponse(e[0]-FunctionCode.Exception,e[1])}toBuffer(){return new Buffer([this.functionCode+FunctionCode.Exception,this.exceptionCode])}toString(){let e=`Exception (${this.exceptionCode})`;return void 0!==CODE_TO_MESSAGE_MAP[this.exceptionCode]&&(e+=`: ${CODE_TO_MESSAGE_MAP[this.exceptionCode]}`),`${helpers.formatFunctionCode(this.functionCode)} (RES) ${e}`}isException(){return!0}}module.exports=ExceptionResponse;","node_modules/h5.buffers/lib/index.js":"exports.BufferQueueReader=require(\"./BufferQueueReader\"),exports.BufferReader=require(\"./BufferReader\"),exports.BufferBuilder=require(\"./BufferBuilder\");","node_modules/h5.buffers/lib/BufferQueueReader.js":"\"use strict\";var toBits=require(\"./helpers\").toBits;function BufferQueueReader(){this.length=0,this.offset=0,this.buffers=[];for(var e=0,t=arguments.length;e<t;++e)this.push(arguments[e])}function shiftUInt(e,t,r){if(e.length<t)throw new Error(\"The reader's length is less than \"+t+\" bytes.\");e.length-=t;for(var n=0,f=-8;t--;){var u=e.buffers[0];r?n+=u[e.offset++]<<(f+=8)>>>0:n=(n<<8>>>0)+u[e.offset++],e.offset>=u.length&&(e.offset-=e.buffers.shift().length)}return n}function readUInt(e,t,r,n){if(t=parseInt(t,10),isNaN(t)||t<0||t+r>e.length)throw new Error(\"The offset must be a number between 0 and the reader's length minus 2.\");t+=e.offset;for(var f,u=0;(f=e.buffers[u++]).length<=t;)t-=f.length;for(var s=0,h=-8;r--;)n?s+=f[t++]<<(h+=8)>>>0:s=(s<<8>>>0)+f[t++],t>=f.length&&(t=0,f=e.buffers[u++]);return s}function toInt8(e){return 128&e?-1*(256-e):e}function toInt16(e){return 32768&e?-1*(65536-e):e}function toInt32(e){return 2147483648&e?-1*(4294967296-e):e}BufferQueueReader.prototype.push=function(){for(var e=0,t=arguments.length;e<t;++e){var r=arguments[e];if(!Buffer.isBuffer(r))throw new Error(\"The buffer must be an instance of Buffer.\");0!==r.length&&(this.buffers.push(r),this.length+=r.length)}},BufferQueueReader.prototype.skip=function(e){if(e=arguments.length?parseInt(e,10):this.length,isNaN(e)||e<0)throw new Error(\"The byte count must be a number greater than or equal to 0.\");var t;for(e>this.length&&(e=this.length),this.offset+=e,this.length-=e;this.buffers.length>0&&(t=this.buffers[0]).length<=this.offset;)this.buffers.shift(),this.offset-=t.length},BufferQueueReader.prototype.indexOf=function(e,t){if(e=parseInt(e,10),isNaN(e)||e<0||e>255)throw new Error(\"The search element must be a number between 0x00 and 0xFF.\");if(t=arguments.length>=2?parseInt(t,10):0,isNaN(t)||t<0||t>this.length)throw new Error(\"The search starting index must be a number between 0 and the reader's length.\");for(var r=this.offset+t,n=0,f=this.buffers[n];n<this.buffers.length&&r>=f.length;)r-=f.length,f=this.buffers[++n];for(var u=t;n<this.buffers.length;){if(f[r]===e)return u;u+=1,(r+=1)>=f.length&&(r=0,f=this.buffers[++n])}return-1},BufferQueueReader.prototype.copy=function(e,t,r,n){if(!Buffer.isBuffer(e))throw new Error(\"The target buffer must be an instance of Buffer.\");if(t=arguments.length>=2?parseInt(t,10):0,isNaN(t)||t<0||t>e.length)throw new Error(\"The target starting index must be a number greater than or equal to 0 and less than or equal to the target buffer's length.\");if(r=arguments.length>=3?parseInt(r,10):0,isNaN(r)||r<0||r>=this.length)throw new Error(\"The source starting index must be a number greater than or equal to 0 and less than the reader's length.\");if(n=arguments.length>=4?parseInt(n,10):this.length,isNaN(n)||n<1||n>this.length)throw new Error(\"The source ending index must be a number greater than 0 and less than or equal to the reader's length.\");if(r>=n)throw new Error(\"The source start index must be less than the source end index.\");for(var f,u=this.offset+r,s=0;(f=this.buffers[s++]).length<=u;)u-=f.length;var h=n-r;if(f.length>=u+h)return f.copy(e,t,u,u+h);for(var o=0;h;){var i=f.copy(e,t,u,Math.min(f.length,u+h));t+=i,o+=i,h-=i,(u+=i)>=f.length&&(u=0,f=this.buffers[s++])}return o},BufferQueueReader.prototype.shiftBits=function(e){return toBits(this.shiftBytes(Math.ceil(e/8)),e)},BufferQueueReader.prototype.shiftByte=function(){if(0===this.length)throw new Error(\"The reader is empty.\");var e=this.buffers[0],t=e[this.offset++];return this.length-=1,this.offset>=e.length&&(this.buffers.shift(),this.offset-=e.length),t},BufferQueueReader.prototype.shiftChar=function(){return String.fromCharCode(this.shiftByte())},BufferQueueReader.prototype.shiftBytes=function(e){if(e=parseInt(e,10),isNaN(e)||e<1||e>this.length)throw new Error(\"The byte count must be a number greater than 0 and less than or equal to the reader's length.\");this.length-=e;for(var t=[];e--;){var r=this.buffers[0];t.push(r[this.offset++]),this.offset>=r.length&&(this.buffers.shift(),this.offset-=r.length)}return t},BufferQueueReader.prototype.shiftBuffer=function(e){return new Buffer(this.shiftBytes(e))},BufferQueueReader.prototype.shiftString=function(e,t){return this.shiftBuffer(e).toString(t||\"utf8\")},BufferQueueReader.prototype.shiftZeroString=function(e){var t=this.indexOf(0);if(-1===t)return\"\";var r=this.shiftString(t,e);return this.skip(1),r},BufferQueueReader.prototype.shiftInt8=function(){return toInt8(this.shiftByte())},BufferQueueReader.prototype.shiftInt16=function(e){return toInt16(shiftUInt(this,2,e))},BufferQueueReader.prototype.shiftInt32=function(e){return toInt32(shiftUInt(this,4,e))},BufferQueueReader.prototype.shiftUInt8=function(){return this.shiftByte()},BufferQueueReader.prototype.shiftUInt16=function(e){return shiftUInt(this,2,e)},BufferQueueReader.prototype.shiftUInt32=function(e){return shiftUInt(this,4,e)},BufferQueueReader.prototype.shiftFloat=function(e){var t=e?\"readFloatLE\":\"readFloatBE\";return this.shiftBuffer(4)[t](0,!1)},BufferQueueReader.prototype.shiftDouble=function(e){var t=e?\"readDoubleLE\":\"readDoubleBE\";return this.shiftBuffer(8)[t](0,!1)},BufferQueueReader.prototype.readBits=function(e,t){return toBits(this.readBytes(e,Math.ceil(t/8)),t)},BufferQueueReader.prototype.readByte=function(e){if(e=parseInt(e,10),isNaN(e)||e<0||e>=this.length)throw new Error(\"The offset must be a number between 0 and the reader's length minus one.\");e+=this.offset;for(var t,r=0;(t=this.buffers[r++]).length<=e;)e-=t.length;return t[e]},BufferQueueReader.prototype.readChar=function(e){return String.fromCharCode(this.readByte(e))},BufferQueueReader.prototype.readBytes=function(e,t){if(e=parseInt(e,10),isNaN(e)||e<0)throw new Error(\"The offset must be a number greater than 0.\");if(t=parseInt(t,10),isNaN(t)||t<1)throw new Error(\"The byte count must be a number greater than 0.\");if(e+t>this.length)throw new Error(\"A sum of the offset and byte count must be less than or equal to the reader's length\");e+=this.offset;for(var r,n=[],f=0;(r=this.buffers[f++]).length<=e;)e-=r.length;for(;t--;)n.push(r[e++]),e>=r.length&&(e=0,r=this.buffers[f++]);return n},BufferQueueReader.prototype.readBuffer=function(e,t){if(e=parseInt(e,10),isNaN(e)||e<0)throw new Error(\"The offset must be a number greater than 0.\");if(t=parseInt(t,10),isNaN(t)||t<1)throw new Error(\"The byte count must be a number greater than 0.\");if(e+t>this.length)throw new Error(\"A sum of the offset and byte count must be less than or equal to the reader's length\");e+=this.offset;for(var r,n=0;(r=this.buffers[n++]).length<=e;)e-=r.length;if(r.length>=e+t)return r.slice(e,e+t);for(var f=new Buffer(t),u=0;t;){var s=r.copy(f,u,e,Math.min(r.length,e+t));u+=s,t-=s,(e+=s)>=r.length&&(e=0,r=this.buffers[n++])}return f},BufferQueueReader.prototype.readString=function(e,t,r){return this.readBuffer(e,t).toString(r||\"utf8\")},BufferQueueReader.prototype.readZeroString=function(e,t){var r=this.indexOf(0,e);return-1===r||r-e==0?\"\":this.readString(e,r-e,t)},BufferQueueReader.prototype.readInt8=function(e){return toInt8(this.readByte(e))},BufferQueueReader.prototype.readInt16=function(e,t){return toInt16(readUInt(this,e,2,t))},BufferQueueReader.prototype.readInt32=function(e,t){return toInt32(readUInt(this,e,4,t))},BufferQueueReader.prototype.readUInt8=function(e){return this.readByte(e)},BufferQueueReader.prototype.readUInt16=function(e,t){return readUInt(this,e,2,t)},BufferQueueReader.prototype.readUInt32=function(e,t){return readUInt(this,e,4,t)},BufferQueueReader.prototype.readFloat=function(e,t){var r=t?\"readFloatLE\":\"readFloatBE\";return this.readBuffer(e,4)[r](0,!1)},BufferQueueReader.prototype.readDouble=function(e,t){var r=t?\"readDoubleLE\":\"readDoubleBE\";return this.readBuffer(e,8)[r](0,!1)},module.exports=BufferQueueReader;","node_modules/h5.buffers/lib/BufferReader.js":"\"use strict\";var toBits=require(\"./helpers\").toBits;function BufferReader(e){if(!Buffer.isBuffer(e))throw new Error(\"Buffer reader expects an instance of Buffer.\");this.length=e.length,this.offset=0,this.buffer=e}BufferReader.prototype.skip=function(e){if(e=0===arguments.length?this.length:parseInt(e,10),isNaN(e)||e<0)throw new Error(\"The byte count must be a number greater than or equal to 0.\");e>this.length&&(e=this.length),this.offset+=e,this.length-=e},BufferReader.prototype.indexOf=function(e,t){if(e=parseInt(e,10),isNaN(e)||e<0||e>255)throw new Error(\"The search element must be a number between 0x00 and 0xFF.\");if(t=arguments.length>=2?parseInt(t,10):0,isNaN(t)||t<0||t>this.length)throw new Error(\"The search starting index must be a number between 0 and the reader's length.\");for(var r=this.offset+t;r<this.length;++r)if(this.buffer[r]===e)return r-this.offset;return-1},BufferReader.prototype.copy=function(e,t,r,n){if(!Buffer.isBuffer(e))throw new Error(\"The target buffer must be an instance of Buffer.\");if(t=arguments.length>=2?parseInt(t,10):0,isNaN(t)||t<0||t>e.length)throw new Error(\"The target starting index must be a number greater than or equal to 0 and less than or equal to the target buffer's length.\");if(r=arguments.length>=3?parseInt(r,10):0,isNaN(r)||r<0||r>=this.length)throw new Error(\"The source starting index must be a number greater than or equal to 0 and less than the reader's length.\");if(n=arguments.length>=4?parseInt(n,10):this.length,isNaN(n)||n<1||n>this.length)throw new Error(\"The source ending index must be a number greater than 0 and less than or equal to the reader's length.\");if(r>=n)throw new Error(\"The source start index must be less than the source end index.\");return this.buffer.copy(e,t,this.offset+r,this.offset+n)},BufferReader.prototype.shiftBits=function(e){return toBits(this.shiftBytes(Math.ceil(e/8)),e)},BufferReader.prototype.shiftByte=function(){if(0===this.length)throw new Error(\"The reader is empty.\");return this.length-=1,this.buffer[this.offset++]},BufferReader.prototype.shiftChar=function(){return String.fromCharCode(this.shiftByte())},BufferReader.prototype.shiftBytes=function(e){if(e=parseInt(e,10),isNaN(e)||e<1||e>this.length)throw new Error(\"The byte count must be a number greater than 0 and less than or equal to the reader's length.\");this.length-=e;for(var t=[];e--;)t.push(this.buffer[this.offset++]);return t},BufferReader.prototype.shiftBuffer=function(e){return new Buffer(this.shiftBytes(e))},BufferReader.prototype.shiftString=function(e,t){return this.shiftBuffer(e).toString(t||\"utf8\")},BufferReader.prototype.shiftZeroString=function(e){var t=this.indexOf(0);if(-1===t)return\"\";var r=this.shiftString(t,e);return this.skip(1),r},BufferReader.prototype.shiftInt8=function(){var e=this.readInt8(0);return this.skip(1),e},BufferReader.prototype.shiftInt16=function(e){var t=this.readInt16(0,e);return this.skip(2),t},BufferReader.prototype.shiftInt32=function(e){var t=this.readInt32(0,e);return this.skip(4),t},BufferReader.prototype.shiftUInt8=function(){var e=this.readUInt8(0);return this.skip(1),e},BufferReader.prototype.shiftUInt16=function(e){var t=this.readUInt16(0,e);return this.skip(2),t},BufferReader.prototype.shiftUInt32=function(e){var t=this.readUInt32(0,e);return this.skip(4),t},BufferReader.prototype.shiftFloat=function(e){var t=this.readFloat(0,e);return this.skip(4),t},BufferReader.prototype.shiftDouble=function(e){var t=this.readDouble(0,e);return this.skip(8),t},BufferReader.prototype.readBits=function(e,t){return toBits(this.readBytes(e,Math.ceil(t/8)),t)},BufferReader.prototype.readByte=function(e){if(e=parseInt(e,10),isNaN(e)||e<0||e>=this.length)throw new Error(\"The offset must be a number between 0 and the reader's length minus one.\");return this.buffer[this.offset+e]},BufferReader.prototype.readChar=function(e){return String.fromCharCode(this.readByte(e))},BufferReader.prototype.readBytes=function(e,t){if(e=parseInt(e,10),isNaN(e)||e<0)throw new Error(\"The offset must be a number greater than 0.\");if(t=parseInt(t,10),isNaN(t)||t<1)throw new Error(\"The byte count must be a number greater than 0.\");if(e+t>this.length)throw new Error(\"A sum of the offset and byte count must be less than or equal to the reader's length.\");e+=this.offset;for(var r=[];t--;)r.push(this.buffer[e++]);return r},BufferReader.prototype.readBuffer=function(e,t){return new Buffer(this.readBytes(e,t))},BufferReader.prototype.readString=function(e,t,r){return this.readBuffer(e,t).toString(r||\"utf8\")},BufferReader.prototype.readZeroString=function(e,t){var r=this.indexOf(0,e);return-1===r||r-e==0?\"\":this.readString(e,r-e,t)},BufferReader.prototype.readInt8=function(e){return this.buffer.readInt8(this.offset+e)},BufferReader.prototype.readInt16=function(e,t){return this.buffer[t?\"readInt16LE\":\"readInt16BE\"](this.offset+e)},BufferReader.prototype.readInt32=function(e,t){return this.buffer[t?\"readInt32LE\":\"readInt32BE\"](this.offset+e)},BufferReader.prototype.readUInt8=function(e){return this.buffer.readUInt8(this.offset+e)},BufferReader.prototype.readUInt16=function(e,t){return this.buffer[t?\"readUInt16LE\":\"readUInt16BE\"](this.offset+e)},BufferReader.prototype.readUInt32=function(e,t){return this.buffer[t?\"readUInt32LE\":\"readUInt32BE\"](this.offset+e)},BufferReader.prototype.readFloat=function(e,t){return this.buffer[t?\"readFloatLE\":\"readFloatBE\"](this.offset+e)},BufferReader.prototype.readDouble=function(e,t){return this.buffer[t?\"readDoubleLE\":\"readDoubleBE\"](this.offset+e)},module.exports=BufferReader;","node_modules/h5.buffers/lib/BufferBuilder.js":"\"use strict\";function BufferBuilder(){this.length=0,this.data=[]}function parseIntValue(t,r,e){if(t=parseInt(t,10),isNaN(t)||t<e||t>r)throw new Error(\"Expected an integer between \"+e+\" and \"+r+\".\");return t}function parseFloatValue(t,r,e){if(t=parseFloat(t,10),isNaN(t)||t<e||t>r)throw new Error(\"Expected a floating-point number between \"+e+\" and \"+r+\".\");return t}BufferBuilder.prototype.toBuffer=function(){var t=new Buffer(this.length);return this.data.reduce(function(r,e){return r+e(t,r)},0),t},BufferBuilder.prototype.pushBits=function(t){if(!Array.isArray(t))throw new Error(\"Expected an array.\");var r=t.length;if(0===r)return this;var e=Math.ceil(r/8);return this.data.push(function(n,u){for(var i=0,h=0,s=0;s<r;++s)0!==i&&i%8==0?(n[u++]=h,i=0,h=t[s]?1:0):t[s]&&(h|=Math.pow(2,i)),i+=1;return n[u]=h,e}),this.length+=e,this},BufferBuilder.prototype.pushByte=function(t){if(t=parseInt(t,10),isNaN(t)||t<0||t>255)throw new Error(\"Expected a number between 0 and 255.\");return this.data.push(function(r,e){return r[e]=t,1}),this.length+=1,this},BufferBuilder.prototype.pushChar=function(t){var r=t.charCodeAt(0);if(isNaN(r)||r<0||r>127)throw new Error(\"Expected an ASCII character.\");return this.pushByte(r)},BufferBuilder.prototype.pushBytes=function(t){if(!Array.isArray(t))throw new Error(\"Expected an array.\");var r=t.length;return 0===r?this:(this.data.push(function(e,n){for(var u=0;u<r;++u)e[n+u]=t[u];return r}),this.length+=r,this)},BufferBuilder.prototype.pushBuffer=function(t){if(!Buffer.isBuffer(t))throw new Error(\"Expected an instance of Buffer.\");return 0===t.length?this:(this.data.push(function(r,e){return t.copy(r,e,0,t.length)}),this.length+=t.length,this)},BufferBuilder.prototype.pushString=function(t,r){if(\"string\"!=typeof t)throw new Error(\"Expected a string.\");return 0===t.length?this:(r||(r=\"utf8\"),this.data.push(function(e,n){return e.write(t,n,r)}),this.length+=Buffer.byteLength(t,r),this)},BufferBuilder.prototype.pushZeroString=function(t,r){return this.pushString(t,r).pushByte(0)},BufferBuilder.prototype.pushInt8=function(t){return t=parseIntValue(t,127,-128),this.data.push(function(r,e){return r.writeInt8(t,e,!0),1}),this.length+=1,this},BufferBuilder.prototype.pushInt16=function(t,r){return t=parseIntValue(t,32767,-32768),this.data.push(function(e,n){return e[r?\"writeInt16LE\":\"writeInt16BE\"](t,n,!0),2}),this.length+=2,this},BufferBuilder.prototype.pushInt32=function(t,r){return t=parseIntValue(t,2147483647,-2147483648),this.data.push(function(e,n){return e[r?\"writeInt32LE\":\"writeInt32BE\"](t,n,!0),4}),this.length+=4,this},BufferBuilder.prototype.pushUInt8=function(t){return t=parseIntValue(t,255,0),this.data.push(function(r,e){return r.writeUInt8(t,e,!0),1}),this.length+=1,this},BufferBuilder.prototype.pushUInt16=function(t,r){return t=parseIntValue(t,65535,0),this.data.push(function(e,n){return e[r?\"writeUInt16LE\":\"writeUInt16BE\"](t,n,!0),2}),this.length+=2,this},BufferBuilder.prototype.pushUInt32=function(t,r){return t=parseIntValue(t,4294967295,0),this.data.push(function(e,n){return e[r?\"writeUInt32LE\":\"writeUInt32BE\"](t,n,!0),4}),this.length+=4,this},BufferBuilder.prototype.pushFloat=function(t,r){return t=parseFloatValue(t,3.4028234663852886e38,-3.4028234663852886e38),this.data.push(function(e,n){return e[r?\"writeFloatLE\":\"writeFloatBE\"](t,n,!0),4}),this.length+=4,this},BufferBuilder.prototype.pushDouble=function(t,r){return t=parseFloatValue(t,1.7976931348623157e308,-1.7976931348623157e308),this.data.push(function(e,n){return e[r?\"writeDoubleLE\":\"writeDoubleBE\"](t,n,!0),8}),this.length+=8,this},module.exports=BufferBuilder;","node_modules/h5.buffers/lib/helpers.js":"\"use strict\";exports.toBits=function(t,o){for(var r=[],e=t.length,n=0;n<e;++n)for(var s=t[n],a=0;a<8&&r.length!==o;++a)r.push(Boolean(s&Math.pow(2,a)));return r};","node_modules/h5.modbus/lib/listeners/monkeyPatch.js":"\"use strict\";const Server=require(\"net\").Server,originalServerListen=Server.prototype.listen;Server.prototype.binding=!1,Server.prototype.listen=function(){const e=()=>{this.binding=!1,this.removeListener(\"error\",e),this.removeListener(\"listening\",e)};return this.on(\"error\",e),this.on(\"listening\",e),this.binding=!0,originalServerListen.apply(this,arguments)};","backend/node_modules/modbus/deltaUtils.js":"\"use strict\";var DELTA_FUNCTIONS={S:2,X:2,Y:1,M:1,T:3,C:3,D:3,input:2,output:1,register:3},DELTA_ADDRESSES={S:function(t){return t<0||t>1023?-1:0+t},X:function(t){return t<0||t>377?-1:1024+8*Math.floor(t/10)+t%10},Y:function(t){return t<0||t>377?-1:1280+8*Math.floor(t/10)+t%10},T:function(t){return t<0||t>255?-1:1536+t},M:function(t){return t<0||t>4095?-1:t<1536?2048+t:45056+t-1536},C:function(t){return t<0||t>255?-1:3584+t},D:function(t){return t<0||t>11999?-1:t<4096?4096+t:36864+t-4096}};exports.getFunctionCode=function(t){if(\"number\"==typeof DELTA_FUNCTIONS[t])return DELTA_FUNCTIONS[t];var r=t.charAt(0);return\"number\"!=typeof DELTA_FUNCTIONS[r]?-1:DELTA_FUNCTIONS[r]},exports.getStartingAddress=function(t){var r=t.charAt(0);if(\"function\"!=typeof DELTA_ADDRESSES[r])return-1;var n=parseInt(t.substr(1),10);return DELTA_ADDRESSES[r](n)};","backend/node_modules/modbus/scaleFunctions.js":"\"use strict\";const _=require(\"lodash\"),SCALE_FUNCTIONS_RE=/([a-zA-Z0-9]+)(?:\\((.*?)\\))?/g,NOOP_SCALE_FUNCTIONS={rawValueToValue:function(u){return u},valueToRawValue:function(u){return u}};var SCALE_FUNCTIONS={round:function(u,n){const e=Math.pow(10,\"number\"==typeof n[0]?n[0]:0);return{rawValueToValue:round.bind(null,e),valueToRawValue:NOOP_SCALE_FUNCTIONS.valueToRawValue}},div:function(u,n){const e=\"number\"==typeof n[0]?n[0]:1;return{rawValueToValue:div.bind(null,e),valueToRawValue:mul.bind(null,e)}},minMax:function(u,n){const e=\"number\"==typeof n[0]?n[0]:u.rawMin,a=\"number\"==typeof n[1]?n[1]:u.rawMax,l=\"number\"==typeof n[2]?n[2]:u.scaleMin,r=\"number\"==typeof n[3]?n[3]:u.scaleMax;return null===a||null===r?NOOP_SCALE_FUNCTIONS:{rawValueToValue:scale.bind(null,e,a,l,r),valueToRawValue:scale.bind(null,l,r,e,a)}},flip:function(){return{rawValueToValue:flip,valueToRawValue:flip}},cast:function(u,n){const e=\"string\"==typeof n[0]?n[0]:\"number\";return{rawValueToValue:cast.bind(null,e),valueToRawValue:cast.bind(null,u.type)}},sub:function(u,n){const e=[];if(_.forEach(n,function(n){const a=u.modbus.tags[n];a&&e.push(a)}),0===e.length)return NOOP_SCALE_FUNCTIONS;const a=sub.bind(null,e);return{rawValueToValue:a,valueToRawValue:a}},offset:function(u,n){const e=\"number\"==typeof n[0]?n[0]:0;return 0===e?NOOP_SCALE_FUNCTIONS:{rawValueToValue:offset.bind(null,e),valueToRawValue:offset.bind(null,-e)}},nil:function(u,n){if(0===n.length)return NOOP_SCALE_FUNCTIONS;if(1===n.length){const u=n[0];return{rawValueToValue:n=>n===u?null:n,valueToRawValue:n=>null===n?u:n}}return{rawValueToValue:u=>n.includes(u)?null:u,valueToRawValue:u=>null===u?n[0]:u}},const:function(u,n){if(0===n.length)return NOOP_SCALE_FUNCTIONS;const e=n[0];return{rawValueToValue:()=>e,valueToRawValue:()=>e}}};function round(u,n){return Math.round(n*u)/u}function div(u,n){return n/u}function mul(u,n){return n*u}function scale(u,n,e,a,l){return(a-e)*(l-u)/(n-u)+e}function flip(u){return!u}function cast(u,n){switch(u){case\"number\":switch(typeof n){case\"bool\":return n?1:0}break;case\"bool\":return!!n}return n}function sub(u,n){return u.reduce((u,n)=>u+n.getValue(),0)-n}function offset(u,n){return n+u}function parseScaleFunctions(u,n){for(var e,a=[];null!==(e=SCALE_FUNCTIONS_RE.exec(n));){var l=e[1],r=\"string\"!=typeof e[2]||0===e[2].length?[]:e[2].split(\",\").map(parseArgValue);\"function\"==typeof SCALE_FUNCTIONS[l]&&a.push(SCALE_FUNCTIONS[l](u,r))}return a}function parseArgValue(u){u=u.trim();const n=parseFloat(u);if(!isNaN(n))return n;switch(u.toLowerCase()){case\"true\":return!0;case\"false\":return!1;case\"null\":return null;default:return u}}exports.create=function(u){if(\"string\"!=typeof u.scaleFunction)return NOOP_SCALE_FUNCTIONS;const n=parseScaleFunctions(u,u.scaleFunction),e=n.length;return 0===e?NOOP_SCALE_FUNCTIONS:{rawValueToValue:function(u){var a=u;for(let u=0;u<e;++u)if(null===(a=n[u].rawValueToValue(a)))return null;return a},valueToRawValue:function(u){var a=u;for(let u=e-1;u>=0;--u)a=n[u].valueToRawValue(a);return a}}};","node_modules/axon/index.js":"module.exports=require(\"./lib\");","node_modules/amp-message/index.js":"var fmt=require(\"util\").format,amp=require(\"amp\"),methods=[\"push\",\"pop\",\"shift\",\"unshift\"];function Message(e){Buffer.isBuffer(e)&&(e=decode(e)),this.args=e||[]}function decode(e){for(var t=amp.decode(e),r=0;r<t.length;r++)t[r]=unpack(t[r]);return t}function encode(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=pack(e[r]);return amp.encode(t)}function pack(e){return Buffer.isBuffer(e)?e:\"string\"==typeof e?new Buffer(\"s:\"+e):(void 0===e&&(e=null),new Buffer(\"j:\"+JSON.stringify(e)))}function unpack(e){return isJSON(e)?JSON.parse(e.slice(2)):isString(e)?e.slice(2).toString():e}function isString(e){return 115==e[0]&&58==e[1]}function isJSON(e){return 106==e[0]&&58==e[1]}function isId(e){return 105==e[0]&&58==e[1]}module.exports=Message,methods.forEach(function(e){Message.prototype[e]=function(){return this.args[e].apply(this.args,arguments)}}),Message.prototype.inspect=function(){return fmt(\"<Message args=%d size=%d>\",this.args.length,this.toBuffer().length)},Message.prototype.toBuffer=function(){return encode(this.args)};","node_modules/axon/lib/index.js":"exports.PubEmitterSocket=require(\"./sockets/pub-emitter\"),exports.SubEmitterSocket=require(\"./sockets/sub-emitter\"),exports.PushSocket=require(\"./sockets/push\"),exports.PullSocket=require(\"./sockets/pull\"),exports.PubSocket=require(\"./sockets/pub\"),exports.SubSocket=require(\"./sockets/sub\"),exports.ReqSocket=require(\"./sockets/req\"),exports.RepSocket=require(\"./sockets/rep\"),exports.Socket=require(\"./sockets/sock\"),exports.types={\"pub-emitter\":exports.PubEmitterSocket,\"sub-emitter\":exports.SubEmitterSocket,push:exports.PushSocket,pull:exports.PullSocket,pub:exports.PubSocket,sub:exports.SubSocket,req:exports.ReqSocket,rep:exports.RepSocket},exports.socket=function(e,t){var r=exports.types[e];if(!r)throw new Error('invalid socket type \"'+e+'\"');return new r(t)};","node_modules/axon/lib/sockets/pub-emitter.js":"var PubSocket=require(\"./pub\");function PubEmitterSocket(){this.sock=new PubSocket,this.emit=this.sock.send.bind(this.sock),this.bind=this.sock.bind.bind(this.sock),this.connect=this.sock.connect.bind(this.sock),this.close=this.sock.close.bind(this.sock)}module.exports=PubEmitterSocket;","node_modules/axon/lib/sockets/sub-emitter.js":"var Message=require(\"amp-message\"),SubSocket=require(\"./sub\");function SubEmitterSocket(){this.sock=new SubSocket,this.sock.onmessage=this.onmessage.bind(this),this.bind=this.sock.bind.bind(this.sock),this.connect=this.sock.connect.bind(this.sock),this.close=this.sock.close.bind(this.sock),this.listeners=[]}module.exports=SubEmitterSocket,SubEmitterSocket.prototype.onmessage=function(){var s=this.listeners,t=this;return function(e){for(var i=new Message(e),n=i.shift(),o=0;o<s.length;++o){var r=s[o],c=r.re.exec(n);c&&r.fn.apply(t,c.slice(1).concat(i.args))}}},SubEmitterSocket.prototype.on=function(s,t){var e=this.sock.subscribe(s);return this.listeners.push({event:s,re:e,fn:t}),this},SubEmitterSocket.prototype.off=function(s){for(var t=0;t<this.listeners.length;++t)this.listeners[t].event===s&&(this.sock.unsubscribe(this.listeners[t].re),this.listeners.splice(t--,1));return this};","node_modules/axon/lib/sockets/push.js":"var roundrobin=require(\"../plugins/round-robin\"),queue=require(\"../plugins/queue\"),Socket=require(\"./sock\");function PushSocket(){Socket.call(this),this.use(queue()),this.use(roundrobin({fallback:this.enqueue}))}module.exports=PushSocket,PushSocket.prototype.__proto__=Socket.prototype;","node_modules/axon/lib/sockets/pull.js":"var Socket=require(\"./sock\");function PullSocket(){Socket.call(this)}module.exports=PullSocket,PullSocket.prototype.__proto__=Socket.prototype,PullSocket.prototype.send=function(){throw new Error(\"pull sockets should not send messages\")};","node_modules/axon/lib/sockets/pub.js":"var Socket=require(\"./sock\"),slice=require(\"../utils\").slice;function PubSocket(){Socket.call(this)}module.exports=PubSocket,PubSocket.prototype.__proto__=Socket.prototype,PubSocket.prototype.send=function(t){for(var e,o=this.socks,r=o.length,c=this.pack(arguments),i=0;i<r;i++)(e=o[i]).writable&&e.write(c);return this};","node_modules/axon/lib/sockets/sub.js":"var debug=require(\"debug\")(\"axon:sub\"),escape=require(\"escape-regexp\"),Message=require(\"amp-message\"),Socket=require(\"./sock\");function SubSocket(){Socket.call(this),this.subscriptions=[]}function toRegExp(t){return t instanceof RegExp?t:(t=(t=escape(t)).replace(/\\\\\\*/g,\"(.+)\"),new RegExp(\"^\"+t+\"$\"))}module.exports=SubSocket,SubSocket.prototype.__proto__=Socket.prototype,SubSocket.prototype.hasSubscriptions=function(){return!!this.subscriptions.length},SubSocket.prototype.matches=function(t){for(var e=0;e<this.subscriptions.length;++e)if(this.subscriptions[e].test(t))return!0;return!1},SubSocket.prototype.onmessage=function(t){var e=this.hasSubscriptions(),s=this;return function(t){var o=new Message(t);if(e){var r=o.args[0];if(!s.matches(r))return debug('not subscribed to \"%s\"',r)}s.emit.apply(s,[\"message\"].concat(o.args))}},SubSocket.prototype.subscribe=function(t){return debug('subscribe to \"%s\"',t),this.subscriptions.push(t=toRegExp(t)),t},SubSocket.prototype.unsubscribe=function(t){debug('unsubscribe from \"%s\"',t),t=toRegExp(t);for(var e=0;e<this.subscriptions.length;++e)this.subscriptions[e].toString()===t.toString()&&this.subscriptions.splice(e--,1)},SubSocket.prototype.clearSubscriptions=function(){this.subscriptions=[]},SubSocket.prototype.send=function(){throw new Error(\"subscribers cannot send messages\")};","node_modules/axon/lib/sockets/req.js":"var debug=require(\"debug\")(\"axon:req\"),queue=require(\"../plugins/queue\"),slice=require(\"../utils\").slice,Message=require(\"amp-message\"),Socket=require(\"./sock\");function ReqSocket(){Socket.call(this),this.n=0,this.ids=0,this.callbacks={},this.identity=this.get(\"identity\"),this.use(queue())}module.exports=ReqSocket,ReqSocket.prototype.__proto__=Socket.prototype,ReqSocket.prototype.id=function(){return this.identity+\":\"+this.ids++},ReqSocket.prototype.onmessage=function(){var e=this;return function(t){var i=new Message(t),s=i.pop(),o=e.callbacks[s];if(!o)return debug(\"missing callback %s\",s);o.apply(null,i.args),delete e.callbacks[s]}},ReqSocket.prototype.send=function(e){var t=this.socks,i=t.length,s=t[this.n++%i],o=slice(arguments);if(s){\"function\"==typeof o[o.length-1]||o.push(function(){});var c=o.pop();c.id=this.id(),this.callbacks[c.id]=c,o.push(c.id)}s?s.write(this.pack(o)):(debug(\"no connected peers\"),this.enqueue(o))};","node_modules/axon/lib/sockets/rep.js":"var slice=require(\"../utils\").slice,debug=require(\"debug\")(\"axon:rep\"),Message=require(\"amp-message\"),Socket=require(\"./sock\");function RepSocket(){Socket.call(this)}module.exports=RepSocket,RepSocket.prototype.__proto__=Socket.prototype,RepSocket.prototype.onmessage=function(e){var t=this;return function(o){var r=new Message(o).args,n=r.pop();r.unshift(\"message\"),r.push(function(){var o=function(){},r=slice(arguments);r[0]=r[0]||null,\"function\"==typeof r[r.length-1]&&(o=r.pop());return r.push(n),e.writable?(e.write(t.pack(r),function(){o(!0)}),!0):(debug(\"peer went away\"),process.nextTick(function(){o(!1)}),!1)}),t.emit.apply(t,r)}};","node_modules/axon/lib/sockets/sock.js":"var Emitter=require(\"events\").EventEmitter,Configurable=require(\"configurable\"),debug=require(\"debug\")(\"axon:sock\"),Message=require(\"amp-message\"),Parser=require(\"amp\").Stream,url=require(\"url\"),net=require(\"net\"),fs=require(\"fs\"),ignore=[\"ECONNREFUSED\",\"ECONNRESET\",\"ETIMEDOUT\",\"EHOSTUNREACH\",\"ENETUNREACH\",\"ENETDOWN\",\"EPIPE\",\"ENOENT\"];function Socket(){this.server=null,this.socks=[],this.settings={},this.set(\"hwm\",1/0),this.set(\"identity\",String(process.pid)),this.set(\"retry timeout\",100),this.set(\"retry max timeout\",5e3)}module.exports=Socket,Socket.prototype.__proto__=Emitter.prototype,Configurable(Socket.prototype),Socket.prototype.use=function(e){return e(this),this},Socket.prototype.pack=function(e){return new Message(e).toBuffer()},Socket.prototype.closeSockets=function(){debug(\"%s closing %d connections\",this.type,this.socks.length),this.socks.forEach(function(e){e.destroy()})},Socket.prototype.close=function(e){debug(\"%s closing\",this.type),this.closing=!0,this.closeSockets(),this.server&&this.closeServer(e)},Socket.prototype.closeServer=function(e){debug(\"%s closing server\",this.type),this.server.on(\"close\",this.emit.bind(this,\"close\")),this.server.close(),e&&e()},Socket.prototype.address=function(){if(this.server){var e=this.server.address();return e.string=\"tcp://\"+e.address+\":\"+e.port,e}},Socket.prototype.removeSocket=function(e){var t=this.socks.indexOf(e);~t&&(debug(\"%s remove socket %d\",this.type,t),this.socks.splice(t,1))},Socket.prototype.addSocket=function(e){var t=new Parser,o=this.socks.push(e)-1;debug(\"%s add socket %d\",this.type,o),e.pipe(t),t.on(\"data\",this.onmessage(e))},Socket.prototype.handleErrors=function(e){var t=this;e.on(\"error\",function(o){if(debug(\"%s error %s\",t.type,o.code||o.message),t.emit(\"socket error\",o),t.removeSocket(e),!~ignore.indexOf(o.code))return t.emit(\"error\",o);debug(\"%s ignored %s\",t.type,o.code),t.emit(\"ignored error\",o)})},Socket.prototype.onmessage=function(e){var t=this;return function(e){var o=new Message(e);t.emit.apply(t,[\"message\"].concat(o.args))}},Socket.prototype.connect=function(e,t,o){var r=this;if(\"server\"==this.type)throw new Error(\"cannot connect() after bind()\");\"function\"==typeof t&&(o=t,t=void 0),\"string\"==typeof e?\"unix:\"==(e=url.parse(e)).protocol?(t=o,o=void 0,e=e.pathname):(t=e.hostname||\"0.0.0.0\",e=parseInt(e.port,10)):t=t||\"0.0.0.0\";var s=r.get(\"retry max timeout\"),n=new net.Socket;return n.setNoDelay(),this.type=\"client\",this.handleErrors(n),n.on(\"close\",function(){if(r.emit(\"socket close\",n),r.connected=!1,r.removeSocket(n),r.closing)return r.emit(\"close\");var o=r.retry||r.get(\"retry timeout\");setTimeout(function(){debug(\"%s attempting reconnect\",r.type),r.emit(\"reconnect attempt\"),n.destroy(),r.connect(e,t),r.retry=Math.round(Math.min(s,1.5*o))},o)}),n.on(\"connect\",function(){debug(\"%s connect\",r.type),r.connected=!0,r.addSocket(n),r.retry=r.get(\"retry timeout\"),r.emit(\"connect\",n),o&&o()}),debug(\"%s connect attempt %s:%s\",r.type,t,e),n.connect(e,t),this},Socket.prototype.onconnect=function(e){var t=this,o=e.remoteAddress+\":\"+e.remotePort;debug(\"%s accept %s\",t.type,o),this.addSocket(e),this.handleErrors(e),this.emit(\"connect\",e),e.on(\"close\",function(){debug(\"%s disconnect %s\",t.type,o),t.emit(\"disconnect\",e),t.removeSocket(e)})},Socket.prototype.bind=function(e,t,o){var r=this;if(\"client\"==this.type)throw new Error(\"cannot bind() after connect()\");\"function\"==typeof t&&(o=t,t=void 0);var s=!1;return\"string\"==typeof e?\"unix:\"==(e=url.parse(e)).protocol?(t=o,o=void 0,e=e.pathname,s=!0):(t=e.hostname||\"0.0.0.0\",e=parseInt(e.port,10)):t=t||\"0.0.0.0\",this.type=\"server\",this.server=net.createServer(this.onconnect.bind(this)),debug(\"%s bind %s:%s\",this.type,t,e),this.server.on(\"listening\",this.emit.bind(this,\"bind\")),s&&this.server.on(\"error\",function(s){if(\"EADDRINUSE\"==s.code){var n=new net.Socket;n.on(\"error\",function(s){\"ECONNREFUSED\"==s.code&&(fs.unlink(e),r.server.listen(e,t,o))}),n.connect({path:e},function(){throw s})}}),this.server.listen(e,t,o),this};","node_modules/axon/lib/utils.js":"exports.slice=function(r){for(var e=r.length,n=new Array(e),t=0;t<e;t++)n[t]=r[t];return n};","node_modules/configurable/index.js":"module.exports=require(\"./lib/configurable\");","node_modules/amp/index.js":"exports.Stream=require(\"./lib/stream\"),exports.encode=require(\"./lib/encode\"),exports.decode=require(\"./lib/decode\");","node_modules/configurable/lib/configurable.js":"module.exports=function(t){return t.settings={},t.set=function(t,e){if(1==arguments.length)for(var n in t)this.set(n,t[n]);else this.settings[t]=e;return this},t.get=function(t){return this.settings[t]},t.enable=function(t){return this.set(t,!0)},t.disable=function(t){return this.set(t,!1)},t.enabled=function(t){return!!this.get(t)},t.disabled=function(t){return!this.get(t)},t};","node_modules/amp/lib/stream.js":"var Stream=require(\"stream\").Writable,encode=require(\"./encode\");function Parser(t){Stream.call(this,t),this.state=\"message\",this._lenbuf=new Buffer(4)}module.exports=Parser,Parser.prototype.__proto__=Stream.prototype,Parser.prototype._write=function(t,e,s){for(var r=0;r<t.length;r++)switch(this.state){case\"message\":var a=t[r];this.version=a>>4,this.argv=15&a,this.state=\"arglen\",this._bufs=[new Buffer([a])],this._nargs=0,this._leni=0;break;case\"arglen\":if(this._lenbuf[this._leni++]=t[r],4==this._leni){this._arglen=this._lenbuf.readUInt32BE(0);var i=new Buffer(4);i[0]=this._lenbuf[0],i[1]=this._lenbuf[1],i[2]=this._lenbuf[2],i[3]=this._lenbuf[3],this._bufs.push(i),this._argcur=0,this.state=\"arg\"}break;case\"arg\":var h=this._arglen-this._argcur,n=Math.min(h+r,t.length),_=t.slice(r,n);this._bufs.push(_),this._argcur+=n-r;var u=this._argcur==this._arglen;if(r=n-1,u&&this._nargs++,this._nargs==this.argv){this.state=\"message\",this.emit(\"data\",Buffer.concat(this._bufs));break}u&&(this.state=\"arglen\",this._leni=0)}s()};","node_modules/amp/lib/encode.js":"var version=1;module.exports=function(r){for(var e=r.length,n=1,t=0,o=0;o<e;o++)n+=4+r[o].length;var v=new Buffer(n);v[t++]=version<<4|e;for(o=0;o<e;o++){var f=r[o];v.writeUInt32BE(f.length,t),t+=4,f.copy(v,t),t+=f.length}return v};","node_modules/amp/lib/decode.js":"module.exports=function(r){for(var e=0,a=r[e++],n=15&a,o=new Array(n),t=0;t<n;t++){var u=r.readUInt32BE(e);e+=4;var v=r.slice(e,e+=u);o[t]=v}return o};","node_modules/escape-regexp/index.js":"module.exports=function(e){return String(e).replace(/([.*+?=^!:${}()|[\\]\\/\\\\])/g,\"\\\\$1\")};","node_modules/axon/lib/plugins/round-robin.js":"var slice=require(\"../utils\").slice;module.exports=function(i){var e=(i=i||{}).fallback||function(){};return function(i){e=e.bind(i);var n=0;i.send=function(){var i=this.socks,t=i.length,r=i[n++%t],c=slice(arguments);r&&r.writable?r.write(this.pack(c)):e(c)}}};","node_modules/axon/lib/plugins/queue.js":"var debug=require(\"debug\")(\"axon:queue\");module.exports=function(e){return e=e||{},function(e){e.queue=[],e.on(\"connect\",function(){var u=e.queue,n=u.length;e.queue=[],debug(\"flush %d messages\",n);for(var t=0;t<n;++t)this.send.apply(this,u[t]);e.emit(\"flush\",u)}),e.enqueue=function(u){var n=e.settings.hwm;if(e.queue.length>=n)return function(u){debug(\"drop\"),e.emit(\"drop\",u)}(u);e.queue.push(u)}}};","backend/node_modules/program/Watchdog.js":"\"use strict\";var util=require(\"util\"),step=require(\"h5.step\"),ControlUnit=require(\"./ControlUnit\");function Watchdog(t){ControlUnit.call(this,t.broker,t.modbus,t.program,\"watchdog\"),this.first=!0,this.timer=null,this.watch([\"contactors.2\"],\"manageWatchdog\")}module.exports=Watchdog,util.inherits(Watchdog,ControlUnit),Watchdog.prototype.manageWatchdog=function(){const t=this.lock(\"manageTest\");if(t.isLocked())return void(t.cb=this.manageWatchdog.bind(this));t.on();const i=this.first,o=!0===this.getTagValue(\"contactors.2\");if(this.first=!1,i&&o)return t.off();null===this.timer&&(this.timer=setInterval(this.refresh.bind(this),1e3))},Watchdog.prototype.refresh=function(){this.getTagValue(\"masters.controlProcess\")&&this.setTagValue(\"watchdog\",!0)};","backend/node_modules/program/ProgramManager.js":"\"use strict\";var util=require(\"util\"),step=require(\"h5.step\"),ControlUnit=require(\"./ControlUnit\");function ProgramManager(t){ControlUnit.call(this,t.broker,t.modbus,t.program,\"program\"),this.Program=t.mongoose.model(\"SnfProgram\"),this.currentProgram=null,this.broker.subscribe(\"snf.programs.edited\",this.onProgramEdited.bind(this)),this.watch([\".30s\",\".hrs\",\".tester\",\"testKind.*\",\".mnh\",\".lampCount\",\".lampBulb\",\".lightSensors\",\".limitSwitch\",\".hrsCount.pc\",\".hrsInterval.pc\",\".hrsDuration\",\".timeToShine\",\".duration.pc\",\".current.min\",\".current.max\",\".contactors\",\"light.1.min.plc\",\"light.2.min.plc\",\"light.1.min.pc\",\"light.2.min.pc\",\".bulbHolder\"],\"manageProgram\")}module.exports=ProgramManager,util.inherits(ProgramManager,ControlUnit),ProgramManager.prototype.getCurrentProgram=function(){return this.currentProgram},ProgramManager.prototype.is30sKind=function(){return this.getTagValue(\"testKind.1\")&&!this.getTagValue(\"testKind.2\")},ProgramManager.prototype.isHrsKind=function(){return!this.getTagValue(\"testKind.1\")&&!this.getTagValue(\"testKind.2\")},ProgramManager.prototype.onProgramEdited=function(t){const a=t.model,r=this.getTagValue(`program.${a.kind}`);a._id===r._id&&this.setTagValue(`program.${a.kind}`,a,()=>{this.getTagValue(\"contactors.2\")||this.changeProgram(a.kind)})},ProgramManager.prototype.manageProgram=function(){this.is30sKind()?this.changeProgram(\"30s\"):this.isHrsKind()?this.changeProgram(\"hrs\"):this.changeProgram(\"tester\")},ProgramManager.prototype.changeProgram=function(t){const a=this.lock(\"changeProgram\");if(a.isLocked())return void(a.cb=this.manageProgram.bind(this));a.on();const r=this.getTagValue(`.${t}`);this.updateProgramTags(r&&r._id?new this.Program(r):null,a)},ProgramManager.prototype.updateProgramTags=function(t,a){const r=this,e=!t?0:t.getContactorsBytes();this.currentProgram=t||null,t||(t={}),step(function(){r.setTagValue(\".mnh\",3===t.lampCount,this.parallel()),r.setTagValue(\".lampCount\",2===t.lampCount,this.parallel()),r.setTagValue(\".lampBulb\",t.lampBulb,this.parallel()),r.setTagValue(\".lightSensors\",!!t.lightSensors,this.parallel()),r.setTagValue(\".limitSwitch\",!0===t.limitSwitch,this.parallel()),r.setTagValue(\".hrsCount.pc\",t.hrsCount||0,this.parallel()),r.setTagValue(\".hrsInterval.pc\",t.hrsInterval||0,this.parallel()),r.setTagValue(\".hrsDuration\",t.hrsTime||0,this.parallel()),r.setTagValue(\".timeToShine\",t.waitForStartTime||0,this.parallel()),r.setTagValue(\".duration.pc\",t.illuminationTime||0,this.parallel()),r.setTagValue(\".current.min\",t.minCurrent||0,this.parallel()),r.setTagValue(\".current.max\",t.maxCurrent||0,this.parallel()),r.setTagValue(\".bulbHolder\",!0===t.bulbHolder,this.parallel()),r.getTagValue(\".contactors\")!==e&&(this.setContactors=!0,r.setTagValue(\".contactors\",0,this.parallel())),r.setTagValue(\"light.1.min.plc\",r.getTagValue(\"light.1.min.pc\")||0,this.parallel()),r.setTagValue(\"light.2.min.plc\",r.getTagValue(\"light.2.min.pc\")||0,this.parallel())},function(){this.setContactors&&setTimeout(this.next(),1e3)},function(){this.setContactors&&r.setTagValue(\".contactors\",e,this.next())},function(){a.off()})};","backend/node_modules/program/TestManager.js":"\"use strict\";const util=require(\"util\"),step=require(\"h5.step\"),ControlUnit=require(\"./ControlUnit\");function TestManager(t){ControlUnit.call(this,t.broker,t.modbus,t.program,\"test\"),this.Test=t.mongoose.model(\"SnfTest\"),this.Program=t.mongoose.model(\"SnfProgram\"),this.currentTest=null,this.lastTest=null,this.tags=null,this.tagCollectionTimer=null,this.watch([\"contactors.2\",\".success\",\".failure\"],\"manageTest\"),this.watch([\".failure.current\",\".failure.light\",\".failure.time\",\".failure.bulbHolder\"],\"handleFailure\")}module.exports=TestManager,util.inherits(TestManager,ControlUnit),TestManager.prototype.manageTest=function(){const t=this.lock(\"manageTest\");if(!t.isLocked())return t.on(),this.getTagValue(\"contactors.2\")?this.beginTest(t):setTimeout(this.finishTest.bind(this,new Date,t),1e3);t.cb=this.manageTest.bind(this)},TestManager.prototype.beginTest=function(t){if(this.currentTest)return this.warn(\"Trying to begin a test, but one is already running?\"),t.off();const e=this.program.programManager.getCurrentProgram();return e?(this.currentTest=new this.Test({startedAt:new Date,finishedAt:null,program:e.toJSON(),result:!1,currentPassed:!0,lightPassed:!0,timePassed:!0,bulbHolderPassed:!0,tags:{},extremes:{minLight1:this.getTagValue(\"light.1.min.pc\"),minLight2:this.getTagValue(\"light.2.min.pc\"),minCurrent:this.getTagValue(\"program.current.min\"),maxCurrent:this.getTagValue(\"program.current.max\")},prodLine:this.getTagValue(\"prodLine\"),orderNo:this.getTagValue(\"currentOrder\")||\"\",serialNo:0}),this.startCollectingTags(),this.broker.publish(\"snf.tests.started\",this.currentTest.toJSON()),this.debug(\"Test started...\",{programName:e.name}),t.off()):(this.warn(\"Trying to begin a test, but there is no program selected!\"),t.off())},TestManager.prototype.handleFailure=function(){this.currentTest&&(this.getTagValue(\".failure.current\")&&(this.currentTest.currentPassed=!1),this.getTagValue(\".failure.light\")&&(this.currentTest.lightPassed=!1),this.getTagValue(\".failure.time\")&&(this.currentTest.timePassed=!1),this.getTagValue(\".failure.bulbHolder\")&&(this.currentTest.bulbHolderPassed=!1))},TestManager.prototype.finishTest=function(t,e){if(!this.currentTest)return this.warn(\"Trying to finish a test, but no test was running?\"),e.off();this.stopCollectingTags();const s=this.currentTest;s.set({finishedAt:t,result:s.currentPassed&&s.lightPassed&&s.timePassed,tags:this.tags}),this.currentTest=null,this.tags=null,s.save(t=>(this.lastTest=null,t?(this.error(t,\"Failed to save the current test.\"),this.broker.publish(\"snf.tests.finished\",null)):(this.debug(\"Test completed.\",{result:s.result}),this.lastTest=s._id.toString()),this.broker.publish(\"snf.tests.finished\",this.lastTest),e.off()))},TestManager.prototype.startCollectingTags=function(){this.tags={temperature:[],light1:[],light2:[],current:[],voltage:[]},this.tagCollectionTimer=setInterval(this.collectTags.bind(this),1e3),this.collectTags()},TestManager.prototype.collectTags=function(){this.tags.temperature.push(this.getTagValue(\"temperature\")),this.tags.light1.push(this.getTagValue(\"light.1\")),this.tags.light2.push(this.getTagValue(\"light.2\")),this.tags.current.push(this.getTagValue(\"current\")),this.tags.voltage.push(this.getTagValue(\"voltage\"))},TestManager.prototype.stopCollectingTags=function(){clearInterval(this.tagCollectionTimer),this.tagCollectionTimer=null};","backend/node_modules/snf-programs/models/snfProgram.js":"\"use strict\";exports.name=\"SnfProgram\",exports.setUp=((t,e)=>{const i={type:Boolean,default:!1},n=new e.Schema({_id:{type:String,required:!0},type:{type:String,required:!0,enum:[\"jpg\",\"png\",\"gif\"]},label:{type:String,required:!0}},{id:!1}),r=new e.Schema({name:{type:String,required:!0,trim:!0},kind:{type:String,enum:[\"30s\",\"hrs\",\"tester\"],default:\"30s\"},lightSourceType:{type:String,enum:[\"100\",\"2x100\",\"400\",\"2x400\",\"2000\"],default:\"100\"},bulbPower:{type:String,enum:[\"100\",\"2x100\",\"150\",\"250\",\"2x250\",\"400\",\"2x400\",\"600\",\"2x600\",\"1000\",\"2000\"],default:\"100\"},ballast:{type:String,enum:[\"400\",\"2x400\",\"2000\"],default:\"400\"},ignitron:{type:String,enum:[\"outside\",\"fitting\",\"tin\"],default:\"outside\"},lampCount:{type:Number,min:1,max:3,default:1},lampBulb:{type:Boolean,default:!1},lightSensors:{type:Boolean,default:!0},plcProgram:{type:Number,min:0,default:0},waitForStartTime:{type:Number,default:0},illuminationTime:{type:Number,default:0},hrsInterval:{type:Number,default:0},hrsTime:{type:Number,default:0},hrsCount:{type:Number,default:0},interlock:{type:String,enum:[\"1\",\"1+2\",\"mnh\"],default:\"1\"},testerK12:i,ballast400W1:i,ballast400W2:i,ballast2000W:i,ignitron400W1:i,ignitron400W2:i,ignitron2000W:i,limitSwitch:i,k15:i,k16:i,k17:i,k18:i,k19:i,k20:i,k21:i,minCurrent:{type:Number,default:0,min:0,max:100},maxCurrent:{type:Number,default:0,min:0,max:100},bulbHolder:{type:Boolean,default:!1},images:[n],updatedAt:Date},{id:!1,versionKey:!1});r.statics.TOPIC_PREFIX=\"snf.programs\",r.pre(\"save\",function(t){this.updatedAt=new Date,t()}),r.methods.getContactorsBytes=function(){let t=this.ballast400W1?1:0;return this.ballast400W2&&(t|=2),this.ballast2000W&&(t|=4),this.ignitron400W1&&(t|=8),this.ignitron400W2&&(t|=16),this.ignitron2000W&&(t|=32),this.k15&&(t|=64),this.k16&&(t|=128),this.k17&&(t|=256),this.k18&&(t|=512),this.k19&&(t|=1024),this.k20&&(t|=2048),this.k21&&(t|=4096),this.testerK12&&(t|=8192),t},e.model(exports.name,r)});","backend/node_modules/snf-tests/models/snfTest.js":"\"use strict\";exports.name=\"SnfTest\",exports.setUp=((e,t)=>{const s=new t.Schema({startedAt:Date,finishedAt:Date,program:{},result:Boolean,currentPassed:Boolean,lightPassed:Boolean,timePassed:Boolean,bulbHolderPassed:Boolean,tags:{},extremes:{},prodLine:String,orderNo:String,serialNo:{type:Number,default:0}},{id:!1});s.statics.TOPIC_PREFIX=\"snf.tests\",s.index({startedAt:-1}),s.index({orderNo:1}),t.model(exports.name,s)});","backend/node_modules/program/ControlUnit.js":"\"use strict\";const _=require(\"lodash\"),Lock=require(\"./Lock\");function ControlUnit(t,n,o,e,i){this.broker=t.sandbox(),this.modbus=n,this.program=o,this.index=i,this.tagPrefix=i>0?`${e}.${i}`:e,this.locks={}}module.exports=ControlUnit,ControlUnit.prototype.getIndex=function(){return this.index},ControlUnit.prototype.getTagName=function(t){return\".\"===t.charAt(0)?this.tagPrefix+t:t},ControlUnit.prototype.getTagValue=function(t){return this.modbus.values[this.getTagName(t)]},ControlUnit.prototype.getLastTagChangeTime=function(t){const n=this.modbus.tags[this.getTagName(t)];return _.isUndefined(n)?0:n.lastChangeTime},ControlUnit.prototype.setTagValue=function(t,n,o){_.isFunction(o)||(o=function(){}),t=this.getTagName(t);const e=this.modbus.tags[t];return _.isObject(e)?e.getValue()===n?o(null,!0):void e.writeValue(n,o):o(new Error(\"UNKNOWN_TAG\"))},ControlUnit.prototype.ackTagValue=function(t,n,o,e){3===arguments.length&&(e=o,o=2e3);const i=this.modbus.tags[this.getTagName(t)];if(_.isUndefined(i)||i.getValue()===n)return e(null,!1);let r,s;r=this.broker.subscribe(\"tagValueChanged.\"+i.name).on(\"message\",function(t){t.newValue===n&&(r.cancel(),clearTimeout(s),e(null,!1))}),s=setTimeout(function(){r.cancel(),e(new Error(\"ACK_TIMEOUT\"),!1)},o||2e3)},ControlUnit.prototype.watch=function(t,n){n=this.bindExec(n),_.isArray(t)||(t=[t]),_.forEach(t,t=>{this.broker.subscribe(`tagValueChanged.${this.getTagName(t)}`,n)}),process.nextTick(n)},ControlUnit.prototype.bindExec=function(t){return this.program.exec.bind(null,this[t].bind(this),`${this.tagPrefix}~${t}`)},ControlUnit.prototype.lock=function(t){return _.isUndefined(this.locks[t])&&(this.locks[t]=new Lock),this.locks[t]},ControlUnit.prototype.debug=function(...t){this.program.debug(...t,{controlUnit:this.tagPrefix})},ControlUnit.prototype.warn=function(...t){this.program.warn(...t,{controlUnit:this.tagPrefix})},ControlUnit.prototype.error=function(...t){this.program.error(...t,{controlUnit:this.tagPrefix})};","backend/node_modules/program/Lock.js":"\"use strict\";function Lock(){this.active=!1,this.cb=null}module.exports=Lock,Lock.prototype.isLocked=function(){return this.active},Lock.prototype.on=function(){this.active=!0},Lock.prototype.off=function(){this.active=!1,null!==this.cb&&(process.nextTick(this.cb),this.cb=null)};"}}